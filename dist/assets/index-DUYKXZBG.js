(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function pd(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function _E(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var Jh={exports:{}},zo={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bv;function EE(){if(bv)return zo;bv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,s,a){var l=null;if(a!==void 0&&(l=""+a),s.key!==void 0&&(l=""+s.key),"key"in s){a={};for(var u in s)u!=="key"&&(a[u]=s[u])}else a=s;return s=a.ref,{$$typeof:n,type:r,key:l,ref:s!==void 0?s:null,props:a}}return zo.Fragment=e,zo.jsx=t,zo.jsxs=t,zo}var vv;function NE(){return vv||(vv=1,Jh.exports=EE()),Jh.exports}var p=NE(),Qh={exports:{}},Se={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xv;function CE(){if(xv)return Se;xv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.iterator;function v(A){return A===null||typeof A!="object"?null:(A=y&&A[y]||A["@@iterator"],typeof A=="function"?A:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,k={};function _(A,W,re){this.props=A,this.context=W,this.refs=k,this.updater=re||x}_.prototype.isReactComponent={},_.prototype.setState=function(A,W){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,W,"setState")},_.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function N(){}N.prototype=_.prototype;function M(A,W,re){this.props=A,this.context=W,this.refs=k,this.updater=re||x}var C=M.prototype=new N;C.constructor=M,w(C,_.prototype),C.isPureReactComponent=!0;var I=Array.isArray,H={H:null,A:null,T:null,S:null,V:null},Q=Object.prototype.hasOwnProperty;function G(A,W,re,ee,de,Oe){return re=Oe.ref,{$$typeof:n,type:A,key:W,ref:re!==void 0?re:null,props:Oe}}function X(A,W){return G(A.type,W,void 0,void 0,void 0,A.props)}function Y(A){return typeof A=="object"&&A!==null&&A.$$typeof===n}function ye(A){var W={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(re){return W[re]})}var $e=/\/+/g;function Ce(A,W){return typeof A=="object"&&A!==null&&A.key!=null?ye(""+A.key):W.toString(36)}function tt(){}function ie(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(tt,tt):(A.status="pending",A.then(function(W){A.status==="pending"&&(A.status="fulfilled",A.value=W)},function(W){A.status==="pending"&&(A.status="rejected",A.reason=W)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function he(A,W,re,ee,de){var Oe=typeof A;(Oe==="undefined"||Oe==="boolean")&&(A=null);var ge=!1;if(A===null)ge=!0;else switch(Oe){case"bigint":case"string":case"number":ge=!0;break;case"object":switch(A.$$typeof){case n:case e:ge=!0;break;case m:return ge=A._init,he(ge(A._payload),W,re,ee,de)}}if(ge)return de=de(A),ge=ee===""?"."+Ce(A,0):ee,I(de)?(re="",ge!=null&&(re=ge.replace($e,"$&/")+"/"),he(de,W,re,"",function(Dn){return Dn})):de!=null&&(Y(de)&&(de=X(de,re+(de.key==null||A&&A.key===de.key?"":(""+de.key).replace($e,"$&/")+"/")+ge)),W.push(de)),1;ge=0;var Vt=ee===""?".":ee+":";if(I(A))for(var Ke=0;Ke<A.length;Ke++)ee=A[Ke],Oe=Vt+Ce(ee,Ke),ge+=he(ee,W,re,Oe,de);else if(Ke=v(A),typeof Ke=="function")for(A=Ke.call(A),Ke=0;!(ee=A.next()).done;)ee=ee.value,Oe=Vt+Ce(ee,Ke++),ge+=he(ee,W,re,Oe,de);else if(Oe==="object"){if(typeof A.then=="function")return he(ie(A),W,re,ee,de);throw W=String(A),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.")}return ge}function $(A,W,re){if(A==null)return A;var ee=[],de=0;return he(A,ee,"","",function(Oe){return W.call(re,Oe,de++)}),ee}function P(A){if(A._status===-1){var W=A._result;W=W(),W.then(function(re){(A._status===0||A._status===-1)&&(A._status=1,A._result=re)},function(re){(A._status===0||A._status===-1)&&(A._status=2,A._result=re)}),A._status===-1&&(A._status=0,A._result=W)}if(A._status===1)return A._result.default;throw A._result}var oe=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var W=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(W))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)};function Ae(){}return Se.Children={map:$,forEach:function(A,W,re){$(A,function(){W.apply(this,arguments)},re)},count:function(A){var W=0;return $(A,function(){W++}),W},toArray:function(A){return $(A,function(W){return W})||[]},only:function(A){if(!Y(A))throw Error("React.Children.only expected to receive a single React element child.");return A}},Se.Component=_,Se.Fragment=t,Se.Profiler=s,Se.PureComponent=M,Se.StrictMode=r,Se.Suspense=d,Se.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=H,Se.__COMPILER_RUNTIME={__proto__:null,c:function(A){return H.H.useMemoCache(A)}},Se.cache=function(A){return function(){return A.apply(null,arguments)}},Se.cloneElement=function(A,W,re){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var ee=w({},A.props),de=A.key,Oe=void 0;if(W!=null)for(ge in W.ref!==void 0&&(Oe=void 0),W.key!==void 0&&(de=""+W.key),W)!Q.call(W,ge)||ge==="key"||ge==="__self"||ge==="__source"||ge==="ref"&&W.ref===void 0||(ee[ge]=W[ge]);var ge=arguments.length-2;if(ge===1)ee.children=re;else if(1<ge){for(var Vt=Array(ge),Ke=0;Ke<ge;Ke++)Vt[Ke]=arguments[Ke+2];ee.children=Vt}return G(A.type,de,void 0,void 0,Oe,ee)},Se.createContext=function(A){return A={$$typeof:l,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:a,_context:A},A},Se.createElement=function(A,W,re){var ee,de={},Oe=null;if(W!=null)for(ee in W.key!==void 0&&(Oe=""+W.key),W)Q.call(W,ee)&&ee!=="key"&&ee!=="__self"&&ee!=="__source"&&(de[ee]=W[ee]);var ge=arguments.length-2;if(ge===1)de.children=re;else if(1<ge){for(var Vt=Array(ge),Ke=0;Ke<ge;Ke++)Vt[Ke]=arguments[Ke+2];de.children=Vt}if(A&&A.defaultProps)for(ee in ge=A.defaultProps,ge)de[ee]===void 0&&(de[ee]=ge[ee]);return G(A,Oe,void 0,void 0,null,de)},Se.createRef=function(){return{current:null}},Se.forwardRef=function(A){return{$$typeof:u,render:A}},Se.isValidElement=Y,Se.lazy=function(A){return{$$typeof:m,_payload:{_status:-1,_result:A},_init:P}},Se.memo=function(A,W){return{$$typeof:h,type:A,compare:W===void 0?null:W}},Se.startTransition=function(A){var W=H.T,re={};H.T=re;try{var ee=A(),de=H.S;de!==null&&de(re,ee),typeof ee=="object"&&ee!==null&&typeof ee.then=="function"&&ee.then(Ae,oe)}catch(Oe){oe(Oe)}finally{H.T=W}},Se.unstable_useCacheRefresh=function(){return H.H.useCacheRefresh()},Se.use=function(A){return H.H.use(A)},Se.useActionState=function(A,W,re){return H.H.useActionState(A,W,re)},Se.useCallback=function(A,W){return H.H.useCallback(A,W)},Se.useContext=function(A){return H.H.useContext(A)},Se.useDebugValue=function(){},Se.useDeferredValue=function(A,W){return H.H.useDeferredValue(A,W)},Se.useEffect=function(A,W,re){var ee=H.H;if(typeof re=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ee.useEffect(A,W)},Se.useId=function(){return H.H.useId()},Se.useImperativeHandle=function(A,W,re){return H.H.useImperativeHandle(A,W,re)},Se.useInsertionEffect=function(A,W){return H.H.useInsertionEffect(A,W)},Se.useLayoutEffect=function(A,W){return H.H.useLayoutEffect(A,W)},Se.useMemo=function(A,W){return H.H.useMemo(A,W)},Se.useOptimistic=function(A,W){return H.H.useOptimistic(A,W)},Se.useReducer=function(A,W,re){return H.H.useReducer(A,W,re)},Se.useRef=function(A){return H.H.useRef(A)},Se.useState=function(A){return H.H.useState(A)},Se.useSyncExternalStore=function(A,W,re){return H.H.useSyncExternalStore(A,W,re)},Se.useTransition=function(){return H.H.useTransition()},Se.version="19.1.1",Se}var wv;function _l(){return wv||(wv=1,Qh.exports=CE()),Qh.exports}var T=_l();const An=pd(T);var Xh={exports:{}},Uo={},Zh={exports:{}},ep={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sv;function TE(){return Sv||(Sv=1,function(n){function e($,P){var oe=$.length;$.push(P);e:for(;0<oe;){var Ae=oe-1>>>1,A=$[Ae];if(0<s(A,P))$[Ae]=P,$[oe]=A,oe=Ae;else break e}}function t($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var P=$[0],oe=$.pop();if(oe!==P){$[0]=oe;e:for(var Ae=0,A=$.length,W=A>>>1;Ae<W;){var re=2*(Ae+1)-1,ee=$[re],de=re+1,Oe=$[de];if(0>s(ee,oe))de<A&&0>s(Oe,ee)?($[Ae]=Oe,$[de]=oe,Ae=de):($[Ae]=ee,$[re]=oe,Ae=re);else if(de<A&&0>s(Oe,oe))$[Ae]=Oe,$[de]=oe,Ae=de;else break e}}return P}function s($,P){var oe=$.sortIndex-P.sortIndex;return oe!==0?oe:$.id-P.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();n.unstable_now=function(){return l.now()-u}}var d=[],h=[],m=1,y=null,v=3,x=!1,w=!1,k=!1,_=!1,N=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function I($){for(var P=t(h);P!==null;){if(P.callback===null)r(h);else if(P.startTime<=$)r(h),P.sortIndex=P.expirationTime,e(d,P);else break;P=t(h)}}function H($){if(k=!1,I($),!w)if(t(d)!==null)w=!0,Q||(Q=!0,Ce());else{var P=t(h);P!==null&&he(H,P.startTime-$)}}var Q=!1,G=-1,X=5,Y=-1;function ye(){return _?!0:!(n.unstable_now()-Y<X)}function $e(){if(_=!1,Q){var $=n.unstable_now();Y=$;var P=!0;try{e:{w=!1,k&&(k=!1,M(G),G=-1),x=!0;var oe=v;try{t:{for(I($),y=t(d);y!==null&&!(y.expirationTime>$&&ye());){var Ae=y.callback;if(typeof Ae=="function"){y.callback=null,v=y.priorityLevel;var A=Ae(y.expirationTime<=$);if($=n.unstable_now(),typeof A=="function"){y.callback=A,I($),P=!0;break t}y===t(d)&&r(d),I($)}else r(d);y=t(d)}if(y!==null)P=!0;else{var W=t(h);W!==null&&he(H,W.startTime-$),P=!1}}break e}finally{y=null,v=oe,x=!1}P=void 0}}finally{P?Ce():Q=!1}}}var Ce;if(typeof C=="function")Ce=function(){C($e)};else if(typeof MessageChannel<"u"){var tt=new MessageChannel,ie=tt.port2;tt.port1.onmessage=$e,Ce=function(){ie.postMessage(null)}}else Ce=function(){N($e,0)};function he($,P){G=N(function(){$(n.unstable_now())},P)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_next=function($){switch(v){case 1:case 2:case 3:var P=3;break;default:P=v}var oe=v;v=P;try{return $()}finally{v=oe}},n.unstable_requestPaint=function(){_=!0},n.unstable_runWithPriority=function($,P){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var oe=v;v=$;try{return P()}finally{v=oe}},n.unstable_scheduleCallback=function($,P,oe){var Ae=n.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?Ae+oe:Ae):oe=Ae,$){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=oe+A,$={id:m++,callback:P,priorityLevel:$,startTime:oe,expirationTime:A,sortIndex:-1},oe>Ae?($.sortIndex=oe,e(h,$),t(d)===null&&$===t(h)&&(k?(M(G),G=-1):k=!0,he(H,oe-Ae))):($.sortIndex=A,e(d,$),w||x||(w=!0,Q||(Q=!0,Ce()))),$},n.unstable_shouldYield=ye,n.unstable_wrapCallback=function($){var P=v;return function(){var oe=v;v=P;try{return $.apply(this,arguments)}finally{v=oe}}}}(ep)),ep}var kv;function jE(){return kv||(kv=1,Zh.exports=TE()),Zh.exports}var tp={exports:{}},$t={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _v;function ME(){if(_v)return $t;_v=1;var n=_l();function e(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(d,h,m){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:y==null?null:""+y,children:d,containerInfo:h,implementation:m}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return $t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,$t.createPortal=function(d,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return a(d,h,null,m)},$t.flushSync=function(d){var h=l.T,m=r.p;try{if(l.T=null,r.p=2,d)return d()}finally{l.T=h,r.p=m,r.d.f()}},$t.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,r.d.C(d,h))},$t.prefetchDNS=function(d){typeof d=="string"&&r.d.D(d)},$t.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var m=h.as,y=u(m,h.crossOrigin),v=typeof h.integrity=="string"?h.integrity:void 0,x=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;m==="style"?r.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:y,integrity:v,fetchPriority:x}):m==="script"&&r.d.X(d,{crossOrigin:y,integrity:v,fetchPriority:x,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},$t.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var m=u(h.as,h.crossOrigin);r.d.M(d,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&r.d.M(d)},$t.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var m=h.as,y=u(m,h.crossOrigin);r.d.L(d,m,{crossOrigin:y,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},$t.preloadModule=function(d,h){if(typeof d=="string")if(h){var m=u(h.as,h.crossOrigin);r.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else r.d.m(d)},$t.requestFormReset=function(d){r.d.r(d)},$t.unstable_batchedUpdates=function(d,h){return d(h)},$t.useFormState=function(d,h,m){return l.H.useFormState(d,h,m)},$t.useFormStatus=function(){return l.H.useHostTransitionStatus()},$t.version="19.1.1",$t}var Ev;function B1(){if(Ev)return tp.exports;Ev=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),tp.exports=ME(),tp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nv;function AE(){if(Nv)return Uo;Nv=1;var n=jE(),e=_l(),t=B1();function r(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function a(i){var o=i,c=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(c=o.return),i=o.return;while(i)}return o.tag===3?c:null}function l(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function u(i){if(a(i)!==i)throw Error(r(188))}function d(i){var o=i.alternate;if(!o){if(o=a(i),o===null)throw Error(r(188));return o!==i?null:i}for(var c=i,f=o;;){var g=c.return;if(g===null)break;var b=g.alternate;if(b===null){if(f=g.return,f!==null){c=f;continue}break}if(g.child===b.child){for(b=g.child;b;){if(b===c)return u(g),i;if(b===f)return u(g),o;b=b.sibling}throw Error(r(188))}if(c.return!==f.return)c=g,f=b;else{for(var S=!1,E=g.child;E;){if(E===c){S=!0,c=g,f=b;break}if(E===f){S=!0,f=g,c=b;break}E=E.sibling}if(!S){for(E=b.child;E;){if(E===c){S=!0,c=b,f=g;break}if(E===f){S=!0,f=b,c=g;break}E=E.sibling}if(!S)throw Error(r(189))}}if(c.alternate!==f)throw Error(r(190))}if(c.tag!==3)throw Error(r(188));return c.stateNode.current===c?i:o}function h(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=h(i),o!==null)return o;i=i.sibling}return null}var m=Object.assign,y=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),M=Symbol.for("react.consumer"),C=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),Q=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),Y=Symbol.for("react.activity"),ye=Symbol.for("react.memo_cache_sentinel"),$e=Symbol.iterator;function Ce(i){return i===null||typeof i!="object"?null:(i=$e&&i[$e]||i["@@iterator"],typeof i=="function"?i:null)}var tt=Symbol.for("react.client.reference");function ie(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===tt?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case w:return"Fragment";case _:return"Profiler";case k:return"StrictMode";case H:return"Suspense";case Q:return"SuspenseList";case Y:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case x:return"Portal";case C:return(i.displayName||"Context")+".Provider";case M:return(i._context.displayName||"Context")+".Consumer";case I:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case G:return o=i.displayName||null,o!==null?o:ie(i.type)||"Memo";case X:o=i._payload,i=i._init;try{return ie(i(o))}catch{}}return null}var he=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe={pending:!1,data:null,method:null,action:null},Ae=[],A=-1;function W(i){return{current:i}}function re(i){0>A||(i.current=Ae[A],Ae[A]=null,A--)}function ee(i,o){A++,Ae[A]=i.current,i.current=o}var de=W(null),Oe=W(null),ge=W(null),Vt=W(null);function Ke(i,o){switch(ee(ge,o),ee(Oe,i),ee(de,null),o.nodeType){case 9:case 11:i=(i=o.documentElement)&&(i=i.namespaceURI)?Kb(i):0;break;default:if(i=o.tagName,o=o.namespaceURI)o=Kb(o),i=Gb(o,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}re(de),ee(de,i)}function Dn(){re(de),re(Oe),re(ge)}function mi(i){i.memoizedState!==null&&ee(Vt,i);var o=de.current,c=Gb(o,i.type);o!==c&&(ee(Oe,i),ee(de,c))}function Cs(i){Oe.current===i&&(re(de),re(Oe)),Vt.current===i&&(re(Vt),Oo._currentValue=oe)}var za=Object.prototype.hasOwnProperty,Ua=n.unstable_scheduleCallback,Pa=n.unstable_cancelCallback,Ld=n.unstable_shouldYield,Dl=n.unstable_requestPaint,yn=n.unstable_now,Bd=n.unstable_getCurrentPriorityLevel,Ll=n.unstable_ImmediatePriority,V=n.unstable_UserBlockingPriority,se=n.unstable_NormalPriority,te=n.unstable_LowPriority,we=n.unstable_IdlePriority,be=n.log,At=n.unstable_setDisableYieldValue,Le=null,Qe=null;function xt(i){if(typeof be=="function"&&At(i),Qe&&typeof Qe.setStrictMode=="function")try{Qe.setStrictMode(Le,i)}catch{}}var ot=Math.clz32?Math.clz32:uk,zd=Math.log,ck=Math.LN2;function uk(i){return i>>>=0,i===0?32:31-(zd(i)/ck|0)|0}var Bl=256,zl=4194304;function Ts(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Ul(i,o,c){var f=i.pendingLanes;if(f===0)return 0;var g=0,b=i.suspendedLanes,S=i.pingedLanes;i=i.warmLanes;var E=f&134217727;return E!==0?(f=E&~b,f!==0?g=Ts(f):(S&=E,S!==0?g=Ts(S):c||(c=E&~i,c!==0&&(g=Ts(c))))):(E=f&~b,E!==0?g=Ts(E):S!==0?g=Ts(S):c||(c=f&~i,c!==0&&(g=Ts(c)))),g===0?0:o!==0&&o!==g&&(o&b)===0&&(b=g&-g,c=o&-o,b>=c||b===32&&(c&4194048)!==0)?o:g}function $a(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function dk(i,o){switch(i){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jg(){var i=Bl;return Bl<<=1,(Bl&4194048)===0&&(Bl=256),i}function Mg(){var i=zl;return zl<<=1,(zl&62914560)===0&&(zl=4194304),i}function Ud(i){for(var o=[],c=0;31>c;c++)o.push(i);return o}function Ia(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function fk(i,o,c,f,g,b){var S=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var E=i.entanglements,j=i.expirationTimes,L=i.hiddenUpdates;for(c=S&~c;0<c;){var q=31-ot(c),K=1<<q;E[q]=0,j[q]=-1;var z=L[q];if(z!==null)for(L[q]=null,q=0;q<z.length;q++){var U=z[q];U!==null&&(U.lane&=-536870913)}c&=~K}f!==0&&Ag(i,f,0),b!==0&&g===0&&i.tag!==0&&(i.suspendedLanes|=b&~(S&~o))}function Ag(i,o,c){i.pendingLanes|=o,i.suspendedLanes&=~o;var f=31-ot(o);i.entangledLanes|=o,i.entanglements[f]=i.entanglements[f]|1073741824|c&4194090}function Og(i,o){var c=i.entangledLanes|=o;for(i=i.entanglements;c;){var f=31-ot(c),g=1<<f;g&o|i[f]&o&&(i[f]|=o),c&=~g}}function Pd(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function $d(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Rg(){var i=P.p;return i!==0?i:(i=window.event,i===void 0?32:fv(i.type))}function hk(i,o){var c=P.p;try{return P.p=i,o()}finally{P.p=c}}var Or=Math.random().toString(36).slice(2),Ut="__reactFiber$"+Or,Qt="__reactProps$"+Or,gi="__reactContainer$"+Or,Id="__reactEvents$"+Or,pk="__reactListeners$"+Or,mk="__reactHandles$"+Or,Dg="__reactResources$"+Or,Ha="__reactMarker$"+Or;function Hd(i){delete i[Ut],delete i[Qt],delete i[Id],delete i[pk],delete i[mk]}function yi(i){var o=i[Ut];if(o)return o;for(var c=i.parentNode;c;){if(o=c[gi]||c[Ut]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(i=Qb(i);i!==null;){if(c=i[Ut])return c;i=Qb(i)}return o}i=c,c=i.parentNode}return null}function bi(i){if(i=i[Ut]||i[gi]){var o=i.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return i}return null}function qa(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(r(33))}function vi(i){var o=i[Dg];return o||(o=i[Dg]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function wt(i){i[Ha]=!0}var Lg=new Set,Bg={};function js(i,o){xi(i,o),xi(i+"Capture",o)}function xi(i,o){for(Bg[i]=o,i=0;i<o.length;i++)Lg.add(o[i])}var gk=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),zg={},Ug={};function yk(i){return za.call(Ug,i)?!0:za.call(zg,i)?!1:gk.test(i)?Ug[i]=!0:(zg[i]=!0,!1)}function Pl(i,o,c){if(yk(o))if(c===null)i.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var f=o.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+c)}}function $l(i,o,c){if(c===null)i.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+c)}}function rr(i,o,c,f){if(f===null)i.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(o,c,""+f)}}var qd,Pg;function wi(i){if(qd===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);qd=o&&o[1]||"",Pg=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+qd+i+Pg}var Vd=!1;function Fd(i,o){if(!i||Vd)return"";Vd=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(o){var K=function(){throw Error()};if(Object.defineProperty(K.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(K,[])}catch(U){var z=U}Reflect.construct(i,[],K)}else{try{K.call()}catch(U){z=U}i.call(K.prototype)}}else{try{throw Error()}catch(U){z=U}(K=i())&&typeof K.catch=="function"&&K.catch(function(){})}}catch(U){if(U&&z&&typeof U.stack=="string")return[U.stack,z.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=f.DetermineComponentFrameRoot(),S=b[0],E=b[1];if(S&&E){var j=S.split(`
`),L=E.split(`
`);for(g=f=0;f<j.length&&!j[f].includes("DetermineComponentFrameRoot");)f++;for(;g<L.length&&!L[g].includes("DetermineComponentFrameRoot");)g++;if(f===j.length||g===L.length)for(f=j.length-1,g=L.length-1;1<=f&&0<=g&&j[f]!==L[g];)g--;for(;1<=f&&0<=g;f--,g--)if(j[f]!==L[g]){if(f!==1||g!==1)do if(f--,g--,0>g||j[f]!==L[g]){var q=`
`+j[f].replace(" at new "," at ");return i.displayName&&q.includes("<anonymous>")&&(q=q.replace("<anonymous>",i.displayName)),q}while(1<=f&&0<=g);break}}}finally{Vd=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?wi(c):""}function bk(i){switch(i.tag){case 26:case 27:case 5:return wi(i.type);case 16:return wi("Lazy");case 13:return wi("Suspense");case 19:return wi("SuspenseList");case 0:case 15:return Fd(i.type,!1);case 11:return Fd(i.type.render,!1);case 1:return Fd(i.type,!0);case 31:return wi("Activity");default:return""}}function $g(i){try{var o="";do o+=bk(i),i=i.return;while(i);return o}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function bn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Ig(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function vk(i){var o=Ig(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),f=""+i[o];if(!i.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var g=c.get,b=c.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return g.call(this)},set:function(S){f=""+S,b.call(this,S)}}),Object.defineProperty(i,o,{enumerable:c.enumerable}),{getValue:function(){return f},setValue:function(S){f=""+S},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Il(i){i._valueTracker||(i._valueTracker=vk(i))}function Hg(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var c=o.getValue(),f="";return i&&(f=Ig(i)?i.checked?"true":"false":i.value),i=f,i!==c?(o.setValue(i),!0):!1}function Hl(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var xk=/[\n"\\]/g;function vn(i){return i.replace(xk,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Kd(i,o,c,f,g,b,S,E){i.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?i.type=S:i.removeAttribute("type"),o!=null?S==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+bn(o)):i.value!==""+bn(o)&&(i.value=""+bn(o)):S!=="submit"&&S!=="reset"||i.removeAttribute("value"),o!=null?Gd(i,S,bn(o)):c!=null?Gd(i,S,bn(c)):f!=null&&i.removeAttribute("value"),g==null&&b!=null&&(i.defaultChecked=!!b),g!=null&&(i.checked=g&&typeof g!="function"&&typeof g!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?i.name=""+bn(E):i.removeAttribute("name")}function qg(i,o,c,f,g,b,S,E){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(i.type=b),o!=null||c!=null){if(!(b!=="submit"&&b!=="reset"||o!=null))return;c=c!=null?""+bn(c):"",o=o!=null?""+bn(o):c,E||o===i.value||(i.value=o),i.defaultValue=o}f=f??g,f=typeof f!="function"&&typeof f!="symbol"&&!!f,i.checked=E?i.checked:!!f,i.defaultChecked=!!f,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(i.name=S)}function Gd(i,o,c){o==="number"&&Hl(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function Si(i,o,c,f){if(i=i.options,o){o={};for(var g=0;g<c.length;g++)o["$"+c[g]]=!0;for(c=0;c<i.length;c++)g=o.hasOwnProperty("$"+i[c].value),i[c].selected!==g&&(i[c].selected=g),g&&f&&(i[c].defaultSelected=!0)}else{for(c=""+bn(c),o=null,g=0;g<i.length;g++){if(i[g].value===c){i[g].selected=!0,f&&(i[g].defaultSelected=!0);return}o!==null||i[g].disabled||(o=i[g])}o!==null&&(o.selected=!0)}}function Vg(i,o,c){if(o!=null&&(o=""+bn(o),o!==i.value&&(i.value=o),c==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=c!=null?""+bn(c):""}function Fg(i,o,c,f){if(o==null){if(f!=null){if(c!=null)throw Error(r(92));if(he(f)){if(1<f.length)throw Error(r(93));f=f[0]}c=f}c==null&&(c=""),o=c}c=bn(o),i.defaultValue=c,f=i.textContent,f===c&&f!==""&&f!==null&&(i.value=f)}function ki(i,o){if(o){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=o;return}}i.textContent=o}var wk=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Kg(i,o,c){var f=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":f?i.setProperty(o,c):typeof c!="number"||c===0||wk.has(o)?o==="float"?i.cssFloat=c:i[o]=(""+c).trim():i[o]=c+"px"}function Gg(i,o,c){if(o!=null&&typeof o!="object")throw Error(r(62));if(i=i.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||o!=null&&o.hasOwnProperty(f)||(f.indexOf("--")===0?i.setProperty(f,""):f==="float"?i.cssFloat="":i[f]="");for(var g in o)f=o[g],o.hasOwnProperty(g)&&c[g]!==f&&Kg(i,g,f)}else for(var b in o)o.hasOwnProperty(b)&&Kg(i,b,o[b])}function Wd(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sk=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),kk=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ql(i){return kk.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var Yd=null;function Jd(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var _i=null,Ei=null;function Wg(i){var o=bi(i);if(o&&(i=o.stateNode)){var c=i[Qt]||null;e:switch(i=o.stateNode,o.type){case"input":if(Kd(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+vn(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var f=c[o];if(f!==i&&f.form===i.form){var g=f[Qt]||null;if(!g)throw Error(r(90));Kd(f,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(o=0;o<c.length;o++)f=c[o],f.form===i.form&&Hg(f)}break e;case"textarea":Vg(i,c.value,c.defaultValue);break e;case"select":o=c.value,o!=null&&Si(i,!!c.multiple,o,!1)}}}var Qd=!1;function Yg(i,o,c){if(Qd)return i(o,c);Qd=!0;try{var f=i(o);return f}finally{if(Qd=!1,(_i!==null||Ei!==null)&&(Tc(),_i&&(o=_i,i=Ei,Ei=_i=null,Wg(o),i)))for(o=0;o<i.length;o++)Wg(i[o])}}function Va(i,o){var c=i.stateNode;if(c===null)return null;var f=c[Qt]||null;if(f===null)return null;c=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(r(231,o,typeof c));return c}var sr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xd=!1;if(sr)try{var Fa={};Object.defineProperty(Fa,"passive",{get:function(){Xd=!0}}),window.addEventListener("test",Fa,Fa),window.removeEventListener("test",Fa,Fa)}catch{Xd=!1}var Rr=null,Zd=null,Vl=null;function Jg(){if(Vl)return Vl;var i,o=Zd,c=o.length,f,g="value"in Rr?Rr.value:Rr.textContent,b=g.length;for(i=0;i<c&&o[i]===g[i];i++);var S=c-i;for(f=1;f<=S&&o[c-f]===g[b-f];f++);return Vl=g.slice(i,1<f?1-f:void 0)}function Fl(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Kl(){return!0}function Qg(){return!1}function Xt(i){function o(c,f,g,b,S){this._reactName=c,this._targetInst=g,this.type=f,this.nativeEvent=b,this.target=S,this.currentTarget=null;for(var E in i)i.hasOwnProperty(E)&&(c=i[E],this[E]=c?c(b):b[E]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?Kl:Qg,this.isPropagationStopped=Qg,this}return m(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Kl)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Kl)},persist:function(){},isPersistent:Kl}),o}var Ms={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gl=Xt(Ms),Ka=m({},Ms,{view:0,detail:0}),_k=Xt(Ka),ef,tf,Ga,Wl=m({},Ka,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rf,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ga&&(Ga&&i.type==="mousemove"?(ef=i.screenX-Ga.screenX,tf=i.screenY-Ga.screenY):tf=ef=0,Ga=i),ef)},movementY:function(i){return"movementY"in i?i.movementY:tf}}),Xg=Xt(Wl),Ek=m({},Wl,{dataTransfer:0}),Nk=Xt(Ek),Ck=m({},Ka,{relatedTarget:0}),nf=Xt(Ck),Tk=m({},Ms,{animationName:0,elapsedTime:0,pseudoElement:0}),jk=Xt(Tk),Mk=m({},Ms,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Ak=Xt(Mk),Ok=m({},Ms,{data:0}),Zg=Xt(Ok),Rk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Dk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Lk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Bk(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=Lk[i])?!!o[i]:!1}function rf(){return Bk}var zk=m({},Ka,{key:function(i){if(i.key){var o=Rk[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Fl(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Dk[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rf,charCode:function(i){return i.type==="keypress"?Fl(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Fl(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Uk=Xt(zk),Pk=m({},Wl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),e0=Xt(Pk),$k=m({},Ka,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rf}),Ik=Xt($k),Hk=m({},Ms,{propertyName:0,elapsedTime:0,pseudoElement:0}),qk=Xt(Hk),Vk=m({},Wl,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Fk=Xt(Vk),Kk=m({},Ms,{newState:0,oldState:0}),Gk=Xt(Kk),Wk=[9,13,27,32],sf=sr&&"CompositionEvent"in window,Wa=null;sr&&"documentMode"in document&&(Wa=document.documentMode);var Yk=sr&&"TextEvent"in window&&!Wa,t0=sr&&(!sf||Wa&&8<Wa&&11>=Wa),n0=" ",r0=!1;function s0(i,o){switch(i){case"keyup":return Wk.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function i0(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ni=!1;function Jk(i,o){switch(i){case"compositionend":return i0(o);case"keypress":return o.which!==32?null:(r0=!0,n0);case"textInput":return i=o.data,i===n0&&r0?null:i;default:return null}}function Qk(i,o){if(Ni)return i==="compositionend"||!sf&&s0(i,o)?(i=Jg(),Vl=Zd=Rr=null,Ni=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return t0&&o.locale!=="ko"?null:o.data;default:return null}}var Xk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function a0(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!Xk[i.type]:o==="textarea"}function o0(i,o,c,f){_i?Ei?Ei.push(f):Ei=[f]:_i=f,o=Dc(o,"onChange"),0<o.length&&(c=new Gl("onChange","change",null,c,f),i.push({event:c,listeners:o}))}var Ya=null,Ja=null;function Zk(i){Ib(i,0)}function Yl(i){var o=qa(i);if(Hg(o))return i}function l0(i,o){if(i==="change")return o}var c0=!1;if(sr){var af;if(sr){var of="oninput"in document;if(!of){var u0=document.createElement("div");u0.setAttribute("oninput","return;"),of=typeof u0.oninput=="function"}af=of}else af=!1;c0=af&&(!document.documentMode||9<document.documentMode)}function d0(){Ya&&(Ya.detachEvent("onpropertychange",f0),Ja=Ya=null)}function f0(i){if(i.propertyName==="value"&&Yl(Ja)){var o=[];o0(o,Ja,i,Jd(i)),Yg(Zk,o)}}function e_(i,o,c){i==="focusin"?(d0(),Ya=o,Ja=c,Ya.attachEvent("onpropertychange",f0)):i==="focusout"&&d0()}function t_(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Yl(Ja)}function n_(i,o){if(i==="click")return Yl(o)}function r_(i,o){if(i==="input"||i==="change")return Yl(o)}function s_(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var on=typeof Object.is=="function"?Object.is:s_;function Qa(i,o){if(on(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var c=Object.keys(i),f=Object.keys(o);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var g=c[f];if(!za.call(o,g)||!on(i[g],o[g]))return!1}return!0}function h0(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function p0(i,o){var c=h0(i);i=0;for(var f;c;){if(c.nodeType===3){if(f=i+c.textContent.length,i<=o&&f>=o)return{node:c,offset:o-i};i=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=h0(c)}}function m0(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?m0(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function g0(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=Hl(i.document);o instanceof i.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)i=o.contentWindow;else break;o=Hl(i.document)}return o}function lf(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}var i_=sr&&"documentMode"in document&&11>=document.documentMode,Ci=null,cf=null,Xa=null,uf=!1;function y0(i,o,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;uf||Ci==null||Ci!==Hl(f)||(f=Ci,"selectionStart"in f&&lf(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Xa&&Qa(Xa,f)||(Xa=f,f=Dc(cf,"onSelect"),0<f.length&&(o=new Gl("onSelect","select",null,o,c),i.push({event:o,listeners:f}),o.target=Ci)))}function As(i,o){var c={};return c[i.toLowerCase()]=o.toLowerCase(),c["Webkit"+i]="webkit"+o,c["Moz"+i]="moz"+o,c}var Ti={animationend:As("Animation","AnimationEnd"),animationiteration:As("Animation","AnimationIteration"),animationstart:As("Animation","AnimationStart"),transitionrun:As("Transition","TransitionRun"),transitionstart:As("Transition","TransitionStart"),transitioncancel:As("Transition","TransitionCancel"),transitionend:As("Transition","TransitionEnd")},df={},b0={};sr&&(b0=document.createElement("div").style,"AnimationEvent"in window||(delete Ti.animationend.animation,delete Ti.animationiteration.animation,delete Ti.animationstart.animation),"TransitionEvent"in window||delete Ti.transitionend.transition);function Os(i){if(df[i])return df[i];if(!Ti[i])return i;var o=Ti[i],c;for(c in o)if(o.hasOwnProperty(c)&&c in b0)return df[i]=o[c];return i}var v0=Os("animationend"),x0=Os("animationiteration"),w0=Os("animationstart"),a_=Os("transitionrun"),o_=Os("transitionstart"),l_=Os("transitioncancel"),S0=Os("transitionend"),k0=new Map,ff="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ff.push("scrollEnd");function Ln(i,o){k0.set(i,o),js(o,[i])}var _0=new WeakMap;function xn(i,o){if(typeof i=="object"&&i!==null){var c=_0.get(i);return c!==void 0?c:(o={value:i,source:o,stack:$g(o)},_0.set(i,o),o)}return{value:i,source:o,stack:$g(o)}}var wn=[],ji=0,hf=0;function Jl(){for(var i=ji,o=hf=ji=0;o<i;){var c=wn[o];wn[o++]=null;var f=wn[o];wn[o++]=null;var g=wn[o];wn[o++]=null;var b=wn[o];if(wn[o++]=null,f!==null&&g!==null){var S=f.pending;S===null?g.next=g:(g.next=S.next,S.next=g),f.pending=g}b!==0&&E0(c,g,b)}}function Ql(i,o,c,f){wn[ji++]=i,wn[ji++]=o,wn[ji++]=c,wn[ji++]=f,hf|=f,i.lanes|=f,i=i.alternate,i!==null&&(i.lanes|=f)}function pf(i,o,c,f){return Ql(i,o,c,f),Xl(i)}function Mi(i,o){return Ql(i,null,null,o),Xl(i)}function E0(i,o,c){i.lanes|=c;var f=i.alternate;f!==null&&(f.lanes|=c);for(var g=!1,b=i.return;b!==null;)b.childLanes|=c,f=b.alternate,f!==null&&(f.childLanes|=c),b.tag===22&&(i=b.stateNode,i===null||i._visibility&1||(g=!0)),i=b,b=b.return;return i.tag===3?(b=i.stateNode,g&&o!==null&&(g=31-ot(c),i=b.hiddenUpdates,f=i[g],f===null?i[g]=[o]:f.push(o),o.lane=c|536870912),b):null}function Xl(i){if(50<_o)throw _o=0,xh=null,Error(r(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var Ai={};function c_(i,o,c,f){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ln(i,o,c,f){return new c_(i,o,c,f)}function mf(i){return i=i.prototype,!(!i||!i.isReactComponent)}function ir(i,o){var c=i.alternate;return c===null?(c=ln(i.tag,o,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=o,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,o=i.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function N0(i,o){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,o=c.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function Zl(i,o,c,f,g,b){var S=0;if(f=i,typeof i=="function")mf(i)&&(S=1);else if(typeof i=="string")S=dE(i,c,de.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case Y:return i=ln(31,c,o,g),i.elementType=Y,i.lanes=b,i;case w:return Rs(c.children,g,b,o);case k:S=8,g|=24;break;case _:return i=ln(12,c,o,g|2),i.elementType=_,i.lanes=b,i;case H:return i=ln(13,c,o,g),i.elementType=H,i.lanes=b,i;case Q:return i=ln(19,c,o,g),i.elementType=Q,i.lanes=b,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case N:case C:S=10;break e;case M:S=9;break e;case I:S=11;break e;case G:S=14;break e;case X:S=16,f=null;break e}S=29,c=Error(r(130,i===null?"null":typeof i,"")),f=null}return o=ln(S,c,o,g),o.elementType=i,o.type=f,o.lanes=b,o}function Rs(i,o,c,f){return i=ln(7,i,f,o),i.lanes=c,i}function gf(i,o,c){return i=ln(6,i,null,o),i.lanes=c,i}function yf(i,o,c){return o=ln(4,i.children!==null?i.children:[],i.key,o),o.lanes=c,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}var Oi=[],Ri=0,ec=null,tc=0,Sn=[],kn=0,Ds=null,ar=1,or="";function Ls(i,o){Oi[Ri++]=tc,Oi[Ri++]=ec,ec=i,tc=o}function C0(i,o,c){Sn[kn++]=ar,Sn[kn++]=or,Sn[kn++]=Ds,Ds=i;var f=ar;i=or;var g=32-ot(f)-1;f&=~(1<<g),c+=1;var b=32-ot(o)+g;if(30<b){var S=g-g%5;b=(f&(1<<S)-1).toString(32),f>>=S,g-=S,ar=1<<32-ot(o)+g|c<<g|f,or=b+i}else ar=1<<b|c<<g|f,or=i}function bf(i){i.return!==null&&(Ls(i,1),C0(i,1,0))}function vf(i){for(;i===ec;)ec=Oi[--Ri],Oi[Ri]=null,tc=Oi[--Ri],Oi[Ri]=null;for(;i===Ds;)Ds=Sn[--kn],Sn[kn]=null,or=Sn[--kn],Sn[kn]=null,ar=Sn[--kn],Sn[kn]=null}var Ft=null,nt=null,Be=!1,Bs=null,Fn=!1,xf=Error(r(519));function zs(i){var o=Error(r(418,""));throw to(xn(o,i)),xf}function T0(i){var o=i.stateNode,c=i.type,f=i.memoizedProps;switch(o[Ut]=i,o[Qt]=f,c){case"dialog":je("cancel",o),je("close",o);break;case"iframe":case"object":case"embed":je("load",o);break;case"video":case"audio":for(c=0;c<No.length;c++)je(No[c],o);break;case"source":je("error",o);break;case"img":case"image":case"link":je("error",o),je("load",o);break;case"details":je("toggle",o);break;case"input":je("invalid",o),qg(o,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),Il(o);break;case"select":je("invalid",o);break;case"textarea":je("invalid",o),Fg(o,f.value,f.defaultValue,f.children),Il(o)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||f.suppressHydrationWarning===!0||Fb(o.textContent,c)?(f.popover!=null&&(je("beforetoggle",o),je("toggle",o)),f.onScroll!=null&&je("scroll",o),f.onScrollEnd!=null&&je("scrollend",o),f.onClick!=null&&(o.onclick=Lc),o=!0):o=!1,o||zs(i)}function j0(i){for(Ft=i.return;Ft;)switch(Ft.tag){case 5:case 13:Fn=!1;return;case 27:case 3:Fn=!0;return;default:Ft=Ft.return}}function Za(i){if(i!==Ft)return!1;if(!Be)return j0(i),Be=!0,!1;var o=i.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||Bh(i.type,i.memoizedProps)),c=!c),c&&nt&&zs(i),j0(i),o===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8)if(c=i.data,c==="/$"){if(o===0){nt=zn(i.nextSibling);break e}o--}else c!=="$"&&c!=="$!"&&c!=="$?"||o++;i=i.nextSibling}nt=null}}else o===27?(o=nt,Yr(i.type)?(i=$h,$h=null,nt=i):nt=o):nt=Ft?zn(i.stateNode.nextSibling):null;return!0}function eo(){nt=Ft=null,Be=!1}function M0(){var i=Bs;return i!==null&&(tn===null?tn=i:tn.push.apply(tn,i),Bs=null),i}function to(i){Bs===null?Bs=[i]:Bs.push(i)}var wf=W(null),Us=null,lr=null;function Dr(i,o,c){ee(wf,o._currentValue),o._currentValue=c}function cr(i){i._currentValue=wf.current,re(wf)}function Sf(i,o,c){for(;i!==null;){var f=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),i===c)break;i=i.return}}function kf(i,o,c,f){var g=i.child;for(g!==null&&(g.return=i);g!==null;){var b=g.dependencies;if(b!==null){var S=g.child;b=b.firstContext;e:for(;b!==null;){var E=b;b=g;for(var j=0;j<o.length;j++)if(E.context===o[j]){b.lanes|=c,E=b.alternate,E!==null&&(E.lanes|=c),Sf(b.return,c,i),f||(S=null);break e}b=E.next}}else if(g.tag===18){if(S=g.return,S===null)throw Error(r(341));S.lanes|=c,b=S.alternate,b!==null&&(b.lanes|=c),Sf(S,c,i),S=null}else S=g.child;if(S!==null)S.return=g;else for(S=g;S!==null;){if(S===i){S=null;break}if(g=S.sibling,g!==null){g.return=S.return,S=g;break}S=S.return}g=S}}function no(i,o,c,f){i=null;for(var g=o,b=!1;g!==null;){if(!b){if((g.flags&524288)!==0)b=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var S=g.alternate;if(S===null)throw Error(r(387));if(S=S.memoizedProps,S!==null){var E=g.type;on(g.pendingProps.value,S.value)||(i!==null?i.push(E):i=[E])}}else if(g===Vt.current){if(S=g.alternate,S===null)throw Error(r(387));S.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(i!==null?i.push(Oo):i=[Oo])}g=g.return}i!==null&&kf(o,i,c,f),o.flags|=262144}function nc(i){for(i=i.firstContext;i!==null;){if(!on(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Ps(i){Us=i,lr=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Pt(i){return A0(Us,i)}function rc(i,o){return Us===null&&Ps(i),A0(i,o)}function A0(i,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},lr===null){if(i===null)throw Error(r(308));lr=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else lr=lr.next=o;return c}var u_=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(c,f){i.push(f)}};this.abort=function(){o.aborted=!0,i.forEach(function(c){return c()})}},d_=n.unstable_scheduleCallback,f_=n.unstable_NormalPriority,gt={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function _f(){return{controller:new u_,data:new Map,refCount:0}}function ro(i){i.refCount--,i.refCount===0&&d_(f_,function(){i.controller.abort()})}var so=null,Ef=0,Di=0,Li=null;function h_(i,o){if(so===null){var c=so=[];Ef=0,Di=Ch(),Li={status:"pending",value:void 0,then:function(f){c.push(f)}}}return Ef++,o.then(O0,O0),o}function O0(){if(--Ef===0&&so!==null){Li!==null&&(Li.status="fulfilled");var i=so;so=null,Di=0,Li=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function p_(i,o){var c=[],f={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return i.then(function(){f.status="fulfilled",f.value=o;for(var g=0;g<c.length;g++)(0,c[g])(o)},function(g){for(f.status="rejected",f.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),f}var R0=$.S;$.S=function(i,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&h_(i,o),R0!==null&&R0(i,o)};var $s=W(null);function Nf(){var i=$s.current;return i!==null?i:Ge.pooledCache}function sc(i,o){o===null?ee($s,$s.current):ee($s,o.pool)}function D0(){var i=Nf();return i===null?null:{parent:gt._currentValue,pool:i}}var io=Error(r(460)),L0=Error(r(474)),ic=Error(r(542)),Cf={then:function(){}};function B0(i){return i=i.status,i==="fulfilled"||i==="rejected"}function ac(){}function z0(i,o,c){switch(c=i[c],c===void 0?i.push(o):c!==o&&(o.then(ac,ac),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,P0(i),i;default:if(typeof o.status=="string")o.then(ac,ac);else{if(i=Ge,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=o,i.status="pending",i.then(function(f){if(o.status==="pending"){var g=o;g.status="fulfilled",g.value=f}},function(f){if(o.status==="pending"){var g=o;g.status="rejected",g.reason=f}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,P0(i),i}throw ao=o,io}}var ao=null;function U0(){if(ao===null)throw Error(r(459));var i=ao;return ao=null,i}function P0(i){if(i===io||i===ic)throw Error(r(483))}var Lr=!1;function Tf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function jf(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Br(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function zr(i,o,c){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,(ze&2)!==0){var g=f.pending;return g===null?o.next=o:(o.next=g.next,g.next=o),f.pending=o,o=Xl(i),E0(i,null,c),o}return Ql(i,f,o,c),Xl(i)}function oo(i,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var f=o.lanes;f&=i.pendingLanes,c|=f,o.lanes=c,Og(i,c)}}function Mf(i,o){var c=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var g=null,b=null;if(c=c.firstBaseUpdate,c!==null){do{var S={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};b===null?g=b=S:b=b.next=S,c=c.next}while(c!==null);b===null?g=b=o:b=b.next=o}else g=b=o;c={baseState:f.baseState,firstBaseUpdate:g,lastBaseUpdate:b,shared:f.shared,callbacks:f.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=o:i.next=o,c.lastBaseUpdate=o}var Af=!1;function lo(){if(Af){var i=Li;if(i!==null)throw i}}function co(i,o,c,f){Af=!1;var g=i.updateQueue;Lr=!1;var b=g.firstBaseUpdate,S=g.lastBaseUpdate,E=g.shared.pending;if(E!==null){g.shared.pending=null;var j=E,L=j.next;j.next=null,S===null?b=L:S.next=L,S=j;var q=i.alternate;q!==null&&(q=q.updateQueue,E=q.lastBaseUpdate,E!==S&&(E===null?q.firstBaseUpdate=L:E.next=L,q.lastBaseUpdate=j))}if(b!==null){var K=g.baseState;S=0,q=L=j=null,E=b;do{var z=E.lane&-536870913,U=z!==E.lane;if(U?(Re&z)===z:(f&z)===z){z!==0&&z===Di&&(Af=!0),q!==null&&(q=q.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});e:{var me=i,fe=E;z=o;var qe=c;switch(fe.tag){case 1:if(me=fe.payload,typeof me=="function"){K=me.call(qe,K,z);break e}K=me;break e;case 3:me.flags=me.flags&-65537|128;case 0:if(me=fe.payload,z=typeof me=="function"?me.call(qe,K,z):me,z==null)break e;K=m({},K,z);break e;case 2:Lr=!0}}z=E.callback,z!==null&&(i.flags|=64,U&&(i.flags|=8192),U=g.callbacks,U===null?g.callbacks=[z]:U.push(z))}else U={lane:z,tag:E.tag,payload:E.payload,callback:E.callback,next:null},q===null?(L=q=U,j=K):q=q.next=U,S|=z;if(E=E.next,E===null){if(E=g.shared.pending,E===null)break;U=E,E=U.next,U.next=null,g.lastBaseUpdate=U,g.shared.pending=null}}while(!0);q===null&&(j=K),g.baseState=j,g.firstBaseUpdate=L,g.lastBaseUpdate=q,b===null&&(g.shared.lanes=0),Fr|=S,i.lanes=S,i.memoizedState=K}}function $0(i,o){if(typeof i!="function")throw Error(r(191,i));i.call(o)}function I0(i,o){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)$0(c[i],o)}var Bi=W(null),oc=W(0);function H0(i,o){i=gr,ee(oc,i),ee(Bi,o),gr=i|o.baseLanes}function Of(){ee(oc,gr),ee(Bi,Bi.current)}function Rf(){gr=oc.current,re(Bi),re(oc)}var Ur=0,Ee=null,Ie=null,ut=null,lc=!1,zi=!1,Is=!1,cc=0,uo=0,Ui=null,m_=0;function lt(){throw Error(r(321))}function Df(i,o){if(o===null)return!1;for(var c=0;c<o.length&&c<i.length;c++)if(!on(i[c],o[c]))return!1;return!0}function Lf(i,o,c,f,g,b){return Ur=b,Ee=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,$.H=i===null||i.memoizedState===null?Ey:Ny,Is=!1,b=c(f,g),Is=!1,zi&&(b=V0(o,c,f,g)),q0(i),b}function q0(i){$.H=mc;var o=Ie!==null&&Ie.next!==null;if(Ur=0,ut=Ie=Ee=null,lc=!1,uo=0,Ui=null,o)throw Error(r(300));i===null||St||(i=i.dependencies,i!==null&&nc(i)&&(St=!0))}function V0(i,o,c,f){Ee=i;var g=0;do{if(zi&&(Ui=null),uo=0,zi=!1,25<=g)throw Error(r(301));if(g+=1,ut=Ie=null,i.updateQueue!=null){var b=i.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}$.H=S_,b=o(c,f)}while(zi);return b}function g_(){var i=$.H,o=i.useState()[0];return o=typeof o.then=="function"?fo(o):o,i=i.useState()[0],(Ie!==null?Ie.memoizedState:null)!==i&&(Ee.flags|=1024),o}function Bf(){var i=cc!==0;return cc=0,i}function zf(i,o,c){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~c}function Uf(i){if(lc){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}lc=!1}Ur=0,ut=Ie=Ee=null,zi=!1,uo=cc=0,Ui=null}function Zt(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ut===null?Ee.memoizedState=ut=i:ut=ut.next=i,ut}function dt(){if(Ie===null){var i=Ee.alternate;i=i!==null?i.memoizedState:null}else i=Ie.next;var o=ut===null?Ee.memoizedState:ut.next;if(o!==null)ut=o,Ie=i;else{if(i===null)throw Ee.alternate===null?Error(r(467)):Error(r(310));Ie=i,i={memoizedState:Ie.memoizedState,baseState:Ie.baseState,baseQueue:Ie.baseQueue,queue:Ie.queue,next:null},ut===null?Ee.memoizedState=ut=i:ut=ut.next=i}return ut}function Pf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function fo(i){var o=uo;return uo+=1,Ui===null&&(Ui=[]),i=z0(Ui,i,o),o=Ee,(ut===null?o.memoizedState:ut.next)===null&&(o=o.alternate,$.H=o===null||o.memoizedState===null?Ey:Ny),i}function uc(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return fo(i);if(i.$$typeof===C)return Pt(i)}throw Error(r(438,String(i)))}function $f(i){var o=null,c=Ee.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var f=Ee.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(o={data:f.data.map(function(g){return g.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=Pf(),Ee.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(i),f=0;f<i;f++)c[f]=ye;return o.index++,c}function ur(i,o){return typeof o=="function"?o(i):o}function dc(i){var o=dt();return If(o,Ie,i)}function If(i,o,c){var f=i.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=c;var g=i.baseQueue,b=f.pending;if(b!==null){if(g!==null){var S=g.next;g.next=b.next,b.next=S}o.baseQueue=g=b,f.pending=null}if(b=i.baseState,g===null)i.memoizedState=b;else{o=g.next;var E=S=null,j=null,L=o,q=!1;do{var K=L.lane&-536870913;if(K!==L.lane?(Re&K)===K:(Ur&K)===K){var z=L.revertLane;if(z===0)j!==null&&(j=j.next={lane:0,revertLane:0,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null}),K===Di&&(q=!0);else if((Ur&z)===z){L=L.next,z===Di&&(q=!0);continue}else K={lane:0,revertLane:L.revertLane,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null},j===null?(E=j=K,S=b):j=j.next=K,Ee.lanes|=z,Fr|=z;K=L.action,Is&&c(b,K),b=L.hasEagerState?L.eagerState:c(b,K)}else z={lane:K,revertLane:L.revertLane,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null},j===null?(E=j=z,S=b):j=j.next=z,Ee.lanes|=K,Fr|=K;L=L.next}while(L!==null&&L!==o);if(j===null?S=b:j.next=E,!on(b,i.memoizedState)&&(St=!0,q&&(c=Li,c!==null)))throw c;i.memoizedState=b,i.baseState=S,i.baseQueue=j,f.lastRenderedState=b}return g===null&&(f.lanes=0),[i.memoizedState,f.dispatch]}function Hf(i){var o=dt(),c=o.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=i;var f=c.dispatch,g=c.pending,b=o.memoizedState;if(g!==null){c.pending=null;var S=g=g.next;do b=i(b,S.action),S=S.next;while(S!==g);on(b,o.memoizedState)||(St=!0),o.memoizedState=b,o.baseQueue===null&&(o.baseState=b),c.lastRenderedState=b}return[b,f]}function F0(i,o,c){var f=Ee,g=dt(),b=Be;if(b){if(c===void 0)throw Error(r(407));c=c()}else c=o();var S=!on((Ie||g).memoizedState,c);S&&(g.memoizedState=c,St=!0),g=g.queue;var E=W0.bind(null,f,g,i);if(ho(2048,8,E,[i]),g.getSnapshot!==o||S||ut!==null&&ut.memoizedState.tag&1){if(f.flags|=2048,Pi(9,fc(),G0.bind(null,f,g,c,o),null),Ge===null)throw Error(r(349));b||(Ur&124)!==0||K0(f,o,c)}return c}function K0(i,o,c){i.flags|=16384,i={getSnapshot:o,value:c},o=Ee.updateQueue,o===null?(o=Pf(),Ee.updateQueue=o,o.stores=[i]):(c=o.stores,c===null?o.stores=[i]:c.push(i))}function G0(i,o,c,f){o.value=c,o.getSnapshot=f,Y0(o)&&J0(i)}function W0(i,o,c){return c(function(){Y0(o)&&J0(i)})}function Y0(i){var o=i.getSnapshot;i=i.value;try{var c=o();return!on(i,c)}catch{return!0}}function J0(i){var o=Mi(i,2);o!==null&&hn(o,i,2)}function qf(i){var o=Zt();if(typeof i=="function"){var c=i;if(i=c(),Is){xt(!0);try{c()}finally{xt(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ur,lastRenderedState:i},o}function Q0(i,o,c,f){return i.baseState=c,If(i,Ie,typeof f=="function"?f:ur)}function y_(i,o,c,f,g){if(pc(i))throw Error(r(485));if(i=o.action,i!==null){var b={payload:g,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){b.listeners.push(S)}};$.T!==null?c(!0):b.isTransition=!1,f(b),c=o.pending,c===null?(b.next=o.pending=b,X0(o,b)):(b.next=c.next,o.pending=c.next=b)}}function X0(i,o){var c=o.action,f=o.payload,g=i.state;if(o.isTransition){var b=$.T,S={};$.T=S;try{var E=c(g,f),j=$.S;j!==null&&j(S,E),Z0(i,o,E)}catch(L){Vf(i,o,L)}finally{$.T=b}}else try{b=c(g,f),Z0(i,o,b)}catch(L){Vf(i,o,L)}}function Z0(i,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){ey(i,o,f)},function(f){return Vf(i,o,f)}):ey(i,o,c)}function ey(i,o,c){o.status="fulfilled",o.value=c,ty(o),i.state=c,o=i.pending,o!==null&&(c=o.next,c===o?i.pending=null:(c=c.next,o.next=c,X0(i,c)))}function Vf(i,o,c){var f=i.pending;if(i.pending=null,f!==null){f=f.next;do o.status="rejected",o.reason=c,ty(o),o=o.next;while(o!==f)}i.action=null}function ty(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function ny(i,o){return o}function ry(i,o){if(Be){var c=Ge.formState;if(c!==null){e:{var f=Ee;if(Be){if(nt){t:{for(var g=nt,b=Fn;g.nodeType!==8;){if(!b){g=null;break t}if(g=zn(g.nextSibling),g===null){g=null;break t}}b=g.data,g=b==="F!"||b==="F"?g:null}if(g){nt=zn(g.nextSibling),f=g.data==="F!";break e}}zs(f)}f=!1}f&&(o=c[0])}}return c=Zt(),c.memoizedState=c.baseState=o,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ny,lastRenderedState:o},c.queue=f,c=Sy.bind(null,Ee,f),f.dispatch=c,f=qf(!1),b=Yf.bind(null,Ee,!1,f.queue),f=Zt(),g={state:o,dispatch:null,action:i,pending:null},f.queue=g,c=y_.bind(null,Ee,g,b,c),g.dispatch=c,f.memoizedState=i,[o,c,!1]}function sy(i){var o=dt();return iy(o,Ie,i)}function iy(i,o,c){if(o=If(i,o,ny)[0],i=dc(ur)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var f=fo(o)}catch(S){throw S===io?ic:S}else f=o;o=dt();var g=o.queue,b=g.dispatch;return c!==o.memoizedState&&(Ee.flags|=2048,Pi(9,fc(),b_.bind(null,g,c),null)),[f,b,i]}function b_(i,o){i.action=o}function ay(i){var o=dt(),c=Ie;if(c!==null)return iy(o,c,i);dt(),o=o.memoizedState,c=dt();var f=c.queue.dispatch;return c.memoizedState=i,[o,f,!1]}function Pi(i,o,c,f){return i={tag:i,create:c,deps:f,inst:o,next:null},o=Ee.updateQueue,o===null&&(o=Pf(),Ee.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=i.next=i:(f=c.next,c.next=i,i.next=f,o.lastEffect=i),i}function fc(){return{destroy:void 0,resource:void 0}}function oy(){return dt().memoizedState}function hc(i,o,c,f){var g=Zt();f=f===void 0?null:f,Ee.flags|=i,g.memoizedState=Pi(1|o,fc(),c,f)}function ho(i,o,c,f){var g=dt();f=f===void 0?null:f;var b=g.memoizedState.inst;Ie!==null&&f!==null&&Df(f,Ie.memoizedState.deps)?g.memoizedState=Pi(o,b,c,f):(Ee.flags|=i,g.memoizedState=Pi(1|o,b,c,f))}function ly(i,o){hc(8390656,8,i,o)}function cy(i,o){ho(2048,8,i,o)}function uy(i,o){return ho(4,2,i,o)}function dy(i,o){return ho(4,4,i,o)}function fy(i,o){if(typeof o=="function"){i=i();var c=o(i);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function hy(i,o,c){c=c!=null?c.concat([i]):null,ho(4,4,fy.bind(null,o,i),c)}function Ff(){}function py(i,o){var c=dt();o=o===void 0?null:o;var f=c.memoizedState;return o!==null&&Df(o,f[1])?f[0]:(c.memoizedState=[i,o],i)}function my(i,o){var c=dt();o=o===void 0?null:o;var f=c.memoizedState;if(o!==null&&Df(o,f[1]))return f[0];if(f=i(),Is){xt(!0);try{i()}finally{xt(!1)}}return c.memoizedState=[f,o],f}function Kf(i,o,c){return c===void 0||(Ur&1073741824)!==0?i.memoizedState=o:(i.memoizedState=c,i=bb(),Ee.lanes|=i,Fr|=i,c)}function gy(i,o,c,f){return on(c,o)?c:Bi.current!==null?(i=Kf(i,c,f),on(i,o)||(St=!0),i):(Ur&42)===0?(St=!0,i.memoizedState=c):(i=bb(),Ee.lanes|=i,Fr|=i,o)}function yy(i,o,c,f,g){var b=P.p;P.p=b!==0&&8>b?b:8;var S=$.T,E={};$.T=E,Yf(i,!1,o,c);try{var j=g(),L=$.S;if(L!==null&&L(E,j),j!==null&&typeof j=="object"&&typeof j.then=="function"){var q=p_(j,f);po(i,o,q,fn(i))}else po(i,o,f,fn(i))}catch(K){po(i,o,{then:function(){},status:"rejected",reason:K},fn())}finally{P.p=b,$.T=S}}function v_(){}function Gf(i,o,c,f){if(i.tag!==5)throw Error(r(476));var g=by(i).queue;yy(i,g,o,oe,c===null?v_:function(){return vy(i),c(f)})}function by(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:oe,baseState:oe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ur,lastRenderedState:oe},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ur,lastRenderedState:c},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function vy(i){var o=by(i).next.queue;po(i,o,{},fn())}function Wf(){return Pt(Oo)}function xy(){return dt().memoizedState}function wy(){return dt().memoizedState}function x_(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var c=fn();i=Br(c);var f=zr(o,i,c);f!==null&&(hn(f,o,c),oo(f,o,c)),o={cache:_f()},i.payload=o;return}o=o.return}}function w_(i,o,c){var f=fn();c={lane:f,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},pc(i)?ky(o,c):(c=pf(i,o,c,f),c!==null&&(hn(c,i,f),_y(c,o,f)))}function Sy(i,o,c){var f=fn();po(i,o,c,f)}function po(i,o,c,f){var g={lane:f,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(pc(i))ky(o,g);else{var b=i.alternate;if(i.lanes===0&&(b===null||b.lanes===0)&&(b=o.lastRenderedReducer,b!==null))try{var S=o.lastRenderedState,E=b(S,c);if(g.hasEagerState=!0,g.eagerState=E,on(E,S))return Ql(i,o,g,0),Ge===null&&Jl(),!1}catch{}finally{}if(c=pf(i,o,g,f),c!==null)return hn(c,i,f),_y(c,o,f),!0}return!1}function Yf(i,o,c,f){if(f={lane:2,revertLane:Ch(),action:f,hasEagerState:!1,eagerState:null,next:null},pc(i)){if(o)throw Error(r(479))}else o=pf(i,c,f,2),o!==null&&hn(o,i,2)}function pc(i){var o=i.alternate;return i===Ee||o!==null&&o===Ee}function ky(i,o){zi=lc=!0;var c=i.pending;c===null?o.next=o:(o.next=c.next,c.next=o),i.pending=o}function _y(i,o,c){if((c&4194048)!==0){var f=o.lanes;f&=i.pendingLanes,c|=f,o.lanes=c,Og(i,c)}}var mc={readContext:Pt,use:uc,useCallback:lt,useContext:lt,useEffect:lt,useImperativeHandle:lt,useLayoutEffect:lt,useInsertionEffect:lt,useMemo:lt,useReducer:lt,useRef:lt,useState:lt,useDebugValue:lt,useDeferredValue:lt,useTransition:lt,useSyncExternalStore:lt,useId:lt,useHostTransitionStatus:lt,useFormState:lt,useActionState:lt,useOptimistic:lt,useMemoCache:lt,useCacheRefresh:lt},Ey={readContext:Pt,use:uc,useCallback:function(i,o){return Zt().memoizedState=[i,o===void 0?null:o],i},useContext:Pt,useEffect:ly,useImperativeHandle:function(i,o,c){c=c!=null?c.concat([i]):null,hc(4194308,4,fy.bind(null,o,i),c)},useLayoutEffect:function(i,o){return hc(4194308,4,i,o)},useInsertionEffect:function(i,o){hc(4,2,i,o)},useMemo:function(i,o){var c=Zt();o=o===void 0?null:o;var f=i();if(Is){xt(!0);try{i()}finally{xt(!1)}}return c.memoizedState=[f,o],f},useReducer:function(i,o,c){var f=Zt();if(c!==void 0){var g=c(o);if(Is){xt(!0);try{c(o)}finally{xt(!1)}}}else g=o;return f.memoizedState=f.baseState=g,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:g},f.queue=i,i=i.dispatch=w_.bind(null,Ee,i),[f.memoizedState,i]},useRef:function(i){var o=Zt();return i={current:i},o.memoizedState=i},useState:function(i){i=qf(i);var o=i.queue,c=Sy.bind(null,Ee,o);return o.dispatch=c,[i.memoizedState,c]},useDebugValue:Ff,useDeferredValue:function(i,o){var c=Zt();return Kf(c,i,o)},useTransition:function(){var i=qf(!1);return i=yy.bind(null,Ee,i.queue,!0,!1),Zt().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,c){var f=Ee,g=Zt();if(Be){if(c===void 0)throw Error(r(407));c=c()}else{if(c=o(),Ge===null)throw Error(r(349));(Re&124)!==0||K0(f,o,c)}g.memoizedState=c;var b={value:c,getSnapshot:o};return g.queue=b,ly(W0.bind(null,f,b,i),[i]),f.flags|=2048,Pi(9,fc(),G0.bind(null,f,b,c,o),null),c},useId:function(){var i=Zt(),o=Ge.identifierPrefix;if(Be){var c=or,f=ar;c=(f&~(1<<32-ot(f)-1)).toString(32)+c,o="«"+o+"R"+c,c=cc++,0<c&&(o+="H"+c.toString(32)),o+="»"}else c=m_++,o="«"+o+"r"+c.toString(32)+"»";return i.memoizedState=o},useHostTransitionStatus:Wf,useFormState:ry,useActionState:ry,useOptimistic:function(i){var o=Zt();o.memoizedState=o.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=Yf.bind(null,Ee,!0,c),c.dispatch=o,[i,o]},useMemoCache:$f,useCacheRefresh:function(){return Zt().memoizedState=x_.bind(null,Ee)}},Ny={readContext:Pt,use:uc,useCallback:py,useContext:Pt,useEffect:cy,useImperativeHandle:hy,useInsertionEffect:uy,useLayoutEffect:dy,useMemo:my,useReducer:dc,useRef:oy,useState:function(){return dc(ur)},useDebugValue:Ff,useDeferredValue:function(i,o){var c=dt();return gy(c,Ie.memoizedState,i,o)},useTransition:function(){var i=dc(ur)[0],o=dt().memoizedState;return[typeof i=="boolean"?i:fo(i),o]},useSyncExternalStore:F0,useId:xy,useHostTransitionStatus:Wf,useFormState:sy,useActionState:sy,useOptimistic:function(i,o){var c=dt();return Q0(c,Ie,i,o)},useMemoCache:$f,useCacheRefresh:wy},S_={readContext:Pt,use:uc,useCallback:py,useContext:Pt,useEffect:cy,useImperativeHandle:hy,useInsertionEffect:uy,useLayoutEffect:dy,useMemo:my,useReducer:Hf,useRef:oy,useState:function(){return Hf(ur)},useDebugValue:Ff,useDeferredValue:function(i,o){var c=dt();return Ie===null?Kf(c,i,o):gy(c,Ie.memoizedState,i,o)},useTransition:function(){var i=Hf(ur)[0],o=dt().memoizedState;return[typeof i=="boolean"?i:fo(i),o]},useSyncExternalStore:F0,useId:xy,useHostTransitionStatus:Wf,useFormState:ay,useActionState:ay,useOptimistic:function(i,o){var c=dt();return Ie!==null?Q0(c,Ie,i,o):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:$f,useCacheRefresh:wy},$i=null,mo=0;function gc(i){var o=mo;return mo+=1,$i===null&&($i=[]),z0($i,i,o)}function go(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function yc(i,o){throw o.$$typeof===y?Error(r(525)):(i=Object.prototype.toString.call(o),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function Cy(i){var o=i._init;return o(i._payload)}function Ty(i){function o(R,O){if(i){var D=R.deletions;D===null?(R.deletions=[O],R.flags|=16):D.push(O)}}function c(R,O){if(!i)return null;for(;O!==null;)o(R,O),O=O.sibling;return null}function f(R){for(var O=new Map;R!==null;)R.key!==null?O.set(R.key,R):O.set(R.index,R),R=R.sibling;return O}function g(R,O){return R=ir(R,O),R.index=0,R.sibling=null,R}function b(R,O,D){return R.index=D,i?(D=R.alternate,D!==null?(D=D.index,D<O?(R.flags|=67108866,O):D):(R.flags|=67108866,O)):(R.flags|=1048576,O)}function S(R){return i&&R.alternate===null&&(R.flags|=67108866),R}function E(R,O,D,F){return O===null||O.tag!==6?(O=gf(D,R.mode,F),O.return=R,O):(O=g(O,D),O.return=R,O)}function j(R,O,D,F){var ae=D.type;return ae===w?q(R,O,D.props.children,F,D.key):O!==null&&(O.elementType===ae||typeof ae=="object"&&ae!==null&&ae.$$typeof===X&&Cy(ae)===O.type)?(O=g(O,D.props),go(O,D),O.return=R,O):(O=Zl(D.type,D.key,D.props,null,R.mode,F),go(O,D),O.return=R,O)}function L(R,O,D,F){return O===null||O.tag!==4||O.stateNode.containerInfo!==D.containerInfo||O.stateNode.implementation!==D.implementation?(O=yf(D,R.mode,F),O.return=R,O):(O=g(O,D.children||[]),O.return=R,O)}function q(R,O,D,F,ae){return O===null||O.tag!==7?(O=Rs(D,R.mode,F,ae),O.return=R,O):(O=g(O,D),O.return=R,O)}function K(R,O,D){if(typeof O=="string"&&O!==""||typeof O=="number"||typeof O=="bigint")return O=gf(""+O,R.mode,D),O.return=R,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case v:return D=Zl(O.type,O.key,O.props,null,R.mode,D),go(D,O),D.return=R,D;case x:return O=yf(O,R.mode,D),O.return=R,O;case X:var F=O._init;return O=F(O._payload),K(R,O,D)}if(he(O)||Ce(O))return O=Rs(O,R.mode,D,null),O.return=R,O;if(typeof O.then=="function")return K(R,gc(O),D);if(O.$$typeof===C)return K(R,rc(R,O),D);yc(R,O)}return null}function z(R,O,D,F){var ae=O!==null?O.key:null;if(typeof D=="string"&&D!==""||typeof D=="number"||typeof D=="bigint")return ae!==null?null:E(R,O,""+D,F);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case v:return D.key===ae?j(R,O,D,F):null;case x:return D.key===ae?L(R,O,D,F):null;case X:return ae=D._init,D=ae(D._payload),z(R,O,D,F)}if(he(D)||Ce(D))return ae!==null?null:q(R,O,D,F,null);if(typeof D.then=="function")return z(R,O,gc(D),F);if(D.$$typeof===C)return z(R,O,rc(R,D),F);yc(R,D)}return null}function U(R,O,D,F,ae){if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return R=R.get(D)||null,E(O,R,""+F,ae);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case v:return R=R.get(F.key===null?D:F.key)||null,j(O,R,F,ae);case x:return R=R.get(F.key===null?D:F.key)||null,L(O,R,F,ae);case X:var Ne=F._init;return F=Ne(F._payload),U(R,O,D,F,ae)}if(he(F)||Ce(F))return R=R.get(D)||null,q(O,R,F,ae,null);if(typeof F.then=="function")return U(R,O,D,gc(F),ae);if(F.$$typeof===C)return U(R,O,D,rc(O,F),ae);yc(O,F)}return null}function me(R,O,D,F){for(var ae=null,Ne=null,le=O,pe=O=0,_t=null;le!==null&&pe<D.length;pe++){le.index>pe?(_t=le,le=null):_t=le.sibling;var De=z(R,le,D[pe],F);if(De===null){le===null&&(le=_t);break}i&&le&&De.alternate===null&&o(R,le),O=b(De,O,pe),Ne===null?ae=De:Ne.sibling=De,Ne=De,le=_t}if(pe===D.length)return c(R,le),Be&&Ls(R,pe),ae;if(le===null){for(;pe<D.length;pe++)le=K(R,D[pe],F),le!==null&&(O=b(le,O,pe),Ne===null?ae=le:Ne.sibling=le,Ne=le);return Be&&Ls(R,pe),ae}for(le=f(le);pe<D.length;pe++)_t=U(le,R,pe,D[pe],F),_t!==null&&(i&&_t.alternate!==null&&le.delete(_t.key===null?pe:_t.key),O=b(_t,O,pe),Ne===null?ae=_t:Ne.sibling=_t,Ne=_t);return i&&le.forEach(function(es){return o(R,es)}),Be&&Ls(R,pe),ae}function fe(R,O,D,F){if(D==null)throw Error(r(151));for(var ae=null,Ne=null,le=O,pe=O=0,_t=null,De=D.next();le!==null&&!De.done;pe++,De=D.next()){le.index>pe?(_t=le,le=null):_t=le.sibling;var es=z(R,le,De.value,F);if(es===null){le===null&&(le=_t);break}i&&le&&es.alternate===null&&o(R,le),O=b(es,O,pe),Ne===null?ae=es:Ne.sibling=es,Ne=es,le=_t}if(De.done)return c(R,le),Be&&Ls(R,pe),ae;if(le===null){for(;!De.done;pe++,De=D.next())De=K(R,De.value,F),De!==null&&(O=b(De,O,pe),Ne===null?ae=De:Ne.sibling=De,Ne=De);return Be&&Ls(R,pe),ae}for(le=f(le);!De.done;pe++,De=D.next())De=U(le,R,pe,De.value,F),De!==null&&(i&&De.alternate!==null&&le.delete(De.key===null?pe:De.key),O=b(De,O,pe),Ne===null?ae=De:Ne.sibling=De,Ne=De);return i&&le.forEach(function(kE){return o(R,kE)}),Be&&Ls(R,pe),ae}function qe(R,O,D,F){if(typeof D=="object"&&D!==null&&D.type===w&&D.key===null&&(D=D.props.children),typeof D=="object"&&D!==null){switch(D.$$typeof){case v:e:{for(var ae=D.key;O!==null;){if(O.key===ae){if(ae=D.type,ae===w){if(O.tag===7){c(R,O.sibling),F=g(O,D.props.children),F.return=R,R=F;break e}}else if(O.elementType===ae||typeof ae=="object"&&ae!==null&&ae.$$typeof===X&&Cy(ae)===O.type){c(R,O.sibling),F=g(O,D.props),go(F,D),F.return=R,R=F;break e}c(R,O);break}else o(R,O);O=O.sibling}D.type===w?(F=Rs(D.props.children,R.mode,F,D.key),F.return=R,R=F):(F=Zl(D.type,D.key,D.props,null,R.mode,F),go(F,D),F.return=R,R=F)}return S(R);case x:e:{for(ae=D.key;O!==null;){if(O.key===ae)if(O.tag===4&&O.stateNode.containerInfo===D.containerInfo&&O.stateNode.implementation===D.implementation){c(R,O.sibling),F=g(O,D.children||[]),F.return=R,R=F;break e}else{c(R,O);break}else o(R,O);O=O.sibling}F=yf(D,R.mode,F),F.return=R,R=F}return S(R);case X:return ae=D._init,D=ae(D._payload),qe(R,O,D,F)}if(he(D))return me(R,O,D,F);if(Ce(D)){if(ae=Ce(D),typeof ae!="function")throw Error(r(150));return D=ae.call(D),fe(R,O,D,F)}if(typeof D.then=="function")return qe(R,O,gc(D),F);if(D.$$typeof===C)return qe(R,O,rc(R,D),F);yc(R,D)}return typeof D=="string"&&D!==""||typeof D=="number"||typeof D=="bigint"?(D=""+D,O!==null&&O.tag===6?(c(R,O.sibling),F=g(O,D),F.return=R,R=F):(c(R,O),F=gf(D,R.mode,F),F.return=R,R=F),S(R)):c(R,O)}return function(R,O,D,F){try{mo=0;var ae=qe(R,O,D,F);return $i=null,ae}catch(le){if(le===io||le===ic)throw le;var Ne=ln(29,le,null,R.mode);return Ne.lanes=F,Ne.return=R,Ne}finally{}}}var Ii=Ty(!0),jy=Ty(!1),_n=W(null),Kn=null;function Pr(i){var o=i.alternate;ee(yt,yt.current&1),ee(_n,i),Kn===null&&(o===null||Bi.current!==null||o.memoizedState!==null)&&(Kn=i)}function My(i){if(i.tag===22){if(ee(yt,yt.current),ee(_n,i),Kn===null){var o=i.alternate;o!==null&&o.memoizedState!==null&&(Kn=i)}}else $r()}function $r(){ee(yt,yt.current),ee(_n,_n.current)}function dr(i){re(_n),Kn===i&&(Kn=null),re(yt)}var yt=W(0);function bc(i){for(var o=i;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||Ph(c)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function Jf(i,o,c,f){o=i.memoizedState,c=c(f,o),c=c==null?o:m({},o,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var Qf={enqueueSetState:function(i,o,c){i=i._reactInternals;var f=fn(),g=Br(f);g.payload=o,c!=null&&(g.callback=c),o=zr(i,g,f),o!==null&&(hn(o,i,f),oo(o,i,f))},enqueueReplaceState:function(i,o,c){i=i._reactInternals;var f=fn(),g=Br(f);g.tag=1,g.payload=o,c!=null&&(g.callback=c),o=zr(i,g,f),o!==null&&(hn(o,i,f),oo(o,i,f))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var c=fn(),f=Br(c);f.tag=2,o!=null&&(f.callback=o),o=zr(i,f,c),o!==null&&(hn(o,i,c),oo(o,i,c))}};function Ay(i,o,c,f,g,b,S){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,b,S):o.prototype&&o.prototype.isPureReactComponent?!Qa(c,f)||!Qa(g,b):!0}function Oy(i,o,c,f){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,f),o.state!==i&&Qf.enqueueReplaceState(o,o.state,null)}function Hs(i,o){var c=o;if("ref"in o){c={};for(var f in o)f!=="ref"&&(c[f]=o[f])}if(i=i.defaultProps){c===o&&(c=m({},c));for(var g in i)c[g]===void 0&&(c[g]=i[g])}return c}var vc=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function Ry(i){vc(i)}function Dy(i){console.error(i)}function Ly(i){vc(i)}function xc(i,o){try{var c=i.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(f){setTimeout(function(){throw f})}}function By(i,o,c){try{var f=i.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Xf(i,o,c){return c=Br(c),c.tag=3,c.payload={element:null},c.callback=function(){xc(i,o)},c}function zy(i){return i=Br(i),i.tag=3,i}function Uy(i,o,c,f){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var b=f.value;i.payload=function(){return g(b)},i.callback=function(){By(o,c,f)}}var S=c.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(i.callback=function(){By(o,c,f),typeof g!="function"&&(Kr===null?Kr=new Set([this]):Kr.add(this));var E=f.stack;this.componentDidCatch(f.value,{componentStack:E!==null?E:""})})}function k_(i,o,c,f,g){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(o=c.alternate,o!==null&&no(o,c,g,!0),c=_n.current,c!==null){switch(c.tag){case 13:return Kn===null?Sh():c.alternate===null&&rt===0&&(rt=3),c.flags&=-257,c.flags|=65536,c.lanes=g,f===Cf?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([f]):o.add(f),_h(i,f,g)),!1;case 22:return c.flags|=65536,f===Cf?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([f]):c.add(f)),_h(i,f,g)),!1}throw Error(r(435,c.tag))}return _h(i,f,g),Sh(),!1}if(Be)return o=_n.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=g,f!==xf&&(i=Error(r(422),{cause:f}),to(xn(i,c)))):(f!==xf&&(o=Error(r(423),{cause:f}),to(xn(o,c))),i=i.current.alternate,i.flags|=65536,g&=-g,i.lanes|=g,f=xn(f,c),g=Xf(i.stateNode,f,g),Mf(i,g),rt!==4&&(rt=2)),!1;var b=Error(r(520),{cause:f});if(b=xn(b,c),ko===null?ko=[b]:ko.push(b),rt!==4&&(rt=2),o===null)return!0;f=xn(f,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,i=g&-g,c.lanes|=i,i=Xf(c.stateNode,f,i),Mf(c,i),!1;case 1:if(o=c.type,b=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Kr===null||!Kr.has(b))))return c.flags|=65536,g&=-g,c.lanes|=g,g=zy(g),Uy(g,i,c,f),Mf(c,g),!1}c=c.return}while(c!==null);return!1}var Py=Error(r(461)),St=!1;function Ot(i,o,c,f){o.child=i===null?jy(o,null,c,f):Ii(o,i.child,c,f)}function $y(i,o,c,f,g){c=c.render;var b=o.ref;if("ref"in f){var S={};for(var E in f)E!=="ref"&&(S[E]=f[E])}else S=f;return Ps(o),f=Lf(i,o,c,S,b,g),E=Bf(),i!==null&&!St?(zf(i,o,g),fr(i,o,g)):(Be&&E&&bf(o),o.flags|=1,Ot(i,o,f,g),o.child)}function Iy(i,o,c,f,g){if(i===null){var b=c.type;return typeof b=="function"&&!mf(b)&&b.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=b,Hy(i,o,b,f,g)):(i=Zl(c.type,null,f,o,o.mode,g),i.ref=o.ref,i.return=o,o.child=i)}if(b=i.child,!ah(i,g)){var S=b.memoizedProps;if(c=c.compare,c=c!==null?c:Qa,c(S,f)&&i.ref===o.ref)return fr(i,o,g)}return o.flags|=1,i=ir(b,f),i.ref=o.ref,i.return=o,o.child=i}function Hy(i,o,c,f,g){if(i!==null){var b=i.memoizedProps;if(Qa(b,f)&&i.ref===o.ref)if(St=!1,o.pendingProps=f=b,ah(i,g))(i.flags&131072)!==0&&(St=!0);else return o.lanes=i.lanes,fr(i,o,g)}return Zf(i,o,c,f,g)}function qy(i,o,c){var f=o.pendingProps,g=f.children,b=i!==null?i.memoizedState:null;if(f.mode==="hidden"){if((o.flags&128)!==0){if(f=b!==null?b.baseLanes|c:c,i!==null){for(g=o.child=i.child,b=0;g!==null;)b=b|g.lanes|g.childLanes,g=g.sibling;o.childLanes=b&~f}else o.childLanes=0,o.child=null;return Vy(i,o,f,c)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&sc(o,b!==null?b.cachePool:null),b!==null?H0(o,b):Of(),My(o);else return o.lanes=o.childLanes=536870912,Vy(i,o,b!==null?b.baseLanes|c:c,c)}else b!==null?(sc(o,b.cachePool),H0(o,b),$r(),o.memoizedState=null):(i!==null&&sc(o,null),Of(),$r());return Ot(i,o,g,c),o.child}function Vy(i,o,c,f){var g=Nf();return g=g===null?null:{parent:gt._currentValue,pool:g},o.memoizedState={baseLanes:c,cachePool:g},i!==null&&sc(o,null),Of(),My(o),i!==null&&no(i,o,f,!0),null}function wc(i,o){var c=o.ref;if(c===null)i!==null&&i.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(r(284));(i===null||i.ref!==c)&&(o.flags|=4194816)}}function Zf(i,o,c,f,g){return Ps(o),c=Lf(i,o,c,f,void 0,g),f=Bf(),i!==null&&!St?(zf(i,o,g),fr(i,o,g)):(Be&&f&&bf(o),o.flags|=1,Ot(i,o,c,g),o.child)}function Fy(i,o,c,f,g,b){return Ps(o),o.updateQueue=null,c=V0(o,f,c,g),q0(i),f=Bf(),i!==null&&!St?(zf(i,o,b),fr(i,o,b)):(Be&&f&&bf(o),o.flags|=1,Ot(i,o,c,b),o.child)}function Ky(i,o,c,f,g){if(Ps(o),o.stateNode===null){var b=Ai,S=c.contextType;typeof S=="object"&&S!==null&&(b=Pt(S)),b=new c(f,b),o.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=Qf,o.stateNode=b,b._reactInternals=o,b=o.stateNode,b.props=f,b.state=o.memoizedState,b.refs={},Tf(o),S=c.contextType,b.context=typeof S=="object"&&S!==null?Pt(S):Ai,b.state=o.memoizedState,S=c.getDerivedStateFromProps,typeof S=="function"&&(Jf(o,c,S,f),b.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(S=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),S!==b.state&&Qf.enqueueReplaceState(b,b.state,null),co(o,f,b,g),lo(),b.state=o.memoizedState),typeof b.componentDidMount=="function"&&(o.flags|=4194308),f=!0}else if(i===null){b=o.stateNode;var E=o.memoizedProps,j=Hs(c,E);b.props=j;var L=b.context,q=c.contextType;S=Ai,typeof q=="object"&&q!==null&&(S=Pt(q));var K=c.getDerivedStateFromProps;q=typeof K=="function"||typeof b.getSnapshotBeforeUpdate=="function",E=o.pendingProps!==E,q||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(E||L!==S)&&Oy(o,b,f,S),Lr=!1;var z=o.memoizedState;b.state=z,co(o,f,b,g),lo(),L=o.memoizedState,E||z!==L||Lr?(typeof K=="function"&&(Jf(o,c,K,f),L=o.memoizedState),(j=Lr||Ay(o,c,j,f,z,L,S))?(q||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(o.flags|=4194308)):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=L),b.props=f,b.state=L,b.context=S,f=j):(typeof b.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{b=o.stateNode,jf(i,o),S=o.memoizedProps,q=Hs(c,S),b.props=q,K=o.pendingProps,z=b.context,L=c.contextType,j=Ai,typeof L=="object"&&L!==null&&(j=Pt(L)),E=c.getDerivedStateFromProps,(L=typeof E=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(S!==K||z!==j)&&Oy(o,b,f,j),Lr=!1,z=o.memoizedState,b.state=z,co(o,f,b,g),lo();var U=o.memoizedState;S!==K||z!==U||Lr||i!==null&&i.dependencies!==null&&nc(i.dependencies)?(typeof E=="function"&&(Jf(o,c,E,f),U=o.memoizedState),(q=Lr||Ay(o,c,q,f,z,U,j)||i!==null&&i.dependencies!==null&&nc(i.dependencies))?(L||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(f,U,j),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(f,U,j)),typeof b.componentDidUpdate=="function"&&(o.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof b.componentDidUpdate!="function"||S===i.memoizedProps&&z===i.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||S===i.memoizedProps&&z===i.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=U),b.props=f,b.state=U,b.context=j,f=q):(typeof b.componentDidUpdate!="function"||S===i.memoizedProps&&z===i.memoizedState||(o.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||S===i.memoizedProps&&z===i.memoizedState||(o.flags|=1024),f=!1)}return b=f,wc(i,o),f=(o.flags&128)!==0,b||f?(b=o.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:b.render(),o.flags|=1,i!==null&&f?(o.child=Ii(o,i.child,null,g),o.child=Ii(o,null,c,g)):Ot(i,o,c,g),o.memoizedState=b.state,i=o.child):i=fr(i,o,g),i}function Gy(i,o,c,f){return eo(),o.flags|=256,Ot(i,o,c,f),o.child}var eh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function th(i){return{baseLanes:i,cachePool:D0()}}function nh(i,o,c){return i=i!==null?i.childLanes&~c:0,o&&(i|=En),i}function Wy(i,o,c){var f=o.pendingProps,g=!1,b=(o.flags&128)!==0,S;if((S=b)||(S=i!==null&&i.memoizedState===null?!1:(yt.current&2)!==0),S&&(g=!0,o.flags&=-129),S=(o.flags&32)!==0,o.flags&=-33,i===null){if(Be){if(g?Pr(o):$r(),Be){var E=nt,j;if(j=E){e:{for(j=E,E=Fn;j.nodeType!==8;){if(!E){E=null;break e}if(j=zn(j.nextSibling),j===null){E=null;break e}}E=j}E!==null?(o.memoizedState={dehydrated:E,treeContext:Ds!==null?{id:ar,overflow:or}:null,retryLane:536870912,hydrationErrors:null},j=ln(18,null,null,0),j.stateNode=E,j.return=o,o.child=j,Ft=o,nt=null,j=!0):j=!1}j||zs(o)}if(E=o.memoizedState,E!==null&&(E=E.dehydrated,E!==null))return Ph(E)?o.lanes=32:o.lanes=536870912,null;dr(o)}return E=f.children,f=f.fallback,g?($r(),g=o.mode,E=Sc({mode:"hidden",children:E},g),f=Rs(f,g,c,null),E.return=o,f.return=o,E.sibling=f,o.child=E,g=o.child,g.memoizedState=th(c),g.childLanes=nh(i,S,c),o.memoizedState=eh,f):(Pr(o),rh(o,E))}if(j=i.memoizedState,j!==null&&(E=j.dehydrated,E!==null)){if(b)o.flags&256?(Pr(o),o.flags&=-257,o=sh(i,o,c)):o.memoizedState!==null?($r(),o.child=i.child,o.flags|=128,o=null):($r(),g=f.fallback,E=o.mode,f=Sc({mode:"visible",children:f.children},E),g=Rs(g,E,c,null),g.flags|=2,f.return=o,g.return=o,f.sibling=g,o.child=f,Ii(o,i.child,null,c),f=o.child,f.memoizedState=th(c),f.childLanes=nh(i,S,c),o.memoizedState=eh,o=g);else if(Pr(o),Ph(E)){if(S=E.nextSibling&&E.nextSibling.dataset,S)var L=S.dgst;S=L,f=Error(r(419)),f.stack="",f.digest=S,to({value:f,source:null,stack:null}),o=sh(i,o,c)}else if(St||no(i,o,c,!1),S=(c&i.childLanes)!==0,St||S){if(S=Ge,S!==null&&(f=c&-c,f=(f&42)!==0?1:Pd(f),f=(f&(S.suspendedLanes|c))!==0?0:f,f!==0&&f!==j.retryLane))throw j.retryLane=f,Mi(i,f),hn(S,i,f),Py;E.data==="$?"||Sh(),o=sh(i,o,c)}else E.data==="$?"?(o.flags|=192,o.child=i.child,o=null):(i=j.treeContext,nt=zn(E.nextSibling),Ft=o,Be=!0,Bs=null,Fn=!1,i!==null&&(Sn[kn++]=ar,Sn[kn++]=or,Sn[kn++]=Ds,ar=i.id,or=i.overflow,Ds=o),o=rh(o,f.children),o.flags|=4096);return o}return g?($r(),g=f.fallback,E=o.mode,j=i.child,L=j.sibling,f=ir(j,{mode:"hidden",children:f.children}),f.subtreeFlags=j.subtreeFlags&65011712,L!==null?g=ir(L,g):(g=Rs(g,E,c,null),g.flags|=2),g.return=o,f.return=o,f.sibling=g,o.child=f,f=g,g=o.child,E=i.child.memoizedState,E===null?E=th(c):(j=E.cachePool,j!==null?(L=gt._currentValue,j=j.parent!==L?{parent:L,pool:L}:j):j=D0(),E={baseLanes:E.baseLanes|c,cachePool:j}),g.memoizedState=E,g.childLanes=nh(i,S,c),o.memoizedState=eh,f):(Pr(o),c=i.child,i=c.sibling,c=ir(c,{mode:"visible",children:f.children}),c.return=o,c.sibling=null,i!==null&&(S=o.deletions,S===null?(o.deletions=[i],o.flags|=16):S.push(i)),o.child=c,o.memoizedState=null,c)}function rh(i,o){return o=Sc({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function Sc(i,o){return i=ln(22,i,null,o),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function sh(i,o,c){return Ii(o,i.child,null,c),i=rh(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function Yy(i,o,c){i.lanes|=o;var f=i.alternate;f!==null&&(f.lanes|=o),Sf(i.return,o,c)}function ih(i,o,c,f,g){var b=i.memoizedState;b===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:g}:(b.isBackwards=o,b.rendering=null,b.renderingStartTime=0,b.last=f,b.tail=c,b.tailMode=g)}function Jy(i,o,c){var f=o.pendingProps,g=f.revealOrder,b=f.tail;if(Ot(i,o,f.children,c),f=yt.current,(f&2)!==0)f=f&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Yy(i,c,o);else if(i.tag===19)Yy(i,c,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}f&=1}switch(ee(yt,f),g){case"forwards":for(c=o.child,g=null;c!==null;)i=c.alternate,i!==null&&bc(i)===null&&(g=c),c=c.sibling;c=g,c===null?(g=o.child,o.child=null):(g=c.sibling,c.sibling=null),ih(o,!1,g,c,b);break;case"backwards":for(c=null,g=o.child,o.child=null;g!==null;){if(i=g.alternate,i!==null&&bc(i)===null){o.child=g;break}i=g.sibling,g.sibling=c,c=g,g=i}ih(o,!0,c,null,b);break;case"together":ih(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function fr(i,o,c){if(i!==null&&(o.dependencies=i.dependencies),Fr|=o.lanes,(c&o.childLanes)===0)if(i!==null){if(no(i,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(r(153));if(o.child!==null){for(i=o.child,c=ir(i,i.pendingProps),o.child=c,c.return=o;i.sibling!==null;)i=i.sibling,c=c.sibling=ir(i,i.pendingProps),c.return=o;c.sibling=null}return o.child}function ah(i,o){return(i.lanes&o)!==0?!0:(i=i.dependencies,!!(i!==null&&nc(i)))}function __(i,o,c){switch(o.tag){case 3:Ke(o,o.stateNode.containerInfo),Dr(o,gt,i.memoizedState.cache),eo();break;case 27:case 5:mi(o);break;case 4:Ke(o,o.stateNode.containerInfo);break;case 10:Dr(o,o.type,o.memoizedProps.value);break;case 13:var f=o.memoizedState;if(f!==null)return f.dehydrated!==null?(Pr(o),o.flags|=128,null):(c&o.child.childLanes)!==0?Wy(i,o,c):(Pr(o),i=fr(i,o,c),i!==null?i.sibling:null);Pr(o);break;case 19:var g=(i.flags&128)!==0;if(f=(c&o.childLanes)!==0,f||(no(i,o,c,!1),f=(c&o.childLanes)!==0),g){if(f)return Jy(i,o,c);o.flags|=128}if(g=o.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),ee(yt,yt.current),f)break;return null;case 22:case 23:return o.lanes=0,qy(i,o,c);case 24:Dr(o,gt,i.memoizedState.cache)}return fr(i,o,c)}function Qy(i,o,c){if(i!==null)if(i.memoizedProps!==o.pendingProps)St=!0;else{if(!ah(i,c)&&(o.flags&128)===0)return St=!1,__(i,o,c);St=(i.flags&131072)!==0}else St=!1,Be&&(o.flags&1048576)!==0&&C0(o,tc,o.index);switch(o.lanes=0,o.tag){case 16:e:{i=o.pendingProps;var f=o.elementType,g=f._init;if(f=g(f._payload),o.type=f,typeof f=="function")mf(f)?(i=Hs(f,i),o.tag=1,o=Ky(null,o,f,i,c)):(o.tag=0,o=Zf(null,o,f,i,c));else{if(f!=null){if(g=f.$$typeof,g===I){o.tag=11,o=$y(null,o,f,i,c);break e}else if(g===G){o.tag=14,o=Iy(null,o,f,i,c);break e}}throw o=ie(f)||f,Error(r(306,o,""))}}return o;case 0:return Zf(i,o,o.type,o.pendingProps,c);case 1:return f=o.type,g=Hs(f,o.pendingProps),Ky(i,o,f,g,c);case 3:e:{if(Ke(o,o.stateNode.containerInfo),i===null)throw Error(r(387));f=o.pendingProps;var b=o.memoizedState;g=b.element,jf(i,o),co(o,f,null,c);var S=o.memoizedState;if(f=S.cache,Dr(o,gt,f),f!==b.cache&&kf(o,[gt],c,!0),lo(),f=S.element,b.isDehydrated)if(b={element:f,isDehydrated:!1,cache:S.cache},o.updateQueue.baseState=b,o.memoizedState=b,o.flags&256){o=Gy(i,o,f,c);break e}else if(f!==g){g=xn(Error(r(424)),o),to(g),o=Gy(i,o,f,c);break e}else{switch(i=o.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(nt=zn(i.firstChild),Ft=o,Be=!0,Bs=null,Fn=!0,c=jy(o,null,f,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(eo(),f===g){o=fr(i,o,c);break e}Ot(i,o,f,c)}o=o.child}return o;case 26:return wc(i,o),i===null?(c=tv(o.type,null,o.pendingProps,null))?o.memoizedState=c:Be||(c=o.type,i=o.pendingProps,f=Bc(ge.current).createElement(c),f[Ut]=o,f[Qt]=i,Dt(f,c,i),wt(f),o.stateNode=f):o.memoizedState=tv(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return mi(o),i===null&&Be&&(f=o.stateNode=Xb(o.type,o.pendingProps,ge.current),Ft=o,Fn=!0,g=nt,Yr(o.type)?($h=g,nt=zn(f.firstChild)):nt=g),Ot(i,o,o.pendingProps.children,c),wc(i,o),i===null&&(o.flags|=4194304),o.child;case 5:return i===null&&Be&&((g=f=nt)&&(f=X_(f,o.type,o.pendingProps,Fn),f!==null?(o.stateNode=f,Ft=o,nt=zn(f.firstChild),Fn=!1,g=!0):g=!1),g||zs(o)),mi(o),g=o.type,b=o.pendingProps,S=i!==null?i.memoizedProps:null,f=b.children,Bh(g,b)?f=null:S!==null&&Bh(g,S)&&(o.flags|=32),o.memoizedState!==null&&(g=Lf(i,o,g_,null,null,c),Oo._currentValue=g),wc(i,o),Ot(i,o,f,c),o.child;case 6:return i===null&&Be&&((i=c=nt)&&(c=Z_(c,o.pendingProps,Fn),c!==null?(o.stateNode=c,Ft=o,nt=null,i=!0):i=!1),i||zs(o)),null;case 13:return Wy(i,o,c);case 4:return Ke(o,o.stateNode.containerInfo),f=o.pendingProps,i===null?o.child=Ii(o,null,f,c):Ot(i,o,f,c),o.child;case 11:return $y(i,o,o.type,o.pendingProps,c);case 7:return Ot(i,o,o.pendingProps,c),o.child;case 8:return Ot(i,o,o.pendingProps.children,c),o.child;case 12:return Ot(i,o,o.pendingProps.children,c),o.child;case 10:return f=o.pendingProps,Dr(o,o.type,f.value),Ot(i,o,f.children,c),o.child;case 9:return g=o.type._context,f=o.pendingProps.children,Ps(o),g=Pt(g),f=f(g),o.flags|=1,Ot(i,o,f,c),o.child;case 14:return Iy(i,o,o.type,o.pendingProps,c);case 15:return Hy(i,o,o.type,o.pendingProps,c);case 19:return Jy(i,o,c);case 31:return f=o.pendingProps,c=o.mode,f={mode:f.mode,children:f.children},i===null?(c=Sc(f,c),c.ref=o.ref,o.child=c,c.return=o,o=c):(c=ir(i.child,f),c.ref=o.ref,o.child=c,c.return=o,o=c),o;case 22:return qy(i,o,c);case 24:return Ps(o),f=Pt(gt),i===null?(g=Nf(),g===null&&(g=Ge,b=_f(),g.pooledCache=b,b.refCount++,b!==null&&(g.pooledCacheLanes|=c),g=b),o.memoizedState={parent:f,cache:g},Tf(o),Dr(o,gt,g)):((i.lanes&c)!==0&&(jf(i,o),co(o,null,null,c),lo()),g=i.memoizedState,b=o.memoizedState,g.parent!==f?(g={parent:f,cache:f},o.memoizedState=g,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=g),Dr(o,gt,f)):(f=b.cache,Dr(o,gt,f),f!==g.cache&&kf(o,[gt],c,!0))),Ot(i,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(r(156,o.tag))}function hr(i){i.flags|=4}function Xy(i,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!av(o)){if(o=_n.current,o!==null&&((Re&4194048)===Re?Kn!==null:(Re&62914560)!==Re&&(Re&536870912)===0||o!==Kn))throw ao=Cf,L0;i.flags|=8192}}function kc(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?Mg():536870912,i.lanes|=o,Fi|=o)}function yo(i,o){if(!Be)switch(i.tailMode){case"hidden":o=i.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function Xe(i){var o=i.alternate!==null&&i.alternate.child===i.child,c=0,f=0;if(o)for(var g=i.child;g!==null;)c|=g.lanes|g.childLanes,f|=g.subtreeFlags&65011712,f|=g.flags&65011712,g.return=i,g=g.sibling;else for(g=i.child;g!==null;)c|=g.lanes|g.childLanes,f|=g.subtreeFlags,f|=g.flags,g.return=i,g=g.sibling;return i.subtreeFlags|=f,i.childLanes=c,o}function E_(i,o,c){var f=o.pendingProps;switch(vf(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xe(o),null;case 1:return Xe(o),null;case 3:return c=o.stateNode,f=null,i!==null&&(f=i.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),cr(gt),Dn(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(Za(o)?hr(o):i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,M0())),Xe(o),null;case 26:return c=o.memoizedState,i===null?(hr(o),c!==null?(Xe(o),Xy(o,c)):(Xe(o),o.flags&=-16777217)):c?c!==i.memoizedState?(hr(o),Xe(o),Xy(o,c)):(Xe(o),o.flags&=-16777217):(i.memoizedProps!==f&&hr(o),Xe(o),o.flags&=-16777217),null;case 27:Cs(o),c=ge.current;var g=o.type;if(i!==null&&o.stateNode!=null)i.memoizedProps!==f&&hr(o);else{if(!f){if(o.stateNode===null)throw Error(r(166));return Xe(o),null}i=de.current,Za(o)?T0(o):(i=Xb(g,f,c),o.stateNode=i,hr(o))}return Xe(o),null;case 5:if(Cs(o),c=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==f&&hr(o);else{if(!f){if(o.stateNode===null)throw Error(r(166));return Xe(o),null}if(i=de.current,Za(o))T0(o);else{switch(g=Bc(ge.current),i){case 1:i=g.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:i=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":i=g.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":i=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":i=g.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof f.is=="string"?g.createElement("select",{is:f.is}):g.createElement("select"),f.multiple?i.multiple=!0:f.size&&(i.size=f.size);break;default:i=typeof f.is=="string"?g.createElement(c,{is:f.is}):g.createElement(c)}}i[Ut]=o,i[Qt]=f;e:for(g=o.child;g!==null;){if(g.tag===5||g.tag===6)i.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===o)break e;for(;g.sibling===null;){if(g.return===null||g.return===o)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}o.stateNode=i;e:switch(Dt(i,c,f),c){case"button":case"input":case"select":case"textarea":i=!!f.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&hr(o)}}return Xe(o),o.flags&=-16777217,null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==f&&hr(o);else{if(typeof f!="string"&&o.stateNode===null)throw Error(r(166));if(i=ge.current,Za(o)){if(i=o.stateNode,c=o.memoizedProps,f=null,g=Ft,g!==null)switch(g.tag){case 27:case 5:f=g.memoizedProps}i[Ut]=o,i=!!(i.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||Fb(i.nodeValue,c)),i||zs(o)}else i=Bc(i).createTextNode(f),i[Ut]=o,o.stateNode=i}return Xe(o),null;case 13:if(f=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(g=Za(o),f!==null&&f.dehydrated!==null){if(i===null){if(!g)throw Error(r(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(r(317));g[Ut]=o}else eo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Xe(o),g=!1}else g=M0(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=g),g=!0;if(!g)return o.flags&256?(dr(o),o):(dr(o),null)}if(dr(o),(o.flags&128)!==0)return o.lanes=c,o;if(c=f!==null,i=i!==null&&i.memoizedState!==null,c){f=o.child,g=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(g=f.alternate.memoizedState.cachePool.pool);var b=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(b=f.memoizedState.cachePool.pool),b!==g&&(f.flags|=2048)}return c!==i&&c&&(o.child.flags|=8192),kc(o,o.updateQueue),Xe(o),null;case 4:return Dn(),i===null&&Ah(o.stateNode.containerInfo),Xe(o),null;case 10:return cr(o.type),Xe(o),null;case 19:if(re(yt),g=o.memoizedState,g===null)return Xe(o),null;if(f=(o.flags&128)!==0,b=g.rendering,b===null)if(f)yo(g,!1);else{if(rt!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(b=bc(i),b!==null){for(o.flags|=128,yo(g,!1),i=b.updateQueue,o.updateQueue=i,kc(o,i),o.subtreeFlags=0,i=c,c=o.child;c!==null;)N0(c,i),c=c.sibling;return ee(yt,yt.current&1|2),o.child}i=i.sibling}g.tail!==null&&yn()>Nc&&(o.flags|=128,f=!0,yo(g,!1),o.lanes=4194304)}else{if(!f)if(i=bc(b),i!==null){if(o.flags|=128,f=!0,i=i.updateQueue,o.updateQueue=i,kc(o,i),yo(g,!0),g.tail===null&&g.tailMode==="hidden"&&!b.alternate&&!Be)return Xe(o),null}else 2*yn()-g.renderingStartTime>Nc&&c!==536870912&&(o.flags|=128,f=!0,yo(g,!1),o.lanes=4194304);g.isBackwards?(b.sibling=o.child,o.child=b):(i=g.last,i!==null?i.sibling=b:o.child=b,g.last=b)}return g.tail!==null?(o=g.tail,g.rendering=o,g.tail=o.sibling,g.renderingStartTime=yn(),o.sibling=null,i=yt.current,ee(yt,f?i&1|2:i&1),o):(Xe(o),null);case 22:case 23:return dr(o),Rf(),f=o.memoizedState!==null,i!==null?i.memoizedState!==null!==f&&(o.flags|=8192):f&&(o.flags|=8192),f?(c&536870912)!==0&&(o.flags&128)===0&&(Xe(o),o.subtreeFlags&6&&(o.flags|=8192)):Xe(o),c=o.updateQueue,c!==null&&kc(o,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),f=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==c&&(o.flags|=2048),i!==null&&re($s),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),cr(gt),Xe(o),null;case 25:return null;case 30:return null}throw Error(r(156,o.tag))}function N_(i,o){switch(vf(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return cr(gt),Dn(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return Cs(o),null;case 13:if(dr(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(r(340));eo()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return re(yt),null;case 4:return Dn(),null;case 10:return cr(o.type),null;case 22:case 23:return dr(o),Rf(),i!==null&&re($s),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return cr(gt),null;case 25:return null;default:return null}}function Zy(i,o){switch(vf(o),o.tag){case 3:cr(gt),Dn();break;case 26:case 27:case 5:Cs(o);break;case 4:Dn();break;case 13:dr(o);break;case 19:re(yt);break;case 10:cr(o.type);break;case 22:case 23:dr(o),Rf(),i!==null&&re($s);break;case 24:cr(gt)}}function bo(i,o){try{var c=o.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var g=f.next;c=g;do{if((c.tag&i)===i){f=void 0;var b=c.create,S=c.inst;f=b(),S.destroy=f}c=c.next}while(c!==g)}}catch(E){Ve(o,o.return,E)}}function Ir(i,o,c){try{var f=o.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var b=g.next;f=b;do{if((f.tag&i)===i){var S=f.inst,E=S.destroy;if(E!==void 0){S.destroy=void 0,g=o;var j=c,L=E;try{L()}catch(q){Ve(g,j,q)}}}f=f.next}while(f!==b)}}catch(q){Ve(o,o.return,q)}}function eb(i){var o=i.updateQueue;if(o!==null){var c=i.stateNode;try{I0(o,c)}catch(f){Ve(i,i.return,f)}}}function tb(i,o,c){c.props=Hs(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(f){Ve(i,o,f)}}function vo(i,o){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var f=i.stateNode;break;case 30:f=i.stateNode;break;default:f=i.stateNode}typeof c=="function"?i.refCleanup=c(f):c.current=f}}catch(g){Ve(i,o,g)}}function Gn(i,o){var c=i.ref,f=i.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(g){Ve(i,o,g)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){Ve(i,o,g)}else c.current=null}function nb(i){var o=i.type,c=i.memoizedProps,f=i.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(g){Ve(i,i.return,g)}}function oh(i,o,c){try{var f=i.stateNode;G_(f,i.type,c,o),f[Qt]=o}catch(g){Ve(i,i.return,g)}}function rb(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Yr(i.type)||i.tag===4}function lh(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||rb(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Yr(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function ch(i,o,c){var f=i.tag;if(f===5||f===6)i=i.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(i),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=Lc));else if(f!==4&&(f===27&&Yr(i.type)&&(c=i.stateNode,o=null),i=i.child,i!==null))for(ch(i,o,c),i=i.sibling;i!==null;)ch(i,o,c),i=i.sibling}function _c(i,o,c){var f=i.tag;if(f===5||f===6)i=i.stateNode,o?c.insertBefore(i,o):c.appendChild(i);else if(f!==4&&(f===27&&Yr(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(_c(i,o,c),i=i.sibling;i!==null;)_c(i,o,c),i=i.sibling}function sb(i){var o=i.stateNode,c=i.memoizedProps;try{for(var f=i.type,g=o.attributes;g.length;)o.removeAttributeNode(g[0]);Dt(o,f,c),o[Ut]=i,o[Qt]=c}catch(b){Ve(i,i.return,b)}}var pr=!1,ct=!1,uh=!1,ib=typeof WeakSet=="function"?WeakSet:Set,kt=null;function C_(i,o){if(i=i.containerInfo,Dh=Hc,i=g0(i),lf(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var g=f.anchorOffset,b=f.focusNode;f=f.focusOffset;try{c.nodeType,b.nodeType}catch{c=null;break e}var S=0,E=-1,j=-1,L=0,q=0,K=i,z=null;t:for(;;){for(var U;K!==c||g!==0&&K.nodeType!==3||(E=S+g),K!==b||f!==0&&K.nodeType!==3||(j=S+f),K.nodeType===3&&(S+=K.nodeValue.length),(U=K.firstChild)!==null;)z=K,K=U;for(;;){if(K===i)break t;if(z===c&&++L===g&&(E=S),z===b&&++q===f&&(j=S),(U=K.nextSibling)!==null)break;K=z,z=K.parentNode}K=U}c=E===-1||j===-1?null:{start:E,end:j}}else c=null}c=c||{start:0,end:0}}else c=null;for(Lh={focusedElem:i,selectionRange:c},Hc=!1,kt=o;kt!==null;)if(o=kt,i=o.child,(o.subtreeFlags&1024)!==0&&i!==null)i.return=o,kt=i;else for(;kt!==null;){switch(o=kt,b=o.alternate,i=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&b!==null){i=void 0,c=o,g=b.memoizedProps,b=b.memoizedState,f=c.stateNode;try{var me=Hs(c.type,g,c.elementType===c.type);i=f.getSnapshotBeforeUpdate(me,b),f.__reactInternalSnapshotBeforeUpdate=i}catch(fe){Ve(c,c.return,fe)}}break;case 3:if((i&1024)!==0){if(i=o.stateNode.containerInfo,c=i.nodeType,c===9)Uh(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Uh(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=o.sibling,i!==null){i.return=o.return,kt=i;break}kt=o.return}}function ab(i,o,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:Hr(i,c),f&4&&bo(5,c);break;case 1:if(Hr(i,c),f&4)if(i=c.stateNode,o===null)try{i.componentDidMount()}catch(S){Ve(c,c.return,S)}else{var g=Hs(c.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(g,o,i.__reactInternalSnapshotBeforeUpdate)}catch(S){Ve(c,c.return,S)}}f&64&&eb(c),f&512&&vo(c,c.return);break;case 3:if(Hr(i,c),f&64&&(i=c.updateQueue,i!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{I0(i,o)}catch(S){Ve(c,c.return,S)}}break;case 27:o===null&&f&4&&sb(c);case 26:case 5:Hr(i,c),o===null&&f&4&&nb(c),f&512&&vo(c,c.return);break;case 12:Hr(i,c);break;case 13:Hr(i,c),f&4&&cb(i,c),f&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=B_.bind(null,c),eE(i,c))));break;case 22:if(f=c.memoizedState!==null||pr,!f){o=o!==null&&o.memoizedState!==null||ct,g=pr;var b=ct;pr=f,(ct=o)&&!b?qr(i,c,(c.subtreeFlags&8772)!==0):Hr(i,c),pr=g,ct=b}break;case 30:break;default:Hr(i,c)}}function ob(i){var o=i.alternate;o!==null&&(i.alternate=null,ob(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&Hd(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Je=null,en=!1;function mr(i,o,c){for(c=c.child;c!==null;)lb(i,o,c),c=c.sibling}function lb(i,o,c){if(Qe&&typeof Qe.onCommitFiberUnmount=="function")try{Qe.onCommitFiberUnmount(Le,c)}catch{}switch(c.tag){case 26:ct||Gn(c,o),mr(i,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:ct||Gn(c,o);var f=Je,g=en;Yr(c.type)&&(Je=c.stateNode,en=!1),mr(i,o,c),To(c.stateNode),Je=f,en=g;break;case 5:ct||Gn(c,o);case 6:if(f=Je,g=en,Je=null,mr(i,o,c),Je=f,en=g,Je!==null)if(en)try{(Je.nodeType===9?Je.body:Je.nodeName==="HTML"?Je.ownerDocument.body:Je).removeChild(c.stateNode)}catch(b){Ve(c,o,b)}else try{Je.removeChild(c.stateNode)}catch(b){Ve(c,o,b)}break;case 18:Je!==null&&(en?(i=Je,Jb(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),Bo(i)):Jb(Je,c.stateNode));break;case 4:f=Je,g=en,Je=c.stateNode.containerInfo,en=!0,mr(i,o,c),Je=f,en=g;break;case 0:case 11:case 14:case 15:ct||Ir(2,c,o),ct||Ir(4,c,o),mr(i,o,c);break;case 1:ct||(Gn(c,o),f=c.stateNode,typeof f.componentWillUnmount=="function"&&tb(c,o,f)),mr(i,o,c);break;case 21:mr(i,o,c);break;case 22:ct=(f=ct)||c.memoizedState!==null,mr(i,o,c),ct=f;break;default:mr(i,o,c)}}function cb(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Bo(i)}catch(c){Ve(o,o.return,c)}}function T_(i){switch(i.tag){case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new ib),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new ib),o;default:throw Error(r(435,i.tag))}}function dh(i,o){var c=T_(i);o.forEach(function(f){var g=z_.bind(null,i,f);c.has(f)||(c.add(f),f.then(g,g))})}function cn(i,o){var c=o.deletions;if(c!==null)for(var f=0;f<c.length;f++){var g=c[f],b=i,S=o,E=S;e:for(;E!==null;){switch(E.tag){case 27:if(Yr(E.type)){Je=E.stateNode,en=!1;break e}break;case 5:Je=E.stateNode,en=!1;break e;case 3:case 4:Je=E.stateNode.containerInfo,en=!0;break e}E=E.return}if(Je===null)throw Error(r(160));lb(b,S,g),Je=null,en=!1,b=g.alternate,b!==null&&(b.return=null),g.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)ub(o,i),o=o.sibling}var Bn=null;function ub(i,o){var c=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:cn(o,i),un(i),f&4&&(Ir(3,i,i.return),bo(3,i),Ir(5,i,i.return));break;case 1:cn(o,i),un(i),f&512&&(ct||c===null||Gn(c,c.return)),f&64&&pr&&(i=i.updateQueue,i!==null&&(f=i.callbacks,f!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var g=Bn;if(cn(o,i),un(i),f&512&&(ct||c===null||Gn(c,c.return)),f&4){var b=c!==null?c.memoizedState:null;if(f=i.memoizedState,c===null)if(f===null)if(i.stateNode===null){e:{f=i.type,c=i.memoizedProps,g=g.ownerDocument||g;t:switch(f){case"title":b=g.getElementsByTagName("title")[0],(!b||b[Ha]||b[Ut]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=g.createElement(f),g.head.insertBefore(b,g.querySelector("head > title"))),Dt(b,f,c),b[Ut]=i,wt(b),f=b;break e;case"link":var S=sv("link","href",g).get(f+(c.href||""));if(S){for(var E=0;E<S.length;E++)if(b=S[E],b.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&b.getAttribute("rel")===(c.rel==null?null:c.rel)&&b.getAttribute("title")===(c.title==null?null:c.title)&&b.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){S.splice(E,1);break t}}b=g.createElement(f),Dt(b,f,c),g.head.appendChild(b);break;case"meta":if(S=sv("meta","content",g).get(f+(c.content||""))){for(E=0;E<S.length;E++)if(b=S[E],b.getAttribute("content")===(c.content==null?null:""+c.content)&&b.getAttribute("name")===(c.name==null?null:c.name)&&b.getAttribute("property")===(c.property==null?null:c.property)&&b.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&b.getAttribute("charset")===(c.charSet==null?null:c.charSet)){S.splice(E,1);break t}}b=g.createElement(f),Dt(b,f,c),g.head.appendChild(b);break;default:throw Error(r(468,f))}b[Ut]=i,wt(b),f=b}i.stateNode=f}else iv(g,i.type,i.stateNode);else i.stateNode=rv(g,f,i.memoizedProps);else b!==f?(b===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):b.count--,f===null?iv(g,i.type,i.stateNode):rv(g,f,i.memoizedProps)):f===null&&i.stateNode!==null&&oh(i,i.memoizedProps,c.memoizedProps)}break;case 27:cn(o,i),un(i),f&512&&(ct||c===null||Gn(c,c.return)),c!==null&&f&4&&oh(i,i.memoizedProps,c.memoizedProps);break;case 5:if(cn(o,i),un(i),f&512&&(ct||c===null||Gn(c,c.return)),i.flags&32){g=i.stateNode;try{ki(g,"")}catch(U){Ve(i,i.return,U)}}f&4&&i.stateNode!=null&&(g=i.memoizedProps,oh(i,g,c!==null?c.memoizedProps:g)),f&1024&&(uh=!0);break;case 6:if(cn(o,i),un(i),f&4){if(i.stateNode===null)throw Error(r(162));f=i.memoizedProps,c=i.stateNode;try{c.nodeValue=f}catch(U){Ve(i,i.return,U)}}break;case 3:if(Pc=null,g=Bn,Bn=zc(o.containerInfo),cn(o,i),Bn=g,un(i),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Bo(o.containerInfo)}catch(U){Ve(i,i.return,U)}uh&&(uh=!1,db(i));break;case 4:f=Bn,Bn=zc(i.stateNode.containerInfo),cn(o,i),un(i),Bn=f;break;case 12:cn(o,i),un(i);break;case 13:cn(o,i),un(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(yh=yn()),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,dh(i,f)));break;case 22:g=i.memoizedState!==null;var j=c!==null&&c.memoizedState!==null,L=pr,q=ct;if(pr=L||g,ct=q||j,cn(o,i),ct=q,pr=L,un(i),f&8192)e:for(o=i.stateNode,o._visibility=g?o._visibility&-2:o._visibility|1,g&&(c===null||j||pr||ct||qs(i)),c=null,o=i;;){if(o.tag===5||o.tag===26){if(c===null){j=c=o;try{if(b=j.stateNode,g)S=b.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{E=j.stateNode;var K=j.memoizedProps.style,z=K!=null&&K.hasOwnProperty("display")?K.display:null;E.style.display=z==null||typeof z=="boolean"?"":(""+z).trim()}}catch(U){Ve(j,j.return,U)}}}else if(o.tag===6){if(c===null){j=o;try{j.stateNode.nodeValue=g?"":j.memoizedProps}catch(U){Ve(j,j.return,U)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}f&4&&(f=i.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,dh(i,c))));break;case 19:cn(o,i),un(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,dh(i,f)));break;case 30:break;case 21:break;default:cn(o,i),un(i)}}function un(i){var o=i.flags;if(o&2){try{for(var c,f=i.return;f!==null;){if(rb(f)){c=f;break}f=f.return}if(c==null)throw Error(r(160));switch(c.tag){case 27:var g=c.stateNode,b=lh(i);_c(i,b,g);break;case 5:var S=c.stateNode;c.flags&32&&(ki(S,""),c.flags&=-33);var E=lh(i);_c(i,E,S);break;case 3:case 4:var j=c.stateNode.containerInfo,L=lh(i);ch(i,L,j);break;default:throw Error(r(161))}}catch(q){Ve(i,i.return,q)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function db(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;db(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function Hr(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)ab(i,o.alternate,o),o=o.sibling}function qs(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:Ir(4,o,o.return),qs(o);break;case 1:Gn(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&tb(o,o.return,c),qs(o);break;case 27:To(o.stateNode);case 26:case 5:Gn(o,o.return),qs(o);break;case 22:o.memoizedState===null&&qs(o);break;case 30:qs(o);break;default:qs(o)}i=i.sibling}}function qr(i,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var f=o.alternate,g=i,b=o,S=b.flags;switch(b.tag){case 0:case 11:case 15:qr(g,b,c),bo(4,b);break;case 1:if(qr(g,b,c),f=b,g=f.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(L){Ve(f,f.return,L)}if(f=b,g=f.updateQueue,g!==null){var E=f.stateNode;try{var j=g.shared.hiddenCallbacks;if(j!==null)for(g.shared.hiddenCallbacks=null,g=0;g<j.length;g++)$0(j[g],E)}catch(L){Ve(f,f.return,L)}}c&&S&64&&eb(b),vo(b,b.return);break;case 27:sb(b);case 26:case 5:qr(g,b,c),c&&f===null&&S&4&&nb(b),vo(b,b.return);break;case 12:qr(g,b,c);break;case 13:qr(g,b,c),c&&S&4&&cb(g,b);break;case 22:b.memoizedState===null&&qr(g,b,c),vo(b,b.return);break;case 30:break;default:qr(g,b,c)}o=o.sibling}}function fh(i,o){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&ro(c))}function hh(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&ro(i))}function Wn(i,o,c,f){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)fb(i,o,c,f),o=o.sibling}function fb(i,o,c,f){var g=o.flags;switch(o.tag){case 0:case 11:case 15:Wn(i,o,c,f),g&2048&&bo(9,o);break;case 1:Wn(i,o,c,f);break;case 3:Wn(i,o,c,f),g&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&ro(i)));break;case 12:if(g&2048){Wn(i,o,c,f),i=o.stateNode;try{var b=o.memoizedProps,S=b.id,E=b.onPostCommit;typeof E=="function"&&E(S,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(j){Ve(o,o.return,j)}}else Wn(i,o,c,f);break;case 13:Wn(i,o,c,f);break;case 23:break;case 22:b=o.stateNode,S=o.alternate,o.memoizedState!==null?b._visibility&2?Wn(i,o,c,f):xo(i,o):b._visibility&2?Wn(i,o,c,f):(b._visibility|=2,Hi(i,o,c,f,(o.subtreeFlags&10256)!==0)),g&2048&&fh(S,o);break;case 24:Wn(i,o,c,f),g&2048&&hh(o.alternate,o);break;default:Wn(i,o,c,f)}}function Hi(i,o,c,f,g){for(g=g&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var b=i,S=o,E=c,j=f,L=S.flags;switch(S.tag){case 0:case 11:case 15:Hi(b,S,E,j,g),bo(8,S);break;case 23:break;case 22:var q=S.stateNode;S.memoizedState!==null?q._visibility&2?Hi(b,S,E,j,g):xo(b,S):(q._visibility|=2,Hi(b,S,E,j,g)),g&&L&2048&&fh(S.alternate,S);break;case 24:Hi(b,S,E,j,g),g&&L&2048&&hh(S.alternate,S);break;default:Hi(b,S,E,j,g)}o=o.sibling}}function xo(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=i,f=o,g=f.flags;switch(f.tag){case 22:xo(c,f),g&2048&&fh(f.alternate,f);break;case 24:xo(c,f),g&2048&&hh(f.alternate,f);break;default:xo(c,f)}o=o.sibling}}var wo=8192;function qi(i){if(i.subtreeFlags&wo)for(i=i.child;i!==null;)hb(i),i=i.sibling}function hb(i){switch(i.tag){case 26:qi(i),i.flags&wo&&i.memoizedState!==null&&hE(Bn,i.memoizedState,i.memoizedProps);break;case 5:qi(i);break;case 3:case 4:var o=Bn;Bn=zc(i.stateNode.containerInfo),qi(i),Bn=o;break;case 22:i.memoizedState===null&&(o=i.alternate,o!==null&&o.memoizedState!==null?(o=wo,wo=16777216,qi(i),wo=o):qi(i));break;default:qi(i)}}function pb(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function So(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var f=o[c];kt=f,gb(f,i)}pb(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)mb(i),i=i.sibling}function mb(i){switch(i.tag){case 0:case 11:case 15:So(i),i.flags&2048&&Ir(9,i,i.return);break;case 3:So(i);break;case 12:So(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&2&&(i.return===null||i.return.tag!==13)?(o._visibility&=-3,Ec(i)):So(i);break;default:So(i)}}function Ec(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var f=o[c];kt=f,gb(f,i)}pb(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:Ir(8,o,o.return),Ec(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,Ec(o));break;default:Ec(o)}i=i.sibling}}function gb(i,o){for(;kt!==null;){var c=kt;switch(c.tag){case 0:case 11:case 15:Ir(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:ro(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,kt=f;else e:for(c=i;kt!==null;){f=kt;var g=f.sibling,b=f.return;if(ob(f),f===c){kt=null;break e}if(g!==null){g.return=b,kt=g;break e}kt=b}}}var j_={getCacheForType:function(i){var o=Pt(gt),c=o.data.get(i);return c===void 0&&(c=i(),o.data.set(i,c)),c}},M_=typeof WeakMap=="function"?WeakMap:Map,ze=0,Ge=null,Te=null,Re=0,Ue=0,dn=null,Vr=!1,Vi=!1,ph=!1,gr=0,rt=0,Fr=0,Vs=0,mh=0,En=0,Fi=0,ko=null,tn=null,gh=!1,yh=0,Nc=1/0,Cc=null,Kr=null,Rt=0,Gr=null,Ki=null,Gi=0,bh=0,vh=null,yb=null,_o=0,xh=null;function fn(){if((ze&2)!==0&&Re!==0)return Re&-Re;if($.T!==null){var i=Di;return i!==0?i:Ch()}return Rg()}function bb(){En===0&&(En=(Re&536870912)===0||Be?jg():536870912);var i=_n.current;return i!==null&&(i.flags|=32),En}function hn(i,o,c){(i===Ge&&(Ue===2||Ue===9)||i.cancelPendingCommit!==null)&&(Wi(i,0),Wr(i,Re,En,!1)),Ia(i,c),((ze&2)===0||i!==Ge)&&(i===Ge&&((ze&2)===0&&(Vs|=c),rt===4&&Wr(i,Re,En,!1)),Yn(i))}function vb(i,o,c){if((ze&6)!==0)throw Error(r(327));var f=!c&&(o&124)===0&&(o&i.expiredLanes)===0||$a(i,o),g=f?R_(i,o):kh(i,o,!0),b=f;do{if(g===0){Vi&&!f&&Wr(i,o,0,!1);break}else{if(c=i.current.alternate,b&&!A_(c)){g=kh(i,o,!1),b=!1;continue}if(g===2){if(b=o,i.errorRecoveryDisabledLanes&b)var S=0;else S=i.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){o=S;e:{var E=i;g=ko;var j=E.current.memoizedState.isDehydrated;if(j&&(Wi(E,S).flags|=256),S=kh(E,S,!1),S!==2){if(ph&&!j){E.errorRecoveryDisabledLanes|=b,Vs|=b,g=4;break e}b=tn,tn=g,b!==null&&(tn===null?tn=b:tn.push.apply(tn,b))}g=S}if(b=!1,g!==2)continue}}if(g===1){Wi(i,0),Wr(i,o,0,!0);break}e:{switch(f=i,b=g,b){case 0:case 1:throw Error(r(345));case 4:if((o&4194048)!==o)break;case 6:Wr(f,o,En,!Vr);break e;case 2:tn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((o&62914560)===o&&(g=yh+300-yn(),10<g)){if(Wr(f,o,En,!Vr),Ul(f,0,!0)!==0)break e;f.timeoutHandle=Wb(xb.bind(null,f,c,tn,Cc,gh,o,En,Vs,Fi,Vr,b,2,-0,0),g);break e}xb(f,c,tn,Cc,gh,o,En,Vs,Fi,Vr,b,0,-0,0)}}break}while(!0);Yn(i)}function xb(i,o,c,f,g,b,S,E,j,L,q,K,z,U){if(i.timeoutHandle=-1,K=o.subtreeFlags,(K&8192||(K&16785408)===16785408)&&(Ao={stylesheets:null,count:0,unsuspend:fE},hb(o),K=pE(),K!==null)){i.cancelPendingCommit=K(Cb.bind(null,i,o,b,c,f,g,S,E,j,q,1,z,U)),Wr(i,b,S,!L);return}Cb(i,o,b,c,f,g,S,E,j)}function A_(i){for(var o=i;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var g=c[f],b=g.getSnapshot;g=g.value;try{if(!on(b(),g))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Wr(i,o,c,f){o&=~mh,o&=~Vs,i.suspendedLanes|=o,i.pingedLanes&=~o,f&&(i.warmLanes|=o),f=i.expirationTimes;for(var g=o;0<g;){var b=31-ot(g),S=1<<b;f[b]=-1,g&=~S}c!==0&&Ag(i,c,o)}function Tc(){return(ze&6)===0?(Eo(0),!1):!0}function wh(){if(Te!==null){if(Ue===0)var i=Te.return;else i=Te,lr=Us=null,Uf(i),$i=null,mo=0,i=Te;for(;i!==null;)Zy(i.alternate,i),i=i.return;Te=null}}function Wi(i,o){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,Y_(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),wh(),Ge=i,Te=c=ir(i.current,null),Re=o,Ue=0,dn=null,Vr=!1,Vi=$a(i,o),ph=!1,Fi=En=mh=Vs=Fr=rt=0,tn=ko=null,gh=!1,(o&8)!==0&&(o|=o&32);var f=i.entangledLanes;if(f!==0)for(i=i.entanglements,f&=o;0<f;){var g=31-ot(f),b=1<<g;o|=i[g],f&=~b}return gr=o,Jl(),c}function wb(i,o){Ee=null,$.H=mc,o===io||o===ic?(o=U0(),Ue=3):o===L0?(o=U0(),Ue=4):Ue=o===Py?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,dn=o,Te===null&&(rt=1,xc(i,xn(o,i.current)))}function Sb(){var i=$.H;return $.H=mc,i===null?mc:i}function kb(){var i=$.A;return $.A=j_,i}function Sh(){rt=4,Vr||(Re&4194048)!==Re&&_n.current!==null||(Vi=!0),(Fr&134217727)===0&&(Vs&134217727)===0||Ge===null||Wr(Ge,Re,En,!1)}function kh(i,o,c){var f=ze;ze|=2;var g=Sb(),b=kb();(Ge!==i||Re!==o)&&(Cc=null,Wi(i,o)),o=!1;var S=rt;e:do try{if(Ue!==0&&Te!==null){var E=Te,j=dn;switch(Ue){case 8:wh(),S=6;break e;case 3:case 2:case 9:case 6:_n.current===null&&(o=!0);var L=Ue;if(Ue=0,dn=null,Yi(i,E,j,L),c&&Vi){S=0;break e}break;default:L=Ue,Ue=0,dn=null,Yi(i,E,j,L)}}O_(),S=rt;break}catch(q){wb(i,q)}while(!0);return o&&i.shellSuspendCounter++,lr=Us=null,ze=f,$.H=g,$.A=b,Te===null&&(Ge=null,Re=0,Jl()),S}function O_(){for(;Te!==null;)_b(Te)}function R_(i,o){var c=ze;ze|=2;var f=Sb(),g=kb();Ge!==i||Re!==o?(Cc=null,Nc=yn()+500,Wi(i,o)):Vi=$a(i,o);e:do try{if(Ue!==0&&Te!==null){o=Te;var b=dn;t:switch(Ue){case 1:Ue=0,dn=null,Yi(i,o,b,1);break;case 2:case 9:if(B0(b)){Ue=0,dn=null,Eb(o);break}o=function(){Ue!==2&&Ue!==9||Ge!==i||(Ue=7),Yn(i)},b.then(o,o);break e;case 3:Ue=7;break e;case 4:Ue=5;break e;case 7:B0(b)?(Ue=0,dn=null,Eb(o)):(Ue=0,dn=null,Yi(i,o,b,7));break;case 5:var S=null;switch(Te.tag){case 26:S=Te.memoizedState;case 5:case 27:var E=Te;if(!S||av(S)){Ue=0,dn=null;var j=E.sibling;if(j!==null)Te=j;else{var L=E.return;L!==null?(Te=L,jc(L)):Te=null}break t}}Ue=0,dn=null,Yi(i,o,b,5);break;case 6:Ue=0,dn=null,Yi(i,o,b,6);break;case 8:wh(),rt=6;break e;default:throw Error(r(462))}}D_();break}catch(q){wb(i,q)}while(!0);return lr=Us=null,$.H=f,$.A=g,ze=c,Te!==null?0:(Ge=null,Re=0,Jl(),rt)}function D_(){for(;Te!==null&&!Ld();)_b(Te)}function _b(i){var o=Qy(i.alternate,i,gr);i.memoizedProps=i.pendingProps,o===null?jc(i):Te=o}function Eb(i){var o=i,c=o.alternate;switch(o.tag){case 15:case 0:o=Fy(c,o,o.pendingProps,o.type,void 0,Re);break;case 11:o=Fy(c,o,o.pendingProps,o.type.render,o.ref,Re);break;case 5:Uf(o);default:Zy(c,o),o=Te=N0(o,gr),o=Qy(c,o,gr)}i.memoizedProps=i.pendingProps,o===null?jc(i):Te=o}function Yi(i,o,c,f){lr=Us=null,Uf(o),$i=null,mo=0;var g=o.return;try{if(k_(i,g,o,c,Re)){rt=1,xc(i,xn(c,i.current)),Te=null;return}}catch(b){if(g!==null)throw Te=g,b;rt=1,xc(i,xn(c,i.current)),Te=null;return}o.flags&32768?(Be||f===1?i=!0:Vi||(Re&536870912)!==0?i=!1:(Vr=i=!0,(f===2||f===9||f===3||f===6)&&(f=_n.current,f!==null&&f.tag===13&&(f.flags|=16384))),Nb(o,i)):jc(o)}function jc(i){var o=i;do{if((o.flags&32768)!==0){Nb(o,Vr);return}i=o.return;var c=E_(o.alternate,o,gr);if(c!==null){Te=c;return}if(o=o.sibling,o!==null){Te=o;return}Te=o=i}while(o!==null);rt===0&&(rt=5)}function Nb(i,o){do{var c=N_(i.alternate,i);if(c!==null){c.flags&=32767,Te=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(i=i.sibling,i!==null)){Te=i;return}Te=i=c}while(i!==null);rt=6,Te=null}function Cb(i,o,c,f,g,b,S,E,j){i.cancelPendingCommit=null;do Mc();while(Rt!==0);if((ze&6)!==0)throw Error(r(327));if(o!==null){if(o===i.current)throw Error(r(177));if(b=o.lanes|o.childLanes,b|=hf,fk(i,c,b,S,E,j),i===Ge&&(Te=Ge=null,Re=0),Ki=o,Gr=i,Gi=c,bh=b,vh=g,yb=f,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,U_(se,function(){return Ob(),null})):(i.callbackNode=null,i.callbackPriority=0),f=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||f){f=$.T,$.T=null,g=P.p,P.p=2,S=ze,ze|=4;try{C_(i,o,c)}finally{ze=S,P.p=g,$.T=f}}Rt=1,Tb(),jb(),Mb()}}function Tb(){if(Rt===1){Rt=0;var i=Gr,o=Ki,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=$.T,$.T=null;var f=P.p;P.p=2;var g=ze;ze|=4;try{ub(o,i);var b=Lh,S=g0(i.containerInfo),E=b.focusedElem,j=b.selectionRange;if(S!==E&&E&&E.ownerDocument&&m0(E.ownerDocument.documentElement,E)){if(j!==null&&lf(E)){var L=j.start,q=j.end;if(q===void 0&&(q=L),"selectionStart"in E)E.selectionStart=L,E.selectionEnd=Math.min(q,E.value.length);else{var K=E.ownerDocument||document,z=K&&K.defaultView||window;if(z.getSelection){var U=z.getSelection(),me=E.textContent.length,fe=Math.min(j.start,me),qe=j.end===void 0?fe:Math.min(j.end,me);!U.extend&&fe>qe&&(S=qe,qe=fe,fe=S);var R=p0(E,fe),O=p0(E,qe);if(R&&O&&(U.rangeCount!==1||U.anchorNode!==R.node||U.anchorOffset!==R.offset||U.focusNode!==O.node||U.focusOffset!==O.offset)){var D=K.createRange();D.setStart(R.node,R.offset),U.removeAllRanges(),fe>qe?(U.addRange(D),U.extend(O.node,O.offset)):(D.setEnd(O.node,O.offset),U.addRange(D))}}}}for(K=[],U=E;U=U.parentNode;)U.nodeType===1&&K.push({element:U,left:U.scrollLeft,top:U.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<K.length;E++){var F=K[E];F.element.scrollLeft=F.left,F.element.scrollTop=F.top}}Hc=!!Dh,Lh=Dh=null}finally{ze=g,P.p=f,$.T=c}}i.current=o,Rt=2}}function jb(){if(Rt===2){Rt=0;var i=Gr,o=Ki,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=$.T,$.T=null;var f=P.p;P.p=2;var g=ze;ze|=4;try{ab(i,o.alternate,o)}finally{ze=g,P.p=f,$.T=c}}Rt=3}}function Mb(){if(Rt===4||Rt===3){Rt=0,Dl();var i=Gr,o=Ki,c=Gi,f=yb;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Rt=5:(Rt=0,Ki=Gr=null,Ab(i,i.pendingLanes));var g=i.pendingLanes;if(g===0&&(Kr=null),$d(c),o=o.stateNode,Qe&&typeof Qe.onCommitFiberRoot=="function")try{Qe.onCommitFiberRoot(Le,o,void 0,(o.current.flags&128)===128)}catch{}if(f!==null){o=$.T,g=P.p,P.p=2,$.T=null;try{for(var b=i.onRecoverableError,S=0;S<f.length;S++){var E=f[S];b(E.value,{componentStack:E.stack})}}finally{$.T=o,P.p=g}}(Gi&3)!==0&&Mc(),Yn(i),g=i.pendingLanes,(c&4194090)!==0&&(g&42)!==0?i===xh?_o++:(_o=0,xh=i):_o=0,Eo(0)}}function Ab(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,ro(o)))}function Mc(i){return Tb(),jb(),Mb(),Ob()}function Ob(){if(Rt!==5)return!1;var i=Gr,o=bh;bh=0;var c=$d(Gi),f=$.T,g=P.p;try{P.p=32>c?32:c,$.T=null,c=vh,vh=null;var b=Gr,S=Gi;if(Rt=0,Ki=Gr=null,Gi=0,(ze&6)!==0)throw Error(r(331));var E=ze;if(ze|=4,mb(b.current),fb(b,b.current,S,c),ze=E,Eo(0,!1),Qe&&typeof Qe.onPostCommitFiberRoot=="function")try{Qe.onPostCommitFiberRoot(Le,b)}catch{}return!0}finally{P.p=g,$.T=f,Ab(i,o)}}function Rb(i,o,c){o=xn(c,o),o=Xf(i.stateNode,o,2),i=zr(i,o,2),i!==null&&(Ia(i,2),Yn(i))}function Ve(i,o,c){if(i.tag===3)Rb(i,i,c);else for(;o!==null;){if(o.tag===3){Rb(o,i,c);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Kr===null||!Kr.has(f))){i=xn(c,i),c=zy(2),f=zr(o,c,2),f!==null&&(Uy(c,f,o,i),Ia(f,2),Yn(f));break}}o=o.return}}function _h(i,o,c){var f=i.pingCache;if(f===null){f=i.pingCache=new M_;var g=new Set;f.set(o,g)}else g=f.get(o),g===void 0&&(g=new Set,f.set(o,g));g.has(c)||(ph=!0,g.add(c),i=L_.bind(null,i,o,c),o.then(i,i))}function L_(i,o,c){var f=i.pingCache;f!==null&&f.delete(o),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,Ge===i&&(Re&c)===c&&(rt===4||rt===3&&(Re&62914560)===Re&&300>yn()-yh?(ze&2)===0&&Wi(i,0):mh|=c,Fi===Re&&(Fi=0)),Yn(i)}function Db(i,o){o===0&&(o=Mg()),i=Mi(i,o),i!==null&&(Ia(i,o),Yn(i))}function B_(i){var o=i.memoizedState,c=0;o!==null&&(c=o.retryLane),Db(i,c)}function z_(i,o){var c=0;switch(i.tag){case 13:var f=i.stateNode,g=i.memoizedState;g!==null&&(c=g.retryLane);break;case 19:f=i.stateNode;break;case 22:f=i.stateNode._retryCache;break;default:throw Error(r(314))}f!==null&&f.delete(o),Db(i,c)}function U_(i,o){return Ua(i,o)}var Ac=null,Ji=null,Eh=!1,Oc=!1,Nh=!1,Fs=0;function Yn(i){i!==Ji&&i.next===null&&(Ji===null?Ac=Ji=i:Ji=Ji.next=i),Oc=!0,Eh||(Eh=!0,$_())}function Eo(i,o){if(!Nh&&Oc){Nh=!0;do for(var c=!1,f=Ac;f!==null;){if(i!==0){var g=f.pendingLanes;if(g===0)var b=0;else{var S=f.suspendedLanes,E=f.pingedLanes;b=(1<<31-ot(42|i)+1)-1,b&=g&~(S&~E),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(c=!0,Ub(f,b))}else b=Re,b=Ul(f,f===Ge?b:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(b&3)===0||$a(f,b)||(c=!0,Ub(f,b));f=f.next}while(c);Nh=!1}}function P_(){Lb()}function Lb(){Oc=Eh=!1;var i=0;Fs!==0&&(W_()&&(i=Fs),Fs=0);for(var o=yn(),c=null,f=Ac;f!==null;){var g=f.next,b=Bb(f,o);b===0?(f.next=null,c===null?Ac=g:c.next=g,g===null&&(Ji=c)):(c=f,(i!==0||(b&3)!==0)&&(Oc=!0)),f=g}Eo(i)}function Bb(i,o){for(var c=i.suspendedLanes,f=i.pingedLanes,g=i.expirationTimes,b=i.pendingLanes&-62914561;0<b;){var S=31-ot(b),E=1<<S,j=g[S];j===-1?((E&c)===0||(E&f)!==0)&&(g[S]=dk(E,o)):j<=o&&(i.expiredLanes|=E),b&=~E}if(o=Ge,c=Re,c=Ul(i,i===o?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f=i.callbackNode,c===0||i===o&&(Ue===2||Ue===9)||i.cancelPendingCommit!==null)return f!==null&&f!==null&&Pa(f),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||$a(i,c)){if(o=c&-c,o===i.callbackPriority)return o;switch(f!==null&&Pa(f),$d(c)){case 2:case 8:c=V;break;case 32:c=se;break;case 268435456:c=we;break;default:c=se}return f=zb.bind(null,i),c=Ua(c,f),i.callbackPriority=o,i.callbackNode=c,o}return f!==null&&f!==null&&Pa(f),i.callbackPriority=2,i.callbackNode=null,2}function zb(i,o){if(Rt!==0&&Rt!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(Mc()&&i.callbackNode!==c)return null;var f=Re;return f=Ul(i,i===Ge?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f===0?null:(vb(i,f,o),Bb(i,yn()),i.callbackNode!=null&&i.callbackNode===c?zb.bind(null,i):null)}function Ub(i,o){if(Mc())return null;vb(i,o,!0)}function $_(){J_(function(){(ze&6)!==0?Ua(Ll,P_):Lb()})}function Ch(){return Fs===0&&(Fs=jg()),Fs}function Pb(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:ql(""+i)}function $b(i,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,i.id&&c.setAttribute("form",i.id),o.parentNode.insertBefore(c,o),i=new FormData(i),c.parentNode.removeChild(c),i}function I_(i,o,c,f,g){if(o==="submit"&&c&&c.stateNode===g){var b=Pb((g[Qt]||null).action),S=f.submitter;S&&(o=(o=S[Qt]||null)?Pb(o.formAction):S.getAttribute("formAction"),o!==null&&(b=o,S=null));var E=new Gl("action","action",null,f,g);i.push({event:E,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Fs!==0){var j=S?$b(g,S):new FormData(g);Gf(c,{pending:!0,data:j,method:g.method,action:b},null,j)}}else typeof b=="function"&&(E.preventDefault(),j=S?$b(g,S):new FormData(g),Gf(c,{pending:!0,data:j,method:g.method,action:b},b,j))},currentTarget:g}]})}}for(var Th=0;Th<ff.length;Th++){var jh=ff[Th],H_=jh.toLowerCase(),q_=jh[0].toUpperCase()+jh.slice(1);Ln(H_,"on"+q_)}Ln(v0,"onAnimationEnd"),Ln(x0,"onAnimationIteration"),Ln(w0,"onAnimationStart"),Ln("dblclick","onDoubleClick"),Ln("focusin","onFocus"),Ln("focusout","onBlur"),Ln(a_,"onTransitionRun"),Ln(o_,"onTransitionStart"),Ln(l_,"onTransitionCancel"),Ln(S0,"onTransitionEnd"),xi("onMouseEnter",["mouseout","mouseover"]),xi("onMouseLeave",["mouseout","mouseover"]),xi("onPointerEnter",["pointerout","pointerover"]),xi("onPointerLeave",["pointerout","pointerover"]),js("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),js("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),js("onBeforeInput",["compositionend","keypress","textInput","paste"]),js("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),js("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),js("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var No="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),V_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(No));function Ib(i,o){o=(o&4)!==0;for(var c=0;c<i.length;c++){var f=i[c],g=f.event;f=f.listeners;e:{var b=void 0;if(o)for(var S=f.length-1;0<=S;S--){var E=f[S],j=E.instance,L=E.currentTarget;if(E=E.listener,j!==b&&g.isPropagationStopped())break e;b=E,g.currentTarget=L;try{b(g)}catch(q){vc(q)}g.currentTarget=null,b=j}else for(S=0;S<f.length;S++){if(E=f[S],j=E.instance,L=E.currentTarget,E=E.listener,j!==b&&g.isPropagationStopped())break e;b=E,g.currentTarget=L;try{b(g)}catch(q){vc(q)}g.currentTarget=null,b=j}}}}function je(i,o){var c=o[Id];c===void 0&&(c=o[Id]=new Set);var f=i+"__bubble";c.has(f)||(Hb(o,i,2,!1),c.add(f))}function Mh(i,o,c){var f=0;o&&(f|=4),Hb(c,i,f,o)}var Rc="_reactListening"+Math.random().toString(36).slice(2);function Ah(i){if(!i[Rc]){i[Rc]=!0,Lg.forEach(function(c){c!=="selectionchange"&&(V_.has(c)||Mh(c,!1,i),Mh(c,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Rc]||(o[Rc]=!0,Mh("selectionchange",!1,o))}}function Hb(i,o,c,f){switch(fv(o)){case 2:var g=yE;break;case 8:g=bE;break;default:g=Fh}c=g.bind(null,o,c,i),g=void 0,!Xd||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(g=!0),f?g!==void 0?i.addEventListener(o,c,{capture:!0,passive:g}):i.addEventListener(o,c,!0):g!==void 0?i.addEventListener(o,c,{passive:g}):i.addEventListener(o,c,!1)}function Oh(i,o,c,f,g){var b=f;if((o&1)===0&&(o&2)===0&&f!==null)e:for(;;){if(f===null)return;var S=f.tag;if(S===3||S===4){var E=f.stateNode.containerInfo;if(E===g)break;if(S===4)for(S=f.return;S!==null;){var j=S.tag;if((j===3||j===4)&&S.stateNode.containerInfo===g)return;S=S.return}for(;E!==null;){if(S=yi(E),S===null)return;if(j=S.tag,j===5||j===6||j===26||j===27){f=b=S;continue e}E=E.parentNode}}f=f.return}Yg(function(){var L=b,q=Jd(c),K=[];e:{var z=k0.get(i);if(z!==void 0){var U=Gl,me=i;switch(i){case"keypress":if(Fl(c)===0)break e;case"keydown":case"keyup":U=Uk;break;case"focusin":me="focus",U=nf;break;case"focusout":me="blur",U=nf;break;case"beforeblur":case"afterblur":U=nf;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":U=Xg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":U=Nk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":U=Ik;break;case v0:case x0:case w0:U=jk;break;case S0:U=qk;break;case"scroll":case"scrollend":U=_k;break;case"wheel":U=Fk;break;case"copy":case"cut":case"paste":U=Ak;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":U=e0;break;case"toggle":case"beforetoggle":U=Gk}var fe=(o&4)!==0,qe=!fe&&(i==="scroll"||i==="scrollend"),R=fe?z!==null?z+"Capture":null:z;fe=[];for(var O=L,D;O!==null;){var F=O;if(D=F.stateNode,F=F.tag,F!==5&&F!==26&&F!==27||D===null||R===null||(F=Va(O,R),F!=null&&fe.push(Co(O,F,D))),qe)break;O=O.return}0<fe.length&&(z=new U(z,me,null,c,q),K.push({event:z,listeners:fe}))}}if((o&7)===0){e:{if(z=i==="mouseover"||i==="pointerover",U=i==="mouseout"||i==="pointerout",z&&c!==Yd&&(me=c.relatedTarget||c.fromElement)&&(yi(me)||me[gi]))break e;if((U||z)&&(z=q.window===q?q:(z=q.ownerDocument)?z.defaultView||z.parentWindow:window,U?(me=c.relatedTarget||c.toElement,U=L,me=me?yi(me):null,me!==null&&(qe=a(me),fe=me.tag,me!==qe||fe!==5&&fe!==27&&fe!==6)&&(me=null)):(U=null,me=L),U!==me)){if(fe=Xg,F="onMouseLeave",R="onMouseEnter",O="mouse",(i==="pointerout"||i==="pointerover")&&(fe=e0,F="onPointerLeave",R="onPointerEnter",O="pointer"),qe=U==null?z:qa(U),D=me==null?z:qa(me),z=new fe(F,O+"leave",U,c,q),z.target=qe,z.relatedTarget=D,F=null,yi(q)===L&&(fe=new fe(R,O+"enter",me,c,q),fe.target=D,fe.relatedTarget=qe,F=fe),qe=F,U&&me)t:{for(fe=U,R=me,O=0,D=fe;D;D=Qi(D))O++;for(D=0,F=R;F;F=Qi(F))D++;for(;0<O-D;)fe=Qi(fe),O--;for(;0<D-O;)R=Qi(R),D--;for(;O--;){if(fe===R||R!==null&&fe===R.alternate)break t;fe=Qi(fe),R=Qi(R)}fe=null}else fe=null;U!==null&&qb(K,z,U,fe,!1),me!==null&&qe!==null&&qb(K,qe,me,fe,!0)}}e:{if(z=L?qa(L):window,U=z.nodeName&&z.nodeName.toLowerCase(),U==="select"||U==="input"&&z.type==="file")var ae=l0;else if(a0(z))if(c0)ae=r_;else{ae=t_;var Ne=e_}else U=z.nodeName,!U||U.toLowerCase()!=="input"||z.type!=="checkbox"&&z.type!=="radio"?L&&Wd(L.elementType)&&(ae=l0):ae=n_;if(ae&&(ae=ae(i,L))){o0(K,ae,c,q);break e}Ne&&Ne(i,z,L),i==="focusout"&&L&&z.type==="number"&&L.memoizedProps.value!=null&&Gd(z,"number",z.value)}switch(Ne=L?qa(L):window,i){case"focusin":(a0(Ne)||Ne.contentEditable==="true")&&(Ci=Ne,cf=L,Xa=null);break;case"focusout":Xa=cf=Ci=null;break;case"mousedown":uf=!0;break;case"contextmenu":case"mouseup":case"dragend":uf=!1,y0(K,c,q);break;case"selectionchange":if(i_)break;case"keydown":case"keyup":y0(K,c,q)}var le;if(sf)e:{switch(i){case"compositionstart":var pe="onCompositionStart";break e;case"compositionend":pe="onCompositionEnd";break e;case"compositionupdate":pe="onCompositionUpdate";break e}pe=void 0}else Ni?s0(i,c)&&(pe="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(pe="onCompositionStart");pe&&(t0&&c.locale!=="ko"&&(Ni||pe!=="onCompositionStart"?pe==="onCompositionEnd"&&Ni&&(le=Jg()):(Rr=q,Zd="value"in Rr?Rr.value:Rr.textContent,Ni=!0)),Ne=Dc(L,pe),0<Ne.length&&(pe=new Zg(pe,i,null,c,q),K.push({event:pe,listeners:Ne}),le?pe.data=le:(le=i0(c),le!==null&&(pe.data=le)))),(le=Yk?Jk(i,c):Qk(i,c))&&(pe=Dc(L,"onBeforeInput"),0<pe.length&&(Ne=new Zg("onBeforeInput","beforeinput",null,c,q),K.push({event:Ne,listeners:pe}),Ne.data=le)),I_(K,i,L,c,q)}Ib(K,o)})}function Co(i,o,c){return{instance:i,listener:o,currentTarget:c}}function Dc(i,o){for(var c=o+"Capture",f=[];i!==null;){var g=i,b=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||b===null||(g=Va(i,c),g!=null&&f.unshift(Co(i,g,b)),g=Va(i,o),g!=null&&f.push(Co(i,g,b))),i.tag===3)return f;i=i.return}return[]}function Qi(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function qb(i,o,c,f,g){for(var b=o._reactName,S=[];c!==null&&c!==f;){var E=c,j=E.alternate,L=E.stateNode;if(E=E.tag,j!==null&&j===f)break;E!==5&&E!==26&&E!==27||L===null||(j=L,g?(L=Va(c,b),L!=null&&S.unshift(Co(c,L,j))):g||(L=Va(c,b),L!=null&&S.push(Co(c,L,j)))),c=c.return}S.length!==0&&i.push({event:o,listeners:S})}var F_=/\r\n?/g,K_=/\u0000|\uFFFD/g;function Vb(i){return(typeof i=="string"?i:""+i).replace(F_,`
`).replace(K_,"")}function Fb(i,o){return o=Vb(o),Vb(i)===o}function Lc(){}function He(i,o,c,f,g,b){switch(c){case"children":typeof f=="string"?o==="body"||o==="textarea"&&f===""||ki(i,f):(typeof f=="number"||typeof f=="bigint")&&o!=="body"&&ki(i,""+f);break;case"className":$l(i,"class",f);break;case"tabIndex":$l(i,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":$l(i,c,f);break;case"style":Gg(i,f,b);break;case"data":if(o!=="object"){$l(i,"data",f);break}case"src":case"href":if(f===""&&(o!=="a"||c!=="href")){i.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(c);break}f=ql(""+f),i.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(c==="formAction"?(o!=="input"&&He(i,o,"name",g.name,g,null),He(i,o,"formEncType",g.formEncType,g,null),He(i,o,"formMethod",g.formMethod,g,null),He(i,o,"formTarget",g.formTarget,g,null)):(He(i,o,"encType",g.encType,g,null),He(i,o,"method",g.method,g,null),He(i,o,"target",g.target,g,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(c);break}f=ql(""+f),i.setAttribute(c,f);break;case"onClick":f!=null&&(i.onclick=Lc);break;case"onScroll":f!=null&&je("scroll",i);break;case"onScrollEnd":f!=null&&je("scrollend",i);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(c=f.__html,c!=null){if(g.children!=null)throw Error(r(60));i.innerHTML=c}}break;case"multiple":i.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":i.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){i.removeAttribute("xlink:href");break}c=ql(""+f),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,""+f):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":f===!0?i.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,f):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?i.setAttribute(c,f):i.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?i.removeAttribute(c):i.setAttribute(c,f);break;case"popover":je("beforetoggle",i),je("toggle",i),Pl(i,"popover",f);break;case"xlinkActuate":rr(i,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":rr(i,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":rr(i,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":rr(i,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":rr(i,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":rr(i,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":rr(i,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":rr(i,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":rr(i,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Pl(i,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Sk.get(c)||c,Pl(i,c,f))}}function Rh(i,o,c,f,g,b){switch(c){case"style":Gg(i,f,b);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(c=f.__html,c!=null){if(g.children!=null)throw Error(r(60));i.innerHTML=c}}break;case"children":typeof f=="string"?ki(i,f):(typeof f=="number"||typeof f=="bigint")&&ki(i,""+f);break;case"onScroll":f!=null&&je("scroll",i);break;case"onScrollEnd":f!=null&&je("scrollend",i);break;case"onClick":f!=null&&(i.onclick=Lc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Bg.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),o=c.slice(2,g?c.length-7:void 0),b=i[Qt]||null,b=b!=null?b[c]:null,typeof b=="function"&&i.removeEventListener(o,b,g),typeof f=="function")){typeof b!="function"&&b!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(o,f,g);break e}c in i?i[c]=f:f===!0?i.setAttribute(c,""):Pl(i,c,f)}}}function Dt(i,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":je("error",i),je("load",i);var f=!1,g=!1,b;for(b in c)if(c.hasOwnProperty(b)){var S=c[b];if(S!=null)switch(b){case"src":f=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:He(i,o,b,S,c,null)}}g&&He(i,o,"srcSet",c.srcSet,c,null),f&&He(i,o,"src",c.src,c,null);return;case"input":je("invalid",i);var E=b=S=g=null,j=null,L=null;for(f in c)if(c.hasOwnProperty(f)){var q=c[f];if(q!=null)switch(f){case"name":g=q;break;case"type":S=q;break;case"checked":j=q;break;case"defaultChecked":L=q;break;case"value":b=q;break;case"defaultValue":E=q;break;case"children":case"dangerouslySetInnerHTML":if(q!=null)throw Error(r(137,o));break;default:He(i,o,f,q,c,null)}}qg(i,b,E,j,L,S,g,!1),Il(i);return;case"select":je("invalid",i),f=S=b=null;for(g in c)if(c.hasOwnProperty(g)&&(E=c[g],E!=null))switch(g){case"value":b=E;break;case"defaultValue":S=E;break;case"multiple":f=E;default:He(i,o,g,E,c,null)}o=b,c=S,i.multiple=!!f,o!=null?Si(i,!!f,o,!1):c!=null&&Si(i,!!f,c,!0);return;case"textarea":je("invalid",i),b=g=f=null;for(S in c)if(c.hasOwnProperty(S)&&(E=c[S],E!=null))switch(S){case"value":f=E;break;case"defaultValue":g=E;break;case"children":b=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(r(91));break;default:He(i,o,S,E,c,null)}Fg(i,f,g,b),Il(i);return;case"option":for(j in c)if(c.hasOwnProperty(j)&&(f=c[j],f!=null))switch(j){case"selected":i.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:He(i,o,j,f,c,null)}return;case"dialog":je("beforetoggle",i),je("toggle",i),je("cancel",i),je("close",i);break;case"iframe":case"object":je("load",i);break;case"video":case"audio":for(f=0;f<No.length;f++)je(No[f],i);break;case"image":je("error",i),je("load",i);break;case"details":je("toggle",i);break;case"embed":case"source":case"link":je("error",i),je("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(L in c)if(c.hasOwnProperty(L)&&(f=c[L],f!=null))switch(L){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:He(i,o,L,f,c,null)}return;default:if(Wd(o)){for(q in c)c.hasOwnProperty(q)&&(f=c[q],f!==void 0&&Rh(i,o,q,f,c,void 0));return}}for(E in c)c.hasOwnProperty(E)&&(f=c[E],f!=null&&He(i,o,E,f,c,null))}function G_(i,o,c,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,b=null,S=null,E=null,j=null,L=null,q=null;for(U in c){var K=c[U];if(c.hasOwnProperty(U)&&K!=null)switch(U){case"checked":break;case"value":break;case"defaultValue":j=K;default:f.hasOwnProperty(U)||He(i,o,U,null,f,K)}}for(var z in f){var U=f[z];if(K=c[z],f.hasOwnProperty(z)&&(U!=null||K!=null))switch(z){case"type":b=U;break;case"name":g=U;break;case"checked":L=U;break;case"defaultChecked":q=U;break;case"value":S=U;break;case"defaultValue":E=U;break;case"children":case"dangerouslySetInnerHTML":if(U!=null)throw Error(r(137,o));break;default:U!==K&&He(i,o,z,U,f,K)}}Kd(i,S,E,j,L,q,b,g);return;case"select":U=S=E=z=null;for(b in c)if(j=c[b],c.hasOwnProperty(b)&&j!=null)switch(b){case"value":break;case"multiple":U=j;default:f.hasOwnProperty(b)||He(i,o,b,null,f,j)}for(g in f)if(b=f[g],j=c[g],f.hasOwnProperty(g)&&(b!=null||j!=null))switch(g){case"value":z=b;break;case"defaultValue":E=b;break;case"multiple":S=b;default:b!==j&&He(i,o,g,b,f,j)}o=E,c=S,f=U,z!=null?Si(i,!!c,z,!1):!!f!=!!c&&(o!=null?Si(i,!!c,o,!0):Si(i,!!c,c?[]:"",!1));return;case"textarea":U=z=null;for(E in c)if(g=c[E],c.hasOwnProperty(E)&&g!=null&&!f.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:He(i,o,E,null,f,g)}for(S in f)if(g=f[S],b=c[S],f.hasOwnProperty(S)&&(g!=null||b!=null))switch(S){case"value":z=g;break;case"defaultValue":U=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(r(91));break;default:g!==b&&He(i,o,S,g,f,b)}Vg(i,z,U);return;case"option":for(var me in c)if(z=c[me],c.hasOwnProperty(me)&&z!=null&&!f.hasOwnProperty(me))switch(me){case"selected":i.selected=!1;break;default:He(i,o,me,null,f,z)}for(j in f)if(z=f[j],U=c[j],f.hasOwnProperty(j)&&z!==U&&(z!=null||U!=null))switch(j){case"selected":i.selected=z&&typeof z!="function"&&typeof z!="symbol";break;default:He(i,o,j,z,f,U)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var fe in c)z=c[fe],c.hasOwnProperty(fe)&&z!=null&&!f.hasOwnProperty(fe)&&He(i,o,fe,null,f,z);for(L in f)if(z=f[L],U=c[L],f.hasOwnProperty(L)&&z!==U&&(z!=null||U!=null))switch(L){case"children":case"dangerouslySetInnerHTML":if(z!=null)throw Error(r(137,o));break;default:He(i,o,L,z,f,U)}return;default:if(Wd(o)){for(var qe in c)z=c[qe],c.hasOwnProperty(qe)&&z!==void 0&&!f.hasOwnProperty(qe)&&Rh(i,o,qe,void 0,f,z);for(q in f)z=f[q],U=c[q],!f.hasOwnProperty(q)||z===U||z===void 0&&U===void 0||Rh(i,o,q,z,f,U);return}}for(var R in c)z=c[R],c.hasOwnProperty(R)&&z!=null&&!f.hasOwnProperty(R)&&He(i,o,R,null,f,z);for(K in f)z=f[K],U=c[K],!f.hasOwnProperty(K)||z===U||z==null&&U==null||He(i,o,K,z,f,U)}var Dh=null,Lh=null;function Bc(i){return i.nodeType===9?i:i.ownerDocument}function Kb(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Gb(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function Bh(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var zh=null;function W_(){var i=window.event;return i&&i.type==="popstate"?i===zh?!1:(zh=i,!0):(zh=null,!1)}var Wb=typeof setTimeout=="function"?setTimeout:void 0,Y_=typeof clearTimeout=="function"?clearTimeout:void 0,Yb=typeof Promise=="function"?Promise:void 0,J_=typeof queueMicrotask=="function"?queueMicrotask:typeof Yb<"u"?function(i){return Yb.resolve(null).then(i).catch(Q_)}:Wb;function Q_(i){setTimeout(function(){throw i})}function Yr(i){return i==="head"}function Jb(i,o){var c=o,f=0,g=0;do{var b=c.nextSibling;if(i.removeChild(c),b&&b.nodeType===8)if(c=b.data,c==="/$"){if(0<f&&8>f){c=f;var S=i.ownerDocument;if(c&1&&To(S.documentElement),c&2&&To(S.body),c&4)for(c=S.head,To(c),S=c.firstChild;S;){var E=S.nextSibling,j=S.nodeName;S[Ha]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&S.rel.toLowerCase()==="stylesheet"||c.removeChild(S),S=E}}if(g===0){i.removeChild(b),Bo(o);return}g--}else c==="$"||c==="$?"||c==="$!"?g++:f=c.charCodeAt(0)-48;else f=0;c=b}while(c);Bo(o)}function Uh(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Uh(c),Hd(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function X_(i,o,c,f){for(;i.nodeType===1;){var g=c;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!f&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(f){if(!i[Ha])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(b=i.getAttribute("rel"),b==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(b!==g.rel||i.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||i.getAttribute("title")!==(g.title==null?null:g.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(b=i.getAttribute("src"),(b!==(g.src==null?null:g.src)||i.getAttribute("type")!==(g.type==null?null:g.type)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&b&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var b=g.name==null?null:""+g.name;if(g.type==="hidden"&&i.getAttribute("name")===b)return i}else return i;if(i=zn(i.nextSibling),i===null)break}return null}function Z_(i,o,c){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=zn(i.nextSibling),i===null))return null;return i}function Ph(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function eE(i,o){var c=i.ownerDocument;if(i.data!=="$?"||c.readyState==="complete")o();else{var f=function(){o(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),i._reactRetry=f}}function zn(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return i}var $h=null;function Qb(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(o===0)return i;o--}else c==="/$"&&o++}i=i.previousSibling}return null}function Xb(i,o,c){switch(o=Bc(c),i){case"html":if(i=o.documentElement,!i)throw Error(r(452));return i;case"head":if(i=o.head,!i)throw Error(r(453));return i;case"body":if(i=o.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function To(i){for(var o=i.attributes;o.length;)i.removeAttributeNode(o[0]);Hd(i)}var Nn=new Map,Zb=new Set;function zc(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var yr=P.d;P.d={f:tE,r:nE,D:rE,C:sE,L:iE,m:aE,X:lE,S:oE,M:cE};function tE(){var i=yr.f(),o=Tc();return i||o}function nE(i){var o=bi(i);o!==null&&o.tag===5&&o.type==="form"?vy(o):yr.r(i)}var Xi=typeof document>"u"?null:document;function ev(i,o,c){var f=Xi;if(f&&typeof o=="string"&&o){var g=vn(o);g='link[rel="'+i+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),Zb.has(g)||(Zb.add(g),i={rel:i,crossOrigin:c,href:o},f.querySelector(g)===null&&(o=f.createElement("link"),Dt(o,"link",i),wt(o),f.head.appendChild(o)))}}function rE(i){yr.D(i),ev("dns-prefetch",i,null)}function sE(i,o){yr.C(i,o),ev("preconnect",i,o)}function iE(i,o,c){yr.L(i,o,c);var f=Xi;if(f&&i&&o){var g='link[rel="preload"][as="'+vn(o)+'"]';o==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+vn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+vn(c.imageSizes)+'"]')):g+='[href="'+vn(i)+'"]';var b=g;switch(o){case"style":b=Zi(i);break;case"script":b=ea(i)}Nn.has(b)||(i=m({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:i,as:o},c),Nn.set(b,i),f.querySelector(g)!==null||o==="style"&&f.querySelector(jo(b))||o==="script"&&f.querySelector(Mo(b))||(o=f.createElement("link"),Dt(o,"link",i),wt(o),f.head.appendChild(o)))}}function aE(i,o){yr.m(i,o);var c=Xi;if(c&&i){var f=o&&typeof o.as=="string"?o.as:"script",g='link[rel="modulepreload"][as="'+vn(f)+'"][href="'+vn(i)+'"]',b=g;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=ea(i)}if(!Nn.has(b)&&(i=m({rel:"modulepreload",href:i},o),Nn.set(b,i),c.querySelector(g)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Mo(b)))return}f=c.createElement("link"),Dt(f,"link",i),wt(f),c.head.appendChild(f)}}}function oE(i,o,c){yr.S(i,o,c);var f=Xi;if(f&&i){var g=vi(f).hoistableStyles,b=Zi(i);o=o||"default";var S=g.get(b);if(!S){var E={loading:0,preload:null};if(S=f.querySelector(jo(b)))E.loading=5;else{i=m({rel:"stylesheet",href:i,"data-precedence":o},c),(c=Nn.get(b))&&Ih(i,c);var j=S=f.createElement("link");wt(j),Dt(j,"link",i),j._p=new Promise(function(L,q){j.onload=L,j.onerror=q}),j.addEventListener("load",function(){E.loading|=1}),j.addEventListener("error",function(){E.loading|=2}),E.loading|=4,Uc(S,o,f)}S={type:"stylesheet",instance:S,count:1,state:E},g.set(b,S)}}}function lE(i,o){yr.X(i,o);var c=Xi;if(c&&i){var f=vi(c).hoistableScripts,g=ea(i),b=f.get(g);b||(b=c.querySelector(Mo(g)),b||(i=m({src:i,async:!0},o),(o=Nn.get(g))&&Hh(i,o),b=c.createElement("script"),wt(b),Dt(b,"link",i),c.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},f.set(g,b))}}function cE(i,o){yr.M(i,o);var c=Xi;if(c&&i){var f=vi(c).hoistableScripts,g=ea(i),b=f.get(g);b||(b=c.querySelector(Mo(g)),b||(i=m({src:i,async:!0,type:"module"},o),(o=Nn.get(g))&&Hh(i,o),b=c.createElement("script"),wt(b),Dt(b,"link",i),c.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},f.set(g,b))}}function tv(i,o,c,f){var g=(g=ge.current)?zc(g):null;if(!g)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=Zi(c.href),c=vi(g).hoistableStyles,f=c.get(o),f||(f={type:"style",instance:null,count:0,state:null},c.set(o,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Zi(c.href);var b=vi(g).hoistableStyles,S=b.get(i);if(S||(g=g.ownerDocument||g,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(i,S),(b=g.querySelector(jo(i)))&&!b._p&&(S.instance=b,S.state.loading=5),Nn.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Nn.set(i,c),b||uE(g,i,c,S.state))),o&&f===null)throw Error(r(528,""));return S}if(o&&f!==null)throw Error(r(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=ea(c),c=vi(g).hoistableScripts,f=c.get(o),f||(f={type:"script",instance:null,count:0,state:null},c.set(o,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function Zi(i){return'href="'+vn(i)+'"'}function jo(i){return'link[rel="stylesheet"]['+i+"]"}function nv(i){return m({},i,{"data-precedence":i.precedence,precedence:null})}function uE(i,o,c,f){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?f.loading=1:(o=i.createElement("link"),f.preload=o,o.addEventListener("load",function(){return f.loading|=1}),o.addEventListener("error",function(){return f.loading|=2}),Dt(o,"link",c),wt(o),i.head.appendChild(o))}function ea(i){return'[src="'+vn(i)+'"]'}function Mo(i){return"script[async]"+i}function rv(i,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var f=i.querySelector('style[data-href~="'+vn(c.href)+'"]');if(f)return o.instance=f,wt(f),f;var g=m({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(i.ownerDocument||i).createElement("style"),wt(f),Dt(f,"style",g),Uc(f,c.precedence,i),o.instance=f;case"stylesheet":g=Zi(c.href);var b=i.querySelector(jo(g));if(b)return o.state.loading|=4,o.instance=b,wt(b),b;f=nv(c),(g=Nn.get(g))&&Ih(f,g),b=(i.ownerDocument||i).createElement("link"),wt(b);var S=b;return S._p=new Promise(function(E,j){S.onload=E,S.onerror=j}),Dt(b,"link",f),o.state.loading|=4,Uc(b,c.precedence,i),o.instance=b;case"script":return b=ea(c.src),(g=i.querySelector(Mo(b)))?(o.instance=g,wt(g),g):(f=c,(g=Nn.get(b))&&(f=m({},c),Hh(f,g)),i=i.ownerDocument||i,g=i.createElement("script"),wt(g),Dt(g,"link",f),i.head.appendChild(g),o.instance=g);case"void":return null;default:throw Error(r(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(f=o.instance,o.state.loading|=4,Uc(f,c.precedence,i));return o.instance}function Uc(i,o,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=f.length?f[f.length-1]:null,b=g,S=0;S<f.length;S++){var E=f[S];if(E.dataset.precedence===o)b=E;else if(b!==g)break}b?b.parentNode.insertBefore(i,b.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(i,o.firstChild))}function Ih(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function Hh(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var Pc=null;function sv(i,o,c){if(Pc===null){var f=new Map,g=Pc=new Map;g.set(c,f)}else g=Pc,f=g.get(c),f||(f=new Map,g.set(c,f));if(f.has(i))return f;for(f.set(i,null),c=c.getElementsByTagName(i),g=0;g<c.length;g++){var b=c[g];if(!(b[Ha]||b[Ut]||i==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var S=b.getAttribute(o)||"";S=i+S;var E=f.get(S);E?E.push(b):f.set(S,[b])}}return f}function iv(i,o,c){i=i.ownerDocument||i,i.head.insertBefore(c,o==="title"?i.querySelector("head > title"):null)}function dE(i,o,c){if(c===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function av(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var Ao=null;function fE(){}function hE(i,o,c){if(Ao===null)throw Error(r(475));var f=Ao;if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=Zi(c.href),b=i.querySelector(jo(g));if(b){i=b._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(f.count++,f=$c.bind(f),i.then(f,f)),o.state.loading|=4,o.instance=b,wt(b);return}b=i.ownerDocument||i,c=nv(c),(g=Nn.get(g))&&Ih(c,g),b=b.createElement("link"),wt(b);var S=b;S._p=new Promise(function(E,j){S.onload=E,S.onerror=j}),Dt(b,"link",c),o.instance=b}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(f.count++,o=$c.bind(f),i.addEventListener("load",o),i.addEventListener("error",o))}}function pE(){if(Ao===null)throw Error(r(475));var i=Ao;return i.stylesheets&&i.count===0&&qh(i,i.stylesheets),0<i.count?function(o){var c=setTimeout(function(){if(i.stylesheets&&qh(i,i.stylesheets),i.unsuspend){var f=i.unsuspend;i.unsuspend=null,f()}},6e4);return i.unsuspend=o,function(){i.unsuspend=null,clearTimeout(c)}}:null}function $c(){if(this.count--,this.count===0){if(this.stylesheets)qh(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Ic=null;function qh(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Ic=new Map,o.forEach(mE,i),Ic=null,$c.call(i))}function mE(i,o){if(!(o.state.loading&4)){var c=Ic.get(i);if(c)var f=c.get(null);else{c=new Map,Ic.set(i,c);for(var g=i.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<g.length;b++){var S=g[b];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(c.set(S.dataset.precedence,S),f=S)}f&&c.set(null,f)}g=o.instance,S=g.getAttribute("data-precedence"),b=c.get(S)||f,b===f&&c.set(null,g),c.set(S,g),this.count++,f=$c.bind(this),g.addEventListener("load",f),g.addEventListener("error",f),b?b.parentNode.insertBefore(g,b.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(g,i.firstChild)),o.state.loading|=4}}var Oo={$$typeof:C,Provider:null,Consumer:null,_currentValue:oe,_currentValue2:oe,_threadCount:0};function gE(i,o,c,f,g,b,S,E){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ud(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ud(0),this.hiddenUpdates=Ud(null),this.identifierPrefix=f,this.onUncaughtError=g,this.onCaughtError=b,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=E,this.incompleteTransitions=new Map}function ov(i,o,c,f,g,b,S,E,j,L,q,K){return i=new gE(i,o,c,S,E,j,L,K),o=1,b===!0&&(o|=24),b=ln(3,null,null,o),i.current=b,b.stateNode=i,o=_f(),o.refCount++,i.pooledCache=o,o.refCount++,b.memoizedState={element:f,isDehydrated:c,cache:o},Tf(b),i}function lv(i){return i?(i=Ai,i):Ai}function cv(i,o,c,f,g,b){g=lv(g),f.context===null?f.context=g:f.pendingContext=g,f=Br(o),f.payload={element:c},b=b===void 0?null:b,b!==null&&(f.callback=b),c=zr(i,f,o),c!==null&&(hn(c,i,o),oo(c,i,o))}function uv(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<o?c:o}}function Vh(i,o){uv(i,o),(i=i.alternate)&&uv(i,o)}function dv(i){if(i.tag===13){var o=Mi(i,67108864);o!==null&&hn(o,i,67108864),Vh(i,67108864)}}var Hc=!0;function yE(i,o,c,f){var g=$.T;$.T=null;var b=P.p;try{P.p=2,Fh(i,o,c,f)}finally{P.p=b,$.T=g}}function bE(i,o,c,f){var g=$.T;$.T=null;var b=P.p;try{P.p=8,Fh(i,o,c,f)}finally{P.p=b,$.T=g}}function Fh(i,o,c,f){if(Hc){var g=Kh(f);if(g===null)Oh(i,o,f,qc,c),hv(i,f);else if(xE(g,i,o,c,f))f.stopPropagation();else if(hv(i,f),o&4&&-1<vE.indexOf(i)){for(;g!==null;){var b=bi(g);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var S=Ts(b.pendingLanes);if(S!==0){var E=b;for(E.pendingLanes|=2,E.entangledLanes|=2;S;){var j=1<<31-ot(S);E.entanglements[1]|=j,S&=~j}Yn(b),(ze&6)===0&&(Nc=yn()+500,Eo(0))}}break;case 13:E=Mi(b,2),E!==null&&hn(E,b,2),Tc(),Vh(b,2)}if(b=Kh(f),b===null&&Oh(i,o,f,qc,c),b===g)break;g=b}g!==null&&f.stopPropagation()}else Oh(i,o,f,null,c)}}function Kh(i){return i=Jd(i),Gh(i)}var qc=null;function Gh(i){if(qc=null,i=yi(i),i!==null){var o=a(i);if(o===null)i=null;else{var c=o.tag;if(c===13){if(i=l(o),i!==null)return i;i=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return qc=i,null}function fv(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Bd()){case Ll:return 2;case V:return 8;case se:case te:return 32;case we:return 268435456;default:return 32}default:return 32}}var Wh=!1,Jr=null,Qr=null,Xr=null,Ro=new Map,Do=new Map,Zr=[],vE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function hv(i,o){switch(i){case"focusin":case"focusout":Jr=null;break;case"dragenter":case"dragleave":Qr=null;break;case"mouseover":case"mouseout":Xr=null;break;case"pointerover":case"pointerout":Ro.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Do.delete(o.pointerId)}}function Lo(i,o,c,f,g,b){return i===null||i.nativeEvent!==b?(i={blockedOn:o,domEventName:c,eventSystemFlags:f,nativeEvent:b,targetContainers:[g]},o!==null&&(o=bi(o),o!==null&&dv(o)),i):(i.eventSystemFlags|=f,o=i.targetContainers,g!==null&&o.indexOf(g)===-1&&o.push(g),i)}function xE(i,o,c,f,g){switch(o){case"focusin":return Jr=Lo(Jr,i,o,c,f,g),!0;case"dragenter":return Qr=Lo(Qr,i,o,c,f,g),!0;case"mouseover":return Xr=Lo(Xr,i,o,c,f,g),!0;case"pointerover":var b=g.pointerId;return Ro.set(b,Lo(Ro.get(b)||null,i,o,c,f,g)),!0;case"gotpointercapture":return b=g.pointerId,Do.set(b,Lo(Do.get(b)||null,i,o,c,f,g)),!0}return!1}function pv(i){var o=yi(i.target);if(o!==null){var c=a(o);if(c!==null){if(o=c.tag,o===13){if(o=l(c),o!==null){i.blockedOn=o,hk(i.priority,function(){if(c.tag===13){var f=fn();f=Pd(f);var g=Mi(c,f);g!==null&&hn(g,c,f),Vh(c,f)}});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Vc(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var c=Kh(i.nativeEvent);if(c===null){c=i.nativeEvent;var f=new c.constructor(c.type,c);Yd=f,c.target.dispatchEvent(f),Yd=null}else return o=bi(c),o!==null&&dv(o),i.blockedOn=c,!1;o.shift()}return!0}function mv(i,o,c){Vc(i)&&c.delete(o)}function wE(){Wh=!1,Jr!==null&&Vc(Jr)&&(Jr=null),Qr!==null&&Vc(Qr)&&(Qr=null),Xr!==null&&Vc(Xr)&&(Xr=null),Ro.forEach(mv),Do.forEach(mv)}function Fc(i,o){i.blockedOn===o&&(i.blockedOn=null,Wh||(Wh=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,wE)))}var Kc=null;function gv(i){Kc!==i&&(Kc=i,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Kc===i&&(Kc=null);for(var o=0;o<i.length;o+=3){var c=i[o],f=i[o+1],g=i[o+2];if(typeof f!="function"){if(Gh(f||c)===null)continue;break}var b=bi(c);b!==null&&(i.splice(o,3),o-=3,Gf(b,{pending:!0,data:g,method:c.method,action:f},f,g))}}))}function Bo(i){function o(j){return Fc(j,i)}Jr!==null&&Fc(Jr,i),Qr!==null&&Fc(Qr,i),Xr!==null&&Fc(Xr,i),Ro.forEach(o),Do.forEach(o);for(var c=0;c<Zr.length;c++){var f=Zr[c];f.blockedOn===i&&(f.blockedOn=null)}for(;0<Zr.length&&(c=Zr[0],c.blockedOn===null);)pv(c),c.blockedOn===null&&Zr.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var g=c[f],b=c[f+1],S=g[Qt]||null;if(typeof b=="function")S||gv(c);else if(S){var E=null;if(b&&b.hasAttribute("formAction")){if(g=b,S=b[Qt]||null)E=S.formAction;else if(Gh(g)!==null)continue}else E=S.action;typeof E=="function"?c[f+1]=E:(c.splice(f,3),f-=3),gv(c)}}}function Yh(i){this._internalRoot=i}Gc.prototype.render=Yh.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(r(409));var c=o.current,f=fn();cv(c,f,i,o,null,null)},Gc.prototype.unmount=Yh.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;cv(i.current,2,null,i,null,null),Tc(),o[gi]=null}};function Gc(i){this._internalRoot=i}Gc.prototype.unstable_scheduleHydration=function(i){if(i){var o=Rg();i={blockedOn:null,target:i,priority:o};for(var c=0;c<Zr.length&&o!==0&&o<Zr[c].priority;c++);Zr.splice(c,0,i),c===0&&pv(i)}};var yv=e.version;if(yv!=="19.1.1")throw Error(r(527,yv,"19.1.1"));P.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=d(o),i=i!==null?h(i):null,i=i===null?null:i.stateNode,i};var SE={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wc.isDisabled&&Wc.supportsFiber)try{Le=Wc.inject(SE),Qe=Wc}catch{}}return Uo.createRoot=function(i,o){if(!s(i))throw Error(r(299));var c=!1,f="",g=Ry,b=Dy,S=Ly,E=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(b=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(E=o.unstable_transitionCallbacks)),o=ov(i,1,!1,null,null,c,f,g,b,S,E,null),i[gi]=o.current,Ah(i),new Yh(o)},Uo.hydrateRoot=function(i,o,c){if(!s(i))throw Error(r(299));var f=!1,g="",b=Ry,S=Dy,E=Ly,j=null,L=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(b=c.onUncaughtError),c.onCaughtError!==void 0&&(S=c.onCaughtError),c.onRecoverableError!==void 0&&(E=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(j=c.unstable_transitionCallbacks),c.formState!==void 0&&(L=c.formState)),o=ov(i,1,!0,o,c??null,f,g,b,S,E,j,L),o.context=lv(null),c=o.current,f=fn(),f=Pd(f),g=Br(f),g.callback=null,zr(c,g,f),c=f,o.current.lanes=c,Ia(o,c),Yn(o),i[gi]=o.current,Ah(i),new Gc(o)},Uo.version="19.1.1",Uo}var Cv;function OE(){if(Cv)return Xh.exports;Cv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Xh.exports=AE(),Xh.exports}var RE=OE();/**
 * react-router v7.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Tv="popstate";function DE(n={}){function e(r,s){let{pathname:a,search:l,hash:u}=r.location;return qp("",{pathname:a,search:l,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:ul(s)}return BE(e,t,null,n)}function et(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function qn(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function LE(){return Math.random().toString(36).substring(2,10)}function jv(n,e){return{usr:n.state,key:n.key,idx:e}}function qp(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Aa(e):e,state:t,key:e&&e.key||r||LE()}}function ul({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Aa(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function BE(n,e,t,r={}){let{window:s=document.defaultView,v5Compat:a=!1}=r,l=s.history,u="POP",d=null,h=m();h==null&&(h=0,l.replaceState({...l.state,idx:h},""));function m(){return(l.state||{idx:null}).idx}function y(){u="POP";let _=m(),N=_==null?null:_-h;h=_,d&&d({action:u,location:k.location,delta:N})}function v(_,N){u="PUSH";let M=qp(k.location,_,N);h=m()+1;let C=jv(M,h),I=k.createHref(M);try{l.pushState(C,"",I)}catch(H){if(H instanceof DOMException&&H.name==="DataCloneError")throw H;s.location.assign(I)}a&&d&&d({action:u,location:k.location,delta:1})}function x(_,N){u="REPLACE";let M=qp(k.location,_,N);h=m();let C=jv(M,h),I=k.createHref(M);l.replaceState(C,"",I),a&&d&&d({action:u,location:k.location,delta:0})}function w(_){return zE(_)}let k={get action(){return u},get location(){return n(s,l)},listen(_){if(d)throw new Error("A history only accepts one active listener");return s.addEventListener(Tv,y),d=_,()=>{s.removeEventListener(Tv,y),d=null}},createHref(_){return e(s,_)},createURL:w,encodeLocation(_){let N=w(_);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:v,replace:x,go(_){return l.go(_)}};return k}function zE(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),et(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:ul(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function z1(n,e,t="/"){return UE(n,e,t,!1)}function UE(n,e,t,r){let s=typeof e=="string"?Aa(e):e,a=Mr(s.pathname||"/",t);if(a==null)return null;let l=U1(n);PE(l);let u=null;for(let d=0;u==null&&d<l.length;++d){let h=JE(a);u=WE(l[d],h,r)}return u}function U1(n,e=[],t=[],r=""){let s=(a,l,u)=>{let d={relativePath:u===void 0?a.path||"":u,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};d.relativePath.startsWith("/")&&(et(d.relativePath.startsWith(r),`Absolute route path "${d.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(r.length));let h=Cr([r,d.relativePath]),m=t.concat(d);a.children&&a.children.length>0&&(et(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),U1(a.children,e,m,h)),!(a.path==null&&!a.index)&&e.push({path:h,score:KE(h,a.index),routesMeta:m})};return n.forEach((a,l)=>{if(a.path===""||!a.path?.includes("?"))s(a,l);else for(let u of P1(a.path))s(a,l,u)}),e}function P1(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let l=P1(r.join("/")),u=[];return u.push(...l.map(d=>d===""?a:[a,d].join("/"))),s&&u.push(...l),u.map(d=>n.startsWith("/")&&d===""?"/":d)}function PE(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:GE(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var $E=/^:[\w-]+$/,IE=3,HE=2,qE=1,VE=10,FE=-2,Mv=n=>n==="*";function KE(n,e){let t=n.split("/"),r=t.length;return t.some(Mv)&&(r+=FE),e&&(r+=HE),t.filter(s=>!Mv(s)).reduce((s,a)=>s+($E.test(a)?IE:a===""?qE:VE),r)}function GE(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function WE(n,e,t=!1){let{routesMeta:r}=n,s={},a="/",l=[];for(let u=0;u<r.length;++u){let d=r[u],h=u===r.length-1,m=a==="/"?e:e.slice(a.length)||"/",y=wu({path:d.relativePath,caseSensitive:d.caseSensitive,end:h},m),v=d.route;if(!y&&h&&t&&!r[r.length-1].route.index&&(y=wu({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},m)),!y)return null;Object.assign(s,y.params),l.push({params:s,pathname:Cr([a,y.pathname]),pathnameBase:eN(Cr([a,y.pathnameBase])),route:v}),y.pathnameBase!=="/"&&(a=Cr([a,y.pathnameBase]))}return l}function wu(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=YE(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let a=s[0],l=a.replace(/(.)\/+$/,"$1"),u=s.slice(1);return{params:r.reduce((h,{paramName:m,isOptional:y},v)=>{if(m==="*"){let w=u[v]||"";l=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const x=u[v];return y&&!x?h[m]=void 0:h[m]=(x||"").replace(/%2F/g,"/"),h},{}),pathname:a,pathnameBase:l,pattern:n}}function YE(n,e=!1,t=!0){qn(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,d)=>(r.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function JE(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return qn(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Mr(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function QE(n,e="/"){let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?Aa(n):n;return{pathname:t?t.startsWith("/")?t:XE(t,e):e,search:tN(r),hash:nN(s)}}function XE(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function np(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ZE(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function $1(n){let e=ZE(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function I1(n,e,t,r=!1){let s;typeof n=="string"?s=Aa(n):(s={...n},et(!s.pathname||!s.pathname.includes("?"),np("?","pathname","search",s)),et(!s.pathname||!s.pathname.includes("#"),np("#","pathname","hash",s)),et(!s.search||!s.search.includes("#"),np("#","search","hash",s)));let a=n===""||s.pathname==="",l=a?"/":s.pathname,u;if(l==null)u=t;else{let y=e.length-1;if(!r&&l.startsWith("..")){let v=l.split("/");for(;v[0]==="..";)v.shift(),y-=1;s.pathname=v.join("/")}u=y>=0?e[y]:"/"}let d=QE(s,u),h=l&&l!=="/"&&l.endsWith("/"),m=(a||l===".")&&t.endsWith("/");return!d.pathname.endsWith("/")&&(h||m)&&(d.pathname+="/"),d}var Cr=n=>n.join("/").replace(/\/\/+/g,"/"),eN=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),tN=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,nN=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function rN(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var H1=["POST","PUT","PATCH","DELETE"];new Set(H1);var sN=["GET",...H1];new Set(sN);var Oa=T.createContext(null);Oa.displayName="DataRouter";var md=T.createContext(null);md.displayName="DataRouterState";T.createContext(!1);var q1=T.createContext({isTransitioning:!1});q1.displayName="ViewTransition";var iN=T.createContext(new Map);iN.displayName="Fetchers";var aN=T.createContext(null);aN.displayName="Await";var tr=T.createContext(null);tr.displayName="Navigation";var El=T.createContext(null);El.displayName="Location";var nr=T.createContext({outlet:null,matches:[],isDataRoute:!1});nr.displayName="Route";var Dm=T.createContext(null);Dm.displayName="RouteError";function oN(n,{relative:e}={}){et(Nl(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=T.useContext(tr),{hash:s,pathname:a,search:l}=Cl(n,{relative:e}),u=a;return t!=="/"&&(u=a==="/"?t:Cr([t,a])),r.createHref({pathname:u,search:l,hash:s})}function Nl(){return T.useContext(El)!=null}function ks(){return et(Nl(),"useLocation() may be used only in the context of a <Router> component."),T.useContext(El).location}var V1="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function F1(n){T.useContext(tr).static||T.useLayoutEffect(n)}function Ra(){let{isDataRoute:n}=T.useContext(nr);return n?wN():lN()}function lN(){et(Nl(),"useNavigate() may be used only in the context of a <Router> component.");let n=T.useContext(Oa),{basename:e,navigator:t}=T.useContext(tr),{matches:r}=T.useContext(nr),{pathname:s}=ks(),a=JSON.stringify($1(r)),l=T.useRef(!1);return F1(()=>{l.current=!0}),T.useCallback((d,h={})=>{if(qn(l.current,V1),!l.current)return;if(typeof d=="number"){t.go(d);return}let m=I1(d,JSON.parse(a),s,h.relative==="path");n==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:Cr([e,m.pathname])),(h.replace?t.replace:t.push)(m,h.state,h)},[e,t,a,s,n])}T.createContext(null);function cN(){let{matches:n}=T.useContext(nr),e=n[n.length-1];return e?e.params:{}}function Cl(n,{relative:e}={}){let{matches:t}=T.useContext(nr),{pathname:r}=ks(),s=JSON.stringify($1(t));return T.useMemo(()=>I1(n,JSON.parse(s),r,e==="path"),[n,s,r,e])}function uN(n,e){return K1(n,e)}function K1(n,e,t,r){et(Nl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=T.useContext(tr),{matches:a}=T.useContext(nr),l=a[a.length-1],u=l?l.params:{},d=l?l.pathname:"/",h=l?l.pathnameBase:"/",m=l&&l.route;{let N=m&&m.path||"";G1(d,!m||N.endsWith("*")||N.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${N}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${N}"> to <Route path="${N==="/"?"*":`${N}/*`}">.`)}let y=ks(),v;if(e){let N=typeof e=="string"?Aa(e):e;et(h==="/"||N.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${N.pathname}" was given in the \`location\` prop.`),v=N}else v=y;let x=v.pathname||"/",w=x;if(h!=="/"){let N=h.replace(/^\//,"").split("/");w="/"+x.replace(/^\//,"").split("/").slice(N.length).join("/")}let k=z1(n,{pathname:w});qn(m||k!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),qn(k==null||k[k.length-1].route.element!==void 0||k[k.length-1].route.Component!==void 0||k[k.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let _=mN(k&&k.map(N=>Object.assign({},N,{params:Object.assign({},u,N.params),pathname:Cr([h,s.encodeLocation?s.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?h:Cr([h,s.encodeLocation?s.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),a,t,r);return e&&_?T.createElement(El.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},_):_}function dN(){let n=xN(),e=rN(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",n),l=T.createElement(T.Fragment,null,T.createElement("p",null,"💿 Hey developer 👋"),T.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",T.createElement("code",{style:a},"ErrorBoundary")," or"," ",T.createElement("code",{style:a},"errorElement")," prop on your route.")),T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},e),t?T.createElement("pre",{style:s},t):null,l)}var fN=T.createElement(dN,null),hN=class extends T.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?T.createElement(nr.Provider,{value:this.props.routeContext},T.createElement(Dm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function pN({routeContext:n,match:e,children:t}){let r=T.useContext(Oa);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),T.createElement(nr.Provider,{value:n},t)}function mN(n,e=[],t=null,r=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let s=n,a=t?.errors;if(a!=null){let d=s.findIndex(h=>h.route.id&&a?.[h.route.id]!==void 0);et(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),s=s.slice(0,Math.min(s.length,d+1))}let l=!1,u=-1;if(t)for(let d=0;d<s.length;d++){let h=s[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:m,errors:y}=t,v=h.route.loader&&!m.hasOwnProperty(h.route.id)&&(!y||y[h.route.id]===void 0);if(h.route.lazy||v){l=!0,u>=0?s=s.slice(0,u+1):s=[s[0]];break}}}return s.reduceRight((d,h,m)=>{let y,v=!1,x=null,w=null;t&&(y=a&&h.route.id?a[h.route.id]:void 0,x=h.route.errorElement||fN,l&&(u<0&&m===0?(G1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,w=null):u===m&&(v=!0,w=h.route.hydrateFallbackElement||null)));let k=e.concat(s.slice(0,m+1)),_=()=>{let N;return y?N=x:v?N=w:h.route.Component?N=T.createElement(h.route.Component,null):h.route.element?N=h.route.element:N=d,T.createElement(pN,{match:h,routeContext:{outlet:d,matches:k,isDataRoute:t!=null},children:N})};return t&&(h.route.ErrorBoundary||h.route.errorElement||m===0)?T.createElement(hN,{location:t.location,revalidation:t.revalidation,component:x,error:y,children:_(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):_()},null)}function Lm(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function gN(n){let e=T.useContext(Oa);return et(e,Lm(n)),e}function yN(n){let e=T.useContext(md);return et(e,Lm(n)),e}function bN(n){let e=T.useContext(nr);return et(e,Lm(n)),e}function Bm(n){let e=bN(n),t=e.matches[e.matches.length-1];return et(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function vN(){return Bm("useRouteId")}function xN(){let n=T.useContext(Dm),e=yN("useRouteError"),t=Bm("useRouteError");return n!==void 0?n:e.errors?.[t]}function wN(){let{router:n}=gN("useNavigate"),e=Bm("useNavigate"),t=T.useRef(!1);return F1(()=>{t.current=!0}),T.useCallback(async(s,a={})=>{qn(t.current,V1),t.current&&(typeof s=="number"?n.navigate(s):await n.navigate(s,{fromRouteId:e,...a}))},[n,e])}var Av={};function G1(n,e,t){!e&&!Av[n]&&(Av[n]=!0,qn(!1,t))}T.memo(SN);function SN({routes:n,future:e,state:t}){return K1(n,void 0,t,e)}function rs(n){et(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function kN({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:s,static:a=!1}){et(!Nl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=n.replace(/^\/*/,"/"),u=T.useMemo(()=>({basename:l,navigator:s,static:a,future:{}}),[l,s,a]);typeof t=="string"&&(t=Aa(t));let{pathname:d="/",search:h="",hash:m="",state:y=null,key:v="default"}=t,x=T.useMemo(()=>{let w=Mr(d,l);return w==null?null:{location:{pathname:w,search:h,hash:m,state:y,key:v},navigationType:r}},[l,d,h,m,y,v,r]);return qn(x!=null,`<Router basename="${l}"> is not able to match the URL "${d}${h}${m}" because it does not start with the basename, so the <Router> won't render anything.`),x==null?null:T.createElement(tr.Provider,{value:u},T.createElement(El.Provider,{children:e,value:x}))}function _N({children:n,location:e}){return uN(Vp(n),e)}function Vp(n,e=[]){let t=[];return T.Children.forEach(n,(r,s)=>{if(!T.isValidElement(r))return;let a=[...e,s];if(r.type===T.Fragment){t.push.apply(t,Vp(r.props.children,a));return}et(r.type===rs,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),et(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=Vp(r.props.children,a)),t.push(l)}),t}var pu="get",mu="application/x-www-form-urlencoded";function gd(n){return n!=null&&typeof n.tagName=="string"}function EN(n){return gd(n)&&n.tagName.toLowerCase()==="button"}function NN(n){return gd(n)&&n.tagName.toLowerCase()==="form"}function CN(n){return gd(n)&&n.tagName.toLowerCase()==="input"}function TN(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function jN(n,e){return n.button===0&&(!e||e==="_self")&&!TN(n)}function Fp(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(s=>[t,s]):[[t,r]])},[]))}function MN(n,e){let t=Fp(n);return e&&e.forEach((r,s)=>{t.has(s)||e.getAll(s).forEach(a=>{t.append(s,a)})}),t}var Yc=null;function AN(){if(Yc===null)try{new FormData(document.createElement("form"),0),Yc=!1}catch{Yc=!0}return Yc}var ON=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function rp(n){return n!=null&&!ON.has(n)?(qn(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${mu}"`),null):n}function RN(n,e){let t,r,s,a,l;if(NN(n)){let u=n.getAttribute("action");r=u?Mr(u,e):null,t=n.getAttribute("method")||pu,s=rp(n.getAttribute("enctype"))||mu,a=new FormData(n)}else if(EN(n)||CN(n)&&(n.type==="submit"||n.type==="image")){let u=n.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=n.getAttribute("formaction")||u.getAttribute("action");if(r=d?Mr(d,e):null,t=n.getAttribute("formmethod")||u.getAttribute("method")||pu,s=rp(n.getAttribute("formenctype"))||rp(u.getAttribute("enctype"))||mu,a=new FormData(u,n),!AN()){let{name:h,type:m,value:y}=n;if(m==="image"){let v=h?`${h}.`:"";a.append(`${v}x`,"0"),a.append(`${v}y`,"0")}else h&&a.append(h,y)}}else{if(gd(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=pu,r=null,s=mu,l=n}return a&&s==="text/plain"&&(l=a,a=void 0),{action:r,method:t.toLowerCase(),encType:s,formData:a,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function zm(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function DN(n,e,t){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return r.pathname==="/"?r.pathname=`_root.${t}`:e&&Mr(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${t}`,r}async function LN(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function BN(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function zN(n,e,t){let r=await Promise.all(n.map(async s=>{let a=e.routes[s.route.id];if(a){let l=await LN(a,t);return l.links?l.links():[]}return[]}));return IN(r.flat(1).filter(BN).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function Ov(n,e,t,r,s,a){let l=(d,h)=>t[h]?d.route.id!==t[h].route.id:!0,u=(d,h)=>t[h].pathname!==d.pathname||t[h].route.path?.endsWith("*")&&t[h].params["*"]!==d.params["*"];return a==="assets"?e.filter((d,h)=>l(d,h)||u(d,h)):a==="data"?e.filter((d,h)=>{let m=r.routes[d.route.id];if(!m||!m.hasLoader)return!1;if(l(d,h)||u(d,h))return!0;if(d.route.shouldRevalidate){let y=d.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function UN(n,e,{includeHydrateFallback:t}={}){return PN(n.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function PN(n){return[...new Set(n)]}function $N(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function IN(n,e){let t=new Set;return new Set(e),n.reduce((r,s)=>{let a=JSON.stringify($N(s));return t.has(a)||(t.add(a),r.push({key:a,link:s})),r},[])}function W1(){let n=T.useContext(Oa);return zm(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function HN(){let n=T.useContext(md);return zm(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Um=T.createContext(void 0);Um.displayName="FrameworkContext";function Y1(){let n=T.useContext(Um);return zm(n,"You must render this element inside a <HydratedRouter> element"),n}function qN(n,e){let t=T.useContext(Um),[r,s]=T.useState(!1),[a,l]=T.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:h,onMouseLeave:m,onTouchStart:y}=e,v=T.useRef(null);T.useEffect(()=>{if(n==="render"&&l(!0),n==="viewport"){let k=N=>{N.forEach(M=>{l(M.isIntersecting)})},_=new IntersectionObserver(k,{threshold:.5});return v.current&&_.observe(v.current),()=>{_.disconnect()}}},[n]),T.useEffect(()=>{if(r){let k=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(k)}}},[r]);let x=()=>{s(!0)},w=()=>{s(!1),l(!1)};return t?n!=="intent"?[a,v,{}]:[a,v,{onFocus:Po(u,x),onBlur:Po(d,w),onMouseEnter:Po(h,x),onMouseLeave:Po(m,w),onTouchStart:Po(y,x)}]:[!1,v,{}]}function Po(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function VN({page:n,...e}){let{router:t}=W1(),r=T.useMemo(()=>z1(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?T.createElement(KN,{page:n,matches:r,...e}):null}function FN(n){let{manifest:e,routeModules:t}=Y1(),[r,s]=T.useState([]);return T.useEffect(()=>{let a=!1;return zN(n,e,t).then(l=>{a||s(l)}),()=>{a=!0}},[n,e,t]),r}function KN({page:n,matches:e,...t}){let r=ks(),{manifest:s,routeModules:a}=Y1(),{basename:l}=W1(),{loaderData:u,matches:d}=HN(),h=T.useMemo(()=>Ov(n,e,d,s,r,"data"),[n,e,d,s,r]),m=T.useMemo(()=>Ov(n,e,d,s,r,"assets"),[n,e,d,s,r]),y=T.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let w=new Set,k=!1;if(e.forEach(N=>{let M=s.routes[N.route.id];!M||!M.hasLoader||(!h.some(C=>C.route.id===N.route.id)&&N.route.id in u&&a[N.route.id]?.shouldRevalidate||M.hasClientLoader?k=!0:w.add(N.route.id))}),w.size===0)return[];let _=DN(n,l,"data");return k&&w.size>0&&_.searchParams.set("_routes",e.filter(N=>w.has(N.route.id)).map(N=>N.route.id).join(",")),[_.pathname+_.search]},[l,u,r,s,h,e,n,a]),v=T.useMemo(()=>UN(m,s),[m,s]),x=FN(m);return T.createElement(T.Fragment,null,y.map(w=>T.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...t})),v.map(w=>T.createElement("link",{key:w,rel:"modulepreload",href:w,...t})),x.map(({key:w,link:k})=>T.createElement("link",{key:w,nonce:t.nonce,...k})))}function GN(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var J1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{J1&&(window.__reactRouterVersion="7.8.0")}catch{}function WN({basename:n,children:e,window:t}){let r=T.useRef();r.current==null&&(r.current=DE({window:t,v5Compat:!0}));let s=r.current,[a,l]=T.useState({action:s.action,location:s.location}),u=T.useCallback(d=>{T.startTransition(()=>l(d))},[l]);return T.useLayoutEffect(()=>s.listen(u),[s,u]),T.createElement(kN,{basename:n,children:e,location:a.location,navigationType:a.action,navigator:s})}var Q1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,vt=T.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:s,reloadDocument:a,replace:l,state:u,target:d,to:h,preventScrollReset:m,viewTransition:y,...v},x){let{basename:w}=T.useContext(tr),k=typeof h=="string"&&Q1.test(h),_,N=!1;if(typeof h=="string"&&k&&(_=h,J1))try{let Y=new URL(window.location.href),ye=h.startsWith("//")?new URL(Y.protocol+h):new URL(h),$e=Mr(ye.pathname,w);ye.origin===Y.origin&&$e!=null?h=$e+ye.search+ye.hash:N=!0}catch{qn(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let M=oN(h,{relative:s}),[C,I,H]=qN(r,v),Q=XN(h,{replace:l,state:u,target:d,preventScrollReset:m,relative:s,viewTransition:y});function G(Y){e&&e(Y),Y.defaultPrevented||Q(Y)}let X=T.createElement("a",{...v,...H,href:_||M,onClick:N||a?e:G,ref:GN(x,I),target:d,"data-discover":!k&&t==="render"?"true":void 0});return C&&!k?T.createElement(T.Fragment,null,X,T.createElement(VN,{page:M})):X});vt.displayName="Link";var YN=T.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:s=!1,style:a,to:l,viewTransition:u,children:d,...h},m){let y=Cl(l,{relative:h.relative}),v=ks(),x=T.useContext(md),{navigator:w,basename:k}=T.useContext(tr),_=x!=null&&sC(y)&&u===!0,N=w.encodeLocation?w.encodeLocation(y).pathname:y.pathname,M=v.pathname,C=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;t||(M=M.toLowerCase(),C=C?C.toLowerCase():null,N=N.toLowerCase()),C&&k&&(C=Mr(C,k)||C);const I=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let H=M===N||!s&&M.startsWith(N)&&M.charAt(I)==="/",Q=C!=null&&(C===N||!s&&C.startsWith(N)&&C.charAt(N.length)==="/"),G={isActive:H,isPending:Q,isTransitioning:_},X=H?e:void 0,Y;typeof r=="function"?Y=r(G):Y=[r,H?"active":null,Q?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let ye=typeof a=="function"?a(G):a;return T.createElement(vt,{...h,"aria-current":X,className:Y,ref:m,style:ye,to:l,viewTransition:u},typeof d=="function"?d(G):d)});YN.displayName="NavLink";var JN=T.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:s,state:a,method:l=pu,action:u,onSubmit:d,relative:h,preventScrollReset:m,viewTransition:y,...v},x)=>{let w=nC(),k=rC(u,{relative:h}),_=l.toLowerCase()==="get"?"get":"post",N=typeof u=="string"&&Q1.test(u),M=C=>{if(d&&d(C),C.defaultPrevented)return;C.preventDefault();let I=C.nativeEvent.submitter,H=I?.getAttribute("formmethod")||l;w(I||C.currentTarget,{fetcherKey:e,method:H,navigate:t,replace:s,state:a,relative:h,preventScrollReset:m,viewTransition:y})};return T.createElement("form",{ref:x,method:_,action:k,onSubmit:r?d:M,...v,"data-discover":!N&&n==="render"?"true":void 0})});JN.displayName="Form";function QN(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function X1(n){let e=T.useContext(Oa);return et(e,QN(n)),e}function XN(n,{target:e,replace:t,state:r,preventScrollReset:s,relative:a,viewTransition:l}={}){let u=Ra(),d=ks(),h=Cl(n,{relative:a});return T.useCallback(m=>{if(jN(m,e)){m.preventDefault();let y=t!==void 0?t:ul(d)===ul(h);u(n,{replace:y,state:r,preventScrollReset:s,relative:a,viewTransition:l})}},[d,u,h,t,r,e,n,s,a,l])}function ZN(n){qn(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=T.useRef(Fp(n)),t=T.useRef(!1),r=ks(),s=T.useMemo(()=>MN(r.search,t.current?null:e.current),[r.search]),a=Ra(),l=T.useCallback((u,d)=>{const h=Fp(typeof u=="function"?u(new URLSearchParams(s)):u);t.current=!0,a("?"+h,d)},[a,s]);return[s,l]}var eC=0,tC=()=>`__${String(++eC)}__`;function nC(){let{router:n}=X1("useSubmit"),{basename:e}=T.useContext(tr),t=vN();return T.useCallback(async(r,s={})=>{let{action:a,method:l,encType:u,formData:d,body:h}=RN(r,e);if(s.navigate===!1){let m=s.fetcherKey||tC();await n.fetch(m,t,s.action||a,{preventScrollReset:s.preventScrollReset,formData:d,body:h,formMethod:s.method||l,formEncType:s.encType||u,flushSync:s.flushSync})}else await n.navigate(s.action||a,{preventScrollReset:s.preventScrollReset,formData:d,body:h,formMethod:s.method||l,formEncType:s.encType||u,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[n,e,t])}function rC(n,{relative:e}={}){let{basename:t}=T.useContext(tr),r=T.useContext(nr);et(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),a={...Cl(n||".",{relative:e})},l=ks();if(n==null){a.search=l.search;let u=new URLSearchParams(a.search),d=u.getAll("index");if(d.some(m=>m==="")){u.delete("index"),d.filter(y=>y).forEach(y=>u.append("index",y));let m=u.toString();a.search=m?`?${m}`:""}}return(!n||n===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:Cr([t,a.pathname])),ul(a)}function sC(n,{relative:e}={}){let t=T.useContext(q1);et(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=X1("useViewTransitionState"),s=Cl(n,{relative:e});if(!t.isTransitioning)return!1;let a=Mr(t.currentLocation.pathname,r)||t.currentLocation.pathname,l=Mr(t.nextLocation.pathname,r)||t.nextLocation.pathname;return wu(s.pathname,l)!=null||wu(s.pathname,a)!=null}var Z1=B1();const iC=pd(Z1),Rv=n=>{let e;const t=new Set,r=(h,m)=>{const y=typeof h=="function"?h(e):h;if(!Object.is(y,e)){const v=e;e=m??(typeof y!="object"||y===null)?y:Object.assign({},e,y),t.forEach(x=>x(e,v))}},s=()=>e,u={setState:r,getState:s,getInitialState:()=>d,subscribe:h=>(t.add(h),()=>t.delete(h))},d=e=n(r,s,u);return u},aC=n=>n?Rv(n):Rv,oC=n=>n;function lC(n,e=oC){const t=An.useSyncExternalStore(n.subscribe,An.useCallback(()=>e(n.getState()),[n,e]),An.useCallback(()=>e(n.getInitialState()),[n,e]));return An.useDebugValue(t),t}const Dv=n=>{const e=aC(n),t=r=>lC(e,r);return Object.assign(t,e),t},Tl=n=>n?Dv(n):Dv,cC="modulepreload",uC=function(n,e){return new URL(n,e).href},Lv={},Da=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let h=function(m){return Promise.all(m.map(y=>Promise.resolve(y).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};const l=document.getElementsByTagName("link"),u=document.querySelector("meta[property=csp-nonce]"),d=u?.nonce||u?.getAttribute("nonce");s=h(t.map(m=>{if(m=uC(m,r),m in Lv)return;Lv[m]=!0;const y=m.endsWith(".css"),v=y?'[rel="stylesheet"]':"";if(!!r)for(let k=l.length-1;k>=0;k--){const _=l[k];if(_.href===m&&(!y||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${v}`))return;const w=document.createElement("link");if(w.rel=y?"stylesheet":cC,y||(w.as="script"),w.crossOrigin="",w.href=m,d&&w.setAttribute("nonce",d),document.head.appendChild(w),y)return new Promise((k,_)=>{w.addEventListener("load",k),w.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${m}`)))})}))}function a(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return s.then(l=>{for(const u of l||[])u.status==="rejected"&&a(u.reason);return e().catch(a)})},dC=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Da(async()=>{const{default:r}=await Promise.resolve().then(()=>La);return{default:r}},[],import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Pm extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class fC extends Pm{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Bv extends Pm{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class zv extends Pm{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Kp;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Kp||(Kp={}));var hC=function(n,e,t,r){function s(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function u(m){try{h(r.next(m))}catch(y){l(y)}}function d(m){try{h(r.throw(m))}catch(y){l(y)}}function h(m){m.done?a(m.value):s(m.value).then(u,d)}h((r=r.apply(n,e||[])).next())})};class pC{constructor(e,{headers:t={},customFetch:r,region:s=Kp.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=dC(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return hC(this,void 0,void 0,function*(){try{const{headers:s,method:a,body:l}=t;let u={},{region:d}=t;d||(d=this.region);const h=new URL(`${this.url}/${e}`);d&&d!=="any"&&(u["x-region"]=d,h.searchParams.set("forceFunctionRegion",d));let m;l&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",m=l):typeof l=="string"?(u["Content-Type"]="text/plain",m=l):typeof FormData<"u"&&l instanceof FormData?m=l:(u["Content-Type"]="application/json",m=JSON.stringify(l)));const y=yield this.fetch(h.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),s),body:m}).catch(k=>{throw new fC(k)}),v=y.headers.get("x-relay-error");if(v&&v==="true")throw new Bv(y);if(!y.ok)throw new zv(y);let x=((r=y.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),w;return x==="application/json"?w=yield y.json():x==="application/octet-stream"?w=yield y.blob():x==="text/event-stream"?w=y:x==="multipart/form-data"?w=yield y.formData():w=yield y.text(),{data:w,error:null,response:y}}catch(s){return{data:null,error:s,response:s instanceof zv||s instanceof Bv?s.context:void 0}}})}}var Et={},ta={},na={},ra={},sa={},ia={},mC=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},_a=mC();const gC=_a.fetch,ew=_a.fetch.bind(_a),tw=_a.Headers,yC=_a.Request,bC=_a.Response,La=Object.freeze(Object.defineProperty({__proto__:null,Headers:tw,Request:yC,Response:bC,default:ew,fetch:gC},Symbol.toStringTag,{value:"Module"})),vC=_E(La);var Jc={},Uv;function nw(){if(Uv)return Jc;Uv=1,Object.defineProperty(Jc,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Jc.default=n,Jc}var Pv;function rw(){if(Pv)return ia;Pv=1;var n=ia&&ia.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ia,"__esModule",{value:!0});const e=n(vC),t=n(nw());class r{constructor(a){this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=a.headers,this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=a.shouldThrowOnError,this.signal=a.signal,this.isMaybeSingle=a.isMaybeSingle,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,l){return this.headers=Object.assign({},this.headers),this.headers[a]=l,this}then(a,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const u=this.fetch;let d=u(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{var m,y,v;let x=null,w=null,k=null,_=h.status,N=h.statusText;if(h.ok){if(this.method!=="HEAD"){const H=await h.text();H===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?w=H:w=JSON.parse(H))}const C=(m=this.headers.Prefer)===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),I=(y=h.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");C&&I&&I.length>1&&(k=parseInt(I[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(x={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,k=null,_=406,N="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const C=await h.text();try{x=JSON.parse(C),Array.isArray(x)&&h.status===404&&(w=[],x=null,_=200,N="OK")}catch{h.status===404&&C===""?(_=204,N="No Content"):x={message:C}}if(x&&this.isMaybeSingle&&(!((v=x?.details)===null||v===void 0)&&v.includes("0 rows"))&&(x=null,_=200,N="OK"),x&&this.shouldThrowOnError)throw new t.default(x)}return{error:x,data:w,count:k,status:_,statusText:N}});return this.shouldThrowOnError||(d=d.catch(h=>{var m,y,v;return{error:{message:`${(m=h?.name)!==null&&m!==void 0?m:"FetchError"}: ${h?.message}`,details:`${(y=h?.stack)!==null&&y!==void 0?y:""}`,hint:"",code:`${(v=h?.code)!==null&&v!==void 0?v:""}`},data:null,count:null,status:0,statusText:""}})),d.then(a,l)}returns(){return this}overrideTypes(){return this}}return ia.default=r,ia}var $v;function sw(){if($v)return sa;$v=1;var n=sa&&sa.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(sa,"__esModule",{value:!0});const e=n(rw());class t extends e.default{select(s){let a=!1;const l=(s??"*").split("").map(u=>/\s/.test(u)&&!a?"":(u==='"'&&(a=!a),u)).join("");return this.url.searchParams.set("select",l),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(s,{ascending:a=!0,nullsFirst:l,foreignTable:u,referencedTable:d=u}={}){const h=d?`${d}.order`:"order",m=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${m?`${m},`:""}${s}.${a?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:a,referencedTable:l=a}={}){const u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(u,`${s}`),this}range(s,a,{foreignTable:l,referencedTable:u=l}={}){const d=typeof u>"u"?"offset":`${u}.offset`,h=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(d,`${s}`),this.url.searchParams.set(h,`${a-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:s=!1,verbose:a=!1,settings:l=!1,buffers:u=!1,wal:d=!1,format:h="text"}={}){var m;const y=[s?"analyze":null,a?"verbose":null,l?"settings":null,u?"buffers":null,d?"wal":null].filter(Boolean).join("|"),v=(m=this.headers.Accept)!==null&&m!==void 0?m:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${h}; for="${v}"; options=${y};`,h==="json"?this:this}rollback(){var s;return((s=this.headers.Prefer)!==null&&s!==void 0?s:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return sa.default=t,sa}var Iv;function $m(){if(Iv)return ra;Iv=1;var n=ra&&ra.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ra,"__esModule",{value:!0});const e=n(sw());class t extends e.default{eq(s,a){return this.url.searchParams.append(s,`eq.${a}`),this}neq(s,a){return this.url.searchParams.append(s,`neq.${a}`),this}gt(s,a){return this.url.searchParams.append(s,`gt.${a}`),this}gte(s,a){return this.url.searchParams.append(s,`gte.${a}`),this}lt(s,a){return this.url.searchParams.append(s,`lt.${a}`),this}lte(s,a){return this.url.searchParams.append(s,`lte.${a}`),this}like(s,a){return this.url.searchParams.append(s,`like.${a}`),this}likeAllOf(s,a){return this.url.searchParams.append(s,`like(all).{${a.join(",")}}`),this}likeAnyOf(s,a){return this.url.searchParams.append(s,`like(any).{${a.join(",")}}`),this}ilike(s,a){return this.url.searchParams.append(s,`ilike.${a}`),this}ilikeAllOf(s,a){return this.url.searchParams.append(s,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(s,a){return this.url.searchParams.append(s,`ilike(any).{${a.join(",")}}`),this}is(s,a){return this.url.searchParams.append(s,`is.${a}`),this}in(s,a){const l=Array.from(new Set(a)).map(u=>typeof u=="string"&&new RegExp("[,()]").test(u)?`"${u}"`:`${u}`).join(",");return this.url.searchParams.append(s,`in.(${l})`),this}contains(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cs.{${a.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(a)}`),this}containedBy(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cd.{${a.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(a)}`),this}rangeGt(s,a){return this.url.searchParams.append(s,`sr.${a}`),this}rangeGte(s,a){return this.url.searchParams.append(s,`nxl.${a}`),this}rangeLt(s,a){return this.url.searchParams.append(s,`sl.${a}`),this}rangeLte(s,a){return this.url.searchParams.append(s,`nxr.${a}`),this}rangeAdjacent(s,a){return this.url.searchParams.append(s,`adj.${a}`),this}overlaps(s,a){return typeof a=="string"?this.url.searchParams.append(s,`ov.${a}`):this.url.searchParams.append(s,`ov.{${a.join(",")}}`),this}textSearch(s,a,{config:l,type:u}={}){let d="";u==="plain"?d="pl":u==="phrase"?d="ph":u==="websearch"&&(d="w");const h=l===void 0?"":`(${l})`;return this.url.searchParams.append(s,`${d}fts${h}.${a}`),this}match(s){return Object.entries(s).forEach(([a,l])=>{this.url.searchParams.append(a,`eq.${l}`)}),this}not(s,a,l){return this.url.searchParams.append(s,`not.${a}.${l}`),this}or(s,{foreignTable:a,referencedTable:l=a}={}){const u=l?`${l}.or`:"or";return this.url.searchParams.append(u,`(${s})`),this}filter(s,a,l){return this.url.searchParams.append(s,`${a}.${l}`),this}}return ra.default=t,ra}var Hv;function iw(){if(Hv)return na;Hv=1;var n=na&&na.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(na,"__esModule",{value:!0});const e=n($m());class t{constructor(s,{headers:a={},schema:l,fetch:u}){this.url=s,this.headers=a,this.schema=l,this.fetch=u}select(s,{head:a=!1,count:l}={}){const u=a?"HEAD":"GET";let d=!1;const h=(s??"*").split("").map(m=>/\s/.test(m)&&!d?"":(m==='"'&&(d=!d),m)).join("");return this.url.searchParams.set("select",h),l&&(this.headers.Prefer=`count=${l}`),new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(s,{count:a,defaultToNull:l=!0}={}){const u="POST",d=[];if(this.headers.Prefer&&d.push(this.headers.Prefer),a&&d.push(`count=${a}`),l||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(s)){const h=s.reduce((m,y)=>m.concat(Object.keys(y)),[]);if(h.length>0){const m=[...new Set(h)].map(y=>`"${y}"`);this.url.searchParams.set("columns",m.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}upsert(s,{onConflict:a,ignoreDuplicates:l=!1,count:u,defaultToNull:d=!0}={}){const h="POST",m=[`resolution=${l?"ignore":"merge"}-duplicates`];if(a!==void 0&&this.url.searchParams.set("on_conflict",a),this.headers.Prefer&&m.push(this.headers.Prefer),u&&m.push(`count=${u}`),d||m.push("missing=default"),this.headers.Prefer=m.join(","),Array.isArray(s)){const y=s.reduce((v,x)=>v.concat(Object.keys(x)),[]);if(y.length>0){const v=[...new Set(y)].map(x=>`"${x}"`);this.url.searchParams.set("columns",v.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}update(s,{count:a}={}){const l="PATCH",u=[];return this.headers.Prefer&&u.push(this.headers.Prefer),a&&u.push(`count=${a}`),this.headers.Prefer=u.join(","),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}delete({count:s}={}){const a="DELETE",l=[];return s&&l.push(`count=${s}`),this.headers.Prefer&&l.unshift(this.headers.Prefer),this.headers.Prefer=l.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return na.default=t,na}var $o={},Io={},qv;function xC(){return qv||(qv=1,Object.defineProperty(Io,"__esModule",{value:!0}),Io.version=void 0,Io.version="0.0.0-automated"),Io}var Vv;function wC(){if(Vv)return $o;Vv=1,Object.defineProperty($o,"__esModule",{value:!0}),$o.DEFAULT_HEADERS=void 0;const n=xC();return $o.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`},$o}var Fv;function SC(){if(Fv)return ta;Fv=1;var n=ta&&ta.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(ta,"__esModule",{value:!0});const e=n(iw()),t=n($m()),r=wC();class s{constructor(l,{headers:u={},schema:d,fetch:h}={}){this.url=l,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),u),this.schemaName=d,this.fetch=h}from(l){const u=new URL(`${this.url}/${l}`);return new e.default(u,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new s(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,u={},{head:d=!1,get:h=!1,count:m}={}){let y;const v=new URL(`${this.url}/rpc/${l}`);let x;d||h?(y=d?"HEAD":"GET",Object.entries(u).filter(([k,_])=>_!==void 0).map(([k,_])=>[k,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([k,_])=>{v.searchParams.append(k,_)})):(y="POST",x=u);const w=Object.assign({},this.headers);return m&&(w.Prefer=`count=${m}`),new t.default({method:y,url:v,headers:w,schema:this.schemaName,body:x,fetch:this.fetch,allowEmpty:!1})}}return ta.default=s,ta}var Kv;function kC(){if(Kv)return Et;Kv=1;var n=Et&&Et.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Et,"__esModule",{value:!0}),Et.PostgrestError=Et.PostgrestBuilder=Et.PostgrestTransformBuilder=Et.PostgrestFilterBuilder=Et.PostgrestQueryBuilder=Et.PostgrestClient=void 0;const e=n(SC());Et.PostgrestClient=e.default;const t=n(iw());Et.PostgrestQueryBuilder=t.default;const r=n($m());Et.PostgrestFilterBuilder=r.default;const s=n(sw());Et.PostgrestTransformBuilder=s.default;const a=n(rw());Et.PostgrestBuilder=a.default;const l=n(nw());return Et.PostgrestError=l.default,Et.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:a.default,PostgrestError:l.default},Et}var _C=kC();const EC=pd(_C),{PostgrestClient:NC,PostgrestQueryBuilder:YD,PostgrestFilterBuilder:JD,PostgrestTransformBuilder:QD,PostgrestBuilder:XD,PostgrestError:ZD}=EC;class CC{static dynamicRequire(e){try{return typeof process<"u"&&process.versions&&process.versions.node&&typeof require<"u"?require(e):null}catch{return null}}static detectEnvironment(){var e,t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const r=parseInt(process.versions.node.split(".")[0]);if(r>=22)try{if(typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};const s=this.dynamicRequire("undici");if(s&&s.WebSocket)return{type:"native",constructor:s.WebSocket};throw new Error("undici not available")}catch{return{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:'Install the "ws" package or check your Node.js installation.'}}try{const s=this.dynamicRequire("ws");if(s)return{type:"ws",constructor:(t=s.WebSocket)!==null&&t!==void 0?t:s};throw new Error("ws package not available")}catch{return{type:"unsupported",error:`Node.js ${r} detected without WebSocket support.`,workaround:'Install the "ws" package: npm install ws'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const TC="2.15.0",jC=`realtime-js/${TC}`,MC="1.0.0",Gp=1e4,AC=1e3,OC=100;var Qo;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Qo||(Qo={}));var bt;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(bt||(bt={}));var Pn;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Pn||(Pn={}));var Wp;(function(n){n.websocket="websocket"})(Wp||(Wp={}));var Js;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Js||(Js={}));class RC{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),a=t.getUint8(2);let l=this.HEADER_LENGTH+2;const u=r.decode(e.slice(l,l+s));l=l+s;const d=r.decode(e.slice(l,l+a));l=l+a;const h=JSON.parse(r.decode(e.slice(l,e.byteLength)));return{ref:null,topic:u,event:d,payload:h}}}class aw{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var We;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(We||(We={}));const Gv=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((a,l)=>(a[l]=DC(l,n,e,s),a),{})},DC=(n,e,t,r)=>{const s=e.find(u=>u.name===n),a=s?.type,l=t[n];return a&&!r.includes(a)?ow(a,l):Yp(l)},ow=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return UC(e,t)}switch(n){case We.bool:return LC(e);case We.float4:case We.float8:case We.int2:case We.int4:case We.int8:case We.numeric:case We.oid:return BC(e);case We.json:case We.jsonb:return zC(e);case We.timestamp:return PC(e);case We.abstime:case We.date:case We.daterange:case We.int4range:case We.int8range:case We.money:case We.reltime:case We.text:case We.time:case We.timestamptz:case We.timetz:case We.tsrange:case We.tstzrange:return Yp(e);default:return Yp(e)}},Yp=n=>n,LC=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},BC=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},zC=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},UC=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let a;const l=n.slice(1,t);try{a=JSON.parse("["+l+"]")}catch{a=l?l.split(","):[]}return a.map(u=>ow(e,u))}return n},PC=n=>typeof n=="string"?n.replace(" ","T"):n,lw=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class sp{constructor(e,t,r={},s=Gp){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Wv;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Wv||(Wv={}));class Xo{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:a,onLeave:l,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Xo.syncState(this.state,s,a,l),this.pendingDiffs.forEach(d=>{this.state=Xo.syncDiff(this.state,d,a,l)}),this.pendingDiffs=[],u()}),this.channel._on(r.diff,{},s=>{const{onJoin:a,onLeave:l,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Xo.syncDiff(this.state,s,a,l),u())}),this.onJoin((s,a,l)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:l})}),this.onLeave((s,a,l)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const a=this.cloneDeep(e),l=this.transformState(t),u={},d={};return this.map(a,(h,m)=>{l[h]||(d[h]=m)}),this.map(l,(h,m)=>{const y=a[h];if(y){const v=m.map(_=>_.presence_ref),x=y.map(_=>_.presence_ref),w=m.filter(_=>x.indexOf(_.presence_ref)<0),k=y.filter(_=>v.indexOf(_.presence_ref)<0);w.length>0&&(u[h]=w),k.length>0&&(d[h]=k)}else u[h]=m}),this.syncDiff(a,{joins:u,leaves:d},r,s)}static syncDiff(e,t,r,s){const{joins:a,leaves:l}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(a,(u,d)=>{var h;const m=(h=e[u])!==null&&h!==void 0?h:[];if(e[u]=this.cloneDeep(d),m.length>0){const y=e[u].map(x=>x.presence_ref),v=m.filter(x=>y.indexOf(x.presence_ref)<0);e[u].unshift(...v)}r(u,m,d)}),this.map(l,(u,d)=>{let h=e[u];if(!h)return;const m=d.map(y=>y.presence_ref);h=h.filter(y=>m.indexOf(y.presence_ref)<0),e[u]=h,s(u,h,d),h.length===0&&delete e[u]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Yv;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Yv||(Yv={}));var Zo;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Zo||(Zo={}));var kr;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(kr||(kr={}));class Im{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=bt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new sp(this,Pn.join,this.params,this.timeout),this.rejoinTimer=new aw(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=bt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=bt.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=bt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=bt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=bt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Pn.reply,{},(s,a)=>{this._trigger(this._replyEventName(a),s)}),this.presence=new Xo(this),this.broadcastEndpointURL=lw(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.state==bt.closed){const{config:{broadcast:a,presence:l,private:u}}=this.params,d=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(v=>v.filter))!==null&&s!==void 0?s:[],h=!!this.bindings[Zo.PRESENCE]&&this.bindings[Zo.PRESENCE].length>0,m={},y={broadcast:a,presence:Object.assign(Object.assign({},l),{enabled:h}),postgres_changes:d,private:u};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(v=>e?.(kr.CHANNEL_ERROR,v)),this._onClose(()=>e?.(kr.CLOSED)),this.updateJoinPayload(Object.assign({config:y},m)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:v})=>{var x;if(this.socket.setAuth(),v===void 0){e?.(kr.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,k=(x=w?.length)!==null&&x!==void 0?x:0,_=[];for(let N=0;N<k;N++){const M=w[N],{filter:{event:C,schema:I,table:H,filter:Q}}=M,G=v&&v[N];if(G&&G.event===C&&G.schema===I&&G.table===H&&G.filter===Q)_.push(Object.assign(Object.assign({},M),{id:G.id}));else{this.unsubscribe(),this.state=bt.errored,e?.(kr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=_,e&&e(kr.SUBSCRIBED);return}}).receive("error",v=>{this.state=bt.errored,e?.(kr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{e?.(kr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===bt.joined&&e===Zo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:l}=e,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:l,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=h.body)===null||s===void 0?void 0:s.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var l,u,d;const h=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(u=(l=this.params)===null||l===void 0?void 0:l.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.ack)&&a("ok"),h.receive("ok",()=>a("ok")),h.receive("error",()=>a("error")),h.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=bt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Pn.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new sp(this,Pn.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=bt.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const s=new AbortController,a=setTimeout(()=>s.abort(),r),l=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(a),l}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new sp(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>OC){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,a;const l=e.toLocaleLowerCase(),{close:u,error:d,leave:h,join:m}=Pn;if(r&&[u,d,h,m].indexOf(l)>=0&&r!==this._joinRef())return;let v=this._onMessage(l,t,r);if(t&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(x=>{var w,k,_;return((w=x.filter)===null||w===void 0?void 0:w.event)==="*"||((_=(k=x.filter)===null||k===void 0?void 0:k.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===l}).map(x=>x.callback(v,r)):(a=this.bindings[l])===null||a===void 0||a.filter(x=>{var w,k,_,N,M,C;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in x){const I=x.id,H=(w=x.filter)===null||w===void 0?void 0:w.event;return I&&((k=t.ids)===null||k===void 0?void 0:k.includes(I))&&(H==="*"||H?.toLocaleLowerCase()===((_=t.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const I=(M=(N=x?.filter)===null||N===void 0?void 0:N.event)===null||M===void 0?void 0:M.toLocaleLowerCase();return I==="*"||I===((C=t?.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===l}).map(x=>{if(typeof v=="object"&&"ids"in v){const w=v.data,{schema:k,table:_,commit_timestamp:N,type:M,errors:C}=w;v=Object.assign(Object.assign({},{schema:k,table:_,commit_timestamp:N,eventType:M,new:{},old:{},errors:C}),this._getPayloadRecords(w))}x.callback(v,r)})}_isClosed(){return this.state===bt.closed}_isJoined(){return this.state===bt.joined}_isJoining(){return this.state===bt.joining}_isLeaving(){return this.state===bt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),a={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===r&&Im.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Pn.close,{},e)}_onError(e){this._on(Pn.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=bt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Gv(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Gv(e.columns,e.old_record)),t}}const Jv=()=>{},Qc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},$C=[1e3,2e3,5e3,1e4],IC=1e4,HC=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class qC{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Gp,this.transport=null,this.heartbeatIntervalMs=Qc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Jv,this.ref=0,this.reconnectTimer=null,this.logger=Jv,this.conn=null,this.sendBuffer=[],this.serializer=new RC,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...l)=>Da(async()=>{const{default:u}=await Promise.resolve().then(()=>La);return{default:u}},void 0,import.meta.url).then(({default:u})=>u(...l)).catch(u=>{throw new Error(`Failed to load @supabase/node-fetch: ${u.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...l)=>a(...l)},!(!((r=t?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Wp.websocket}`,this.httpEndpoint=lw(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=CC.createWebSocket(this.endpointURL())}catch(e){throw this._setConnectionState("disconnected"),new Error(`WebSocket not available: ${e.message}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:MC}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Qo.connecting:return Js.Connecting;case Qo.open:return Js.Open;case Qo.closing:return Js.Closing;default:return Js.Closed}}isConnected(){return this.connectionState()===Js.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(a=>a.topic===r);if(s)return s;{const a=new Im(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:r,payload:s,ref:a}=e,l=()=>{this.encode(e,u=>{var d;(d=this.conn)===null||d===void 0||d.send(u)})};this.log("push",`${t} ${r} (${a})`,s),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(AC,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Qc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:a,ref:l}=t,u=l?`(${l})`:"",d=a.status||"";this.log("receive",`${d} ${r} ${s} ${u}`.trim(),a),this.channels.filter(h=>h._isMember(r)).forEach(h=>h._trigger(s,a,l)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Pn.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([HC],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const s={access_token:t,version:jC};t&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(Pn.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new aw(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Qc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,a,l,u,d,h;if(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e?.timeout)!==null&&r!==void 0?r:Gp,this.heartbeatIntervalMs=(s=e?.heartbeatIntervalMs)!==null&&s!==void 0?s:Qc.HEARTBEAT_INTERVAL,this.worker=(a=e?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(l=e?.accessToken)!==null&&l!==void 0?l:null,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e?.reconnectAfterMs)!==null&&u!==void 0?u:m=>$C[m-1]||IC,this.encode=(d=e?.encode)!==null&&d!==void 0?d:(m,y)=>y(JSON.stringify(m)),this.decode=(h=e?.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class Hm extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Nt(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class VC extends Hm{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Jp extends Hm{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var FC=function(n,e,t,r){function s(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function u(m){try{h(r.next(m))}catch(y){l(y)}}function d(m){try{h(r.throw(m))}catch(y){l(y)}}function h(m){m.done?a(m.value):s(m.value).then(u,d)}h((r=r.apply(n,e||[])).next())})};const cw=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Da(async()=>{const{default:r}=await Promise.resolve().then(()=>La);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},KC=()=>FC(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Da(()=>Promise.resolve().then(()=>La),void 0,import.meta.url)).Response:Response}),Qp=n=>{if(Array.isArray(n))return n.map(t=>Qp(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[s]=Qp(r)}),e},GC=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var fi=function(n,e,t,r){function s(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function u(m){try{h(r.next(m))}catch(y){l(y)}}function d(m){try{h(r.throw(m))}catch(y){l(y)}}function h(m){m.done?a(m.value):s(m.value).then(u,d)}h((r=r.apply(n,e||[])).next())})};const ip=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),WC=(n,e,t)=>fi(void 0,void 0,void 0,function*(){const r=yield KC();n instanceof r&&!t?.noResolveJson?n.json().then(s=>{const a=n.status||500,l=s?.statusCode||a+"";e(new VC(ip(s),a,l))}).catch(s=>{e(new Jp(ip(s),s))}):e(new Jp(ip(n),n))}),YC=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"||!r?s:(GC(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(r)):s.body=r,Object.assign(Object.assign({},s),t))};function jl(n,e,t,r,s,a){return fi(this,void 0,void 0,function*(){return new Promise((l,u)=>{n(t,YC(e,r,s,a)).then(d=>{if(!d.ok)throw d;return r?.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>WC(d,u,r))})})}function Su(n,e,t,r){return fi(this,void 0,void 0,function*(){return jl(n,"GET",e,t,r)})}function _r(n,e,t,r,s){return fi(this,void 0,void 0,function*(){return jl(n,"POST",e,r,s,t)})}function Xp(n,e,t,r,s){return fi(this,void 0,void 0,function*(){return jl(n,"PUT",e,r,s,t)})}function JC(n,e,t,r){return fi(this,void 0,void 0,function*(){return jl(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function uw(n,e,t,r,s){return fi(this,void 0,void 0,function*(){return jl(n,"DELETE",e,r,s,t)})}var nn=function(n,e,t,r){function s(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function u(m){try{h(r.next(m))}catch(y){l(y)}}function d(m){try{h(r.throw(m))}catch(y){l(y)}}function h(m){m.done?a(m.value):s(m.value).then(u,d)}h((r=r.apply(n,e||[])).next())})};const QC={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Qv={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class XC{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=cw(s)}uploadOrUpdate(e,t,r,s){return nn(this,void 0,void 0,function*(){try{let a;const l=Object.assign(Object.assign({},Qv),s);let u=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",l.cacheControl),d&&a.append("metadata",this.encodeMetadata(d)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.append("cacheControl",l.cacheControl),d&&a.append("metadata",this.encodeMetadata(d))):(a=r,u["cache-control"]=`max-age=${l.cacheControl}`,u["content-type"]=l.contentType,d&&(u["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),s?.headers&&(u=Object.assign(Object.assign({},u),s.headers));const h=this._removeEmptyFolders(t),m=this._getFinalPath(h),y=yield(e=="PUT"?Xp:_r)(this.fetch,`${this.url}/object/${m}`,a,Object.assign({headers:u},l?.duplex?{duplex:l.duplex}:{}));return{data:{path:h,id:y.Id,fullPath:y.Key},error:null}}catch(a){if(Nt(a))return{data:null,error:a};throw a}})}upload(e,t,r){return nn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return nn(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),l=this._getFinalPath(a),u=new URL(this.url+`/object/upload/sign/${l}`);u.searchParams.set("token",t);try{let d;const h=Object.assign({upsert:Qv.upsert},s),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",h.cacheControl)):(d=r,m["cache-control"]=`max-age=${h.cacheControl}`,m["content-type"]=h.contentType);const y=yield Xp(this.fetch,u.toString(),d,{headers:m});return{data:{path:a,fullPath:y.Key},error:null}}catch(d){if(Nt(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(e,t){return nn(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t?.upsert&&(s["x-upsert"]="true");const a=yield _r(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),l=new URL(this.url+a.url),u=l.searchParams.get("token");if(!u)throw new Hm("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:u},error:null}}catch(r){if(Nt(r))return{data:null,error:r};throw r}})}update(e,t,r){return nn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return nn(this,void 0,void 0,function*(){try{return{data:yield _r(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Nt(s))return{data:null,error:s};throw s}})}copy(e,t,r){return nn(this,void 0,void 0,function*(){try{return{data:{path:(yield _r(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Nt(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return nn(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),a=yield _r(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const l=r?.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${l}`)},{data:a,error:null}}catch(s){if(Nt(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return nn(this,void 0,void 0,function*(){try{const s=yield _r(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${a}`):null})),error:null}}catch(s){if(Nt(s))return{data:null,error:s};throw s}})}download(e,t){return nn(this,void 0,void 0,function*(){const s=typeof t?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(t?.transform||{}),l=a?`?${a}`:"";try{const u=this._getFinalPath(e);return{data:yield(yield Su(this.fetch,`${this.url}/${s}/${u}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(u){if(Nt(u))return{data:null,error:u};throw u}})}info(e){return nn(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield Su(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Qp(r),error:null}}catch(r){if(Nt(r))return{data:null,error:r};throw r}})}exists(e){return nn(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield JC(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Nt(r)&&r instanceof Jp){const s=r.originalError;if([400,404].includes(s?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],a=t?.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&s.push(a);const u=typeof t?.transform<"u"?"render/image":"object",d=this.transformOptsToQueryString(t?.transform||{});d!==""&&s.push(d);let h=s.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${r}${h}`)}}}remove(e){return nn(this,void 0,void 0,function*(){try{return{data:yield uw(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Nt(t))return{data:null,error:t};throw t}})}list(e,t,r){return nn(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},QC),t),{prefix:e||""});return{data:yield _r(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(Nt(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ZC="2.10.4",eT={"X-Client-Info":`storage-js/${ZC}`};var aa=function(n,e,t,r){function s(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function u(m){try{h(r.next(m))}catch(y){l(y)}}function d(m){try{h(r.throw(m))}catch(y){l(y)}}function h(m){m.done?a(m.value):s(m.value).then(u,d)}h((r=r.apply(n,e||[])).next())})};class tT{constructor(e,t={},r,s){const a=new URL(e);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},eT),t),this.fetch=cw(r)}listBuckets(){return aa(this,void 0,void 0,function*(){try{return{data:yield Su(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Nt(e))return{data:null,error:e};throw e}})}getBucket(e){return aa(this,void 0,void 0,function*(){try{return{data:yield Su(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Nt(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return aa(this,void 0,void 0,function*(){try{return{data:yield _r(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Nt(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return aa(this,void 0,void 0,function*(){try{return{data:yield Xp(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Nt(r))return{data:null,error:r};throw r}})}emptyBucket(e){return aa(this,void 0,void 0,function*(){try{return{data:yield _r(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Nt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return aa(this,void 0,void 0,function*(){try{return{data:yield uw(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Nt(t))return{data:null,error:t};throw t}})}}class nT extends tT{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new XC(this.url,this.headers,e,this.fetch)}}const rT="2.54.0";let Ko="";typeof Deno<"u"?Ko="deno":typeof document<"u"?Ko="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ko="react-native":Ko="node";const sT={"X-Client-Info":`supabase-js-${Ko}/${rT}`},iT={headers:sT},aT={schema:"public"},oT={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},lT={};var cT=function(n,e,t,r){function s(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function u(m){try{h(r.next(m))}catch(y){l(y)}}function d(m){try{h(r.throw(m))}catch(y){l(y)}}function h(m){m.done?a(m.value):s(m.value).then(u,d)}h((r=r.apply(n,e||[])).next())})};const uT=n=>{let e;return n?e=n:typeof fetch>"u"?e=ew:e=fetch,(...t)=>e(...t)},dT=()=>typeof Headers>"u"?tw:Headers,fT=(n,e,t)=>{const r=uT(t),s=dT();return(a,l)=>cT(void 0,void 0,void 0,function*(){var u;const d=(u=yield e())!==null&&u!==void 0?u:n;let h=new s(l?.headers);return h.has("apikey")||h.set("apikey",n),h.has("Authorization")||h.set("Authorization",`Bearer ${d}`),r(a,Object.assign(Object.assign({},l),{headers:h}))})};var hT=function(n,e,t,r){function s(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function u(m){try{h(r.next(m))}catch(y){l(y)}}function d(m){try{h(r.throw(m))}catch(y){l(y)}}function h(m){m.done?a(m.value):s(m.value).then(u,d)}h((r=r.apply(n,e||[])).next())})};function pT(n){return n.endsWith("/")?n:n+"/"}function mT(n,e){var t,r;const{db:s,auth:a,realtime:l,global:u}=n,{db:d,auth:h,realtime:m,global:y}=e,v={db:Object.assign(Object.assign({},d),s),auth:Object.assign(Object.assign({},h),a),realtime:Object.assign(Object.assign({},m),l),storage:{},global:Object.assign(Object.assign(Object.assign({},y),u),{headers:Object.assign(Object.assign({},(t=y?.headers)!==null&&t!==void 0?t:{}),(r=u?.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>hT(this,void 0,void 0,function*(){return""})};return n.accessToken?v.accessToken=n.accessToken:delete v.accessToken,v}const dw="2.71.1",pa=30*1e3,Zp=3,ap=Zp*pa,gT="http://localhost:9999",yT="supabase.auth.token",bT={"X-Client-Info":`gotrue-js/${dw}`},em="X-Supabase-Api-Version",fw={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},vT=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,xT=600*1e3;class qm extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function xe(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class wT extends qm{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function ST(n){return xe(n)&&n.name==="AuthApiError"}class hw extends qm{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class _s extends qm{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class ss extends _s{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function kT(n){return xe(n)&&n.name==="AuthSessionMissingError"}class Xc extends _s{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Zc extends _s{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class eu extends _s{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function _T(n){return xe(n)&&n.name==="AuthImplicitGrantRedirectError"}class Xv extends _s{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class tm extends _s{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function op(n){return xe(n)&&n.name==="AuthRetryableFetchError"}class Zv extends _s{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class nm extends _s{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const ku="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ex=` 	
\r=`.split(""),ET=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<ex.length;e+=1)n[ex[e].charCodeAt(0)]=-2;for(let e=0;e<ku.length;e+=1)n[ku[e].charCodeAt(0)]=e;return n})();function tx(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(ku[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(ku[r]),e.queuedBits-=6}}function pw(n,e,t){const r=ET[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function nx(n){const e=[],t=l=>{e.push(String.fromCodePoint(l))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=l=>{TT(l,r,t)};for(let l=0;l<n.length;l+=1)pw(n.charCodeAt(l),s,a);return e.join("")}function NT(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function CT(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}NT(r,e)}}function TT(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function jT(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)pw(n.charCodeAt(s),t,r);return new Uint8Array(e)}function MT(n){const e=[];return CT(n,t=>e.push(t)),new Uint8Array(e)}function AT(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};return n.forEach(s=>tx(s,t,r)),tx(null,t,r),e.join("")}function OT(n){return Math.round(Date.now()/1e3)+n}function RT(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const Un=()=>typeof window<"u"&&typeof document<"u",Ks={tested:!1,writable:!1},mw=()=>{if(!Un())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ks.tested)return Ks.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Ks.tested=!0,Ks.writable=!0}catch{Ks.tested=!0,Ks.writable=!1}return Ks.writable};function DT(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,a)=>{e[a]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const gw=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Da(async()=>{const{default:r}=await Promise.resolve().then(()=>La);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},LT=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",ma=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Gs=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},ts=async(n,e)=>{await n.removeItem(e)};class yd{constructor(){this.promise=new yd.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}yd.promiseConstructor=Promise;function lp(n){const e=n.split(".");if(e.length!==3)throw new nm("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!vT.test(e[r]))throw new nm("JWT not in base64url format");return{header:JSON.parse(nx(e[0])),payload:JSON.parse(nx(e[1])),signature:jT(e[2]),raw:{header:e[0],payload:e[1]}}}async function BT(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function zT(n,e){return new Promise((r,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const l=await n(a);if(!e(a,null,l)){r(l);return}}catch(l){if(!e(a,l)){s(l);return}}})()})}function UT(n){return("0"+n.toString(16)).substr(-2)}function PT(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let a=0;a<56;a++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,UT).join("")}async function $T(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function IT(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await $T(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function oa(n,e,t=!1){const r=PT();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await ma(n,`${e}-code-verifier`,s);const a=await IT(r);return[a,r===a?"plain":"s256"]}const HT=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function qT(n){const e=n.headers.get(em);if(!e||!e.match(HT))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function VT(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function FT(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const KT=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function la(n){if(!KT.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function cp(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function rx(n){return JSON.parse(JSON.stringify(n))}var GT=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const Ys=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),WT=[502,503,504];async function sx(n){var e;if(!LT(n))throw new tm(Ys(n),0);if(WT.includes(n.status))throw new tm(Ys(n),n.status);let t;try{t=await n.json()}catch(a){throw new hw(Ys(a),a)}let r;const s=qT(n);if(s&&s.getTime()>=fw["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Zv(Ys(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new ss}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,l)=>a&&typeof l=="string",!0))throw new Zv(Ys(t),n.status,t.weak_password.reasons);throw new wT(Ys(t),n.status||500,r)}const YT=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function Me(n,e,t,r){var s;const a=Object.assign({},r?.headers);a[em]||(a[em]=fw["2024-01-01"].name),r?.jwt&&(a.Authorization=`Bearer ${r.jwt}`);const l=(s=r?.query)!==null&&s!==void 0?s:{};r?.redirectTo&&(l.redirect_to=r.redirectTo);const u=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await JT(n,e,t+u,{headers:a,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(d):{data:Object.assign({},d),error:null}}async function JT(n,e,t,r,s,a){const l=YT(e,r,s,a);let u;try{u=await n(t,Object.assign({},l))}catch(d){throw console.error(d),new tm(Ys(d),0)}if(u.ok||await sx(u),r?.noResolveJson)return u;try{return await u.json()}catch(d){await sx(d)}}function wr(n){var e;let t=null;ej(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=OT(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function ix(n){const e=wr(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function us(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function QT(n){return{data:n,error:null}}function XT(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:a}=n,l=GT(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:a},d=Object.assign({},l);return{data:{properties:u,user:d},error:null}}function ZT(n){return n}function ej(n){return n.access_token&&n.refresh_token&&n.expires_in}const up=["global","local","others"];var tj=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class nj{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=gw(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=up[0]){if(up.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${up.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(xe(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:us})}catch(r){if(xe(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=tj(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r?.newEmail,delete s.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:XT,redirectTo:t?.redirectTo})}catch(t){if(xe(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:us})}catch(t){if(xe(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,a,l,u,d;try{const h={nextPage:null,lastPage:0,total:0},m=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(a=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:ZT});if(m.error)throw m.error;const y=await m.json(),v=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,x=(d=(u=m.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return x.length>0&&(x.forEach(w=>{const k=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(w.split(";")[1].split("=")[1]);h[`${_}Page`]=k}),h.total=parseInt(v)),{data:Object.assign(Object.assign({},y),h),error:null}}catch(h){if(xe(h))return{data:{users:[]},error:h};throw h}}async getUserById(e){la(e);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:us})}catch(t){if(xe(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){la(e);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:us})}catch(r){if(xe(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){la(e);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:us})}catch(r){if(xe(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){la(e.userId);try{const{data:t,error:r}=await Me(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(xe(t))return{data:null,error:t};throw t}}async _deleteFactor(e){la(e.userId),la(e.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(xe(t))return{data:null,error:t};throw t}}}function ax(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function rj(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ca={debug:!!(globalThis&&mw()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class yw extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class sj extends yw{}async function ij(n,e,t){ca.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),ca.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){ca.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{ca.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw ca.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new sj(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(ca.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}rj();const aj={url:gT,storageKey:yT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:bT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ox(n,e,t){return await t()}const ua={};class dl{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=dl.nextInstanceID,dl.nextInstanceID+=1,this.instanceID>0&&Un()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},aj),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new nj({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=gw(s.fetch),this.lock=s.lock||ox,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Un()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=ij:this.lock=ox,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:mw()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ax(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=ax(this.memoryStorage)),Un()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=ua[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){ua[this.storageKey]=Object.assign(Object.assign({},ua[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=ua[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){ua[this.storageKey]=Object.assign(Object.assign({},ua[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${dw}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=DT(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),Un()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:a}=await this._getSessionFromURL(t,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),_T(a)){const d=(e=a.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:l,redirectType:u}=s;return this._debug("#_initialize()","detected session in URL",l,"redirect type",u),await this._saveSession(l),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return xe(t)?{error:t}:{error:new hw("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:wr}),{data:l,error:u}=a;if(u||!l)return{data:{user:null,session:null},error:u};const d=l.session,h=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:h,session:d},error:null}}catch(a){if(xe(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,r,s;try{let a;if("email"in e){const{email:m,password:y,options:v}=e;let x=null,w=null;this.flowType==="pkce"&&([x,w]=await oa(this.storage,this.storageKey)),a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v?.emailRedirectTo,body:{email:m,password:y,data:(t=v?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:x,code_challenge_method:w},xform:wr})}else if("phone"in e){const{phone:m,password:y,options:v}=e;a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:y,data:(r=v?.data)!==null&&r!==void 0?r:{},channel:(s=v?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:wr})}else throw new Zc("You must provide either an email or phone number and a password");const{data:l,error:u}=a;if(u||!l)return{data:{user:null,session:null},error:u};const d=l.session,h=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:h,session:d},error:null}}catch(a){if(xe(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:l,options:u}=e;t=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:ix})}else if("phone"in e){const{phone:a,password:l,options:u}=e;t=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:ix})}else throw new Zc("You must provide either an email or phone number and a password");const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Xc}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(xe(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,s,a,l,u,d,h,m,y,v,x;let w,k;if("message"in e)w=e.message,k=e.signature;else{const{chain:_,wallet:N,statement:M,options:C}=e;let I;if(Un())if(typeof N=="object")I=N;else{const Q=window;if("solana"in Q&&typeof Q.solana=="object"&&("signIn"in Q.solana&&typeof Q.solana.signIn=="function"||"signMessage"in Q.solana&&typeof Q.solana.signMessage=="function"))I=Q.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");I=N}const H=new URL((t=C?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in I&&I.signIn){const Q=await I.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C?.signInWithSolana),{version:"1",domain:H.host,uri:H.href}),M?{statement:M}:null));let G;if(Array.isArray(Q)&&Q[0]&&typeof Q[0]=="object")G=Q[0];else if(Q&&typeof Q=="object"&&"signedMessage"in Q&&"signature"in Q)G=Q;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in G&&"signature"in G&&(typeof G.signedMessage=="string"||G.signedMessage instanceof Uint8Array)&&G.signature instanceof Uint8Array)w=typeof G.signedMessage=="string"?G.signedMessage:new TextDecoder().decode(G.signedMessage),k=G.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in I)||typeof I.signMessage!="function"||!("publicKey"in I)||typeof I!="object"||!I.publicKey||!("toBase58"in I.publicKey)||typeof I.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${H.host} wants you to sign in with your Solana account:`,I.publicKey.toBase58(),...M?["",M,""]:[""],"Version: 1",`URI: ${H.href}`,`Issued At: ${(s=(r=C?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=C?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((l=C?.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((u=C?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((d=C?.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((h=C?.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((y=(m=C?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||y===void 0)&&y.length?["Resources",...C.signInWithSolana.resources.map(G=>`- ${G}`)]:[]].join(`
`);const Q=await I.signMessage(new TextEncoder().encode(w),"utf8");if(!Q||!(Q instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");k=Q}}try{const{data:_,error:N}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:AT(k)},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:wr});if(N)throw N;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new Xc}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:N})}catch(_){if(xe(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(e){const t=await Gs(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{const{data:a,error:l}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:wr});if(await ts(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Xc}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:l})}catch(a){if(xe(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:a,nonce:l}=e,u=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:a,nonce:l,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:wr}),{data:d,error:h}=u;return h?{data:{user:null,session:null},error:h}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new Xc}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:h})}catch(t){if(xe(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,a,l;try{if("email"in e){const{email:u,options:d}=e;let h=null,m=null;this.flowType==="pkce"&&([h,m]=await oa(this.storage,this.storageKey));const{error:y}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(t=d?.data)!==null&&t!==void 0?t:{},create_user:(r=d?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:h,code_challenge_method:m},redirectTo:d?.emailRedirectTo});return{data:{user:null,session:null},error:y}}if("phone"in e){const{phone:u,options:d}=e,{data:h,error:m}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(s=d?.data)!==null&&s!==void 0?s:{},create_user:(a=d?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},channel:(l=d?.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:h?.message_id},error:m}}throw new Zc("You must provide either an email or phone number.")}catch(u){if(xe(u))return{data:{user:null,session:null},error:u};throw u}}async verifyOtp(e){var t,r;try{let s,a;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:l,error:u}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:wr});if(u)throw u;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,h=l.user;return d?.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:h,session:d},error:null}}catch(s){if(xe(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{let a=null,l=null;return this.flowType==="pkce"&&([a,l]=await oa(this.storage,this.storageKey)),await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:l}),headers:this.headers,xform:QT})}catch(a){if(xe(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new ss;const{error:s}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(xe(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:a}=e,{error:l}=await Me(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in e){const{phone:r,type:s,options:a}=e,{data:l,error:u}=await Me(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return{data:{user:null,session:null,messageId:l?.message_id},error:u}}throw new Zc("You must provide either an email or phone number and a type")}catch(t){if(xe(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Gs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<ap:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const l=await Gs(this.userStorage,this.storageKey+"-user");l?.user?e.user=l.user:e.user=cp()}if(this.storage.isServer&&e.user){let l=this.suppressGetSessionWarning;e=new Proxy(e,{get:(d,h,m)=>(!l&&h==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,h,m))})}return{data:{session:e},error:null}}const{session:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:us}):await this._useSession(async t=>{var r,s,a;const{data:l,error:u}=t;if(u)throw u;return!(!((r=l.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ss}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:us})})}catch(t){if(xe(t))return kT(t)&&(await this._removeSession(),await ts(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:a}=r;if(a)throw a;if(!s.session)throw new ss;const l=s.session;let u=null,d=null;this.flowType==="pkce"&&e.email!=null&&([u,d]=await oa(this.storage,this.storageKey));const{data:h,error:m}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:u,code_challenge_method:d}),jwt:l.access_token,xform:us});if(m)throw m;return l.user=h.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(r){if(xe(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ss;const t=Date.now()/1e3;let r=t,s=!0,a=null;const{payload:l}=lp(e.access_token);if(l.exp&&(r=l.exp,s=r<=t),s){const{session:u,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!u)return{data:{user:null,session:null},error:null};a=u}else{const{data:u,error:d}=await this._getUser(e.access_token);if(d)throw d;a={access_token:e.access_token,refresh_token:e.refresh_token,user:u.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(xe(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:l,error:u}=t;if(u)throw u;e=(r=l.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new ss;const{session:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(xe(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Un())throw new eu("No browser detected.");if(e.error||e.error_description||e.error_code)throw new eu(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Xv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new eu("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Xv("No code detected.");const{data:M,error:C}=await this._exchangeCodeForSession(e.code);if(C)throw C;const I=new URL(window.location.href);return I.searchParams.delete("code"),window.history.replaceState(window.history.state,"",I.toString()),{data:{session:M.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:a,refresh_token:l,expires_in:u,expires_at:d,token_type:h}=e;if(!a||!u||!l||!h)throw new eu("No session defined in URL");const m=Math.round(Date.now()/1e3),y=parseInt(u);let v=m+y;d&&(v=parseInt(d));const x=v-m;x*1e3<=pa&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${y}s`);const w=v-y;m-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,v,m):m-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,v,m);const{data:k,error:_}=await this._getUser(a);if(_)throw _;const N={provider_token:r,provider_refresh_token:s,access_token:a,expires_in:y,expires_at:v,refresh_token:l,token_type:h,user:k.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:N,redirectType:e.type},error:null}}catch(r){if(xe(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Gs(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return{error:a};const l=(r=s.session)===null||r===void 0?void 0:r.access_token;if(l){const{error:u}=await this.admin.signOut(l,e);if(u&&!(ST(u)&&(u.status===404||u.status===401||u.status===403)))return{error:u}}return e!=="others"&&(await this._removeSession(),await ts(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=RT(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:a},error:l}=t;if(l)throw l;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await oa(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(xe(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(xe(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:s}=await this._useSession(async a=>{var l,u,d,h,m;const{data:y,error:v}=a;if(v)throw v;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(u=e.options)===null||u===void 0?void 0:u.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",x,{headers:this.headers,jwt:(m=(h=y.session)===null||h===void 0?void 0:h.access_token)!==null&&m!==void 0?m:void 0})});if(s)throw s;return Un()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:e.provider,url:r?.url},error:null}}catch(r){if(xe(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:a,error:l}=t;if(l)throw l;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(xe(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await zT(async s=>(s>0&&await BT(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:wr})),(s,a)=>{const l=200*Math.pow(2,s);return a&&op(a)&&Date.now()+l-r<pa})}catch(r){if(this._debug(t,"error",r),xe(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Un()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await Gs(this.storage,this.storageKey);if(s&&this.userStorage){let l=await Gs(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:s.user},await ma(this.userStorage,this.storageKey+"-user",l)),s.user=(e=l?.user)!==null&&e!==void 0?e:cp()}else if(s&&!s.user&&!s.user){const l=await Gs(this.storage,this.storageKey+"-user");l&&l?.user?(s.user=l.user,await ts(this.storage,this.storageKey+"-user"),await ma(this.storage,this.storageKey,s)):s.user=cp()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const a=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<ap;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${ap}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:l}=await this._callRefreshToken(s.refresh_token);l&&(console.error(l),op(l)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:u}=await this._getUser(s.access_token);!u&&l?.user?(s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(r,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new ss;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new yd;const{data:a,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!a.session)throw new ss;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const u={session:a.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(a){if(this._debug(s,"error",a),xe(a)){const l={session:null,error:a};return op(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(l),l}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],l=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(e,t)}catch(d){a.push(d)}});if(await Promise.all(l),a.length>0){for(let u=0;u<a.length;u+=1)console.error(a[u]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await ma(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const a=rx(s);await ma(this.storage,this.storageKey,a)}else{const s=rx(t);await ma(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await ts(this.storage,this.storageKey),await ts(this.storage,this.storageKey+"-code-verifier"),await ts(this.storage,this.storageKey+"-user"),this.userStorage&&await ts(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Un()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),pa);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/pa);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${pa}ms, refresh threshold is ${Zp} ticks`),s<=Zp&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof yw)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Un()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[a,l]=await oa(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(l)}`});s.push(u.toString())}if(r?.queryParams){const a=new URLSearchParams(r.queryParams);s.push(a.toString())}return r?.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;return a?{data:null,error:a}:await Me(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(xe(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:a,error:l}=t;if(l)return{data:null,error:l};const u=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:d,error:h}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(r=a?.session)===null||r===void 0?void 0:r.access_token});return h?{data:null,error:h}:(e.factorType==="totp"&&(!((s=d?.totp)===null||s===void 0)&&s.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(t){if(xe(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return{data:null,error:a};const{data:l,error:u}=await Me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:u})})}catch(t){if(xe(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;return a?{data:null,error:a}:await Me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(xe(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=e?.factors||[],s=r.filter(l=>l.factor_type==="totp"&&l.status==="verified"),a=r.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:r,totp:s,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:s},error:a}=e;if(a)return{data:null,error:a};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=lp(s.access_token);let u=null;l.aal&&(u=l.aal);let d=u;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(y=>y.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(d="aal2");const m=l.amr||[];return{data:{currentLevel:u,nextLevel:d,currentAuthenticationMethods:m},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(u=>u.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(u=>u.kid===e),r&&this.jwks_cached_at+xT>s)return r;const{data:a,error:l}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,r=a.keys.find(u=>u.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:x,error:w}=await this.getSession();if(w||!x.session)return{data:null,error:w};r=x.session.access_token}const{header:s,payload:a,signature:l,raw:{header:u,payload:d}}=lp(r);t?.allowExpired||VT(a.exp);const h=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!h){const{error:x}=await this.getUser(r);if(x)throw x;return{data:{claims:a,header:s,signature:l},error:null}}const m=FT(s.alg),y=await crypto.subtle.importKey("jwk",h,m,!0,["verify"]);if(!await crypto.subtle.verify(m,y,l,MT(`${u}.${d}`)))throw new nm("Invalid JWT signature");return{data:{claims:a,header:s,signature:l},error:null}}catch(r){if(xe(r))return{data:null,error:r};throw r}}}dl.nextInstanceID=0;const oj=dl;class lj extends oj{constructor(e){super(e)}}var cj=function(n,e,t,r){function s(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function u(m){try{h(r.next(m))}catch(y){l(y)}}function d(m){try{h(r.throw(m))}catch(y){l(y)}}function h(m){m.done?a(m.value):s(m.value).then(u,d)}h((r=r.apply(n,e||[])).next())})};class uj{constructor(e,t,r){var s,a,l;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const u=pT(e),d=new URL(u);this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const h=`sb-${d.hostname.split(".")[0]}-auth-token`,m={db:aT,realtime:lT,auth:Object.assign(Object.assign({},oT),{storageKey:h}),global:iT},y=mT(r??{},m);this.storageKey=(s=y.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=y.global.headers)!==null&&a!==void 0?a:{},y.accessToken?(this.accessToken=y.accessToken,this.auth=new Proxy({},{get:(v,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=y.auth)!==null&&l!==void 0?l:{},this.headers,y.global.fetch),this.fetch=fT(t,this._getAccessToken.bind(this),y.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},y.realtime)),this.rest=new NC(new URL("rest/v1",d).href,{headers:this.headers,schema:y.db.schema,fetch:this.fetch}),this.storage=new nT(this.storageUrl.href,this.headers,this.fetch,r?.storage),y.accessToken||this._listenForAuthEvents()}get functions(){return new pC(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return cj(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:a,flowType:l,lock:u,debug:d},h,m){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new lj({url:this.authUrl.href,headers:Object.assign(Object.assign({},y),h),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:l,lock:u,debug:d,fetch:m,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new qC(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const dj=(n,e,t)=>new uj(n,e,t);function fj(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}fj()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const hj="https://pxmouonbnyeofvlqgini.supabase.co",pj="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB4bW91b25ibnllb2Z2bHFnaW5pIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ5ODQ0NzcsImV4cCI6MjA3MDU2MDQ3N30.lvPShUeBpX7JH2j9rxNWtpwZxFN9MYgWYWNiJ-7_NtI",B=dj(hj,pj,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),Jt=Tl((n,e)=>({user:null,userProfile:null,session:null,loading:!0,initialize:async()=>{try{const{data:{session:t}}=await B.auth.getSession();t?.user&&(n({user:t.user,session:t}),await e().loadUserProfile()),B.auth.onAuthStateChange(async(r,s)=>{s?.user?(n({user:s.user,session:s}),await e().loadUserProfile()):n({user:null,session:null,userProfile:null})})}catch(t){console.error("Auth initialization error:",t)}finally{n({loading:!1})}},login:async(t,r)=>{const{data:s,error:a}=await B.auth.signInWithPassword({email:t,password:r});if(a)throw a;s.user&&(n({user:s.user,session:s.session}),await e().loadUserProfile())},register:async(t,r,s)=>{const{error:a}=await B.auth.signUp({email:t,password:r,options:{data:{username:s||t.split("@")[0]}}});if(a)throw a},logout:async()=>{const{error:t}=await B.auth.signOut();if(t)throw t;n({user:null,session:null,userProfile:null})},loadUserProfile:async()=>{const{user:t}=e();if(t)try{const{data:r,error:s}=await B.from("users").select("*").eq("id",t.id).single();if(s){console.error("Error loading user profile:",s);return}n({userProfile:r})}catch(r){console.error("Error loading user profile:",r)}},updateProfile:async t=>{const{user:r,userProfile:s}=e();if(!r||!s)throw new Error("User not authenticated");const{data:a,error:l}=await B.from("users").update({...t,updated_at:new Date().toISOString()}).eq("id",r.id).select().single();if(l)throw l;n({userProfile:a})},resetPassword:async t=>{const{error:r}=await B.auth.resetPasswordForEmail(t,{redirectTo:`${window.location.origin}/reset-password`});if(r)throw r}}));Jt.getState().initialize();const bw=Tl((n,e)=>({notifications:[],unreadCount:0,loading:!1,loadNotifications:async()=>{try{n({loading:!0});const{data:t,error:r}=await B.from("notifications").select("*").order("created_at",{ascending:!1}).limit(50);if(r){if(r.code==="PGRST116"||r.message.includes('relation "public.notifications" does not exist')){console.warn("Notifications table not found - skipping notification loading"),n({notifications:[],unreadCount:0});return}throw r}const s=t?.filter(a=>!a.is_read).length||0;n({notifications:t||[],unreadCount:s})}catch(t){console.error("Error loading notifications:",t),n({notifications:[],unreadCount:0})}finally{n({loading:!1})}},markAsRead:async t=>{try{const{error:r}=await B.from("notifications").update({is_read:!0}).eq("id",t);if(r){if(r.code==="PGRST116"||r.message.includes('relation "public.notifications" does not exist')){console.warn("Notifications table not found - cannot mark as read");return}throw r}n(s=>({notifications:s.notifications.map(a=>a.id===t?{...a,is_read:!0}:a),unreadCount:Math.max(0,s.unreadCount-1)}))}catch(r){console.error("Error marking notification as read:",r)}},markAllAsRead:async()=>{try{const{error:t}=await B.from("notifications").update({is_read:!0}).eq("is_read",!1);if(t){if(t.code==="PGRST116"||t.message.includes('relation "public.notifications" does not exist')){console.warn("Notifications table not found - cannot mark all as read");return}throw t}n(r=>({notifications:r.notifications.map(s=>({...s,is_read:!0})),unreadCount:0}))}catch(t){console.error("Error marking all notifications as read:",t)}},addNotification:t=>{n(r=>({notifications:[t,...r.notifications],unreadCount:t.is_read?r.unreadCount:r.unreadCount+1}))},deleteNotification:async t=>{try{const{error:r}=await B.from("notifications").delete().eq("id",t);if(r){if(r.code==="PGRST116"||r.message.includes('relation "public.notifications" does not exist')){console.warn("Notifications table not found - cannot delete notification");return}throw r}n(s=>{const a=s.notifications.find(l=>l.id===t);return{notifications:s.notifications.filter(l=>l.id!==t),unreadCount:a&&!a.is_read?Math.max(0,s.unreadCount-1):s.unreadCount}})}catch(r){console.error("Error deleting notification:",r)}},subscribeToRealtime:t=>{const r=B.channel(`notifications:user_id=eq.${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${t}`},s=>{const a=s.new;e().addNotification(a),Notification.permission==="granted"&&new Notification(a.title,{body:a.message,icon:"/favicon.ico"})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"notifications",filter:`user_id=eq.${t}`},s=>{const a=s.new;n(l=>({notifications:l.notifications.map(u=>u.id===a.id?a:u)}))}).subscribe();return()=>{B.removeChannel(r)}}})),mj=()=>{const{user:n}=Jt(),{subscribeToRealtime:e}=bw();T.useEffect(()=>n?e(n.id):void 0,[n?.id,e])};class fl{async getPosts(e,t=!1){let r={};typeof e=="number"?r.category=e:e&&(r=e);let s=B.from("posts").select(`
        *,
        users!posts_user_id_fkey(id, username, avatar_url, role),
        categories!inner(id, name_de, name_fr, name_it),
        therapists(id, form_of_address, first_name, last_name, designation, institution, canton)
      `).eq("is_active",!0).order("created_at",{ascending:!1});if(t){const{data:{user:u}}=await B.auth.getUser();u?s=s.or(`and(is_published.eq.true,is_banned.eq.false,moderation_status.eq.approved),and(user_id.eq.${u.id},is_banned.eq.true)`):s=s.eq("is_published",!0).eq("is_banned",!1).eq("moderation_status","approved")}else s=s.eq("is_published",!0).eq("is_banned",!1).eq("moderation_status","approved");if(r.category&&(s=s.eq("category_id",r.category)),r.canton&&(s=s.eq("canton",r.canton)),r.therapist&&(s=s.eq("therapist_id",parseInt(r.therapist))),r.designation&&(s=s.eq("designation",r.designation)),r.dateFrom){const u=new Date(r.dateFrom);s=s.gte("created_at",u.toISOString())}if(r.dateTo){const u=new Date(r.dateTo);u.setDate(u.getDate()+1),s=s.lt("created_at",u.toISOString())}r.search&&(s=s.or(`title.ilike.%${r.search}%,content.ilike.%${r.search}%`));const{data:a,error:l}=await s;if(l)throw console.error("Error fetching posts:",l),l;return a||[]}async getPost(e,t=!1){let r=B.from("posts").select(`
        *,
        users!posts_user_id_fkey(id, username, avatar_url, role),
        categories!inner(id, name_de, name_fr, name_it),
        therapists(id, form_of_address, first_name, last_name, designation, institution, canton)
      `).eq("id",e).eq("is_active",!0);if(t){const{data:{user:l}}=await B.auth.getUser();l?r=r.or(`and(is_published.eq.true,is_banned.eq.false,moderation_status.eq.approved),and(user_id.eq.${l.id},is_banned.eq.true)`):r=r.eq("is_published",!0).eq("is_banned",!1).eq("moderation_status","approved")}else r=r.eq("is_published",!0).eq("is_banned",!1).eq("moderation_status","approved");const{data:s,error:a}=await r.single();if(a)throw console.error("Error fetching post:",a),a;return s}async createPost(e){console.log("🔧 PostsService: Starting createPost with data:",e);const{data:{user:t},error:r}=await B.auth.getUser();if(r)throw console.error("❌ PostsService: Auth error:",r),new Error("Authentication failed: "+r.message);if(!t)throw console.error("❌ PostsService: No authenticated user"),new Error("User not authenticated");console.log("👤 PostsService: Authenticated user:",t.email,"ID:",t.id);const s={...e,user_id:t.id,is_published:!1,moderation_status:"pending",designation:"Allgemein"};console.log("📤 PostsService: Inserting data:",s);const{data:a,error:l}=await B.from("posts").insert([s]).select().single();if(l)throw console.error("❌ PostsService: Database error:",l),new Error("Database error: "+l.message);return console.log("✅ PostsService: Post created successfully:",a),a}async getCategories(){const{data:e,error:t}=await B.from("categories").select("*").eq("is_active",!0).order("id",{ascending:!0});if(t)throw console.error("Error fetching categories:",t),t;return e||[]}async searchPosts(e){const{data:t,error:r}=await B.from("posts").select(`
        *,
        users!posts_user_id_fkey(id, username, avatar_url, role),
        categories!inner(id, name_de, name_fr, name_it),
        therapists(id, form_of_address, first_name, last_name, designation, institution, canton)
      `).eq("is_published",!0).eq("is_active",!0).eq("is_banned",!1).eq("moderation_status","approved").or(`title.ilike.%${e}%,content.ilike.%${e}%`).order("created_at",{ascending:!1});if(r)throw console.error("Error searching posts:",r),r;return t||[]}async updatePost(e,t){console.log("🔧 PostsService: Starting updatePost for ID:",e,"with updates:",t);const{data:{user:r},error:s}=await B.auth.getUser();if(s)throw console.error("❌ PostsService: Auth error:",s),new Error("Authentication failed: "+s.message);if(!r)throw console.error("❌ PostsService: No authenticated user"),new Error("User not authenticated");const{data:a,error:l}=await B.from("posts").select("user_id").eq("id",e).single();if(l)throw console.error("❌ PostsService: Error fetching post for authorization:",l),new Error("Post not found");if(a.user_id!==r.id)throw console.error("❌ PostsService: User not authorized to edit this post"),new Error("Not authorized to edit this post");const u={...t,updated_at:new Date().toISOString()};console.log("📤 PostsService: Updating post with data:",u);const{data:d,error:h}=await B.from("posts").update(u).eq("id",e).select(`
        *,
        users!posts_user_id_fkey(id, username, avatar_url, role),
        categories!inner(id, name_de, name_fr, name_it),
        therapists(id, form_of_address, first_name, last_name, designation, institution, canton)
      `).single();if(h)throw console.error("❌ PostsService: Database error:",h),new Error("Database error: "+h.message);return console.log("✅ PostsService: Post updated successfully:",d),d}async getDesignations(){const{data:e,error:t}=await B.from("designations").select("*").order("name_de",{ascending:!0});return t?(console.error("Error fetching designations:",t),[]):e||[]}}const Ho={page:1,limit:20,hasMore:!0,total:0},da=new fl,hs=Tl((n,e)=>({posts:[],currentPost:null,loading:!1,filters:{},pagination:Ho,categories:[],categoriesLoading:!1,loadPosts:async t=>{try{n({loading:!0}),t&&n({filters:t,pagination:Ho});const r=t||e().filters,s=await da.getPosts({category:r.category,canton:r.canton,therapist:r.therapist,designation:r.designation,dateFrom:r.dateFrom,dateTo:r.dateTo,search:r.search});n({posts:s,pagination:{...e().pagination,total:s.length,hasMore:s.length>=e().pagination.limit}})}catch(r){throw console.error("Error loading posts:",r),r}finally{n({loading:!1})}},loadMorePosts:async()=>{const{pagination:t,filters:r,posts:s}=e();if(t.hasMore)try{n({loading:!0});const a=t.page+1,l=await da.getPosts({category:r.category,canton:r.canton,therapist:r.therapist,designation:r.designation,dateFrom:r.dateFrom,dateTo:r.dateTo,search:r.search});n({posts:[...s,...l],pagination:{...t,page:a,hasMore:l.length>=t.limit}})}catch(a){throw console.error("Error loading more posts:",a),a}finally{n({loading:!1})}},loadPost:async t=>{try{n({loading:!0});const r=await da.getPost(t);n({currentPost:r})}catch(r){throw console.error("Error loading post:",r),r}finally{n({loading:!1})}},createPost:async t=>{try{const r=await da.createPost(t);n(s=>({posts:[r,...s.posts]}))}catch(r){throw console.error("Error creating post:",r),r}},updatePost:async(t,r)=>{try{console.log("🔧 ForumStore: Updating post:",t,r),await new fl().updatePost(t,r),console.log("✅ ForumStore: Post updated successfully");const l=await new fl().getPost(t);l&&n(u=>({posts:u.posts.map(d=>d.id===t?l:d),currentPost:u.currentPost?.id===t?l:u.currentPost}))}catch(s){throw console.error("❌ ForumStore: Error updating post:",s),s}},deletePost:async t=>{try{n(r=>({posts:r.posts.filter(s=>s.id!==t),currentPost:r.currentPost?.id===t?null:r.currentPost}))}catch(r){throw console.error("Error deleting post:",r),r}},setFilters:t=>{n(r=>({filters:{...r.filters,...t},pagination:Ho}))},clearFilters:()=>{n({filters:{},pagination:Ho})},loadCategories:async()=>{try{n({categoriesLoading:!0});const t=await da.getCategories();n({categories:t})}catch(t){throw console.error("Error loading categories:",t),t}finally{n({categoriesLoading:!1})}},searchPosts:async t=>{try{n({loading:!0});const r=await da.searchPosts(t);n({posts:r,filters:{...e().filters,search:t},pagination:{...Ho,total:r.length}})}catch(r){throw console.error("Error searching posts:",r),r}finally{n({loading:!1})}}}));hs.getState().loadCategories();const gj=()=>{const n=hs();T.useEffect(()=>{const e=B.channel("posts:realtime").on("postgres_changes",{event:"INSERT",schema:"public",table:"posts",filter:"is_published=eq.true"},async t=>{const r=t.new,{filters:s}=hs.getState();let a=!0;if(s.category&&r.category_id!==s.category&&(a=!1),a){const{data:l}=await B.from("posts").select(`
                *,
                users!inner(id, username, avatar_url, role),
                categories!inner(id, name_de, name_fr, name_it),
                therapists(*)
              `).eq("id",r.id).single();if(l){const u=hs.getState().posts;hs.setState({posts:[l,...u]})}}}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"posts"},async t=>{const r=t.new,{data:s}=await B.from("posts").select(`
              *,
              users!inner(id, username, avatar_url, role),
              categories!inner(id, name_de, name_fr, name_it),
              therapists(*)
            `).eq("id",r.id).single();s&&n.updatePost(r.id,s)}).on("postgres_changes",{event:"DELETE",schema:"public",table:"posts"},t=>{const r=t.old;n.deletePost(r.id)}).subscribe();return()=>{B.removeChannel(e)}},[n])};async function yj(){try{console.log("🔍 Testing Supabase connection...");const{error:n}=await B.from("categories").select("count").limit(1);if(n)return console.error("❌ Health check failed:",n),!1;console.log("✅ Health check passed");const{data:e,error:t}=await B.from("categories").select("*").limit(5);t?console.error("❌ Categories query failed:",t):(console.log("✅ Categories found:",e?.length||0),console.log("📊 Sample categories:",e));const{data:r,error:s}=await B.from("users").select("*").limit(5);s?console.error("❌ Users query failed:",s):console.log("✅ Users found:",r?.length||0);const{data:a,error:l}=await B.from("posts").select("*").limit(5);l?console.error("❌ Posts query failed:",l):console.log("✅ Posts found:",a?.length||0);const{data:{user:u},error:d}=await B.auth.getUser();return d?console.error("❌ Auth check failed:",d):u?console.log("✅ Authenticated user:",u.email):console.log("ℹ️ No authenticated user"),!0}catch(n){return console.error("💥 Connection test failed:",n),!1}}const bd=()=>{const{user:n,userProfile:e}=Jt();if(!n||!e)return{role:null,isUser:!1,isModerator:!1,isAdmin:!1,canModerate:!1,canAdmin:!1,isBanned:!1,canEditPost:()=>!1,canDeletePost:()=>!1,canEditComment:()=>!1,canDeleteComment:()=>!1,canBanUser:!1,canChangeUserRole:!1,userProfile:null};const t=e.role,r=e.is_banned,s=t==="user",a=t==="moderator",l=t==="admin",u=a||l,d=l;return{role:t,isUser:s,isModerator:a,isAdmin:l,canModerate:u&&!r,canAdmin:d&&!r,isBanned:r,userProfile:e,canEditPost:h=>r?!1:n.id===h||u,canDeletePost:h=>r?!1:n.id===h||u,canEditComment:h=>r?!1:n.id===h||u,canDeleteComment:h=>r?!1:n.id===h||u,canBanUser:u&&!r,canChangeUserRole:d&&!r}};class vw{async getConversations(){const{data:{user:e}}=await B.auth.getUser();if(!e)throw new Error("User not authenticated");const{data:t,error:r}=await B.from("messages").select(`
        *,
        sender:users!messages_sender_id_fkey(id, username, avatar_url),
        receiver:users!messages_receiver_id_fkey(id, username, avatar_url)
      `).or(`sender_id.eq.${e.id},receiver_id.eq.${e.id}`).order("created_at",{ascending:!1});if(r){if(console.error("Error fetching conversations:",r),r.code==="PGRST116"||r.message.includes('relation "public.messages" does not exist'))return console.warn("Messages table not found - returning empty conversations"),[];throw r}if(!t)return[];const s=new Map;for(const l of t){const u=l.sender_id===e.id?l.receiver_id:l.sender_id,d=l.sender_id===e.id?l.receiver:l.sender;s.has(u)||s.set(u,{participant:d,messages:[],unreadCount:0});const h=s.get(u);h.messages.push(l),l.receiver_id===e.id&&!l.is_read&&h.unreadCount++}const a=[];return s.forEach((l,u)=>{const d=l.messages[0];d&&a.push({id:u,participant:l.participant,lastMessage:d,unreadCount:l.unreadCount,lastActivity:d.created_at})}),a.sort((l,u)=>new Date(u.lastActivity).getTime()-new Date(l.lastActivity).getTime()),a}async getConversationMessages(e){const{data:{user:t}}=await B.auth.getUser();if(!t)throw new Error("User not authenticated");if(await this.isUserBlocked(e,t.id))throw new Error("Cannot view conversation - user has blocked you");const{data:s,error:a}=await B.from("messages").select(`
        *,
        sender:users!messages_sender_id_fkey(id, username, avatar_url),
        receiver:users!messages_receiver_id_fkey(id, username, avatar_url)
      `).or(`and(sender_id.eq.${t.id},receiver_id.eq.${e}),and(sender_id.eq.${e},receiver_id.eq.${t.id})`).order("created_at",{ascending:!0});if(a){if(console.error("Error fetching conversation messages:",a),a.code==="PGRST116"||a.message.includes('relation "public.messages" does not exist'))return console.warn("Messages table not found - returning empty messages"),[];throw a}return s||[]}async sendMessage(e){const{data:{user:t}}=await B.auth.getUser();if(!t)throw new Error("User not authenticated");const{data:r,error:s}=await B.from("users").select("messages_active").eq("id",e.receiver_id).single();if(s)throw console.error("Error checking recipient:",s),new Error("Unable to send message - recipient not found");if(!r.messages_active)throw new Error("User has disabled private messages");const[a,l]=await Promise.all([this.isUserBlocked(e.receiver_id,t.id),this.isUserBlocked(t.id,e.receiver_id)]);if(a||l)throw new Error("Cannot send message - blocked user");const{data:u,error:d}=await B.from("messages").insert([{sender_id:t.id,receiver_id:e.receiver_id,content:e.content,post_messages_id:e.post_messages_id||null,is_read:!1}]).select().single();if(d)throw console.error("Error sending message:",d),d.code==="PGRST116"||d.message.includes('relation "public.messages" does not exist')?new Error("Messaging system is not available"):d;return await this.createMessageNotification(u,e.receiver_id),u}async markMessagesAsRead(e){const{data:{user:t}}=await B.auth.getUser();if(!t)throw new Error("User not authenticated");const{error:r}=await B.from("messages").update({is_read:!0}).eq("sender_id",e).eq("receiver_id",t.id).eq("is_read",!1);if(r){if(console.error("Error marking messages as read:",r),r.code==="PGRST116"||r.message.includes('relation "public.messages" does not exist')){console.warn("Messages table not found - cannot mark as read");return}throw r}}async getUnreadMessageCount(){const{data:{user:e}}=await B.auth.getUser();if(!e)return 0;const{count:t,error:r}=await B.from("messages").select("*",{count:"exact",head:!0}).eq("receiver_id",e.id).eq("is_read",!1);return r?(console.error("Error getting unread count:",r),(r.code==="PGRST116"||r.message.includes('relation "public.messages" does not exist'))&&console.warn("Messages table not found - returning 0 unread count"),0):t||0}async isUserBlocked(e,t){const{data:r,error:s}=await B.from("user_blocks").select("blocker_id").eq("blocker_id",e).eq("blocked_id",t).single();return s&&s.code!=="PGRST116"?(console.error("Error checking user block status:",s),!1):!!r}async createMessageNotification(e,t){try{const{data:r}=await B.from("users").select("username").eq("id",e.sender_id).single();if(r){const{error:s}=await B.from("notifications").insert([{user_id:t,type:"private_message",title:"New Message",message:`${r.username} sent you a message`,is_read:!1}]);s&&!(s.code==="PGRST116"||s.message.includes('relation "public.notifications" does not exist'))&&console.error("Error creating notification:",s)}}catch(r){console.error("Error creating message notification:",r)}}async deleteMessage(e){const{data:{user:t}}=await B.auth.getUser();if(!t)throw new Error("User not authenticated");const{error:r}=await B.from("messages").delete().eq("id",e).eq("sender_id",t.id);if(r)throw console.error("Error deleting message:",r),r.code==="PGRST116"||r.message.includes('relation "public.messages" does not exist')?new Error("Messaging system is not available"):r}async canMessageUser(e){const{data:{user:t}}=await B.auth.getUser();if(!t)return{canMessage:!1,reason:"Not authenticated"};if(t.id===e)return{canMessage:!1,reason:"Cannot message yourself"};const{data:r,error:s}=await B.from("users").select("messages_active").eq("id",e).single();if(s)return{canMessage:!1,reason:"User not found"};if(!r.messages_active)return{canMessage:!1,reason:"User has disabled private messages"};const[a,l]=await Promise.all([this.isUserBlocked(e,t.id),this.isUserBlocked(t.id,e)]);return a?{canMessage:!1,reason:"User has blocked you"}:l?{canMessage:!1,reason:"You have blocked this user"}:{canMessage:!0}}}class xw{async blockUser(e){const{data:{user:t}}=await B.auth.getUser();if(!t)throw new Error("User not authenticated");if(t.id===e)throw new Error("Cannot block yourself");if(await this.isUserBlocked(e))throw new Error("User is already blocked");const{error:s}=await B.from("user_blocks").insert([{blocker_id:t.id,blocked_id:e,blocked_at:new Date().toISOString()}]);if(s)throw console.error("Error blocking user:",s),s.code==="PGRST116"||s.message.includes('relation "public.user_blocks" does not exist')?new Error("User blocking system is not available"):s;console.log(`User ${e} blocked by ${t.id}`)}async unblockUser(e){const{data:{user:t}}=await B.auth.getUser();if(!t)throw new Error("User not authenticated");const{error:r}=await B.from("user_blocks").delete().eq("blocker_id",t.id).eq("blocked_id",e);if(r)throw console.error("Error unblocking user:",r),r.code==="PGRST116"||r.message.includes('relation "public.user_blocks" does not exist')?new Error("User blocking system is not available"):r;console.log(`User ${e} unblocked by ${t.id}`)}async isUserBlocked(e){const{data:{user:t}}=await B.auth.getUser();if(!t)return!1;const{data:r,error:s}=await B.from("user_blocks").select("blocker_id").eq("blocker_id",t.id).eq("blocked_id",e).single();return s&&s.code!=="PGRST116"?(console.error("Error checking block status:",s),s.message.includes('relation "public.user_blocks" does not exist')&&console.warn("User blocks table not found - returning false"),!1):!!r}async isBlockedBy(e){const{data:{user:t}}=await B.auth.getUser();if(!t)return!1;const{data:r,error:s}=await B.from("user_blocks").select("blocker_id").eq("blocker_id",e).eq("blocked_id",t.id).single();return s&&s.code!=="PGRST116"?(console.error("Error checking if blocked by user:",s),s.message.includes('relation "public.user_blocks" does not exist')&&console.warn("User blocks table not found - returning false"),!1):!!r}async getBlockedUsers(){const{data:{user:e}}=await B.auth.getUser();if(!e)return[];const{data:t,error:r}=await B.from("user_blocks").select(`
        blocked_at,
        blocked_user:users!user_blocks_blocked_id_fkey(
          id,
          username,
          avatar_url
        )
      `).eq("blocker_id",e.id).order("blocked_at",{ascending:!1});if(r){if(console.error("Error fetching blocked users:",r),r.code==="PGRST116"||r.message.includes('relation "public.user_blocks" does not exist'))return console.warn("User blocks table not found - returning empty list"),[];throw r}return t?t.map(s=>({id:s.blocked_user.id,username:s.blocked_user.username,avatar_url:s.blocked_user.avatar_url,blocked_at:s.blocked_at})):[]}async getBlockedUsersCount(){const{data:{user:e}}=await B.auth.getUser();if(!e)return 0;const{count:t,error:r}=await B.from("user_blocks").select("*",{count:"exact",head:!0}).eq("blocker_id",e.id);return r?(console.error("Error getting blocked users count:",r),(r.code==="PGRST116"||r.message.includes('relation "public.user_blocks" does not exist'))&&console.warn("User blocks table not found - returning 0 count"),0):t||0}async checkBlockRelationship(e,t){const[r,s]=await Promise.all([B.from("user_blocks").select("blocker_id").eq("blocker_id",e).eq("blocked_id",t).single(),B.from("user_blocks").select("blocker_id").eq("blocker_id",t).eq("blocked_id",e).single()]);return{user1BlockedUser2:!!r.data,user2BlockedUser1:!!s.data}}async toggleBlockUser(e){return await this.isUserBlocked(e)?(await this.unblockUser(e),{action:"unblocked"}):(await this.blockUser(e),{action:"blocked"})}}const On=Tl((n,e)=>({conversations:[],currentConversation:null,currentMessages:[],unreadCount:0,loading:!1,loadingMessages:!1,initialized:!1,messagesService:new vw,userBlocksService:new xw,loadConversations:async()=>{n({loading:!0});try{const{messagesService:t}=e(),r=await t.getConversations();n({conversations:r})}catch(t){console.error("Error loading conversations:",t)}finally{n({loading:!1})}},loadConversationMessages:async t=>{n({loadingMessages:!0});try{const{messagesService:r}=e(),s=await r.getConversationMessages(t);n({currentMessages:s}),await r.markMessagesAsRead(t),e().loadUnreadCount();const{conversations:a}=e(),l=a.map(u=>u.id===t?{...u,unreadCount:0}:u);n({conversations:l})}catch(r){console.error("Error loading conversation messages:",r)}finally{n({loadingMessages:!1})}},sendMessage:async t=>{try{const{messagesService:r}=e(),s=await r.sendMessage(t);if(e().currentConversation?.id===t.receiver_id){const{currentMessages:a}=e(),l={...s,sender:{id:s.sender_id,username:"You",avatar_url:null}};n({currentMessages:[...a,l]})}e().loadConversations()}catch(r){throw console.error("Error sending message:",r),r}},markMessagesAsRead:async t=>{try{const{messagesService:r}=e();await r.markMessagesAsRead(t),e().loadUnreadCount();const{conversations:s}=e(),a=s.map(l=>l.id===t?{...l,unreadCount:0}:l);n({conversations:a})}catch(r){console.error("Error marking messages as read:",r)}},setCurrentConversation:t=>{n({currentConversation:t,currentMessages:[]}),t&&e().loadConversationMessages(t.id)},loadUnreadCount:async()=>{try{const{messagesService:t}=e(),r=await t.getUnreadMessageCount();n({unreadCount:r})}catch(t){console.error("Error loading unread count:",t)}},deleteMessage:async t=>{try{const{messagesService:r}=e();await r.deleteMessage(t);const{currentMessages:s}=e(),a=s.filter(l=>l.id!==t);n({currentMessages:a}),e().loadConversations()}catch(r){throw console.error("Error deleting message:",r),r}},findOrCreateConversation:async(t,r)=>{const{conversations:s}=e(),a=s.find(u=>u.id===t);if(a)return a;const l={id:t,participant:{id:r.id||t,username:r.username||"Unknown User",avatar_url:r.avatar_url||null},lastMessage:{id:0,sender_id:"",receiver_id:"",content:"",created_at:new Date().toISOString(),is_read:!1,post_messages_id:null},unreadCount:0,lastActivity:new Date().toISOString()};return n({conversations:[l,...s]}),l},updateConversationLastMessage:async t=>{const{conversations:r}=e(),{data:{user:s}}=await B.auth.getUser();if(!s)return;const a=t.sender_id===s.id?t.receiver_id:t.sender_id,l=r.map(u=>u.id===a?{...u,lastMessage:t,lastActivity:t.created_at,unreadCount:t.receiver_id===s.id&&!t.is_read?u.unreadCount+1:u.unreadCount}:u);l.sort((u,d)=>new Date(d.lastActivity).getTime()-new Date(u.lastActivity).getTime()),n({conversations:l})},subscribeToMessages:async()=>{const{data:{user:t}}=await B.auth.getUser();if(!t)return;const r=t.id;B.channel("messages-realtime").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`receiver_id=eq.${r}`},s=>{console.log("New message received:",s);const a=s.new;e().updateConversationLastMessage(a),e().loadUnreadCount();const{currentConversation:l}=e();l?.id===a.sender_id&&e().loadConversationMessages(l.id)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"messages",filter:`receiver_id=eq.${r}`},s=>{console.log("Message updated:",s);const a=s.new,{currentMessages:l}=e(),u=l.map(d=>d.id===a.id?{...d,...a}:d);n({currentMessages:u})}).subscribe()},unsubscribeFromMessages:()=>{B.removeAllChannels()}}));let lx=!1;const bj=()=>{lx||(lx=!0,B.auth.onAuthStateChange(async(n,e)=>{if(n==="SIGNED_IN"&&e?.user){const t=On.getState();t.initialized||(t.loadConversations(),t.loadUnreadCount(),await t.subscribeToMessages(),On.setState({initialized:!0}))}else n==="SIGNED_OUT"&&(On.getState().unsubscribeFromMessages(),On.setState({conversations:[],currentConversation:null,currentMessages:[],unreadCount:0,initialized:!1}))}))},cx=({className:n="",showLabel:e=!1})=>{const t=Ra(),{unreadCount:r}=On(),s=()=>{t("/messages")};return p.jsxs("button",{onClick:s,className:`relative inline-flex items-center text-gray-300 hover:text-white transition-colors ${n}`,title:"Messages",children:[p.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),e&&p.jsx("span",{className:"ml-2 text-sm",children:"Messages"}),r>0&&p.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-bold",children:r>99?"99+":r})]})};class xa{static BUCKET_NAME="avatars";static MAX_FILE_SIZE=5*1024*1024;static ALLOWED_TYPES=["image/jpeg","image/png","image/webp","image/gif"];static async uploadAvatar(e,t){if(console.log(`Starting avatar upload for user ${e}, file:`,{name:t.name,type:t.type,size:t.size}),!this.ALLOWED_TYPES.includes(t.type))throw new Error("Invalid file type. Please upload a JPEG, PNG, WebP, or GIF image.");if(t.size>this.MAX_FILE_SIZE)throw new Error("File size too large. Please upload an image smaller than 5MB.");const r=t.name.split(".").pop(),s=`${e}-${Date.now()}.${r}`,a=`${e}/${s}`;console.log(`Uploading to path: ${a}`);try{console.log("Attempting file upload...");const{data:l,error:u}=await B.storage.from(this.BUCKET_NAME).upload(a,t,{cacheControl:"3600",upsert:!0});if(u)throw console.error("Upload error details:",u),u.message.includes("Bucket not found")?new Error('Avatar storage is not set up. Please contact the administrator to create the "avatars" storage bucket in Supabase.'):u.message.includes("new row violates row-level security")?new Error("Permission denied. Please ensure the storage policies are set up correctly."):new Error(`Upload failed: ${u.message}`);console.log("Upload successful:",l);const{data:{publicUrl:d}}=B.storage.from(this.BUCKET_NAME).getPublicUrl(a);console.log("Generated public URL:",d),console.log("Updating user profile...");const{error:h}=await B.from("users").update({avatar_url:d,updated_at:new Date().toISOString()}).eq("id",e);if(h)throw console.error("Profile update error:",h),new Error(`Failed to update profile: ${h.message}`);return console.log("Avatar upload completed successfully"),d}catch(l){throw console.error("Avatar upload error:",l),l}}static async deleteAvatar(e,t){try{const r=t.split("/"),s=r[r.length-1],a=`${e}/${s}`,{error:l}=await B.storage.from(this.BUCKET_NAME).remove([a]);l&&console.error("Error deleting avatar file:",l);const{error:u}=await B.from("users").update({avatar_url:null,updated_at:new Date().toISOString()}).eq("id",e);if(u)throw new Error(`Failed to update profile: ${u.message}`)}catch(r){throw console.error("Avatar deletion error:",r),r}}static getDefaultAvatar(e){const t=e.charAt(0).toUpperCase(),r=e.charCodeAt(0)%6;return`data:image/svg+xml,${encodeURIComponent(`
      <svg width="120" height="120" xmlns="http://www.w3.org/2000/svg">
        <rect width="120" height="120" fill="${["#37a653","#2563eb","#dc2626","#ea580c","#7c3aed","#0891b2"][r]}"/>
        <text x="60" y="75" text-anchor="middle" fill="white" font-size="48" font-family="Arial, sans-serif" font-weight="bold">
          ${t}
        </text>
      </svg>
    `)}`}static async createAvatarBucket(){const{error:e}=await B.storage.createBucket(this.BUCKET_NAME,{public:!0,allowedMimeTypes:this.ALLOWED_TYPES,fileSizeLimit:this.MAX_FILE_SIZE});if(e&&!e.message.includes("already exists"))throw new Error(`Failed to create avatar bucket: ${e.message}`)}}const sn=({user:n,size:e="medium",showUpload:t=!1,className:r=""})=>{const[s,a]=T.useState(!1),[l,u]=T.useState(null),d=T.useRef(null),{updateProfile:h}=Jt(),m={small:{width:"1.6rem",height:"1.6rem"},medium:{width:"4rem",height:"4rem"},large:{width:"8rem",height:"8rem"}},y=n.avatar_url||xa.getDefaultAvatar(n.username),v=_=>"email"in _&&"role"in _,x=async _=>{const N=_.target.files?.[0];if(!(!N||!v(n))){a(!0),u(null);try{const M=await xa.uploadAvatar(n.id,N);await h({avatar_url:M})}catch(M){console.error("Avatar upload error:",M),u(M instanceof Error?M.message:"Failed to upload avatar")}finally{a(!1),d.current&&(d.current.value="")}}},w=async()=>{if(!(!n.avatar_url||!v(n))){a(!0),u(null);try{await xa.deleteAvatar(n.id,n.avatar_url),await h({avatar_url:null})}catch(_){console.error("Avatar deletion error:",_),u(_ instanceof Error?_.message:"Failed to remove avatar")}finally{a(!1)}}},k=()=>{t&&!s&&v(n)&&d.current&&d.current.click()};return p.jsxs("div",{className:`relative ${r}`,children:[p.jsxs("div",{className:`
          rounded-full overflow-hidden shadow-lg group
          ${t&&v(n)?"cursor-pointer hover:opacity-80 transition-opacity duration-200":""}
          ${s?"opacity-50":""}
        `,style:m[e],onClick:k,children:[p.jsx("img",{src:y,alt:`${n.username}'s avatar`,className:"w-full h-full object-cover bg-gray-200",onLoad:()=>console.log("Avatar loaded successfully:",y),onError:_=>{console.error("Avatar failed to load:",y);const N=_.target;N.src=xa.getDefaultAvatar(n.username)}}),!1,s&&p.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center",children:p.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#37a653]"})})]}),t&&v(n)&&p.jsx("input",{ref:d,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:x,className:"hidden"}),t&&v(n)&&n.avatar_url&&e==="large"&&p.jsx("button",{onClick:w,disabled:s,className:"absolute -top-2 -right-2 bg-red-500 hover:bg-red-600 text-white rounded-full p-2 shadow-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Remove avatar",children:p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),t&&v(n)&&e==="large"&&p.jsx("div",{className:"absolute -bottom-8 left-1/2 transform -translate-x-1/2",children:p.jsx("p",{className:"text-xs text-gray-500 text-center whitespace-nowrap",children:"Click to change avatar"})}),l&&p.jsxs("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded text-sm whitespace-nowrap",children:[l,p.jsx("button",{onClick:()=>u(null),className:"ml-2 text-red-500 hover:text-red-700",children:"×"})]})]})},vj=({onCreatePost:n,showCreatePostButton:e=!0})=>{const{user:t,userProfile:r,logout:s}=Jt(),a=bd(),{unreadCount:l,loadNotifications:u}=bw(),{unreadCount:d}=On(),[h,m]=T.useState(!1),y=l+d;T.useEffect(()=>{t&&u()},[t,u]);const v=async()=>{await s()};return p.jsx("nav",{className:"bg-[#1a3442] md:bg-white",children:p.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[p.jsxs("div",{className:"flex justify-between items-center h-16",children:[p.jsx("div",{className:"flex items-center",children:p.jsxs(vt,{to:"/",className:"flex items-center space-x-3",children:[p.jsx("h1",{className:"font-headline font-bold text-[#37a653] md:text-primary-600",style:{fontSize:"39px"},children:"REMY"}),p.jsxs("div",{className:"text-white md:text-gray-500 leading-tight text-left uppercase",style:{fontSize:"8px"},children:[p.jsx("div",{children:"FORUM FÜR"}),p.jsx("div",{children:"MENSCHEN IN"}),p.jsx("div",{children:"PSYCHOTHERAPIE"})]})]})}),p.jsxs("div",{className:"hidden md:flex items-center space-x-4",children:[p.jsxs("div",{className:"flex items-center space-x-6",children:[p.jsx(vt,{to:"/",className:"text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"🏠 Forum"}),p.jsx(vt,{to:"/therapists",className:"text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"👩‍⚕️ Therapeuten"}),t&&p.jsx(cx,{className:"text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors",showLabel:!0}),a.canModerate&&p.jsxs(p.Fragment,{children:[p.jsx(vt,{to:"/admin/moderation",className:"text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"🛡️ Moderation"}),a.isAdmin&&p.jsx(vt,{to:"/admin",className:"text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"⚙️ Admin"})]})]}),e&&p.jsxs("button",{onClick:n,className:"bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-lg font-medium transition-all transform hover:scale-105 shadow-md flex items-center space-x-2",style:{backgroundColor:"#0284c7",boxShadow:"0 2px 4px -1px rgba(0, 0, 0, 0.1)"},children:[p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),p.jsx("span",{children:"Beitrag erstellen"})]}),t?p.jsxs("div",{className:"flex items-center space-x-3",children:[p.jsxs(vt,{to:"/profile",className:"flex items-center space-x-2 text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors",children:[r&&p.jsx(sn,{user:r,size:"small"}),p.jsx("span",{className:"hidden lg:inline",children:"Profil"})]}),p.jsx("button",{onClick:v,className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-md text-sm font-medium transition-colors",children:"Abmelden"})]}):p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx(vt,{to:"/login",className:"text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium",children:"Anmelden"}),p.jsx(vt,{to:"/register",className:"bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors",children:"Registrieren"})]})]}),p.jsx("div",{className:"md:hidden",children:t?p.jsxs("button",{onClick:()=>m(!h),className:"relative p-1 rounded-full transition-colors",children:[r&&p.jsx(sn,{user:r,size:"small"}),y>0&&p.jsx("div",{className:"absolute -top-1 -right-1 bg-red-400 text-white font-bold rounded-full w-5 h-5 flex items-center justify-center min-w-[1.25rem]",style:{fontSize:"0.65rem"},children:y>99?"99+":y})]}):p.jsx("button",{onClick:()=>m(!h),className:"text-[#37a653] hover:text-[#2e8844] p-2 rounded-md transition-colors",children:p.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h?p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})})]}),h&&p.jsx("div",{className:"md:hidden border-t border-[#2a4a57] py-4",children:p.jsxs("div",{className:"flex flex-col space-y-2",children:[p.jsx(vt,{to:"/",className:"text-gray-300 hover:text-[#37a653] px-4 py-3 rounded-md text-base font-medium transition-colors",onClick:()=>m(!1),children:"🏠 Forum"}),p.jsx(vt,{to:"/therapists",className:"text-gray-300 hover:text-[#37a653] px-4 py-3 rounded-md text-base font-medium transition-colors",onClick:()=>m(!1),children:"👩‍⚕️ Therapeuten"}),t&&p.jsx("div",{className:"px-4 py-3",onClick:()=>m(!1),children:p.jsx(cx,{className:"text-gray-300 hover:text-[#37a653] text-base font-medium transition-colors",showLabel:!0})}),a.canModerate&&p.jsxs(p.Fragment,{children:[p.jsx(vt,{to:"/admin/moderation",className:"text-gray-300 hover:text-[#37a653] px-4 py-3 rounded-md text-base font-medium transition-colors",onClick:()=>m(!1),children:"🛡️ Moderation"}),a.isAdmin&&p.jsx(vt,{to:"/admin",className:"text-gray-300 hover:text-[#37a653] px-4 py-3 rounded-md text-base font-medium transition-colors",onClick:()=>m(!1),children:"⚙️ Admin"})]}),e&&p.jsxs("button",{onClick:()=>{n(),m(!1)},className:"mx-4 mt-2 bg-[#37a653] hover:bg-[#2e8844] text-white px-4 py-3 rounded-lg font-medium transition-colors flex items-center space-x-2",children:[p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),p.jsx("span",{children:"Beitrag erstellen"})]}),t?p.jsxs("div",{className:"border-t border-[#2a4a57] mt-4 pt-4",children:[p.jsxs("div",{className:"flex items-center px-4 py-2 text-sm text-gray-300",children:[r&&p.jsx("div",{className:"mr-3",children:p.jsx(sn,{user:r,size:"small"})}),p.jsx("span",{children:t.email})]}),p.jsx(vt,{to:"/profile",className:"block text-gray-300 hover:text-[#37a653] px-4 py-3 rounded-md text-base font-medium transition-colors",onClick:()=>m(!1),children:"👤 Profil"}),p.jsx("button",{onClick:()=>{v(),m(!1)},className:"w-full text-left text-gray-300 hover:text-red-400 px-4 py-3 rounded-md text-base font-medium transition-colors",children:"🚪 Abmelden"})]}):p.jsxs("div",{className:"border-t border-[#2a4a57] mt-4 pt-4 flex flex-col space-y-2 px-4",children:[p.jsx(vt,{to:"/login",className:"text-center bg-[#2a4a57] hover:bg-[#37a653] text-gray-300 hover:text-white px-4 py-3 rounded-md text-base font-medium transition-colors",onClick:()=>m(!1),children:"Anmelden"}),p.jsx(vt,{to:"/register",className:"text-center bg-[#37a653] hover:bg-[#2e8844] text-white px-4 py-3 rounded-md text-base font-medium transition-colors",onClick:()=>m(!1),children:"Registrieren"})]})]})})]})})},xj=({children:n,onCreatePost:e=()=>{},showCreatePostButton:t=!0})=>p.jsxs("div",{className:"min-h-screen bg-gray-50",children:[p.jsx(vj,{onCreatePost:e,showCreatePostButton:t}),p.jsx("main",{className:"flex-1",children:n}),p.jsx("footer",{className:"bg-white border-t border-gray-200 mt-auto",children:p.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wider mb-4",children:"Über Remy Forum"}),p.jsx("p",{className:"text-gray-600 text-sm",children:"Eine sichere Community für Psychotherapie-Patienten zum Austausch von Erfahrungen und gegenseitiger Unterstützung."})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wider mb-4",children:"Hilfreiche Links"}),p.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[p.jsx("li",{children:p.jsx("a",{href:"#",className:"hover:text-primary-600 transition-colors",children:"📋 Community-Regeln"})}),p.jsx("li",{children:p.jsx("a",{href:"#",className:"hover:text-primary-600 transition-colors",children:"🔒 Datenschutz"})}),p.jsx("li",{children:p.jsx("a",{href:"#",className:"hover:text-primary-600 transition-colors",children:"📞 Krisenhilfe"})}),p.jsx("li",{children:p.jsx("a",{href:"#",className:"hover:text-primary-600 transition-colors",children:"❓ FAQ"})})]})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wider mb-4",children:"Kontakt & Support"}),p.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[p.jsx("li",{children:p.jsx("a",{href:"mailto:support@remy-forum.ch",className:"hover:text-primary-600 transition-colors",children:"✉️ Support kontaktieren"})}),p.jsx("li",{children:p.jsx("a",{href:"#",className:"hover:text-primary-600 transition-colors",children:"🚨 Problem melden"})}),p.jsx("li",{children:p.jsx("a",{href:"#",className:"hover:text-primary-600 transition-colors",children:"💡 Feedback geben"})})]})]})]}),p.jsx("div",{className:"border-t border-gray-200 mt-8 pt-6",children:p.jsxs("p",{className:"text-center text-sm text-gray-500",children:["© 2024 Remy Forum. Alle Rechte vorbehalten.",p.jsx("span",{className:"mx-2",children:"•"}),"Behandle andere respektvoll und teile keine persönlichen Daten."]})})]})})]});function wj(n){const e=[];n.form_of_address&&e.push(n.form_of_address),e.push(n.first_name),e.push(n.last_name);const t=e.join(" "),r=[];n.designation&&r.push(n.designation),n.institution&&r.push(n.institution);let s=t;return r.length>0&&(s+=` ${r.join(", ")}`),n.canton&&(s+=` und ${n.canton}`),s}function Sj(n){return`Erfahrung mit ${wj(n)}`}function kj(n,e){return n===1&&!!e}function _u(n){return kj(n.category_id,n.therapists)?Sj(n.therapists):n.title}class Vm{async getComments(e){const{data:t,error:r}=await B.from("comments").select(`
        *,
        users!comments_user_id_fkey(id, username, avatar_url, role)
      `).eq("post_id",e).order("created_at",{ascending:!0});if(r)throw console.error("Error fetching comments:",r),r;return t||[]}async getReplies(e){return console.log("⚠️ Threaded comments not supported in current schema"),[]}async createComment(e){const{data:{user:t}}=await B.auth.getUser();if(!t)throw new Error("User not authenticated");const r={post_id:e.post_id,content:e.content,user_id:t.id},{data:s,error:a}=await B.from("comments").insert([r]).select().single();if(a)throw console.error("Error creating comment:",a),a;return s}async updateComment(e,t){const{data:{user:r}}=await B.auth.getUser();if(!r)throw new Error("User not authenticated");const{data:s,error:a}=await B.from("comments").update({content:t}).eq("id",e).eq("user_id",r.id).select().single();if(a)throw console.error("Error updating comment:",a),a;return s}async deleteComment(e){const{data:{user:t}}=await B.auth.getUser();if(!t)throw new Error("User not authenticated");const{error:r}=await B.from("comments").delete().eq("id",e).eq("user_id",t.id);if(r)throw console.error("Error deleting comment:",r),r}async getCommentCount(e){const{count:t,error:r}=await B.from("comments").select("*",{count:"exact",head:!0}).eq("post_id",e);if(r)throw console.error("Error getting comment count:",r),r;return t||0}}const tu=new Vm,ww=(n,e)=>e.parent_comment_id?n.map(t=>t.id===e.parent_comment_id?{...t,replies:t.replies?[e,...t.replies]:[e]}:t.replies?{...t,replies:ww(t.replies,e)}:t):[e,...n],Sw=(n,e,t)=>n.map(r=>r.id===e?{...r,...t}:r.replies?{...r,replies:Sw(r.replies,e,t)}:r),kw=(n,e)=>n.filter(t=>t.id!==e).map(t=>t.replies?{...t,replies:kw(t.replies,e)}:t),_w=n=>n.reduce((e,t)=>{let r=1;return t.replies&&(r+=_w(t.replies)),e+r},0),Fm=Tl((n,e)=>({comments:{},loading:{},loadComments:async t=>{const r=t.toString();try{n(a=>({loading:{...a.loading,[r]:!0}}));const s=await tu.getComments(t);n(a=>({comments:{...a.comments,[r]:s}}))}catch(s){throw console.error("Error loading comments:",s),s}finally{n(s=>({loading:{...s.loading,[r]:!1}}))}},addComment:(t,r)=>{const s=t.toString();n(a=>{const l=a.comments[s]||[],u=ww(l,r);return{comments:{...a.comments,[s]:u}}})},addCommentOptimistic:(t,r)=>{e().addComment(t,r)},updateComment:(t,r,s)=>{const a=t.toString();n(l=>{const u=l.comments[a]||[],d=Sw(u,r,s);return{comments:{...l.comments,[a]:d}}})},deleteComment:(t,r)=>{const s=t.toString();n(a=>{const l=a.comments[s]||[],u=kw(l,r);return{comments:{...a.comments,[s]:u}}})},createComment:async t=>{try{const r=await tu.createComment(t);return e().addComment(t.post_id,r),r}catch(r){throw console.error("Error creating comment:",r),r}},editComment:async(t,r)=>{try{await tu.updateComment(t,r);const{comments:s}=e();for(const[a,l]of Object.entries(s)){const u=parseInt(a);e().updateComment(u,t,{content:r,is_edited:!0,updated_at:new Date().toISOString()})}}catch(s){throw console.error("Error editing comment:",s),s}},removeComment:async t=>{try{await tu.deleteComment(t);const{comments:r}=e();for(const[s,a]of Object.entries(r)){const l=parseInt(s);e().deleteComment(l,t)}}catch(r){throw console.error("Error removing comment:",r),r}},getCommentCount:t=>{const r=t.toString(),s=e().comments[r]||[];return _w(s)}}));class Ew{async getUsers(e=50,t=0){const{data:r,error:s}=await B.from("users").select("*").range(t,t+e-1).order("created_at",{ascending:!1});if(s)throw s;return r||[]}async getUsersByRole(e){const{data:t,error:r}=await B.from("users").select("*").eq("role",e).order("created_at",{ascending:!1});if(r)throw r;return t||[]}async updateUserRole(e,t){const{error:r}=await B.from("users").update({role:t,updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r}async banUser(e,t){const{error:r}=await B.from("users").update({is_banned:!0,updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r}async unbanUser(e){const{error:t}=await B.from("users").update({is_banned:!1,updated_at:new Date().toISOString()}).eq("id",e);if(t)throw t}async deletePost(e,t){await B.from("comments").delete().eq("post_id",e);const{error:r}=await B.from("posts").delete().eq("id",e);if(r)throw r}async deleteComment(e,t){const{error:r}=await B.from("comments").delete().eq("id",e);if(r)throw r}async editPost(e,t,r){const{error:s}=await B.from("posts").update({...t,updated_at:new Date().toISOString()}).eq("id",e);if(s)throw s}async editComment(e,t,r){const{error:s}=await B.from("comments").update({content:t,updated_at:new Date().toISOString()}).eq("id",e);if(s)throw s}async getReportedContent(){return[]}async checkUserPermissions(e){const{data:t,error:r}=await B.from("users").select("role, is_banned").eq("id",e).single();if(r)throw r;const s=t.role;return{role:s,canModerate:s==="moderator"||s==="admin",canAdmin:s==="admin",isBanned:t.is_banned}}async getModerationStats(){const[e,t,r,s,a,l]=await Promise.all([B.from("users").select("id",{count:"exact",head:!0}),B.from("users").select("id",{count:"exact",head:!0}).eq("is_banned",!0),B.from("users").select("id",{count:"exact",head:!0}).eq("role","moderator"),B.from("users").select("id",{count:"exact",head:!0}).eq("role","admin"),B.from("posts").select("id",{count:"exact",head:!0}),B.from("comments").select("id",{count:"exact",head:!0})]);return{totalUsers:e.count||0,bannedUsers:t.count||0,moderators:r.count||0,admins:s.count||0,totalPosts:a.count||0,totalComments:l.count||0}}}const _j=({contentType:n,contentId:e,contentUserId:t,onContentDeleted:r,className:s=""})=>{const a=bd(),[l,u]=T.useState(!1),[d,h]=T.useState(!1),m=new Ew;if(!a.canEditPost(t)&&!a.canDeletePost(t))return null;const y=async()=>{if(confirm(`Sind Sie sicher, dass Sie ${n==="post"?"diesen Beitrag":"diesen Kommentar"} löschen möchten?`)){h(!0);try{n==="post"?await m.deletePost(e,"Moderator deletion"):await m.deleteComment(e,"Moderator deletion"),r?.(),u(!1)}catch(x){console.error(`Error deleting ${n}:`,x),alert(`Fehler beim Löschen ${n==="post"?"des Beitrags":"des Kommentars"}`)}finally{h(!1)}}};return p.jsxs("div",{className:`relative ${s}`,children:[p.jsx("button",{onClick:()=>u(!l),className:"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 p-1 rounded transition-colors",title:"Moderation",children:p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})}),l&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>u(!1)}),p.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-md shadow-lg py-1 z-20 min-w-32",children:[a.canDeletePost(t)&&p.jsxs("button",{onClick:y,disabled:d,className:"w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center disabled:opacity-50",children:[p.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),d?"Löschen...":"Löschen"]}),a.canModerate&&a.role!=="user"&&p.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 mt-1 pt-1",children:p.jsxs("div",{className:"px-3 py-2 text-xs text-gray-500 dark:text-gray-400",children:["Moderation: ",a.role==="admin"?"Admin":"Moderator"]})})]})]})]})},Nw=({recipientId:n,recipientUsername:e,postTitle:t,postId:r,className:s="",variant:a="default"})=>{const l=Ra(),{user:u}=Jt(),{findOrCreateConversation:d,setCurrentConversation:h}=On(),[m,y]=T.useState({canMessage:!1}),[v,x]=T.useState(!0),w=new vw;T.useEffect(()=>{k()},[n,u]);const k=async()=>{if(!u||!n){x(!1);return}try{const N=await w.canMessageUser(n);y(N)}catch(N){console.error("Error checking messaging permission:",N),y({canMessage:!1,reason:"Error checking permissions"})}finally{x(!1)}},_=async()=>{if(!(!u||!m.canMessage))try{const N=await d(n,{id:n,username:e});h(N);const M=new URLSearchParams;t&&r&&(M.set("postTitle",t),M.set("postId",r.toString()));const C=M.toString();l(`/messages?${C}`)}catch(N){console.error("Error starting conversation:",N),alert("Fehler beim Öffnen der Unterhaltung")}};return v?p.jsx("div",{className:"animate-pulse",children:p.jsx("div",{className:"h-8 w-20 bg-gray-600 rounded"})}):m.canMessage?a==="icon-only"?p.jsx("button",{onClick:_,className:`inline-flex items-center justify-center p-2 text-gray-300 hover:text-white transition-colors ${s}`,title:`Send message to ${e}`,children:p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}):a==="small"?p.jsxs("button",{onClick:_,className:`inline-flex items-center space-x-1 px-2 py-1 text-xs text-gray-300 hover:text-white transition-colors border border-gray-600 hover:border-gray-500 rounded ${s}`,children:[p.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),p.jsx("span",{children:"Message"})]}):p.jsxs("button",{onClick:_,className:`inline-flex items-center space-x-2 px-3 py-2 text-sm text-gray-300 hover:text-white transition-colors border border-gray-600 hover:border-gray-500 rounded-md ${s}`,children:[p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),p.jsx("span",{children:"Send Message"})]}):(m.reason,null)},Ej=({post:n,onClick:e})=>{const t=Ra(),{user:r}=Jt(),{getCommentCount:s,loadComments:a}=Fm(),l=s(n.id);T.useEffect(()=>{a(n.id)},[n.id,a]);const u=()=>{e?e():t(`/post/${n.id}`)},d=m=>new Date(m).toLocaleDateString("de-DE",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),h=m=>({1:"bg-[#37a653] text-white",2:"bg-[#37a653] text-white",3:"bg-[#37a653] text-white",4:"bg-[#37a653] text-white",5:"bg-[#37a653] text-white"})[m]||"bg-[#37a653] text-white";return p.jsxs("div",{className:"bg-[#203f4a] p-6 mb-4 hover:bg-[#234652] transition-colors cursor-pointer",style:{borderRadius:"20px"},onClick:u,children:[p.jsxs("div",{className:"flex items-start justify-between mb-4",children:[p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-lg font-medium ${h(n.category_id)}`,style:{fontSize:"0.65rem"},children:n.categories?.name_de}),n.canton&&p.jsx("img",{src:`/kantone/${n.canton.toLowerCase()}.png`,alt:`${n.canton} flag`,className:"w-4 h-auto object-cover",onError:m=>{m.target.style.display="none"}}),n.canton&&p.jsx("span",{className:"text-gray-300 text-xs font-medium",children:n.canton}),n.is_banned&&p.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-lg font-medium bg-red-600 text-white text-xs",children:"ABGELEHNT"})]}),p.jsxs("div",{className:"relative flex items-center",children:[p.jsx("div",{className:"relative bg-[#37a653] rounded-full p-1.5",children:p.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),l>0&&p.jsx("div",{className:"absolute -top-1 -right-1 bg-red-400 text-white font-bold rounded-full w-4 h-4 flex items-center justify-center min-w-[1rem]",style:{fontSize:"0.6rem"},children:l>99?"99+":l})]})]}),p.jsxs("div",{className:"flex items-start space-x-3 mb-4",children:[n.users&&p.jsx(sn,{user:n.users,size:"small",className:"flex-shrink-0"}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("p",{className:"font-medium text-white text-xs text-left leading-none",children:n.users?.username}),p.jsx("p",{className:"text-xs text-gray-300 text-left leading-none mt-0.5",style:{fontSize:"0.65rem"},children:d(n.created_at)})]}),p.jsxs("div",{className:"flex items-center space-x-2",children:[r&&n.users&&r.id!==n.user_id&&p.jsx(Nw,{recipientId:n.user_id,recipientUsername:n.users.username,postTitle:_u(n),postId:n.id,variant:"icon-only",className:"hover:bg-[#2a4a57] rounded p-1"}),p.jsx(_j,{contentType:"post",contentId:n.id,contentUserId:n.user_id,onContentDeleted:()=>window.location.reload()})]})]}),p.jsx("h3",{className:"text-base md:text-xl font-semibold text-[#37a653] mb-4 leading-tight text-left",children:_u(n)}),n.is_banned&&n.rejection_reason&&p.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg",children:p.jsxs("div",{className:"text-red-800 text-sm",children:[p.jsx("strong",{children:"Grund der Ablehnung:"})," ",n.rejection_reason]})}),n.content&&p.jsx("div",{className:"flex flex-wrap gap-2",children:p.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-lg bg-[#2a4a57] text-white text-xs md:text-sm",children:"Minimalismus"})})]})};var dp={exports:{}},fp={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ux;function Nj(){if(ux)return fp;ux=1;var n=_l();function e(y,v){return y===v&&(y!==0||1/y===1/v)||y!==y&&v!==v}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,s=n.useEffect,a=n.useLayoutEffect,l=n.useDebugValue;function u(y,v){var x=v(),w=r({inst:{value:x,getSnapshot:v}}),k=w[0].inst,_=w[1];return a(function(){k.value=x,k.getSnapshot=v,d(k)&&_({inst:k})},[y,x,v]),s(function(){return d(k)&&_({inst:k}),y(function(){d(k)&&_({inst:k})})},[y]),l(x),x}function d(y){var v=y.getSnapshot;y=y.value;try{var x=v();return!t(y,x)}catch{return!0}}function h(y,v){return v()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:u;return fp.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:m,fp}var dx;function Cw(){return dx||(dx=1,dp.exports=Nj()),dp.exports}var Tw=Cw();function Lt(n){this.content=n}Lt.prototype={constructor:Lt,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,s=r.find(n),a=r.content.slice();return s==-1?a.push(t||n,e):(a[s+1]=e,t&&(a[s]=t)),new Lt(a)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new Lt(t)},addToStart:function(n,e){return new Lt([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new Lt(t)},addBefore:function(n,e,t){var r=this.remove(e),s=r.content.slice(),a=r.find(n);return s.splice(a==-1?s.length:a,0,e,t),new Lt(s)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=Lt.from(n),n.size?new Lt(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=Lt.from(n),n.size?new Lt(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=Lt.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};Lt.from=function(n){if(n instanceof Lt)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new Lt(e)};function jw(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let s=n.child(r),a=e.child(r);if(s==a){t+=s.nodeSize;continue}if(!s.sameMarkup(a))return t;if(s.isText&&s.text!=a.text){for(let l=0;s.text[l]==a.text[l];l++)t++;return t}if(s.content.size||a.content.size){let l=jw(s.content,a.content,t+1);if(l!=null)return l}t+=s.nodeSize}}function Mw(n,e,t,r){for(let s=n.childCount,a=e.childCount;;){if(s==0||a==0)return s==a?null:{a:t,b:r};let l=n.child(--s),u=e.child(--a),d=l.nodeSize;if(l==u){t-=d,r-=d;continue}if(!l.sameMarkup(u))return{a:t,b:r};if(l.isText&&l.text!=u.text){let h=0,m=Math.min(l.text.length,u.text.length);for(;h<m&&l.text[l.text.length-h-1]==u.text[u.text.length-h-1];)h++,t--,r--;return{a:t,b:r}}if(l.content.size||u.content.size){let h=Mw(l.content,u.content,t-1,r-1);if(h)return h}t-=d,r-=d}}class J{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,s=0,a){for(let l=0,u=0;u<t;l++){let d=this.content[l],h=u+d.nodeSize;if(h>e&&r(d,s+u,a||null,l)!==!1&&d.content.size){let m=u+1;d.nodesBetween(Math.max(0,e-m),Math.min(d.content.size,t-m),r,s+m)}u=h}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,s){let a="",l=!0;return this.nodesBetween(e,t,(u,d)=>{let h=u.isText?u.text.slice(Math.max(e,d)-d,t-d):u.isLeaf?s?typeof s=="function"?s(u):s:u.type.spec.leafText?u.type.spec.leafText(u):"":"";u.isBlock&&(u.isLeaf&&h||u.isTextblock)&&r&&(l?l=!1:a+=r),a+=h},0),a}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,s=this.content.slice(),a=0;for(t.isText&&t.sameMarkup(r)&&(s[s.length-1]=t.withText(t.text+r.text),a=1);a<e.content.length;a++)s.push(e.content[a]);return new J(s,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],s=0;if(t>e)for(let a=0,l=0;l<t;a++){let u=this.content[a],d=l+u.nodeSize;d>e&&((l<e||d>t)&&(u.isText?u=u.cut(Math.max(0,e-l),Math.min(u.text.length,t-l)):u=u.cut(Math.max(0,e-l-1),Math.min(u.content.size,t-l-1))),r.push(u),s+=u.nodeSize),l=d}return new J(r,s)}cutByIndex(e,t){return e==t?J.empty:e==0&&t==this.content.length?this:new J(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let s=this.content.slice(),a=this.size+t.nodeSize-r.nodeSize;return s[e]=t,new J(s,a)}addToStart(e){return new J([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new J(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let s=this.content[t];e(s,r,t),r+=s.nodeSize}}findDiffStart(e,t=0){return jw(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return Mw(this,e,t,r)}findIndex(e){if(e==0)return nu(0,e);if(e==this.size)return nu(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let t=0,r=0;;t++){let s=this.child(t),a=r+s.nodeSize;if(a>=e)return a==e?nu(t+1,a):nu(t,r);r=a}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return J.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new J(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return J.empty;let t,r=0;for(let s=0;s<e.length;s++){let a=e[s];r+=a.nodeSize,s&&a.isText&&e[s-1].sameMarkup(a)?(t||(t=e.slice(0,s)),t[t.length-1]=a.withText(t[t.length-1].text+a.text)):t&&t.push(a)}return new J(t||e,r)}static from(e){if(!e)return J.empty;if(e instanceof J)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new J([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}J.empty=new J([],0);const hp={index:0,offset:0};function nu(n,e){return hp.index=n,hp.offset=e,hp}function Eu(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!Eu(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!Eu(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let Fe=class rm{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let s=0;s<e.length;s++){let a=e[s];if(this.eq(a))return e;if(this.type.excludes(a.type))t||(t=e.slice(0,s));else{if(a.type.excludes(this.type))return e;!r&&a.type.rank>this.type.rank&&(t||(t=e.slice(0,s)),t.push(this),r=!0),t&&t.push(a)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Eu(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let s=r.create(t.attrs);return r.checkAttrs(s.attrs),s}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return rm.none;if(e instanceof rm)return[e];let t=e.slice();return t.sort((r,s)=>r.type.rank-s.type.rank),t}};Fe.none=[];class Nu extends Error{}class ne{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=Ow(this.content,e+this.openStart,t);return r&&new ne(r,this.openStart,this.openEnd)}removeBetween(e,t){return new ne(Aw(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return ne.empty;let r=t.openStart||0,s=t.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new ne(J.fromJSON(e,t.content),r,s)}static maxOpen(e,t=!0){let r=0,s=0;for(let a=e.firstChild;a&&!a.isLeaf&&(t||!a.type.spec.isolating);a=a.firstChild)r++;for(let a=e.lastChild;a&&!a.isLeaf&&(t||!a.type.spec.isolating);a=a.lastChild)s++;return new ne(e,r,s)}}ne.empty=new ne(J.empty,0,0);function Aw(n,e,t){let{index:r,offset:s}=n.findIndex(e),a=n.maybeChild(r),{index:l,offset:u}=n.findIndex(t);if(s==e||a.isText){if(u!=t&&!n.child(l).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=l)throw new RangeError("Removing non-flat range");return n.replaceChild(r,a.copy(Aw(a.content,e-s-1,t-s-1)))}function Ow(n,e,t,r){let{index:s,offset:a}=n.findIndex(e),l=n.maybeChild(s);if(a==e||l.isText)return r&&!r.canReplace(s,s,t)?null:n.cut(0,e).append(t).append(n.cut(e));let u=Ow(l.content,e-a-1,t,l);return u&&n.replaceChild(s,l.copy(u))}function Cj(n,e,t){if(t.openStart>n.depth)throw new Nu("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new Nu("Inconsistent open depths");return Rw(n,e,t,0)}function Rw(n,e,t,r){let s=n.index(r),a=n.node(r);if(s==e.index(r)&&r<n.depth-t.openStart){let l=Rw(n,e,t,r+1);return a.copy(a.content.replaceChild(s,l))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let l=n.parent,u=l.content;return ri(l,u.cut(0,n.parentOffset).append(t.content).append(u.cut(e.parentOffset)))}else{let{start:l,end:u}=Tj(t,n);return ri(a,Lw(n,l,u,e,r))}else return ri(a,Cu(n,e,r))}function Dw(n,e){if(!e.type.compatibleContent(n.type))throw new Nu("Cannot join "+e.type.name+" onto "+n.type.name)}function sm(n,e,t){let r=n.node(t);return Dw(r,e.node(t)),r}function ni(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function el(n,e,t,r){let s=(e||n).node(t),a=0,l=e?e.index(t):s.childCount;n&&(a=n.index(t),n.depth>t?a++:n.textOffset&&(ni(n.nodeAfter,r),a++));for(let u=a;u<l;u++)ni(s.child(u),r);e&&e.depth==t&&e.textOffset&&ni(e.nodeBefore,r)}function ri(n,e){return n.type.checkContent(e),n.copy(e)}function Lw(n,e,t,r,s){let a=n.depth>s&&sm(n,e,s+1),l=r.depth>s&&sm(t,r,s+1),u=[];return el(null,n,s,u),a&&l&&e.index(s)==t.index(s)?(Dw(a,l),ni(ri(a,Lw(n,e,t,r,s+1)),u)):(a&&ni(ri(a,Cu(n,e,s+1)),u),el(e,t,s,u),l&&ni(ri(l,Cu(t,r,s+1)),u)),el(r,null,s,u),new J(u)}function Cu(n,e,t){let r=[];if(el(null,n,t,r),n.depth>t){let s=sm(n,e,t+1);ni(ri(s,Cu(n,e,t+1)),r)}return el(e,null,t,r),new J(r)}function Tj(n,e){let t=e.depth-n.openStart,s=e.node(t).copy(n.content);for(let a=t-1;a>=0;a--)s=e.node(a).copy(J.from(s));return{start:s.resolveNoCache(n.openStart+t),end:s.resolveNoCache(s.content.size-n.openEnd-t)}}class hl{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(t);return r?e.child(t).cut(r):s}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],s=t==0?0:this.path[t*3-1]+1;for(let a=0;a<e;a++)s+=r.child(a).nodeSize;return s}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return Fe.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),s=e.maybeChild(t);if(!r){let u=r;r=s,s=u}let a=r.marks;for(var l=0;l<a.length;l++)a[l].type.spec.inclusive===!1&&(!s||!a[l].isInSet(s.marks))&&(a=a[l--].removeFromSet(a));return a}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,s=e.parent.maybeChild(e.index());for(var a=0;a<r.length;a++)r[a].type.spec.inclusive===!1&&(!s||!r[a].isInSet(s.marks))&&(r=r[a--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new Tu(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],s=0,a=t;for(let l=e;;){let{index:u,offset:d}=l.content.findIndex(a),h=a-d;if(r.push(l,u,s+d),!h||(l=l.child(u),l.isText))break;a=h-1,s+=d+1}return new hl(t,r,a)}static resolveCached(e,t){let r=fx.get(e);if(r)for(let a=0;a<r.elts.length;a++){let l=r.elts[a];if(l.pos==t)return l}else fx.set(e,r=new jj);let s=r.elts[r.i]=hl.resolve(e,t);return r.i=(r.i+1)%Mj,s}}class jj{constructor(){this.elts=[],this.i=0}}const Mj=12,fx=new WeakMap;class Tu{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Aj=Object.create(null);class Hn{constructor(e,t,r,s=Fe.none){this.type=e,this.attrs=t,this.marks=s,this.content=r||J.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,s=0){this.content.nodesBetween(e,t,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,s){return this.content.textBetween(e,t,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&Eu(this.attrs,t||e.defaultAttrs||Aj)&&Fe.sameSet(this.marks,r||Fe.none)}copy(e=null){return e==this.content?this:new Hn(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Hn(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return ne.empty;let s=this.resolve(e),a=this.resolve(t),l=r?0:s.sharedDepth(t),u=s.start(l),h=s.node(l).content.cut(s.pos-u,a.pos-u);return new ne(h,s.depth-l,a.depth-l)}replace(e,t,r){return Cj(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:s}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(s==e||t.isText)return t;e-=s+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let s=this.content.child(t-1);return{node:s,index:t-1,offset:r-s.nodeSize}}resolve(e){return hl.resolveCached(this,e)}resolveNoCache(e){return hl.resolve(this,e)}rangeHasMark(e,t,r){let s=!1;return t>e&&this.nodesBetween(e,t,a=>(r.isInSet(a.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Bw(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=J.empty,s=0,a=r.childCount){let l=this.contentMatchAt(e).matchFragment(r,s,a),u=l&&l.matchFragment(this.content,t);if(!u||!u.validEnd)return!1;for(let d=s;d<a;d++)if(!this.type.allowsMarks(r.child(d).marks))return!1;return!0}canReplaceWith(e,t,r,s){if(s&&!this.type.allowsMarks(s))return!1;let a=this.contentMatchAt(e).matchType(r),l=a&&a.matchFragment(this.content,t);return l?l.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Fe.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Fe.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let s=J.fromJSON(e,t.content),a=e.nodeType(t.type).create(t.attrs,s,r);return a.type.checkAttrs(a.attrs),a}}Hn.prototype.text=void 0;class ju extends Hn{constructor(e,t,r,s){if(super(e,t,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Bw(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new ju(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new ju(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function Bw(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class oi{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new Oj(e,t);if(r.next==null)return oi.empty;let s=zw(r);r.next&&r.err("Unexpected trailing text");let a=Pj(Uj(s));return $j(a,r),a}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let s=this;for(let a=t;s&&a<r;a++)s=s.matchType(e.child(a).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let s=[this];function a(l,u){let d=l.matchFragment(e,r);if(d&&(!t||d.validEnd))return J.from(u.map(h=>h.createAndFill()));for(let h=0;h<l.next.length;h++){let{type:m,next:y}=l.next[h];if(!(m.isText||m.hasRequiredAttrs())&&s.indexOf(y)==-1){s.push(y);let v=a(y,u.concat(m));if(v)return v}}return null}return a(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),a=s.match;if(a.matchType(e)){let l=[];for(let u=s;u.type;u=u.via)l.push(u.type);return l.reverse()}for(let l=0;l<a.next.length;l++){let{type:u,next:d}=a.next[l];!u.isLeaf&&!u.hasRequiredAttrs()&&!(u.name in t)&&(!s.type||d.validEnd)&&(r.push({match:u.contentMatch,type:u,via:s}),t[u.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&t(r.next[s].next)}return t(this),e.map((r,s)=>{let a=s+(r.validEnd?"*":" ")+" ";for(let l=0;l<r.next.length;l++)a+=(l?", ":"")+r.next[l].type.name+"->"+e.indexOf(r.next[l].next);return a}).join(`
`)}}oi.empty=new oi(!0);class Oj{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function zw(n){let e=[];do e.push(Rj(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function Rj(n){let e=[];do e.push(Dj(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function Dj(n){let e=zj(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=Lj(n,e);else break;return e}function hx(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function Lj(n,e){let t=hx(n),r=t;return n.eat(",")&&(n.next!="}"?r=hx(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function Bj(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let s=[];for(let a in t){let l=t[a];l.isInGroup(e)&&s.push(l)}return s.length==0&&n.err("No node type or group '"+e+"' found"),s}function zj(n){if(n.eat("(")){let e=zw(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=Bj(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function Uj(n){let e=[[]];return s(a(n,0),t()),e;function t(){return e.push([])-1}function r(l,u,d){let h={term:d,to:u};return e[l].push(h),h}function s(l,u){l.forEach(d=>d.to=u)}function a(l,u){if(l.type=="choice")return l.exprs.reduce((d,h)=>d.concat(a(h,u)),[]);if(l.type=="seq")for(let d=0;;d++){let h=a(l.exprs[d],u);if(d==l.exprs.length-1)return h;s(h,u=t())}else if(l.type=="star"){let d=t();return r(u,d),s(a(l.expr,d),d),[r(d)]}else if(l.type=="plus"){let d=t();return s(a(l.expr,u),d),s(a(l.expr,d),d),[r(d)]}else{if(l.type=="opt")return[r(u)].concat(a(l.expr,u));if(l.type=="range"){let d=u;for(let h=0;h<l.min;h++){let m=t();s(a(l.expr,d),m),d=m}if(l.max==-1)s(a(l.expr,d),d);else for(let h=l.min;h<l.max;h++){let m=t();r(d,m),s(a(l.expr,d),m),d=m}return[r(d)]}else{if(l.type=="name")return[r(u,void 0,l.value)];throw new Error("Unknown expr type")}}}}function Uw(n,e){return e-n}function px(n,e){let t=[];return r(e),t.sort(Uw);function r(s){let a=n[s];if(a.length==1&&!a[0].term)return r(a[0].to);t.push(s);for(let l=0;l<a.length;l++){let{term:u,to:d}=a[l];!u&&t.indexOf(d)==-1&&r(d)}}}function Pj(n){let e=Object.create(null);return t(px(n,0));function t(r){let s=[];r.forEach(l=>{n[l].forEach(({term:u,to:d})=>{if(!u)return;let h;for(let m=0;m<s.length;m++)s[m][0]==u&&(h=s[m][1]);px(n,d).forEach(m=>{h||s.push([u,h=[]]),h.indexOf(m)==-1&&h.push(m)})})});let a=e[r.join(",")]=new oi(r.indexOf(n.length-1)>-1);for(let l=0;l<s.length;l++){let u=s[l][1].sort(Uw);a.next.push({type:s[l][0],next:e[u.join(",")]||t(u)})}return a}}function $j(n,e){for(let t=0,r=[n];t<r.length;t++){let s=r[t],a=!s.validEnd,l=[];for(let u=0;u<s.next.length;u++){let{type:d,next:h}=s.next[u];l.push(d.name),a&&!(d.isText||d.hasRequiredAttrs())&&(a=!1),r.indexOf(h)==-1&&r.push(h)}a&&e.err("Only non-generatable nodes ("+l.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Pw(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function $w(n,e){let t=Object.create(null);for(let r in n){let s=e&&e[r];if(s===void 0){let a=n[r];if(a.hasDefault)s=a.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=s}return t}function Iw(n,e,t,r){for(let s in e)if(!(s in n))throw new RangeError(`Unsupported attribute ${s} for ${t} of type ${s}`);for(let s in n){let a=n[s];a.validate&&a.validate(e[s])}}function Hw(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new Hj(n,r,e[r]);return t}let mx=class qw{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Hw(e,r.attrs),this.defaultAttrs=Pw(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==oi.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:$w(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Hn(this,this.computeAttrs(e),J.from(t),Fe.setFrom(r))}createChecked(e=null,t,r){return t=J.from(t),this.checkContent(t),new Hn(this,this.computeAttrs(e),t,Fe.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=J.from(t),t.size){let l=this.contentMatch.fillBefore(t);if(!l)return null;t=l.append(t)}let s=this.contentMatch.matchFragment(t),a=s&&s.fillBefore(J.empty,!0);return a?new Hn(this,e,t.append(a),Fe.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){Iw(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:Fe.none:e}static compile(e,t){let r=Object.create(null);e.forEach((a,l)=>r[a]=new qw(a,t,l));let s=t.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let a in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function Ij(n,e,t){let r=t.split("|");return s=>{let a=s===null?"null":typeof s;if(r.indexOf(a)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${a}`)}}class Hj{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?Ij(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class vd{constructor(e,t,r,s){this.name=e,this.rank=t,this.schema=r,this.spec=s,this.attrs=Hw(e,s.attrs),this.excluded=null;let a=Pw(this.attrs);this.instance=a?new Fe(this,a):null}create(e=null){return!e&&this.instance?this.instance:new Fe(this,$w(this.attrs,e))}static compile(e,t){let r=Object.create(null),s=0;return e.forEach((a,l)=>r[a]=new vd(a,s++,t,l)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){Iw(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Vw{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let s in e)t[s]=e[s];t.nodes=Lt.from(e.nodes),t.marks=Lt.from(e.marks||{}),this.nodes=mx.compile(this.spec.nodes,this),this.marks=vd.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let a=this.nodes[s],l=a.spec.content||"",u=a.spec.marks;if(a.contentMatch=r[l]||(r[l]=oi.parse(l,this.nodes)),a.inlineContent=a.contentMatch.inlineContent,a.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!a.isInline||!a.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=a}a.markSet=u=="_"?null:u?gx(this,u.split(" ")):u==""||!a.inlineContent?[]:null}for(let s in this.marks){let a=this.marks[s],l=a.spec.excludes;a.excluded=l==null?[a]:l==""?[]:gx(this,l.split(" "))}this.nodeFromJSON=s=>Hn.fromJSON(this,s),this.markFromJSON=s=>Fe.fromJSON(this,s),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof mx){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,s)}text(e,t){let r=this.nodes.text;return new ju(r,r.defaultAttrs,e,Fe.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function gx(n,e){let t=[];for(let r=0;r<e.length;r++){let s=e[r],a=n.marks[s],l=a;if(a)t.push(a);else for(let u in n.marks){let d=n.marks[u];(s=="_"||d.spec.group&&d.spec.group.split(" ").indexOf(s)>-1)&&t.push(l=d)}if(!l)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function qj(n){return n.tag!=null}function Vj(n){return n.style!=null}class ys{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(s=>{if(qj(s))this.tags.push(s);else if(Vj(s)){let a=/[^=]*/.exec(s.style)[0];r.indexOf(a)<0&&r.push(a),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let a=e.nodes[s.node];return a.contentMatch.matchType(a)})}parse(e,t={}){let r=new bx(this,t,!1);return r.addAll(e,Fe.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new bx(this,t,!0);return r.addAll(e,Fe.none,t.from,t.to),ne.maxOpen(r.finish())}matchTag(e,t,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let a=this.tags[s];if(Gj(e,a.tag)&&(a.namespace===void 0||e.namespaceURI==a.namespace)&&(!a.context||t.matchesContext(a.context))){if(a.getAttrs){let l=a.getAttrs(e);if(l===!1)continue;a.attrs=l||void 0}return a}}}matchStyle(e,t,r,s){for(let a=s?this.styles.indexOf(s)+1:0;a<this.styles.length;a++){let l=this.styles[a],u=l.style;if(!(u.indexOf(e)!=0||l.context&&!r.matchesContext(l.context)||u.length>e.length&&(u.charCodeAt(e.length)!=61||u.slice(e.length+1)!=t))){if(l.getAttrs){let d=l.getAttrs(t);if(d===!1)continue;l.attrs=d||void 0}return l}}}static schemaRules(e){let t=[];function r(s){let a=s.priority==null?50:s.priority,l=0;for(;l<t.length;l++){let u=t[l];if((u.priority==null?50:u.priority)<a)break}t.splice(l,0,s)}for(let s in e.marks){let a=e.marks[s].spec.parseDOM;a&&a.forEach(l=>{r(l=vx(l)),l.mark||l.ignore||l.clearMark||(l.mark=s)})}for(let s in e.nodes){let a=e.nodes[s].spec.parseDOM;a&&a.forEach(l=>{r(l=vx(l)),l.node||l.ignore||l.mark||(l.node=s)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new ys(e,ys.schemaRules(e)))}}const Fw={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Fj={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Kw={ol:!0,ul:!0},pl=1,im=2,tl=4;function yx(n,e,t){return e!=null?(e?pl:0)|(e==="full"?im:0):n&&n.whitespace=="pre"?pl|im:t&~tl}class ru{constructor(e,t,r,s,a,l){this.type=e,this.attrs=t,this.marks=r,this.solid=s,this.options=l,this.content=[],this.activeMarks=Fe.none,this.match=a||(l&tl?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(J.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&pl)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let a=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=a.withText(a.text.slice(0,a.text.length-s[0].length))}}let t=J.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(J.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Fw.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class bx{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let s=t.topNode,a,l=yx(null,t.preserveWhitespace,0)|(r?tl:0);s?a=new ru(s.type,s.attrs,Fe.none,!0,t.topMatch||s.type.contentMatch,l):r?a=new ru(null,null,Fe.none,!0,null,l):a=new ru(e.schema.topNodeType,null,Fe.none,!0,null,l),this.nodes=[a],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,s=this.top,a=s.options&im?"full":this.localPreserveWS||(s.options&pl)>0;if(a==="full"||s.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(a)a!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let l=s.content[s.content.length-1],u=e.previousSibling;(!l||u&&u.nodeName=="BR"||l.isText&&/[ \t\r\n\u000c]$/.test(l.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),t,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let s=this.localPreserveWS,a=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let l=e.nodeName.toLowerCase(),u;Kw.hasOwnProperty(l)&&this.parser.normalizeLists&&Kj(e);let d=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(u=this.parser.matchTag(e,this,r));e:if(d?d.ignore:Fj.hasOwnProperty(l))this.findInside(e),this.ignoreFallback(e,t);else if(!d||d.skip||d.closeParent){d&&d.closeParent?this.open=Math.max(0,this.open-1):d&&d.skip.nodeType&&(e=d.skip);let h,m=this.needsBlock;if(Fw.hasOwnProperty(l))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),h=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let y=d&&d.skip?t:this.readStyles(e,t);y&&this.addAll(e,y),h&&this.sync(a),this.needsBlock=m}else{let h=this.readStyles(e,t);h&&this.addElementByRule(e,d,h,d.consuming===!1?u:void 0)}this.localPreserveWS=s}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let a=this.parser.matchedStyles[s],l=r.getPropertyValue(a);if(l)for(let u=void 0;;){let d=this.parser.matchStyle(a,l,this,u);if(!d)break;if(d.ignore)return null;if(d.clearMark?t=t.filter(h=>!d.clearMark(h)):t=t.concat(this.parser.schema.marks[d.mark].create(d.attrs)),d.consuming===!1)u=d;else break}}return t}addElementByRule(e,t,r,s){let a,l;if(t.node)if(l=this.parser.schema.nodes[t.node],l.isLeaf)this.insertNode(l.create(t.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let d=this.enter(l,t.attrs||null,r,t.preserveWhitespace);d&&(a=!0,r=d)}else{let d=this.parser.schema.marks[t.mark];r=r.concat(d.create(t.attrs))}let u=this.top;if(l&&l.isLeaf)this.findInside(e);else if(s)this.addElement(e,r,s);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(d=>this.insertNode(d,r,!1));else{let d=e;typeof t.contentElement=="string"?d=e.querySelector(t.contentElement):typeof t.contentElement=="function"?d=t.contentElement(e):t.contentElement&&(d=t.contentElement),this.findAround(e,d,!0),this.addAll(d,r),this.findAround(e,d,!1)}a&&this.sync(u)&&this.open--}addAll(e,t,r,s){let a=r||0;for(let l=r?e.childNodes[r]:e.firstChild,u=s==null?null:e.childNodes[s];l!=u;l=l.nextSibling,++a)this.findAtPoint(e,a),this.addDOM(l,t);this.findAtPoint(e,a)}findPlace(e,t,r){let s,a;for(let l=this.open,u=0;l>=0;l--){let d=this.nodes[l],h=d.findWrapping(e);if(h&&(!s||s.length>h.length+u)&&(s=h,a=d,!h.length))break;if(d.solid){if(r)break;u+=2}}if(!s)return null;this.sync(a);for(let l=0;l<s.length;l++)t=this.enterInner(s[l],null,t,!1);return t}insertNode(e,t,r){if(e.isInline&&this.needsBlock&&!this.top.type){let a=this.textblockFromContext();a&&(t=this.enterInner(a,null,t))}let s=this.findPlace(e,t,r);if(s){this.closeExtra();let a=this.top;a.match&&(a.match=a.match.matchType(e.type));let l=Fe.none;for(let u of s.concat(e.marks))(a.type?a.type.allowsMarkType(u.type):xx(u.type,e.type))&&(l=u.addToSet(l));return a.content.push(e.mark(l)),!0}return!1}enter(e,t,r,s){let a=this.findPlace(e.create(t),r,!1);return a&&(a=this.enterInner(e,t,r,!0,s)),a}enterInner(e,t,r,s=!1,a){this.closeExtra();let l=this.top;l.match=l.match&&l.match.matchType(e);let u=yx(e,a,l.options);l.options&tl&&l.content.length==0&&(u|=tl);let d=Fe.none;return r=r.filter(h=>(l.type?l.type.allowsMarkType(h.type):xx(h.type,e))?(d=h.addToSet(d),!1):!0),this.nodes.push(new ru(e,t,d,s,null,u)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=pl)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&t.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),a=-(r?r.depth+1:0)+(s?0:1),l=(u,d)=>{for(;u>=0;u--){let h=t[u];if(h==""){if(u==t.length-1||u==0)continue;for(;d>=a;d--)if(l(u-1,d))return!0;return!1}else{let m=d>0||d==0&&s?this.nodes[d].type:r&&d>=a?r.node(d-a).type:null;if(!m||m.name!=h&&!m.isInGroup(h))return!1;d--}}return!0};return l(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}}function Kj(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Kw.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function Gj(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function vx(n){let e={};for(let t in n)e[t]=n[t];return e}function xx(n,e){let t=e.schema.nodes;for(let r in t){let s=t[r];if(!s.allowsMarkType(n))continue;let a=[],l=u=>{a.push(u);for(let d=0;d<u.edgeCount;d++){let{type:h,next:m}=u.edge(d);if(h==e||a.indexOf(m)<0&&l(m))return!0}};if(l(s.contentMatch))return!0}}class hi{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=pp(t).createDocumentFragment());let s=r,a=[];return e.forEach(l=>{if(a.length||l.marks.length){let u=0,d=0;for(;u<a.length&&d<l.marks.length;){let h=l.marks[d];if(!this.marks[h.type.name]){d++;continue}if(!h.eq(a[u][0])||h.type.spec.spanning===!1)break;u++,d++}for(;u<a.length;)s=a.pop()[1];for(;d<l.marks.length;){let h=l.marks[d++],m=this.serializeMark(h,l.isInline,t);m&&(a.push([h,s]),s.appendChild(m.dom),s=m.contentDOM||m.dom)}}s.appendChild(this.serializeNodeInner(l,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:s}=gu(pp(t),this.nodes[e.type.name](e),null,e.attrs);if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,s)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let s=e.marks.length-1;s>=0;s--){let a=this.serializeMark(e.marks[s],e.isInline,t);a&&((a.contentDOM||a.dom).appendChild(r),r=a.dom)}return r}serializeMark(e,t,r={}){let s=this.marks[e.type.name];return s&&gu(pp(r),s(e,t),null,e.attrs)}static renderSpec(e,t,r=null,s){return gu(e,t,r,s)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new hi(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=wx(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return wx(e.marks)}}function wx(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function pp(n){return n.document||window.document}const Sx=new WeakMap;function Wj(n){let e=Sx.get(n);return e===void 0&&Sx.set(n,e=Yj(n)),e}function Yj(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let s=0;s<r.length;s++)t(r[s]);else for(let s in r)t(r[s])}return t(n),e}function gu(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let s=e[0],a;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(a=Wj(r))&&a.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let l=s.indexOf(" ");l>0&&(t=s.slice(0,l),s=s.slice(l+1));let u,d=t?n.createElementNS(t,s):n.createElement(s),h=e[1],m=1;if(h&&typeof h=="object"&&h.nodeType==null&&!Array.isArray(h)){m=2;for(let y in h)if(h[y]!=null){let v=y.indexOf(" ");v>0?d.setAttributeNS(y.slice(0,v),y.slice(v+1),h[y]):y=="style"&&d.style?d.style.cssText=h[y]:d.setAttribute(y,h[y])}}for(let y=m;y<e.length;y++){let v=e[y];if(v===0){if(y<e.length-1||y>m)throw new RangeError("Content hole must be the only child of its parent node");return{dom:d,contentDOM:d}}else{let{dom:x,contentDOM:w}=gu(n,v,t,r);if(d.appendChild(x),w){if(u)throw new RangeError("Multiple content holes");u=w}}}return{dom:d,contentDOM:u}}const Gw=65535,Ww=Math.pow(2,16);function Jj(n,e){return n+e*Ww}function kx(n){return n&Gw}function Qj(n){return(n-(n&Gw))/Ww}const Yw=1,Jw=2,yu=4,Qw=8;class am{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&Qw)>0}get deletedBefore(){return(this.delInfo&(Yw|yu))>0}get deletedAfter(){return(this.delInfo&(Jw|yu))>0}get deletedAcross(){return(this.delInfo&yu)>0}}class pn{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&pn.empty)return pn.empty}recover(e){let t=0,r=kx(e);if(!this.inverted)for(let s=0;s<r;s++)t+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+t+Qj(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let s=0,a=this.inverted?2:1,l=this.inverted?1:2;for(let u=0;u<this.ranges.length;u+=3){let d=this.ranges[u]-(this.inverted?s:0);if(d>e)break;let h=this.ranges[u+a],m=this.ranges[u+l],y=d+h;if(e<=y){let v=h?e==d?-1:e==y?1:t:t,x=d+s+(v<0?0:m);if(r)return x;let w=e==(t<0?d:y)?null:Jj(u/3,e-d),k=e==d?Jw:e==y?Yw:yu;return(t<0?e!=d:e!=y)&&(k|=Qw),new am(x,k,w)}s+=m-h}return r?e+s:new am(e+s,0,null)}touches(e,t){let r=0,s=kx(t),a=this.inverted?2:1,l=this.inverted?1:2;for(let u=0;u<this.ranges.length;u+=3){let d=this.ranges[u]-(this.inverted?r:0);if(d>e)break;let h=this.ranges[u+a],m=d+h;if(e<=m&&u==s*3)return!0;r+=this.ranges[u+l]-h}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,a=0;s<this.ranges.length;s+=3){let l=this.ranges[s],u=l-(this.inverted?a:0),d=l+(this.inverted?0:a),h=this.ranges[s+t],m=this.ranges[s+r];e(u,u+h,d,d+m),a+=m-h}}invert(){return new pn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?pn.empty:new pn(e<0?[0,-e,0]:[0,0,e])}}pn.empty=new pn([]);class ml{constructor(e,t,r=0,s=e?e.length:0){this.mirror=t,this.from=r,this.to=s,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new ml(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,r=this._maps.length;t<e._maps.length;t++){let s=e.getMirror(t);this.appendMap(e._maps[t],s!=null&&s<t?r+s:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this._maps.length+e._maps.length;t>=0;t--){let s=e.getMirror(t);this.appendMap(e._maps[t].invert(),s!=null&&s>t?r-s-1:void 0)}}invert(){let e=new ml;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let s=0;for(let a=this.from;a<this.to;a++){let l=this._maps[a],u=l.mapResult(e,t);if(u.recover!=null){let d=this.getMirror(a);if(d!=null&&d>a&&d<this.to){a=d,e=this._maps[d].recover(u.recover);continue}}s|=u.delInfo,e=u.pos}return r?e:new am(e,s,null)}}const mp=Object.create(null);class qt{getMap(){return pn.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=mp[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in mp)throw new RangeError("Duplicate use of step JSON ID "+e);return mp[e]=t,t.prototype.jsonID=e,t}}class ft{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new ft(e,null)}static fail(e){return new ft(null,e)}static fromReplace(e,t,r,s){try{return ft.ok(e.replace(t,r,s))}catch(a){if(a instanceof Nu)return ft.fail(a.message);throw a}}}function Km(n,e,t){let r=[];for(let s=0;s<n.childCount;s++){let a=n.child(s);a.content.size&&(a=a.copy(Km(a.content,e,a))),a.isInline&&(a=e(a,t,s)),r.push(a)}return J.fromArray(r)}class ps extends qt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),a=new ne(Km(t.content,(l,u)=>!l.isAtom||!u.type.allowsMarkType(this.mark.type)?l:l.mark(this.mark.addToSet(l.marks)),s),t.openStart,t.openEnd);return ft.fromReplace(e,this.from,this.to,a)}invert(){return new In(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new ps(t.pos,r.pos,this.mark)}merge(e){return e instanceof ps&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ps(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new ps(t.from,t.to,e.markFromJSON(t.mark))}}qt.jsonID("addMark",ps);class In extends qt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new ne(Km(t.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),t.openStart,t.openEnd);return ft.fromReplace(e,this.from,this.to,r)}invert(){return new ps(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new In(t.pos,r.pos,this.mark)}merge(e){return e instanceof In&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new In(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new In(t.from,t.to,e.markFromJSON(t.mark))}}qt.jsonID("removeMark",In);class ms extends qt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ft.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return ft.fromReplace(e,this.pos,this.pos+1,new ne(J.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let s=0;s<t.marks.length;s++)if(!t.marks[s].isInSet(r))return new ms(this.pos,t.marks[s]);return new ms(this.pos,this.mark)}}return new li(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ms(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new ms(t.pos,e.markFromJSON(t.mark))}}qt.jsonID("addNodeMark",ms);class li extends qt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ft.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return ft.fromReplace(e,this.pos,this.pos+1,new ne(J.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new ms(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new li(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new li(t.pos,e.markFromJSON(t.mark))}}qt.jsonID("removeNodeMark",li);class Ct extends qt{constructor(e,t,r,s=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=s}apply(e){return this.structure&&om(e,this.from,this.to)?ft.fail("Structure replace would overwrite content"):ft.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new pn([this.from,this.to-this.from,this.slice.size])}invert(e){return new Ct(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new Ct(t.pos,Math.max(t.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Ct)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?ne.empty:new ne(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Ct(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?ne.empty:new ne(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Ct(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Ct(t.from,t.to,ne.fromJSON(e,t.slice),!!t.structure)}}qt.jsonID("replace",Ct);class Tt extends qt{constructor(e,t,r,s,a,l,u=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=s,this.slice=a,this.insert=l,this.structure=u}apply(e){if(this.structure&&(om(e,this.from,this.gapFrom)||om(e,this.gapTo,this.to)))return ft.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return ft.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?ft.fromReplace(e,this.from,this.to,r):ft.fail("Content does not fit in gap")}getMap(){return new pn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Tt(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),a=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||s<t.pos||a>r.pos?null:new Tt(t.pos,r.pos,s,a,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Tt(t.from,t.to,t.gapFrom,t.gapTo,ne.fromJSON(e,t.slice),t.insert,!!t.structure)}}qt.jsonID("replaceAround",Tt);function om(n,e,t){let r=n.resolve(e),s=t-e,a=r.depth;for(;s>0&&a>0&&r.indexAfter(a)==r.node(a).childCount;)a--,s--;if(s>0){let l=r.node(a).maybeChild(r.indexAfter(a));for(;s>0;){if(!l||l.isLeaf)return!0;l=l.firstChild,s--}}return!1}function Xj(n,e,t,r){let s=[],a=[],l,u;n.doc.nodesBetween(e,t,(d,h,m)=>{if(!d.isInline)return;let y=d.marks;if(!r.isInSet(y)&&m.type.allowsMarkType(r.type)){let v=Math.max(h,e),x=Math.min(h+d.nodeSize,t),w=r.addToSet(y);for(let k=0;k<y.length;k++)y[k].isInSet(w)||(l&&l.to==v&&l.mark.eq(y[k])?l.to=x:s.push(l=new In(v,x,y[k])));u&&u.to==v?u.to=x:a.push(u=new ps(v,x,r))}}),s.forEach(d=>n.step(d)),a.forEach(d=>n.step(d))}function Zj(n,e,t,r){let s=[],a=0;n.doc.nodesBetween(e,t,(l,u)=>{if(!l.isInline)return;a++;let d=null;if(r instanceof vd){let h=l.marks,m;for(;m=r.isInSet(h);)(d||(d=[])).push(m),h=m.removeFromSet(h)}else r?r.isInSet(l.marks)&&(d=[r]):d=l.marks;if(d&&d.length){let h=Math.min(u+l.nodeSize,t);for(let m=0;m<d.length;m++){let y=d[m],v;for(let x=0;x<s.length;x++){let w=s[x];w.step==a-1&&y.eq(s[x].style)&&(v=w)}v?(v.to=h,v.step=a):s.push({style:y,from:Math.max(u,e),to:h,step:a})}}}),s.forEach(l=>n.step(new In(l.from,l.to,l.style)))}function Gm(n,e,t,r=t.contentMatch,s=!0){let a=n.doc.nodeAt(e),l=[],u=e+1;for(let d=0;d<a.childCount;d++){let h=a.child(d),m=u+h.nodeSize,y=r.matchType(h.type);if(!y)l.push(new Ct(u,m,ne.empty));else{r=y;for(let v=0;v<h.marks.length;v++)t.allowsMarkType(h.marks[v].type)||n.step(new In(u,m,h.marks[v]));if(s&&h.isText&&t.whitespace!="pre"){let v,x=/\r?\n|\r/g,w;for(;v=x.exec(h.text);)w||(w=new ne(J.from(t.schema.text(" ",t.allowedMarks(h.marks))),0,0)),l.push(new Ct(u+v.index,u+v.index+v[0].length,w))}}u=m}if(!r.validEnd){let d=r.fillBefore(J.empty,!0);n.replace(u,u,new ne(d,0,0))}for(let d=l.length-1;d>=0;d--)n.step(l[d])}function eM(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function Ba(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let s=n.$from.node(r),a=n.$from.index(r),l=n.$to.indexAfter(r);if(r<n.depth&&s.canReplace(a,l,t))return r;if(r==0||s.type.spec.isolating||!eM(s,a,l))break}return null}function tM(n,e,t){let{$from:r,$to:s,depth:a}=e,l=r.before(a+1),u=s.after(a+1),d=l,h=u,m=J.empty,y=0;for(let w=a,k=!1;w>t;w--)k||r.index(w)>0?(k=!0,m=J.from(r.node(w).copy(m)),y++):d--;let v=J.empty,x=0;for(let w=a,k=!1;w>t;w--)k||s.after(w+1)<s.end(w)?(k=!0,v=J.from(s.node(w).copy(v)),x++):h++;n.step(new Tt(d,h,l,u,new ne(m.append(v),y,x),m.size-y,!0))}function Wm(n,e,t=null,r=n){let s=nM(n,e),a=s&&rM(r,e);return a?s.map(_x).concat({type:e,attrs:t}).concat(a.map(_x)):null}function _x(n){return{type:n,attrs:null}}function nM(n,e){let{parent:t,startIndex:r,endIndex:s}=n,a=t.contentMatchAt(r).findWrapping(e);if(!a)return null;let l=a.length?a[0]:e;return t.canReplaceWith(r,s,l)?a:null}function rM(n,e){let{parent:t,startIndex:r,endIndex:s}=n,a=t.child(r),l=e.contentMatch.findWrapping(a.type);if(!l)return null;let d=(l.length?l[l.length-1]:e).contentMatch;for(let h=r;d&&h<s;h++)d=d.matchType(t.child(h).type);return!d||!d.validEnd?null:l}function sM(n,e,t){let r=J.empty;for(let l=t.length-1;l>=0;l--){if(r.size){let u=t[l].type.contentMatch.matchFragment(r);if(!u||!u.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=J.from(t[l].type.create(t[l].attrs,r))}let s=e.start,a=e.end;n.step(new Tt(s,a,s,a,new ne(r,0,0),t.length,!0))}function iM(n,e,t,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let a=n.steps.length;n.doc.nodesBetween(e,t,(l,u)=>{let d=typeof s=="function"?s(l):s;if(l.isTextblock&&!l.hasMarkup(r,d)&&aM(n.doc,n.mapping.slice(a).map(u),r)){let h=null;if(r.schema.linebreakReplacement){let x=r.whitespace=="pre",w=!!r.contentMatch.matchType(r.schema.linebreakReplacement);x&&!w?h=!1:!x&&w&&(h=!0)}h===!1&&Zw(n,l,u,a),Gm(n,n.mapping.slice(a).map(u,1),r,void 0,h===null);let m=n.mapping.slice(a),y=m.map(u,1),v=m.map(u+l.nodeSize,1);return n.step(new Tt(y,v,y+1,v-1,new ne(J.from(r.create(d,null,l.marks)),0,0),1,!0)),h===!0&&Xw(n,l,u,a),!1}})}function Xw(n,e,t,r){e.forEach((s,a)=>{if(s.isText){let l,u=/\r?\n|\r/g;for(;l=u.exec(s.text);){let d=n.mapping.slice(r).map(t+1+a+l.index);n.replaceWith(d,d+1,e.type.schema.linebreakReplacement.create())}}})}function Zw(n,e,t,r){e.forEach((s,a)=>{if(s.type==s.type.schema.linebreakReplacement){let l=n.mapping.slice(r).map(t+1+a);n.replaceWith(l,l+1,e.type.schema.text(`
`))}})}function aM(n,e,t){let r=n.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,t)}function oM(n,e,t,r,s){let a=n.doc.nodeAt(e);if(!a)throw new RangeError("No node at given position");t||(t=a.type);let l=t.create(r,null,s||a.marks);if(a.isLeaf)return n.replaceWith(e,e+a.nodeSize,l);if(!t.validContent(a.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new Tt(e,e+a.nodeSize,e+1,e+a.nodeSize-1,new ne(J.from(l),0,0),1,!0))}function Tr(n,e,t=1,r){let s=n.resolve(e),a=s.depth-t,l=r&&r[r.length-1]||s.parent;if(a<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!l.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let h=s.depth-1,m=t-2;h>a;h--,m--){let y=s.node(h),v=s.index(h);if(y.type.spec.isolating)return!1;let x=y.content.cutByIndex(v,y.childCount),w=r&&r[m+1];w&&(x=x.replaceChild(0,w.type.create(w.attrs)));let k=r&&r[m]||y;if(!y.canReplace(v+1,y.childCount)||!k.type.validContent(x))return!1}let u=s.indexAfter(a),d=r&&r[0];return s.node(a).canReplaceWith(u,u,d?d.type:s.node(a+1).type)}function lM(n,e,t=1,r){let s=n.doc.resolve(e),a=J.empty,l=J.empty;for(let u=s.depth,d=s.depth-t,h=t-1;u>d;u--,h--){a=J.from(s.node(u).copy(a));let m=r&&r[h];l=J.from(m?m.type.create(m.attrs,l):s.node(u).copy(l))}n.step(new Ct(e,e,new ne(a.append(l),t,t),!0))}function Es(n,e){let t=n.resolve(e),r=t.index();return eS(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function cM(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let s=0;s<e.childCount;s++){let a=e.child(s),l=a.type==r?n.type.schema.nodes.text:a.type;if(t=t.matchType(l),!t||!n.type.allowsMarks(a.marks))return!1}return t.validEnd}function eS(n,e){return!!(n&&e&&!n.isLeaf&&cM(n,e))}function xd(n,e,t=-1){let r=n.resolve(e);for(let s=r.depth;;s--){let a,l,u=r.index(s);if(s==r.depth?(a=r.nodeBefore,l=r.nodeAfter):t>0?(a=r.node(s+1),u++,l=r.node(s).maybeChild(u)):(a=r.node(s).maybeChild(u-1),l=r.node(s+1)),a&&!a.isTextblock&&eS(a,l)&&r.node(s).canReplace(u,u+1))return e;if(s==0)break;e=t<0?r.before(s):r.after(s)}}function uM(n,e,t){let r=null,{linebreakReplacement:s}=n.doc.type.schema,a=n.doc.resolve(e-t),l=a.node().type;if(s&&l.inlineContent){let m=l.whitespace=="pre",y=!!l.contentMatch.matchType(s);m&&!y?r=!1:!m&&y&&(r=!0)}let u=n.steps.length;if(r===!1){let m=n.doc.resolve(e+t);Zw(n,m.node(),m.before(),u)}l.inlineContent&&Gm(n,e+t-1,l,a.node().contentMatchAt(a.index()),r==null);let d=n.mapping.slice(u),h=d.map(e-t);if(n.step(new Ct(h,d.map(e+t,-1),ne.empty,!0)),r===!0){let m=n.doc.resolve(h);Xw(n,m.node(),m.before(),n.steps.length)}return n}function dM(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let a=r.index(s);if(r.node(s).canReplaceWith(a,a,t))return r.before(s+1);if(a>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,t))return r.after(s+1);if(a<r.node(s).childCount)return null}return null}function tS(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let s=t.content;for(let a=0;a<t.openStart;a++)s=s.firstChild.content;for(let a=1;a<=(t.openStart==0&&t.size?2:1);a++)for(let l=r.depth;l>=0;l--){let u=l==r.depth?0:r.pos<=(r.start(l+1)+r.end(l+1))/2?-1:1,d=r.index(l)+(u>0?1:0),h=r.node(l),m=!1;if(a==1)m=h.canReplace(d,d,s);else{let y=h.contentMatchAt(d).findWrapping(s.firstChild.type);m=y&&h.canReplaceWith(d,d,y[0])}if(m)return u==0?r.pos:u<0?r.before(l+1):r.after(l+1)}return null}function wd(n,e,t=e,r=ne.empty){if(e==t&&!r.size)return null;let s=n.resolve(e),a=n.resolve(t);return nS(s,a,r)?new Ct(e,t,r):new fM(s,a,r).fit()}function nS(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class fM{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=J.empty;for(let s=0;s<=e.depth;s++){let a=e.node(s);this.frontier.push({type:a.type,match:a.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=J.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let h=this.findFittable();h?this.placeNodes(h):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let a=this.placed,l=r.depth,u=s.depth;for(;l&&u&&a.childCount==1;)a=a.firstChild.content,l--,u--;let d=new ne(a,l,u);return e>-1?new Tt(r.pos,e,this.$to.pos,this.$to.end(),d,t):d.size||r.pos!=this.$to.pos?new Ct(r.pos,s.pos,d):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let a=t.firstChild;if(t.childCount>1&&(s=0),a.type.spec.isolating&&s<=r){e=r;break}t=a.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let s,a=null;r?(a=gp(this.unplaced.content,r-1).firstChild,s=a.content):s=this.unplaced.content;let l=s.firstChild;for(let u=this.depth;u>=0;u--){let{type:d,match:h}=this.frontier[u],m,y=null;if(t==1&&(l?h.matchType(l.type)||(y=h.fillBefore(J.from(l),!1)):a&&d.compatibleContent(a.type)))return{sliceDepth:r,frontierDepth:u,parent:a,inject:y};if(t==2&&l&&(m=h.findWrapping(l.type)))return{sliceDepth:r,frontierDepth:u,parent:a,wrap:m};if(a&&h.matchType(a.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=gp(e,t);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new ne(e,t+1,Math.max(r,s.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=gp(e,t);if(s.childCount<=1&&t>0){let a=e.size-t<=t+s.size;this.unplaced=new ne(Go(e,t-1,1),t-1,a?t-1:r)}else this.unplaced=new ne(Go(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:s,wrap:a}){for(;this.depth>t;)this.closeFrontierNode();if(a)for(let k=0;k<a.length;k++)this.openFrontierNode(a[k]);let l=this.unplaced,u=r?r.content:l.content,d=l.openStart-e,h=0,m=[],{match:y,type:v}=this.frontier[t];if(s){for(let k=0;k<s.childCount;k++)m.push(s.child(k));y=y.matchFragment(s)}let x=u.size+e-(l.content.size-l.openEnd);for(;h<u.childCount;){let k=u.child(h),_=y.matchType(k.type);if(!_)break;h++,(h>1||d==0||k.content.size)&&(y=_,m.push(rS(k.mark(v.allowedMarks(k.marks)),h==1?d:0,h==u.childCount?x:-1)))}let w=h==u.childCount;w||(x=-1),this.placed=Wo(this.placed,t,J.from(m)),this.frontier[t].match=y,w&&x<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let k=0,_=u;k<x;k++){let N=_.lastChild;this.frontier.push({type:N.type,match:N.contentMatchAt(N.childCount)}),_=N.content}this.unplaced=w?e==0?ne.empty:new ne(Go(l.content,e-1,1),e-1,x<0?l.openEnd:e-1):new ne(Go(l.content,e,h),l.openStart,l.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!yp(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:s}=this.frontier[t],a=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),l=yp(e,t,s,r,a);if(l){for(let u=t-1;u>=0;u--){let{match:d,type:h}=this.frontier[u],m=yp(e,u,h,d,!0);if(!m||m.childCount)continue e}return{depth:t,fit:l,move:a?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Wo(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let s=e.node(r),a=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,a)}return e}openFrontierNode(e,t=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=Wo(this.placed,this.depth,J.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(J.empty,!0);t.childCount&&(this.placed=Wo(this.placed,this.frontier.length,t))}}function Go(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Go(n.firstChild.content,e-1,t)))}function Wo(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Wo(n.lastChild.content,e-1,t)))}function gp(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function rS(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,rS(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(J.empty,!0)))),n.copy(r)}function yp(n,e,t,r,s){let a=n.node(e),l=s?n.indexAfter(e):n.index(e);if(l==a.childCount&&!t.compatibleContent(a.type))return null;let u=r.fillBefore(a.content,!0,l);return u&&!hM(t,a.content,l)?u:null}function hM(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function pM(n){return n.spec.defining||n.spec.definingForContent}function mM(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let s=n.doc.resolve(e),a=n.doc.resolve(t);if(nS(s,a,r))return n.step(new Ct(e,t,r));let l=iS(s,n.doc.resolve(t));l[l.length-1]==0&&l.pop();let u=-(s.depth+1);l.unshift(u);for(let v=s.depth,x=s.pos-1;v>0;v--,x--){let w=s.node(v).type.spec;if(w.defining||w.definingAsContext||w.isolating)break;l.indexOf(v)>-1?u=v:s.before(v)==x&&l.splice(1,0,-v)}let d=l.indexOf(u),h=[],m=r.openStart;for(let v=r.content,x=0;;x++){let w=v.firstChild;if(h.push(w),x==r.openStart)break;v=w.content}for(let v=m-1;v>=0;v--){let x=h[v],w=pM(x.type);if(w&&!x.sameMarkup(s.node(Math.abs(u)-1)))m=v;else if(w||!x.type.isTextblock)break}for(let v=r.openStart;v>=0;v--){let x=(v+m+1)%(r.openStart+1),w=h[x];if(w)for(let k=0;k<l.length;k++){let _=l[(k+d)%l.length],N=!0;_<0&&(N=!1,_=-_);let M=s.node(_-1),C=s.index(_-1);if(M.canReplaceWith(C,C,w.type,w.marks))return n.replace(s.before(_),N?a.after(_):t,new ne(sS(r.content,0,r.openStart,x),x,r.openEnd))}}let y=n.steps.length;for(let v=l.length-1;v>=0&&(n.replace(e,t,r),!(n.steps.length>y));v--){let x=l[v];x<0||(e=s.before(x),t=a.after(x))}}function sS(n,e,t,r,s){if(e<t){let a=n.firstChild;n=n.replaceChild(0,a.copy(sS(a.content,e+1,t,r,a)))}if(e>r){let a=s.contentMatchAt(0),l=a.fillBefore(n).append(n);n=l.append(a.matchFragment(l).fillBefore(J.empty,!0))}return n}function gM(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let s=dM(n.doc,e,r.type);s!=null&&(e=t=s)}n.replaceRange(e,t,new ne(J.from(r),0,0))}function yM(n,e,t){let r=n.doc.resolve(e),s=n.doc.resolve(t),a=iS(r,s);for(let l=0;l<a.length;l++){let u=a[l],d=l==a.length-1;if(d&&u==0||r.node(u).type.contentMatch.validEnd)return n.delete(r.start(u),s.end(u));if(u>0&&(d||r.node(u-1).canReplace(r.index(u-1),s.indexAfter(u-1))))return n.delete(r.before(u),s.after(u))}for(let l=1;l<=r.depth&&l<=s.depth;l++)if(e-r.start(l)==r.depth-l&&t>r.end(l)&&s.end(l)-t!=s.depth-l&&r.start(l-1)==s.start(l-1)&&r.node(l-1).canReplace(r.index(l-1),s.index(l-1)))return n.delete(r.before(l),t);n.delete(e,t)}function iS(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let s=r;s>=0;s--){let a=n.start(s);if(a<n.pos-(n.depth-s)||e.end(s)>e.pos+(e.depth-s)||n.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(a==e.start(s)||s==n.depth&&s==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==a-1)&&t.push(s)}return t}class Sa extends qt{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return ft.fail("No node at attribute step's position");let r=Object.create(null);for(let a in t.attrs)r[a]=t.attrs[a];r[this.attr]=this.value;let s=t.type.create(r,null,t.marks);return ft.fromReplace(e,this.pos,this.pos+1,new ne(J.from(s),0,t.isLeaf?0:1))}getMap(){return pn.empty}invert(e){return new Sa(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Sa(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Sa(t.pos,t.attr,t.value)}}qt.jsonID("attr",Sa);class gl extends qt{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let s in e.attrs)t[s]=e.attrs[s];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return ft.ok(r)}getMap(){return pn.empty}invert(e){return new gl(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new gl(t.attr,t.value)}}qt.jsonID("docAttr",gl);let Ea=class extends Error{};Ea=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Ea.prototype=Object.create(Error.prototype);Ea.prototype.constructor=Ea;Ea.prototype.name="TransformError";class aS{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new ml}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Ea(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=ne.empty){let s=wd(this.doc,e,t,r);return s&&this.step(s),this}replaceWith(e,t,r){return this.replace(e,t,new ne(J.from(r),0,0))}delete(e,t){return this.replace(e,t,ne.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return mM(this,e,t,r),this}replaceRangeWith(e,t,r){return gM(this,e,t,r),this}deleteRange(e,t){return yM(this,e,t),this}lift(e,t){return tM(this,e,t),this}join(e,t=1){return uM(this,e,t),this}wrap(e,t){return sM(this,e,t),this}setBlockType(e,t=e,r,s=null){return iM(this,e,t,r,s),this}setNodeMarkup(e,t,r=null,s){return oM(this,e,t,r,s),this}setNodeAttribute(e,t,r){return this.step(new Sa(e,t,r)),this}setDocAttribute(e,t){return this.step(new gl(e,t)),this}addNodeMark(e,t){return this.step(new ms(e,t)),this}removeNodeMark(e,t){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t instanceof Fe)t.isInSet(r.marks)&&this.step(new li(e,t));else{let s=r.marks,a,l=[];for(;a=t.isInSet(s);)l.push(new li(e,a)),s=a.removeFromSet(s);for(let u=l.length-1;u>=0;u--)this.step(l[u])}return this}split(e,t=1,r){return lM(this,e,t,r),this}addMark(e,t,r){return Xj(this,e,t,r),this}removeMark(e,t,r){return Zj(this,e,t,r),this}clearIncompatible(e,t,r){return Gm(this,e,t,r),this}}const bp=Object.create(null);class ke{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new bM(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=ne.empty){let r=t.content.lastChild,s=null;for(let u=0;u<t.openEnd;u++)s=r,r=r.lastChild;let a=e.steps.length,l=this.ranges;for(let u=0;u<l.length;u++){let{$from:d,$to:h}=l[u],m=e.mapping.slice(a);e.replaceRange(m.map(d.pos),m.map(h.pos),u?ne.empty:t),u==0&&Cx(e,a,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:u}=s[a],d=e.mapping.slice(r),h=d.map(l.pos),m=d.map(u.pos);a?e.deleteRange(h,m):(e.replaceRangeWith(h,m,t),Cx(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let s=e.parent.inlineContent?new ve(e):ga(e.node(0),e.parent,e.pos,e.index(),t,r);if(s)return s;for(let a=e.depth-1;a>=0;a--){let l=t<0?ga(e.node(0),e.node(a),e.before(a+1),e.index(a),t,r):ga(e.node(0),e.node(a),e.after(a+1),e.index(a)+1,t,r);if(l)return l}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new mn(e.node(0))}static atStart(e){return ga(e,e,0,0,1)||new mn(e)}static atEnd(e){return ga(e,e,e.content.size,e.childCount,-1)||new mn(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=bp[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in bp)throw new RangeError("Duplicate use of selection JSON ID "+e);return bp[e]=t,t.prototype.jsonID=e,t}getBookmark(){return ve.between(this.$anchor,this.$head).getBookmark()}}ke.prototype.visible=!0;class bM{constructor(e,t){this.$from=e,this.$to=t}}let Ex=!1;function Nx(n){!Ex&&!n.parent.inlineContent&&(Ex=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class ve extends ke{constructor(e,t=e){Nx(e),Nx(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return ke.near(r);let s=e.resolve(t.map(this.anchor));return new ve(s.parent.inlineContent?s:r,r)}replace(e,t=ne.empty){if(super.replace(e,t),t==ne.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof ve&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Sd(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new ve(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let s=e.resolve(t);return new this(s,r==t?s:e.resolve(r))}static between(e,t,r){let s=e.pos-t.pos;if((!r||s)&&(r=s>=0?1:-1),!t.parent.inlineContent){let a=ke.findFrom(t,r,!0)||ke.findFrom(t,-r,!0);if(a)t=a.$head;else return ke.near(t,r)}return e.parent.inlineContent||(s==0?e=t:(e=(ke.findFrom(e,-r,!0)||ke.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=s<0&&(e=t))),new ve(e,t)}}ke.jsonID("text",ve);class Sd{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Sd(e.map(this.anchor),e.map(this.head))}resolve(e){return ve.between(e.resolve(this.anchor),e.resolve(this.head))}}class ue extends ke{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:s}=t.mapResult(this.anchor),a=e.resolve(s);return r?ke.near(a):new ue(a)}content(){return new ne(J.from(this.node),0,0)}eq(e){return e instanceof ue&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Ym(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ue(e.resolve(t.anchor))}static create(e,t){return new ue(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}ue.prototype.visible=!1;ke.jsonID("node",ue);class Ym{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new Sd(r,r):new Ym(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&ue.isSelectable(r)?new ue(t):ke.near(t)}}class mn extends ke{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=ne.empty){if(t==ne.empty){e.delete(0,e.doc.content.size);let r=ke.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new mn(e)}map(e){return new mn(e)}eq(e){return e instanceof mn}getBookmark(){return vM}}ke.jsonID("all",mn);const vM={map(){return this},resolve(n){return new mn(n)}};function ga(n,e,t,r,s,a=!1){if(e.inlineContent)return ve.create(n,t);for(let l=r-(s>0?0:1);s>0?l<e.childCount:l>=0;l+=s){let u=e.child(l);if(u.isAtom){if(!a&&ue.isSelectable(u))return ue.create(n,t-(s<0?u.nodeSize:0))}else{let d=ga(n,u,t+s,s<0?u.childCount:0,s,a);if(d)return d}t+=u.nodeSize*s}return null}function Cx(n,e,t){let r=n.steps.length-1;if(r<e)return;let s=n.steps[r];if(!(s instanceof Ct||s instanceof Tt))return;let a=n.mapping.maps[r],l;a.forEach((u,d,h,m)=>{l==null&&(l=m)}),n.setSelection(ke.near(n.doc.resolve(l),t))}const Tx=1,su=2,jx=4;class xM extends aS{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Tx)&~su,this.storedMarks=null,this}get selectionSet(){return(this.updated&Tx)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=su,this}ensureMarks(e){return Fe.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&su)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~su,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Fe.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let s=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let a=this.storedMarks;if(!a){let l=this.doc.resolve(t);a=r==t?l.marks():l.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,s.text(e,a)),this.selection.empty||this.setSelection(ke.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=jx,this}get scrolledIntoView(){return(this.updated&jx)>0}}function Mx(n,e){return!e||!n?n:n.bind(e)}class Yo{constructor(e,t,r){this.name=e,this.init=Mx(t.init,r),this.apply=Mx(t.apply,r)}}const wM=[new Yo("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Yo("selection",{init(n,e){return n.selection||ke.atStart(e.doc)},apply(n){return n.selection}}),new Yo("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Yo("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class vp{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=wM.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Yo(r.key,r.spec.state,r))})}}class wa{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),s=null;for(;;){let a=!1;for(let l=0;l<this.config.plugins.length;l++){let u=this.config.plugins[l];if(u.spec.appendTransaction){let d=s?s[l].n:0,h=s?s[l].state:this,m=d<t.length&&u.spec.appendTransaction.call(u,d?t.slice(d):t,h,r);if(m&&r.filterTransaction(m,l)){if(m.setMeta("appendedTransaction",e),!s){s=[];for(let y=0;y<this.config.plugins.length;y++)s.push(y<l?{state:r,n:t.length}:{state:this,n:0})}t.push(m),r=r.applyInner(m),a=!0}s&&(s[l]={state:r,n:t.length})}}if(!a)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new wa(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let a=r[s];t[a.name]=a.apply(e,this[a.name],this,t)}return t}get tr(){return new xM(this)}static create(e){let t=new vp(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new wa(t);for(let s=0;s<t.fields.length;s++)r[t.fields[s].name]=t.fields[s].init(e,r);return r}reconfigure(e){let t=new vp(this.schema,e.plugins),r=t.fields,s=new wa(t);for(let a=0;a<r.length;a++){let l=r[a].name;s[l]=this.hasOwnProperty(l)?this[l]:r[a].init(e,s)}return s}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],a=s.spec.state;a&&a.toJSON&&(t[r]=a.toJSON.call(s,this[s.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new vp(e.schema,e.plugins),a=new wa(s);return s.fields.forEach(l=>{if(l.name=="doc")a.doc=Hn.fromJSON(e.schema,t.doc);else if(l.name=="selection")a.selection=ke.fromJSON(a.doc,t.selection);else if(l.name=="storedMarks")t.storedMarks&&(a.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let u in r){let d=r[u],h=d.spec.state;if(d.key==l.name&&h&&h.fromJSON&&Object.prototype.hasOwnProperty.call(t,u)){a[l.name]=h.fromJSON.call(d,e,t[u],a);return}}a[l.name]=l.init(e,a)}}),a}}function oS(n,e,t){for(let r in n){let s=n[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=oS(s,e,{})),t[r]=s}return t}class at{constructor(e){this.spec=e,this.props={},e.props&&oS(e.props,this,this.props),this.key=e.key?e.key.key:lS("plugin")}getState(e){return e[this.key]}}const xp=Object.create(null);function lS(n){return n in xp?n+"$"+ ++xp[n]:(xp[n]=0,n+"$")}class Mt{constructor(e="key"){this.key=lS(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Bt=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},Na=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let lm=null;const Er=function(n,e,t){let r=lm||(lm=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},SM=function(){lm=null},ci=function(n,e,t,r){return t&&(Ax(n,e,t,r,-1)||Ax(n,e,t,r,1))},kM=/^(img|br|input|textarea|hr)$/i;function Ax(n,e,t,r,s){for(var a;;){if(n==t&&e==r)return!0;if(e==(s<0?0:Mn(n))){let l=n.parentNode;if(!l||l.nodeType!=1||Ml(n)||kM.test(n.nodeName)||n.contentEditable=="false")return!1;e=Bt(n)+(s<0?0:1),n=l}else if(n.nodeType==1){let l=n.childNodes[e+(s<0?-1:0)];if(l.nodeType==1&&l.contentEditable=="false")if(!((a=l.pmViewDesc)===null||a===void 0)&&a.ignoreForSelection)e+=s;else return!1;else n=l,e=s<0?Mn(n):0}else return!1}}function Mn(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function _M(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=Mn(n)}else if(n.parentNode&&!Ml(n))e=Bt(n),n=n.parentNode;else return null}}function EM(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!Ml(n))e=Bt(n)+1,n=n.parentNode;else return null}}function NM(n,e,t){for(let r=e==0,s=e==Mn(n);r||s;){if(n==t)return!0;let a=Bt(n);if(n=n.parentNode,!n)return!1;r=r&&a==0,s=s&&a==Mn(n)}}function Ml(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const kd=function(n){return n.focusNode&&ci(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function Qs(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function CM(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function TM(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:Math.min(Mn(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:Math.min(Mn(r.startContainer),r.startOffset)}}}const Zn=typeof navigator<"u"?navigator:null,Ox=typeof document<"u"?document:null,Ns=Zn&&Zn.userAgent||"",cm=/Edge\/(\d+)/.exec(Ns),cS=/MSIE \d/.exec(Ns),um=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ns),an=!!(cS||um||cm),bs=cS?document.documentMode:um?+um[1]:cm?+cm[1]:0,Vn=!an&&/gecko\/(\d+)/i.test(Ns);Vn&&+(/Firefox\/(\d+)/.exec(Ns)||[0,0])[1];const dm=!an&&/Chrome\/(\d+)/.exec(Ns),Ht=!!dm,uS=dm?+dm[1]:0,Gt=!an&&!!Zn&&/Apple Computer/.test(Zn.vendor),Ca=Gt&&(/Mobile\/\w+/.test(Ns)||!!Zn&&Zn.maxTouchPoints>2),jn=Ca||(Zn?/Mac/.test(Zn.platform):!1),jM=Zn?/Win/.test(Zn.platform):!1,Nr=/Android \d/.test(Ns),Al=!!Ox&&"webkitFontSmoothing"in Ox.documentElement.style,MM=Al?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function AM(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function br(n,e){return typeof n=="number"?n:n[e]}function OM(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function Rx(n,e,t){let r=n.someProp("scrollThreshold")||0,s=n.someProp("scrollMargin")||5,a=n.dom.ownerDocument;for(let l=t||n.dom;l;){if(l.nodeType!=1){l=Na(l);continue}let u=l,d=u==a.body,h=d?AM(a):OM(u),m=0,y=0;if(e.top<h.top+br(r,"top")?y=-(h.top-e.top+br(s,"top")):e.bottom>h.bottom-br(r,"bottom")&&(y=e.bottom-e.top>h.bottom-h.top?e.top+br(s,"top")-h.top:e.bottom-h.bottom+br(s,"bottom")),e.left<h.left+br(r,"left")?m=-(h.left-e.left+br(s,"left")):e.right>h.right-br(r,"right")&&(m=e.right-h.right+br(s,"right")),m||y)if(d)a.defaultView.scrollBy(m,y);else{let x=u.scrollLeft,w=u.scrollTop;y&&(u.scrollTop+=y),m&&(u.scrollLeft+=m);let k=u.scrollLeft-x,_=u.scrollTop-w;e={left:e.left-k,top:e.top-_,right:e.right-k,bottom:e.bottom-_}}let v=d?"fixed":getComputedStyle(l).position;if(/^(fixed|sticky)$/.test(v))break;l=v=="absolute"?l.offsetParent:Na(l)}}function RM(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,s;for(let a=(e.left+e.right)/2,l=t+1;l<Math.min(innerHeight,e.bottom);l+=5){let u=n.root.elementFromPoint(a,l);if(!u||u==n.dom||!n.dom.contains(u))continue;let d=u.getBoundingClientRect();if(d.top>=t-20){r=u,s=d.top;break}}return{refDOM:r,refTop:s,stack:dS(n.dom)}}function dS(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=Na(r));return e}function DM({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;fS(t,r==0?0:r-e)}function fS(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:s,left:a}=n[t];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=a&&(r.scrollLeft=a)}}let fa=null;function LM(n){if(n.setActive)return n.setActive();if(fa)return n.focus(fa);let e=dS(n);n.focus(fa==null?{get preventScroll(){return fa={preventScroll:!0},!0}}:void 0),fa||(fa=!1,fS(e,0))}function hS(n,e){let t,r=2e8,s,a=0,l=e.top,u=e.top,d,h;for(let m=n.firstChild,y=0;m;m=m.nextSibling,y++){let v;if(m.nodeType==1)v=m.getClientRects();else if(m.nodeType==3)v=Er(m).getClientRects();else continue;for(let x=0;x<v.length;x++){let w=v[x];if(w.top<=l&&w.bottom>=u){l=Math.max(w.bottom,l),u=Math.min(w.top,u);let k=w.left>e.left?w.left-e.left:w.right<e.left?e.left-w.right:0;if(k<r){t=m,r=k,s=k&&t.nodeType==3?{left:w.right<e.left?w.right:w.left,top:e.top}:e,m.nodeType==1&&k&&(a=y+(e.left>=(w.left+w.right)/2?1:0));continue}}else w.top>e.top&&!d&&w.left<=e.left&&w.right>=e.left&&(d=m,h={left:Math.max(w.left,Math.min(w.right,e.left)),top:w.top});!t&&(e.left>=w.right&&e.top>=w.top||e.left>=w.left&&e.top>=w.bottom)&&(a=y+1)}}return!t&&d&&(t=d,s=h,r=0),t&&t.nodeType==3?BM(t,s):!t||r&&t.nodeType==1?{node:n,offset:a}:hS(t,s)}function BM(n,e){let t=n.nodeValue.length,r=document.createRange();for(let s=0;s<t;s++){r.setEnd(n,s+1),r.setStart(n,s);let a=is(r,1);if(a.top!=a.bottom&&Jm(e,a))return{node:n,offset:s+(e.left>=(a.left+a.right)/2?1:0)}}return{node:n,offset:0}}function Jm(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function zM(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function UM(n,e,t){let{node:r,offset:s}=hS(e,t),a=-1;if(r.nodeType==1&&!r.firstChild){let l=r.getBoundingClientRect();a=l.left!=l.right&&t.left>(l.left+l.right)/2?1:-1}return n.docView.posFromDOM(r,s,a)}function PM(n,e,t,r){let s=-1;for(let a=e,l=!1;a!=n.dom;){let u=n.docView.nearestDesc(a,!0),d;if(!u)return null;if(u.dom.nodeType==1&&(u.node.isBlock&&u.parent||!u.contentDOM)&&((d=u.dom.getBoundingClientRect()).width||d.height)&&(u.node.isBlock&&u.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(u.dom.nodeName)&&(!l&&d.left>r.left||d.top>r.top?s=u.posBefore:(!l&&d.right<r.left||d.bottom<r.top)&&(s=u.posAfter),l=!0),!u.contentDOM&&s<0&&!u.node.isText))return(u.node.isBlock?r.top<(d.top+d.bottom)/2:r.left<(d.left+d.right)/2)?u.posBefore:u.posAfter;a=u.dom.parentNode}return s>-1?s:n.docView.posFromDOM(e,t,-1)}function pS(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),a=s;;){let l=n.childNodes[a];if(l.nodeType==1){let u=l.getClientRects();for(let d=0;d<u.length;d++){let h=u[d];if(Jm(e,h))return pS(l,e,h)}}if((a=(a+1)%r)==s)break}return n}function $M(n,e){let t=n.dom.ownerDocument,r,s=0,a=TM(t,e.left,e.top);a&&({node:r,offset:s}=a);let l=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),u;if(!l||!n.dom.contains(l.nodeType!=1?l.parentNode:l)){let h=n.dom.getBoundingClientRect();if(!Jm(e,h)||(l=pS(n.dom,e,h),!l))return null}if(Gt)for(let h=l;r&&h;h=Na(h))h.draggable&&(r=void 0);if(l=zM(l,e),r){if(Vn&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let m=r.childNodes[s],y;m.nodeName=="IMG"&&(y=m.getBoundingClientRect()).right<=e.left&&y.bottom>e.top&&s++}let h;Al&&s&&r.nodeType==1&&(h=r.childNodes[s-1]).nodeType==1&&h.contentEditable=="false"&&h.getBoundingClientRect().top>=e.top&&s--,r==n.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?u=n.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(u=PM(n,r,s,e))}u==null&&(u=UM(n,l,e));let d=n.docView.nearestDesc(l,!0);return{pos:u,inside:d?d.posAtStart-d.border:-1}}function Dx(n){return n.top<n.bottom||n.left<n.right}function is(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(Dx(r))return r}return Array.prototype.find.call(t,Dx)||n.getBoundingClientRect()}const IM=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function mS(n,e,t){let{node:r,offset:s,atom:a}=n.docView.domFromPos(e,t<0?-1:1),l=Al||Vn;if(r.nodeType==3)if(l&&(IM.test(r.nodeValue)||(t<0?!s:s==r.nodeValue.length))){let d=is(Er(r,s,s),t);if(Vn&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let h=is(Er(r,s-1,s-1),-1);if(h.top==d.top){let m=is(Er(r,s,s+1),-1);if(m.top!=d.top)return qo(m,m.left<h.left)}}return d}else{let d=s,h=s,m=t<0?1:-1;return t<0&&!s?(h++,m=-1):t>=0&&s==r.nodeValue.length?(d--,m=1):t<0?d--:h++,qo(is(Er(r,d,h),m),m<0)}if(!n.state.doc.resolve(e-(a||0)).parent.inlineContent){if(a==null&&s&&(t<0||s==Mn(r))){let d=r.childNodes[s-1];if(d.nodeType==1)return wp(d.getBoundingClientRect(),!1)}if(a==null&&s<Mn(r)){let d=r.childNodes[s];if(d.nodeType==1)return wp(d.getBoundingClientRect(),!0)}return wp(r.getBoundingClientRect(),t>=0)}if(a==null&&s&&(t<0||s==Mn(r))){let d=r.childNodes[s-1],h=d.nodeType==3?Er(d,Mn(d)-(l?0:1)):d.nodeType==1&&(d.nodeName!="BR"||!d.nextSibling)?d:null;if(h)return qo(is(h,1),!1)}if(a==null&&s<Mn(r)){let d=r.childNodes[s];for(;d.pmViewDesc&&d.pmViewDesc.ignoreForCoords;)d=d.nextSibling;let h=d?d.nodeType==3?Er(d,0,l?0:1):d.nodeType==1?d:null:null;if(h)return qo(is(h,-1),!0)}return qo(is(r.nodeType==3?Er(r):r,-t),t>=0)}function qo(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function wp(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function gS(n,e,t){let r=n.state,s=n.root.activeElement;r!=e&&n.updateState(e),s!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),s!=n.dom&&s&&s.focus()}}function HM(n,e,t){let r=e.selection,s=t=="up"?r.$from:r.$to;return gS(n,e,()=>{let{node:a}=n.docView.domFromPos(s.pos,t=="up"?-1:1);for(;;){let u=n.docView.nearestDesc(a,!0);if(!u)break;if(u.node.isBlock){a=u.contentDOM||u.dom;break}a=u.dom.parentNode}let l=mS(n,s.pos,1);for(let u=a.firstChild;u;u=u.nextSibling){let d;if(u.nodeType==1)d=u.getClientRects();else if(u.nodeType==3)d=Er(u,0,u.nodeValue.length).getClientRects();else continue;for(let h=0;h<d.length;h++){let m=d[h];if(m.bottom>m.top+1&&(t=="up"?l.top-m.top>(m.bottom-l.top)*2:m.bottom-l.bottom>(l.bottom-m.top)*2))return!1}}return!0})}const qM=/[\u0590-\u08ac]/;function VM(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,a=!s,l=s==r.parent.content.size,u=n.domSelection();return u?!qM.test(r.parent.textContent)||!u.modify?t=="left"||t=="backward"?a:l:gS(n,e,()=>{let{focusNode:d,focusOffset:h,anchorNode:m,anchorOffset:y}=n.domSelectionRange(),v=u.caretBidiLevel;u.modify("move",t,"character");let x=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:w,focusOffset:k}=n.domSelectionRange(),_=w&&!x.contains(w.nodeType==1?w:w.parentNode)||d==w&&h==k;try{u.collapse(m,y),d&&(d!=m||h!=y)&&u.extend&&u.extend(d,h)}catch{}return v!=null&&(u.caretBidiLevel=v),_}):r.pos==r.start()||r.pos==r.end()}let Lx=null,Bx=null,zx=!1;function FM(n,e,t){return Lx==e&&Bx==t?zx:(Lx=e,Bx=t,zx=t=="up"||t=="down"?HM(n,e,t):VM(n,e,t))}const Rn=0,Ux=1,Xs=2,er=3;class Ol{constructor(e,t,r,s){this.parent=e,this.children=t,this.dom=r,this.contentDOM=s,this.dirty=Rn,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let s=this.children[t];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let a,l;if(e==this.contentDOM)a=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.previousSibling}for(;a&&!((l=a.pmViewDesc)&&l.parent==this);)a=a.previousSibling;return a?this.posBeforeChild(l)+l.size:this.posAtStart}else{let a,l;if(e==this.contentDOM)a=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.nextSibling}for(;a&&!((l=a.pmViewDesc)&&l.parent==this);)a=a.nextSibling;return a?this.posBeforeChild(l):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=t>Bt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let a=e;;a=a.parentNode){if(a==this.dom){s=!1;break}if(a.previousSibling)break}if(s==null&&t==e.childNodes.length)for(let a=e;;a=a.parentNode){if(a==this.dom){s=!0;break}if(a.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,s=e;s;s=s.parentNode){let a=this.getDesc(s),l;if(a&&(!t||a.node))if(r&&(l=a.nodeDOM)&&!(l.nodeType==1?l.contains(e.nodeType==1?e:e.parentNode):l==e))r=!1;else return a}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let s=e;s;s=s.parentNode){let a=this.getDesc(s);if(a)return a.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let s=this.children[t],a=r+s.size;if(r==e&&a!=r){for(;!s.border&&s.children.length;)for(let l=0;l<s.children.length;l++){let u=s.children[l];if(u.size){s=u;break}}return s}if(e<a)return s.descAt(e-r-s.border);r=a}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let a=0;r<this.children.length;r++){let l=this.children[r],u=a+l.size;if(u>e||l instanceof bS){s=e-a;break}a=u}if(s)return this.children[r].domFromPos(s-this.children[r].border,t);for(let a;r&&!(a=this.children[r-1]).size&&a instanceof yS&&a.side>=0;r--);if(t<=0){let a,l=!0;for(;a=r?this.children[r-1]:null,!(!a||a.dom.parentNode==this.contentDOM);r--,l=!1);return a&&t&&l&&!a.border&&!a.domAtom?a.domFromPos(a.size,t):{node:this.contentDOM,offset:a?Bt(a.dom)+1:0}}else{let a,l=!0;for(;a=r<this.children.length?this.children[r]:null,!(!a||a.dom.parentNode==this.contentDOM);r++,l=!1);return a&&l&&!a.border&&!a.domAtom?a.domFromPos(0,t):{node:this.contentDOM,offset:a?Bt(a.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,a=-1;for(let l=r,u=0;;u++){let d=this.children[u],h=l+d.size;if(s==-1&&e<=h){let m=l+d.border;if(e>=m&&t<=h-d.border&&d.node&&d.contentDOM&&this.contentDOM.contains(d.contentDOM))return d.parseRange(e,t,m);e=l;for(let y=u;y>0;y--){let v=this.children[y-1];if(v.size&&v.dom.parentNode==this.contentDOM&&!v.emptyChildAt(1)){s=Bt(v.dom)+1;break}e-=v.size}s==-1&&(s=0)}if(s>-1&&(h>t||u==this.children.length-1)){t=h;for(let m=u+1;m<this.children.length;m++){let y=this.children[m];if(y.size&&y.dom.parentNode==this.contentDOM&&!y.emptyChildAt(-1)){a=Bt(y.dom);break}t+=y.size}a==-1&&(a=this.contentDOM.childNodes.length);break}l=h}return{node:this.contentDOM,from:e,to:t,fromOffset:s,toOffset:a}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,s=!1){let a=Math.min(e,t),l=Math.max(e,t);for(let x=0,w=0;x<this.children.length;x++){let k=this.children[x],_=w+k.size;if(a>w&&l<_)return k.setSelection(e-w-k.border,t-w-k.border,r,s);w=_}let u=this.domFromPos(e,e?-1:1),d=t==e?u:this.domFromPos(t,t?-1:1),h=r.root.getSelection(),m=r.domSelectionRange(),y=!1;if((Vn||Gt)&&e==t){let{node:x,offset:w}=u;if(x.nodeType==3){if(y=!!(w&&x.nodeValue[w-1]==`
`),y&&w==x.nodeValue.length)for(let k=x,_;k;k=k.parentNode){if(_=k.nextSibling){_.nodeName=="BR"&&(u=d={node:_.parentNode,offset:Bt(_)+1});break}let N=k.pmViewDesc;if(N&&N.node&&N.node.isBlock)break}}else{let k=x.childNodes[w-1];y=k&&(k.nodeName=="BR"||k.contentEditable=="false")}}if(Vn&&m.focusNode&&m.focusNode!=d.node&&m.focusNode.nodeType==1){let x=m.focusNode.childNodes[m.focusOffset];x&&x.contentEditable=="false"&&(s=!0)}if(!(s||y&&Gt)&&ci(u.node,u.offset,m.anchorNode,m.anchorOffset)&&ci(d.node,d.offset,m.focusNode,m.focusOffset))return;let v=!1;if((h.extend||e==t)&&!y){h.collapse(u.node,u.offset);try{e!=t&&h.extend(d.node,d.offset),v=!0}catch{}}if(!v){if(e>t){let w=u;u=d,d=w}let x=document.createRange();x.setEnd(d.node,d.offset),x.setStart(u.node,u.offset),h.removeAllRanges(),h.addRange(x)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,s=0;s<this.children.length;s++){let a=this.children[s],l=r+a.size;if(r==l?e<=l&&t>=r:e<l&&t>r){let u=r+a.border,d=l-a.border;if(e>=u&&t<=d){this.dirty=e==r||t==l?Xs:Ux,e==u&&t==d&&(a.contentLost||a.dom.parentNode!=this.contentDOM)?a.dirty=er:a.markDirty(e-u,t-u);return}else a.dirty=a.dom==a.contentDOM&&a.dom.parentNode==this.contentDOM&&!a.children.length?Xs:er}r=l}this.dirty=Xs}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?Xs:Ux;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class yS extends Ol{constructor(e,t,r,s){let a,l=t.type.toDOM;if(typeof l=="function"&&(l=l(r,()=>{if(!a)return s;if(a.parent)return a.parent.posBeforeChild(a)})),!t.type.spec.raw){if(l.nodeType!=1){let u=document.createElement("span");u.appendChild(l),l=u}l.contentEditable="false",l.classList.add("ProseMirror-widget")}super(e,[],l,null),this.widget=t,this.widget=t,a=this}matchesWidget(e){return this.dirty==Rn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class KM extends Ol{constructor(e,t,r,s){super(e,[],t,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class ui extends Ol{constructor(e,t,r,s,a){super(e,[],r,s),this.mark=t,this.spec=a}static create(e,t,r,s){let a=s.nodeViews[t.type.name],l=a&&a(t,s,r);return(!l||!l.dom)&&(l=hi.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new ui(e,t,l.dom,l.contentDOM||l.dom,l)}parseRule(){return this.dirty&er||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=er&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=Rn){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Rn}}slice(e,t,r){let s=ui.create(this.parent,this.mark,!0,r),a=this.children,l=this.size;t<l&&(a=hm(a,t,l,r)),e>0&&(a=hm(a,0,e,r));for(let u=0;u<a.length;u++)a[u].parent=s;return s.children=a,s}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class vs extends Ol{constructor(e,t,r,s,a,l,u,d,h){super(e,[],a,l),this.node=t,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=u}static create(e,t,r,s,a,l){let u=a.nodeViews[t.type.name],d,h=u&&u(t,a,()=>{if(!d)return l;if(d.parent)return d.parent.posBeforeChild(d)},r,s),m=h&&h.dom,y=h&&h.contentDOM;if(t.isText){if(!m)m=document.createTextNode(t.text);else if(m.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else m||({dom:m,contentDOM:y}=hi.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!y&&!t.isText&&m.nodeName!="BR"&&(m.hasAttribute("contenteditable")||(m.contentEditable="false"),t.type.spec.draggable&&(m.draggable=!0));let v=m;return m=wS(m,r,t),h?d=new GM(e,t,r,s,m,y||null,v,h,a,l+1):t.isText?new _d(e,t,r,s,m,v,a):new vs(e,t,r,s,m,y||null,v,a,l+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>J.empty)}return e}matchesNode(e,t,r){return this.dirty==Rn&&e.eq(this.node)&&Mu(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,s=t,a=e.composing?this.localCompositionInfo(e,t):null,l=a&&a.pos>-1?a:null,u=a&&a.pos<0,d=new YM(this,l&&l.node,e);XM(this.node,this.innerDeco,(h,m,y)=>{h.spec.marks?d.syncToMarks(h.spec.marks,r,e):h.type.side>=0&&!y&&d.syncToMarks(m==this.node.childCount?Fe.none:this.node.child(m).marks,r,e),d.placeWidget(h,e,s)},(h,m,y,v)=>{d.syncToMarks(h.marks,r,e);let x;d.findNodeMatch(h,m,y,v)||u&&e.state.selection.from>s&&e.state.selection.to<s+h.nodeSize&&(x=d.findIndexWithChild(a.node))>-1&&d.updateNodeAt(h,m,y,x,e)||d.updateNextNode(h,m,y,e,v,s)||d.addNode(h,m,y,e,s),s+=h.nodeSize}),d.syncToMarks([],r,e),this.node.isTextblock&&d.addTextblockHacks(),d.destroyRest(),(d.changed||this.dirty==Xs)&&(l&&this.protectLocalComposition(e,l),vS(this.contentDOM,this.children,e),Ca&&ZM(this.dom))}localCompositionInfo(e,t){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof ve)||r<t||s>t+this.node.content.size)return null;let a=e.input.compositionNode;if(!a||!this.dom.contains(a.parentNode))return null;if(this.node.inlineContent){let l=a.nodeValue,u=eA(this.node.content,l,r-t,s-t);return u<0?null:{node:a,pos:u,text:l}}else return{node:a,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:s}){if(this.getDesc(t))return;let a=t;for(;a.parentNode!=this.contentDOM;a=a.parentNode){for(;a.previousSibling;)a.parentNode.removeChild(a.previousSibling);for(;a.nextSibling;)a.parentNode.removeChild(a.nextSibling);a.pmViewDesc&&(a.pmViewDesc=void 0)}let l=new KM(this,a,t,s);e.input.compositionNodes.push(l),this.children=hm(this.children,r,r+s.length,e,l)}update(e,t,r,s){return this.dirty==er||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,s),!0)}updateInner(e,t,r,s){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=Rn}updateOuterDeco(e){if(Mu(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=xS(this.dom,this.nodeDOM,fm(this.outerDeco,this.node,t),fm(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function Px(n,e,t,r,s){wS(r,e,n);let a=new vs(void 0,n,e,t,r,r,r,s,0);return a.contentDOM&&a.updateChildren(s,0),a}class _d extends vs{constructor(e,t,r,s,a,l,u){super(e,t,r,s,a,null,l,u,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,s){return this.dirty==er||this.dirty!=Rn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=Rn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=Rn,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let s=this.node.cut(e,t),a=document.createTextNode(s.text);return new _d(this.parent,s,this.outerDeco,this.innerDeco,a,a,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=er)}get domAtom(){return!1}isText(e){return this.node.text==e}}class bS extends Ol{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Rn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class GM extends vs{constructor(e,t,r,s,a,l,u,d,h,m){super(e,t,r,s,a,l,u,h,m),this.spec=d}update(e,t,r,s){if(this.dirty==er)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let a=this.spec.update(e,t,r);return a&&this.updateInner(e,t,r,s),a}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,s){this.spec.setSelection?this.spec.setSelection(e,t,r.root):super.setSelection(e,t,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function vS(n,e,t){let r=n.firstChild,s=!1;for(let a=0;a<e.length;a++){let l=e[a],u=l.dom;if(u.parentNode==n){for(;u!=r;)r=$x(r),s=!0;r=r.nextSibling}else s=!0,n.insertBefore(u,r);if(l instanceof ui){let d=r?r.previousSibling:n.lastChild;vS(l.contentDOM,l.children,t),r=d?d.nextSibling:n.firstChild}}for(;r;)r=$x(r),s=!0;s&&t.trackWrites==n&&(t.trackWrites=null)}const nl=function(n){n&&(this.nodeName=n)};nl.prototype=Object.create(null);const Zs=[new nl];function fm(n,e,t){if(n.length==0)return Zs;let r=t?Zs[0]:new nl,s=[r];for(let a=0;a<n.length;a++){let l=n[a].type.attrs;if(l){l.nodeName&&s.push(r=new nl(l.nodeName));for(let u in l){let d=l[u];d!=null&&(t&&s.length==1&&s.push(r=new nl(e.isInline?"span":"div")),u=="class"?r.class=(r.class?r.class+" ":"")+d:u=="style"?r.style=(r.style?r.style+";":"")+d:u!="nodeName"&&(r[u]=d))}}}return s}function xS(n,e,t,r){if(t==Zs&&r==Zs)return e;let s=e;for(let a=0;a<r.length;a++){let l=r[a],u=t[a];if(a){let d;u&&u.nodeName==l.nodeName&&s!=n&&(d=s.parentNode)&&d.nodeName.toLowerCase()==l.nodeName||(d=document.createElement(l.nodeName),d.pmIsDeco=!0,d.appendChild(s),u=Zs[0]),s=d}WM(s,u||Zs[0],l)}return s}function WM(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=t.class?t.class.split(" ").filter(Boolean):[];for(let a=0;a<r.length;a++)s.indexOf(r[a])==-1&&n.classList.remove(r[a]);for(let a=0;a<s.length;a++)r.indexOf(s[a])==-1&&n.classList.add(s[a]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)n.style.removeProperty(s[1])}t.style&&(n.style.cssText+=t.style)}}function wS(n,e,t){return xS(n,n,Zs,fm(e,t,n.nodeType!=1))}function Mu(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function $x(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class YM{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=JM(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let s=0,a=this.stack.length>>1,l=Math.min(a,e.length);for(;s<l&&(s==a-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<a;)this.destroyRest(),this.top.dirty=Rn,this.index=this.stack.pop(),this.top=this.stack.pop(),a--;for(;a<e.length;){this.stack.push(this.top,this.index+1);let u=-1;for(let d=this.index;d<Math.min(this.index+3,this.top.children.length);d++){let h=this.top.children[d];if(h.matchesMark(e[a])&&!this.isLocked(h.dom)){u=d;break}}if(u>-1)u>this.index&&(this.changed=!0,this.destroyBetween(this.index,u)),this.top=this.top.children[this.index];else{let d=ui.create(this.top,e[a],t,r);this.top.children.splice(this.index,0,d),this.top=d,this.changed=!0}this.index=0,a++}}findNodeMatch(e,t,r,s){let a=-1,l;if(s>=this.preMatch.index&&(l=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&l.matchesNode(e,t,r))a=this.top.children.indexOf(l,this.index);else for(let u=this.index,d=Math.min(this.top.children.length,u+5);u<d;u++){let h=this.top.children[u];if(h.matchesNode(e,t,r)&&!this.preMatch.matched.has(h)){a=u;break}}return a<0?!1:(this.destroyBetween(this.index,a),this.index++,!0)}updateNodeAt(e,t,r,s,a){let l=this.top.children[s];return l.dirty==er&&l.dom==l.contentDOM&&(l.dirty=Xs),l.update(e,t,r,a)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=t}}updateNextNode(e,t,r,s,a,l){for(let u=this.index;u<this.top.children.length;u++){let d=this.top.children[u];if(d instanceof vs){let h=this.preMatch.matched.get(d);if(h!=null&&h!=a)return!1;let m=d.dom,y,v=this.isLocked(m)&&!(e.isText&&d.node&&d.node.isText&&d.nodeDOM.nodeValue==e.text&&d.dirty!=er&&Mu(t,d.outerDeco));if(!v&&d.update(e,t,r,s))return this.destroyBetween(this.index,u),d.dom!=m&&(this.changed=!0),this.index++,!0;if(!v&&(y=this.recreateWrapper(d,e,t,r,s,l)))return this.destroyBetween(this.index,u),this.top.children[this.index]=y,y.contentDOM&&(y.dirty=Xs,y.updateChildren(s,l+1),y.dirty=Rn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,s,a,l){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!Mu(r,e.outerDeco)||!s.eq(e.innerDeco))return null;let u=vs.create(this.top,t,r,s,a,l);if(u.contentDOM){u.children=e.children,e.children=[];for(let d of u.children)d.parent=u}return e.destroy(),u}addNode(e,t,r,s,a){let l=vs.create(this.top,e,t,r,s,a);l.contentDOM&&l.updateChildren(s,a+1),this.top.children.splice(this.index++,0,l),this.changed=!0}placeWidget(e,t,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let a=new yS(this.top,e,t,r);this.top.children.splice(this.index++,0,a),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof ui;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof _d)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Gt||Ht)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new bS(this.top,[],r,null);t!=this.top?t.children.push(s):t.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function JM(n,e){let t=e,r=t.children.length,s=n.childCount,a=new Map,l=[];e:for(;s>0;){let u;for(;;)if(r){let h=t.children[r-1];if(h instanceof ui)t=h,r=h.children.length;else{u=h,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let d=u.node;if(d){if(d!=n.child(s-1))break;--s,a.set(u,s),l.push(u)}}return{index:s,matched:a,matches:l.reverse()}}function QM(n,e){return n.type.side-e.type.side}function XM(n,e,t,r){let s=e.locals(n),a=0;if(s.length==0){for(let h=0;h<n.childCount;h++){let m=n.child(h);r(m,s,e.forChild(a,m),h),a+=m.nodeSize}return}let l=0,u=[],d=null;for(let h=0;;){let m,y;for(;l<s.length&&s[l].to==a;){let _=s[l++];_.widget&&(m?(y||(y=[m])).push(_):m=_)}if(m)if(y){y.sort(QM);for(let _=0;_<y.length;_++)t(y[_],h,!!d)}else t(m,h,!!d);let v,x;if(d)x=-1,v=d,d=null;else if(h<n.childCount)x=h,v=n.child(h++);else break;for(let _=0;_<u.length;_++)u[_].to<=a&&u.splice(_--,1);for(;l<s.length&&s[l].from<=a&&s[l].to>a;)u.push(s[l++]);let w=a+v.nodeSize;if(v.isText){let _=w;l<s.length&&s[l].from<_&&(_=s[l].from);for(let N=0;N<u.length;N++)u[N].to<_&&(_=u[N].to);_<w&&(d=v.cut(_-a),v=v.cut(0,_-a),w=_,x=-1)}else for(;l<s.length&&s[l].to<w;)l++;let k=v.isInline&&!v.isLeaf?u.filter(_=>!_.inline):u.slice();r(v,k,e.forChild(a,v),x),a=w}}function ZM(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function eA(n,e,t,r){for(let s=0,a=0;s<n.childCount&&a<=r;){let l=n.child(s++),u=a;if(a+=l.nodeSize,!l.isText)continue;let d=l.text;for(;s<n.childCount;){let h=n.child(s++);if(a+=h.nodeSize,!h.isText)break;d+=h.text}if(a>=t){if(a>=r&&d.slice(r-e.length-u,r-u)==e)return r-e.length;let h=u<r?d.lastIndexOf(e,r-u-1):-1;if(h>=0&&h+e.length+u>=t)return u+h;if(t==r&&d.length>=r+e.length-u&&d.slice(r-u,r-u+e.length)==e)return r}}return-1}function hm(n,e,t,r,s){let a=[];for(let l=0,u=0;l<n.length;l++){let d=n[l],h=u,m=u+=d.size;h>=t||m<=e?a.push(d):(h<e&&a.push(d.slice(0,e-h,r)),s&&(a.push(s),s=void 0),m>t&&a.push(d.slice(t-h,d.size,r)))}return a}function Qm(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let s=n.docView.nearestDesc(t.focusNode),a=s&&s.size==0,l=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(l<0)return null;let u=r.resolve(l),d,h;if(kd(t)){for(d=l;s&&!s.node;)s=s.parent;let y=s.node;if(s&&y.isAtom&&ue.isSelectable(y)&&s.parent&&!(y.isInline&&NM(t.focusNode,t.focusOffset,s.dom))){let v=s.posBefore;h=new ue(l==v?u:r.resolve(v))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let y=l,v=l;for(let x=0;x<t.rangeCount;x++){let w=t.getRangeAt(x);y=Math.min(y,n.docView.posFromDOM(w.startContainer,w.startOffset,1)),v=Math.max(v,n.docView.posFromDOM(w.endContainer,w.endOffset,-1))}if(y<0)return null;[d,l]=v==n.state.selection.anchor?[v,y]:[y,v],u=r.resolve(l)}else d=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(d<0)return null}let m=r.resolve(d);if(!h){let y=e=="pointer"||n.state.selection.head<u.pos&&!a?1:-1;h=Xm(n,m,u,y)}return h}function SS(n){return n.editable?n.hasFocus():_S(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function jr(n,e=!1){let t=n.state.selection;if(kS(n,t),!!SS(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Ht){let r=n.domSelectionRange(),s=n.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&ci(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)nA(n);else{let{anchor:r,head:s}=t,a,l;Ix&&!(t instanceof ve)&&(t.$from.parent.inlineContent||(a=Hx(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(l=Hx(n,t.to))),n.docView.setSelection(r,s,n,e),Ix&&(a&&qx(a),l&&qx(l)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&tA(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const Ix=Gt||Ht&&uS<63;function Hx(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),s=r<t.childNodes.length?t.childNodes[r]:null,a=r?t.childNodes[r-1]:null;if(Gt&&s&&s.contentEditable=="false")return Sp(s);if((!s||s.contentEditable=="false")&&(!a||a.contentEditable=="false")){if(s)return Sp(s);if(a)return Sp(a)}}function Sp(n){return n.contentEditable="true",Gt&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function qx(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function tA(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,s=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=s)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!SS(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function nA(n){let e=n.domSelection(),t=document.createRange();if(!e)return;let r=n.cursorWrapper.dom,s=r.nodeName=="IMG";s?t.setStart(r.parentNode,Bt(r)+1):t.setStart(r,0),t.collapse(!0),e.removeAllRanges(),e.addRange(t),!s&&!n.state.selection.visible&&an&&bs<=11&&(r.disabled=!0,r.disabled=!1)}function kS(n,e){if(e instanceof ue){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(Vx(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else Vx(n)}function Vx(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function Xm(n,e,t,r){return n.someProp("createSelectionBetween",s=>s(n,e,t))||ve.between(e,t,r)}function Fx(n){return n.editable&&!n.hasFocus()?!1:_S(n)}function _S(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function rA(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return ci(e.node,e.offset,t.anchorNode,t.anchorOffset)}function pm(n,e){let{$anchor:t,$head:r}=n.selection,s=e>0?t.max(r):t.min(r),a=s.parent.inlineContent?s.depth?n.doc.resolve(e>0?s.after():s.before()):null:s;return a&&ke.findFrom(a,e)}function as(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function Kx(n,e,t){let r=n.state.selection;if(r instanceof ve)if(t.indexOf("s")>-1){let{$head:s}=r,a=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!a||a.isText||!a.isLeaf)return!1;let l=n.state.doc.resolve(s.pos+a.nodeSize*(e<0?-1:1));return as(n,new ve(r.$anchor,l))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let s=pm(n.state,e);return s&&s instanceof ue?as(n,s):!1}else if(!(jn&&t.indexOf("m")>-1)){let s=r.$head,a=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,l;if(!a||a.isText)return!1;let u=e<0?s.pos-a.nodeSize:s.pos;return a.isAtom||(l=n.docView.descAt(u))&&!l.contentDOM?ue.isSelectable(a)?as(n,new ue(e<0?n.state.doc.resolve(s.pos-a.nodeSize):s)):Al?as(n,new ve(n.state.doc.resolve(e<0?u:u+a.nodeSize))):!1:!1}}else return!1;else{if(r instanceof ue&&r.node.isInline)return as(n,new ve(e>0?r.$to:r.$from));{let s=pm(n.state,e);return s?as(n,s):!1}}}function Au(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function rl(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function ha(n,e){return e<0?sA(n):iA(n)}function sA(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s,a,l=!1;for(Vn&&t.nodeType==1&&r<Au(t)&&rl(t.childNodes[r],-1)&&(l=!0);;)if(r>0){if(t.nodeType!=1)break;{let u=t.childNodes[r-1];if(rl(u,-1))s=t,a=--r;else if(u.nodeType==3)t=u,r=t.nodeValue.length;else break}}else{if(ES(t))break;{let u=t.previousSibling;for(;u&&rl(u,-1);)s=t.parentNode,a=Bt(u),u=u.previousSibling;if(u)t=u,r=Au(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}l?mm(n,t,r):s&&mm(n,s,a)}function iA(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s=Au(t),a,l;for(;;)if(r<s){if(t.nodeType!=1)break;let u=t.childNodes[r];if(rl(u,1))a=t,l=++r;else break}else{if(ES(t))break;{let u=t.nextSibling;for(;u&&rl(u,1);)a=u.parentNode,l=Bt(u)+1,u=u.nextSibling;if(u)t=u,r=0,s=Au(t);else{if(t=t.parentNode,t==n.dom)break;r=s=0}}}a&&mm(n,a,l)}function ES(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function aA(n,e){for(;n&&e==n.childNodes.length&&!Ml(n);)e=Bt(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function oA(n,e){for(;n&&!e&&!Ml(n);)e=Bt(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function mm(n,e,t){if(e.nodeType!=3){let a,l;(l=aA(e,t))?(e=l,t=0):(a=oA(e,t))&&(e=a,t=a.nodeValue.length)}let r=n.domSelection();if(!r)return;if(kd(r)){let a=document.createRange();a.setEnd(e,t),a.setStart(e,t),r.removeAllRanges(),r.addRange(a)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:s}=n;setTimeout(()=>{n.state==s&&jr(n)},50)}function Gx(n,e){let t=n.state.doc.resolve(e);if(!(Ht||jM)&&t.parent.inlineContent){let s=n.coordsAtPos(e);if(e>t.start()){let a=n.coordsAtPos(e-1),l=(a.top+a.bottom)/2;if(l>s.top&&l<s.bottom&&Math.abs(a.left-s.left)>1)return a.left<s.left?"ltr":"rtl"}if(e<t.end()){let a=n.coordsAtPos(e+1),l=(a.top+a.bottom)/2;if(l>s.top&&l<s.bottom&&Math.abs(a.left-s.left)>1)return a.left>s.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function Wx(n,e,t){let r=n.state.selection;if(r instanceof ve&&!r.empty||t.indexOf("s")>-1||jn&&t.indexOf("m")>-1)return!1;let{$from:s,$to:a}=r;if(!s.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let l=pm(n.state,e);if(l&&l instanceof ue)return as(n,l)}if(!s.parent.inlineContent){let l=e<0?s:a,u=r instanceof mn?ke.near(l,e):ke.findFrom(l,e);return u?as(n,u):!1}return!1}function Yx(n,e){if(!(n.state.selection instanceof ve))return!0;let{$head:t,$anchor:r,empty:s}=n.state.selection;if(!t.sameParent(r))return!0;if(!s)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let a=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(a&&!a.isText){let l=n.state.tr;return e<0?l.delete(t.pos-a.nodeSize,t.pos):l.delete(t.pos,t.pos+a.nodeSize),n.dispatch(l),!0}return!1}function Jx(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function lA(n){if(!Gt||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Jx(n,r,"true"),setTimeout(()=>Jx(n,r,"false"),20)}return!1}function cA(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function uA(n,e){let t=e.keyCode,r=cA(e);if(t==8||jn&&t==72&&r=="c")return Yx(n,-1)||ha(n,-1);if(t==46&&!e.shiftKey||jn&&t==68&&r=="c")return Yx(n,1)||ha(n,1);if(t==13||t==27)return!0;if(t==37||jn&&t==66&&r=="c"){let s=t==37?Gx(n,n.state.selection.from)=="ltr"?-1:1:-1;return Kx(n,s,r)||ha(n,s)}else if(t==39||jn&&t==70&&r=="c"){let s=t==39?Gx(n,n.state.selection.from)=="ltr"?1:-1:1;return Kx(n,s,r)||ha(n,s)}else{if(t==38||jn&&t==80&&r=="c")return Wx(n,-1,r)||ha(n,-1);if(t==40||jn&&t==78&&r=="c")return lA(n)||Wx(n,1,r)||ha(n,1);if(r==(jn?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function Zm(n,e){n.someProp("transformCopied",x=>{e=x(e,n)});let t=[],{content:r,openStart:s,openEnd:a}=e;for(;s>1&&a>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,a--;let x=r.firstChild;t.push(x.type.name,x.attrs!=x.type.defaultAttrs?x.attrs:null),r=x.content}let l=n.someProp("clipboardSerializer")||hi.fromSchema(n.state.schema),u=AS(),d=u.createElement("div");d.appendChild(l.serializeFragment(r,{document:u}));let h=d.firstChild,m,y=0;for(;h&&h.nodeType==1&&(m=MS[h.nodeName.toLowerCase()]);){for(let x=m.length-1;x>=0;x--){let w=u.createElement(m[x]);for(;d.firstChild;)w.appendChild(d.firstChild);d.appendChild(w),y++}h=d.firstChild}h&&h.nodeType==1&&h.setAttribute("data-pm-slice",`${s} ${a}${y?` -${y}`:""} ${JSON.stringify(t)}`);let v=n.someProp("clipboardTextSerializer",x=>x(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:d,text:v,slice:e}}function NS(n,e,t,r,s){let a=s.parent.type.spec.code,l,u;if(!t&&!e)return null;let d=e&&(r||a||!t);if(d){if(n.someProp("transformPastedText",v=>{e=v(e,a||r,n)}),a)return e?new ne(J.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):ne.empty;let y=n.someProp("clipboardTextParser",v=>v(e,s,r,n));if(y)u=y;else{let v=s.marks(),{schema:x}=n.state,w=hi.fromSchema(x);l=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(k=>{let _=l.appendChild(document.createElement("p"));k&&_.appendChild(w.serializeNode(x.text(k,v)))})}}else n.someProp("transformPastedHTML",y=>{t=y(t,n)}),l=pA(t),Al&&mA(l);let h=l&&l.querySelector("[data-pm-slice]"),m=h&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(h.getAttribute("data-pm-slice")||"");if(m&&m[3])for(let y=+m[3];y>0;y--){let v=l.firstChild;for(;v&&v.nodeType!=1;)v=v.nextSibling;if(!v)break;l=v}if(u||(u=(n.someProp("clipboardParser")||n.someProp("domParser")||ys.fromSchema(n.state.schema)).parseSlice(l,{preserveWhitespace:!!(d||m),context:s,ruleFromNode(v){return v.nodeName=="BR"&&!v.nextSibling&&v.parentNode&&!dA.test(v.parentNode.nodeName)?{ignore:!0}:null}})),m)u=gA(Qx(u,+m[1],+m[2]),m[4]);else if(u=ne.maxOpen(fA(u.content,s),!0),u.openStart||u.openEnd){let y=0,v=0;for(let x=u.content.firstChild;y<u.openStart&&!x.type.spec.isolating;y++,x=x.firstChild);for(let x=u.content.lastChild;v<u.openEnd&&!x.type.spec.isolating;v++,x=x.lastChild);u=Qx(u,y,v)}return n.someProp("transformPasted",y=>{u=y(u,n)}),u}const dA=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function fA(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let s=e.node(t).contentMatchAt(e.index(t)),a,l=[];if(n.forEach(u=>{if(!l)return;let d=s.findWrapping(u.type),h;if(!d)return l=null;if(h=l.length&&a.length&&TS(d,a,u,l[l.length-1],0))l[l.length-1]=h;else{l.length&&(l[l.length-1]=jS(l[l.length-1],a.length));let m=CS(u,d);l.push(m),s=s.matchType(m.type),a=d}}),l)return J.from(l)}return n}function CS(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,J.from(n));return n}function TS(n,e,t,r,s){if(s<n.length&&s<e.length&&n[s]==e[s]){let a=TS(n,e,t,r.lastChild,s+1);if(a)return r.copy(r.content.replaceChild(r.childCount-1,a));if(r.contentMatchAt(r.childCount).matchType(s==n.length-1?t.type:n[s+1]))return r.copy(r.content.append(J.from(CS(t,n,s+1))))}}function jS(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,jS(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(J.empty,!0);return n.copy(t.append(r))}function gm(n,e,t,r,s,a){let l=e<0?n.firstChild:n.lastChild,u=l.content;return n.childCount>1&&(a=0),s<r-1&&(u=gm(u,e,t,r,s+1,a)),s>=t&&(u=e<0?l.contentMatchAt(0).fillBefore(u,a<=s).append(u):u.append(l.contentMatchAt(l.childCount).fillBefore(J.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,l.copy(u))}function Qx(n,e,t){return e<n.openStart&&(n=new ne(gm(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new ne(gm(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const MS={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Xx=null;function AS(){return Xx||(Xx=document.implementation.createHTMLDocument("title"))}let kp=null;function hA(n){let e=window.trustedTypes;return e?(kp||(kp=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),kp.createHTML(n)):n}function pA(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=AS().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),s;if((s=r&&MS[r[1].toLowerCase()])&&(n=s.map(a=>"<"+a+">").join("")+n+s.map(a=>"</"+a+">").reverse().join("")),t.innerHTML=hA(n),s)for(let a=0;a<s.length;a++)t=t.querySelector(s[a])||t;return t}function mA(n){let e=n.querySelectorAll(Ht?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function gA(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:s,openStart:a,openEnd:l}=n;for(let u=r.length-2;u>=0;u-=2){let d=t.nodes[r[u]];if(!d||d.hasRequiredAttrs())break;s=J.from(d.create(r[u+1],s)),a++,l++}return new ne(s,a,l)}const Wt={},Yt={},yA={touchstart:!0,touchmove:!0};class bA{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function vA(n){for(let e in Wt){let t=Wt[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{wA(n,r)&&!eg(n,r)&&(n.editable||!(r.type in Yt))&&t(n,r)},yA[e]?{passive:!0}:void 0)}Gt&&n.dom.addEventListener("input",()=>null),ym(n)}function gs(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function xA(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function ym(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>eg(n,r))})}function eg(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function wA(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function SA(n,e){!eg(n,e)&&Wt[e.type]&&(n.editable||!(e.type in Yt))&&Wt[e.type](n,e)}Yt.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!RS(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Nr&&Ht&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),Ca&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",s=>s(n,Qs(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||uA(n,t)?t.preventDefault():gs(n,"key")};Yt.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Yt.keypress=(n,e)=>{let t=e;if(RS(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||jn&&t.metaKey)return;if(n.someProp("handleKeyPress",s=>s(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof ve)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(t.charCode),a=()=>n.state.tr.insertText(s).scrollIntoView();!/[\r\n]/.test(s)&&!n.someProp("handleTextInput",l=>l(n,r.$from.pos,r.$to.pos,s,a))&&n.dispatch(a()),t.preventDefault()}};function Ed(n){return{left:n.clientX,top:n.clientY}}function kA(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function tg(n,e,t,r,s){if(r==-1)return!1;let a=n.state.doc.resolve(r);for(let l=a.depth+1;l>0;l--)if(n.someProp(e,u=>l>a.depth?u(n,t,a.nodeAfter,a.before(l),s,!0):u(n,t,a.node(l),a.before(l),s,!1)))return!0;return!1}function ka(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function _A(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&ue.isSelectable(r)?(ka(n,new ue(t)),!0):!1}function EA(n,e){if(e==-1)return!1;let t=n.state.selection,r,s;t instanceof ue&&(r=t.node);let a=n.state.doc.resolve(e);for(let l=a.depth+1;l>0;l--){let u=l>a.depth?a.nodeAfter:a.node(l);if(ue.isSelectable(u)){r&&t.$from.depth>0&&l>=t.$from.depth&&a.before(t.$from.depth+1)==t.$from.pos?s=a.before(t.$from.depth):s=a.before(l);break}}return s!=null?(ka(n,ue.create(n.state.doc,s)),!0):!1}function NA(n,e,t,r,s){return tg(n,"handleClickOn",e,t,r)||n.someProp("handleClick",a=>a(n,e,r))||(s?EA(n,t):_A(n,t))}function CA(n,e,t,r){return tg(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",s=>s(n,e,r))}function TA(n,e,t,r){return tg(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",s=>s(n,e,r))||jA(n,t,r)}function jA(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(ka(n,ve.create(r,0,r.content.size)),!0):!1;let s=r.resolve(e);for(let a=s.depth+1;a>0;a--){let l=a>s.depth?s.nodeAfter:s.node(a),u=s.before(a);if(l.inlineContent)ka(n,ve.create(r,u+1,u+1+l.content.size));else if(ue.isSelectable(l))ka(n,ue.create(r,u));else continue;return!0}}function ng(n){return Ou(n)}const OS=jn?"metaKey":"ctrlKey";Wt.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=ng(n),s=Date.now(),a="singleClick";s-n.input.lastClick.time<500&&kA(t,n.input.lastClick)&&!t[OS]&&n.input.lastClick.button==t.button&&(n.input.lastClick.type=="singleClick"?a="doubleClick":n.input.lastClick.type=="doubleClick"&&(a="tripleClick")),n.input.lastClick={time:s,x:t.clientX,y:t.clientY,type:a,button:t.button};let l=n.posAtCoords(Ed(t));l&&(a=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new MA(n,l,t,!!r)):(a=="doubleClick"?CA:TA)(n,l.pos,l.inside,t)?t.preventDefault():gs(n,"pointer"))};class MA{constructor(e,t,r,s){this.view=e,this.pos=t,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[OS],this.allowDefault=r.shiftKey;let a,l;if(t.inside>-1)a=e.state.doc.nodeAt(t.inside),l=t.inside;else{let m=e.state.doc.resolve(t.pos);a=m.parent,l=m.depth?m.before():0}const u=s?null:r.target,d=u?e.docView.nearestDesc(u,!0):null;this.target=d&&d.dom.nodeType==1?d.dom:null;let{selection:h}=e.state;(r.button==0&&a.type.spec.draggable&&a.type.spec.selectable!==!1||h instanceof ue&&h.from<=l&&h.to>l)&&(this.mightDrag={node:a,pos:l,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Vn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),gs(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>jr(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Ed(e))),this.updateAllowDefault(e),this.allowDefault||!t?gs(this.view,"pointer"):NA(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Gt&&this.mightDrag&&!this.mightDrag.node.isAtom||Ht&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(ka(this.view,ke.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):gs(this.view,"pointer")}move(e){this.updateAllowDefault(e),gs(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Wt.touchstart=n=>{n.input.lastTouch=Date.now(),ng(n),gs(n,"pointer")};Wt.touchmove=n=>{n.input.lastTouch=Date.now(),gs(n,"pointer")};Wt.contextmenu=n=>ng(n);function RS(n,e){return n.composing?!0:Gt&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const AA=Nr?5e3:-1;Yt.compositionstart=Yt.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof ve&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),Ou(n,!0),n.markCursor=null;else if(Ou(n,!e.selection.empty),Vn&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let s=r.focusNode,a=r.focusOffset;s&&s.nodeType==1&&a!=0;){let l=a<0?s.lastChild:s.childNodes[a-1];if(!l)break;if(l.nodeType==3){let u=n.domSelection();u&&u.collapse(l,l.nodeValue.length);break}else s=l,a=-1}}n.input.composing=!0}DS(n,AA)};Yt.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,DS(n,20))};function DS(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>Ou(n),e))}function LS(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=RA());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function OA(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=_M(e.focusNode,e.focusOffset),r=EM(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let s=r.pmViewDesc,a=n.domObserver.lastChangedTextNode;if(t==a||r==a)return a;if(!s||!s.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let l=t.pmViewDesc;if(!(!l||!l.isText(t.nodeValue)))return r}}return t||r}function RA(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Ou(n,e=!1){if(!(Nr&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),LS(n),e||n.docView&&n.docView.dirty){let t=Qm(n),r=n.state.selection;return t&&!t.eq(r)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function DA(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const yl=an&&bs<15||Ca&&MM<604;Wt.copy=Yt.cut=(n,e)=>{let t=e,r=n.state.selection,s=t.type=="cut";if(r.empty)return;let a=yl?null:t.clipboardData,l=r.content(),{dom:u,text:d}=Zm(n,l);a?(t.preventDefault(),a.clearData(),a.setData("text/html",u.innerHTML),a.setData("text/plain",d)):DA(n,u),s&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function LA(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function BA(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?bl(n,r.value,null,s,e):bl(n,r.textContent,r.innerHTML,s,e)},50)}function bl(n,e,t,r,s){let a=NS(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",d=>d(n,s,a||ne.empty)))return!0;if(!a)return!1;let l=LA(a),u=l?n.state.tr.replaceSelectionWith(l,r):n.state.tr.replaceSelection(a);return n.dispatch(u.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function BS(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Yt.paste=(n,e)=>{let t=e;if(n.composing&&!Nr)return;let r=yl?null:t.clipboardData,s=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&bl(n,BS(r),r.getData("text/html"),s,t)?t.preventDefault():BA(n,t)};class zS{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const zA=jn?"altKey":"ctrlKey";function US(n,e){let t=n.someProp("dragCopies",r=>!r(e));return t??!e[zA]}Wt.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let s=n.state.selection,a=s.empty?null:n.posAtCoords(Ed(t)),l;if(!(a&&a.pos>=s.from&&a.pos<=(s instanceof ue?s.to-1:s.to))){if(r&&r.mightDrag)l=ue.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let y=n.docView.nearestDesc(t.target,!0);y&&y.node.type.spec.draggable&&y!=n.docView&&(l=ue.create(n.state.doc,y.posBefore))}}let u=(l||n.state.selection).content(),{dom:d,text:h,slice:m}=Zm(n,u);(!t.dataTransfer.files.length||!Ht||uS>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(yl?"Text":"text/html",d.innerHTML),t.dataTransfer.effectAllowed="copyMove",yl||t.dataTransfer.setData("text/plain",h),n.dragging=new zS(m,US(n,t),l)};Wt.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Yt.dragover=Yt.dragenter=(n,e)=>e.preventDefault();Yt.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let s=n.posAtCoords(Ed(t));if(!s)return;let a=n.state.doc.resolve(s.pos),l=r&&r.slice;l?n.someProp("transformPasted",w=>{l=w(l,n)}):l=NS(n,BS(t.dataTransfer),yl?null:t.dataTransfer.getData("text/html"),!1,a);let u=!!(r&&US(n,t));if(n.someProp("handleDrop",w=>w(n,t,l||ne.empty,u))){t.preventDefault();return}if(!l)return;t.preventDefault();let d=l?tS(n.state.doc,a.pos,l):a.pos;d==null&&(d=a.pos);let h=n.state.tr;if(u){let{node:w}=r;w?w.replace(h):h.deleteSelection()}let m=h.mapping.map(d),y=l.openStart==0&&l.openEnd==0&&l.content.childCount==1,v=h.doc;if(y?h.replaceRangeWith(m,m,l.content.firstChild):h.replaceRange(m,m,l),h.doc.eq(v))return;let x=h.doc.resolve(m);if(y&&ue.isSelectable(l.content.firstChild)&&x.nodeAfter&&x.nodeAfter.sameMarkup(l.content.firstChild))h.setSelection(new ue(x));else{let w=h.mapping.map(d);h.mapping.maps[h.mapping.maps.length-1].forEach((k,_,N,M)=>w=M),h.setSelection(Xm(n,x,h.doc.resolve(w)))}n.focus(),n.dispatch(h.setMeta("uiEvent","drop"))};Wt.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&jr(n)},20))};Wt.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Wt.beforeinput=(n,e)=>{if(Ht&&Nr&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",a=>a(n,Qs(8,"Backspace")))))return;let{$cursor:s}=n.state.selection;s&&s.pos>0&&n.dispatch(n.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let n in Yt)Wt[n]=Yt[n];function vl(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class Ru{constructor(e,t){this.toDOM=e,this.spec=t||si,this.side=this.spec.side||0}map(e,t,r,s){let{pos:a,deleted:l}=e.mapResult(t.from+s,this.side<0?-1:1);return l?null:new Kt(a-r,a-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Ru&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&vl(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class xs{constructor(e,t){this.attrs=e,this.spec=t||si}map(e,t,r,s){let a=e.map(t.from+s,this.spec.inclusiveStart?-1:1)-r,l=e.map(t.to+s,this.spec.inclusiveEnd?1:-1)-r;return a>=l?null:new Kt(a,l,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof xs&&vl(this.attrs,e.attrs)&&vl(this.spec,e.spec)}static is(e){return e.type instanceof xs}destroy(){}}class rg{constructor(e,t){this.attrs=e,this.spec=t||si}map(e,t,r,s){let a=e.mapResult(t.from+s,1);if(a.deleted)return null;let l=e.mapResult(t.to+s,-1);return l.deleted||l.pos<=a.pos?null:new Kt(a.pos-r,l.pos-r,this)}valid(e,t){let{index:r,offset:s}=e.content.findIndex(t.from),a;return s==t.from&&!(a=e.child(r)).isText&&s+a.nodeSize==t.to}eq(e){return this==e||e instanceof rg&&vl(this.attrs,e.attrs)&&vl(this.spec,e.spec)}destroy(){}}class Kt{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new Kt(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new Kt(e,e,new Ru(t,r))}static inline(e,t,r,s){return new Kt(e,t,new xs(r,s))}static node(e,t,r,s){return new Kt(e,t,new rg(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof xs}get widget(){return this.type instanceof Ru}}const ya=[],si={};class Ze{constructor(e,t){this.local=e.length?e:ya,this.children=t.length?t:ya}static create(e,t){return t.length?Du(t,e,0,si):It}find(e,t,r){let s=[];return this.findInner(e??0,t??1e9,s,0,r),s}findInner(e,t,r,s,a){for(let l=0;l<this.local.length;l++){let u=this.local[l];u.from<=t&&u.to>=e&&(!a||a(u.spec))&&r.push(u.copy(u.from+s,u.to+s))}for(let l=0;l<this.children.length;l+=3)if(this.children[l]<t&&this.children[l+1]>e){let u=this.children[l]+1;this.children[l+2].findInner(e-u,t-u,r,s+u,a)}}map(e,t,r){return this==It||e.maps.length==0?this:this.mapInner(e,t,0,0,r||si)}mapInner(e,t,r,s,a){let l;for(let u=0;u<this.local.length;u++){let d=this.local[u].map(e,r,s);d&&d.type.valid(t,d)?(l||(l=[])).push(d):a.onRemove&&a.onRemove(this.local[u].spec)}return this.children.length?UA(this.children,l||[],e,t,r,s,a):l?new Ze(l.sort(ii),ya):It}add(e,t){return t.length?this==It?Ze.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let s,a=0;e.forEach((u,d)=>{let h=d+r,m;if(m=$S(t,u,h)){for(s||(s=this.children.slice());a<s.length&&s[a]<d;)a+=3;s[a]==d?s[a+2]=s[a+2].addInner(u,m,h+1):s.splice(a,0,d,d+u.nodeSize,Du(m,u,h+1,si)),a+=3}});let l=PS(a?IS(t):t,-r);for(let u=0;u<l.length;u++)l[u].type.valid(e,l[u])||l.splice(u--,1);return new Ze(l.length?this.local.concat(l).sort(ii):this.local,s||this.children)}remove(e){return e.length==0||this==It?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,s=this.local;for(let a=0;a<r.length;a+=3){let l,u=r[a]+t,d=r[a+1]+t;for(let m=0,y;m<e.length;m++)(y=e[m])&&y.from>u&&y.to<d&&(e[m]=null,(l||(l=[])).push(y));if(!l)continue;r==this.children&&(r=this.children.slice());let h=r[a+2].removeInner(l,u+1);h!=It?r[a+2]=h:(r.splice(a,3),a-=3)}if(s.length){for(let a=0,l;a<e.length;a++)if(l=e[a])for(let u=0;u<s.length;u++)s[u].eq(l,t)&&(s==this.local&&(s=this.local.slice()),s.splice(u--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new Ze(s,r):It}forChild(e,t){if(this==It)return this;if(t.isLeaf)return Ze.empty;let r,s;for(let u=0;u<this.children.length;u+=3)if(this.children[u]>=e){this.children[u]==e&&(r=this.children[u+2]);break}let a=e+1,l=a+t.content.size;for(let u=0;u<this.local.length;u++){let d=this.local[u];if(d.from<l&&d.to>a&&d.type instanceof xs){let h=Math.max(a,d.from)-a,m=Math.min(l,d.to)-a;h<m&&(s||(s=[])).push(d.copy(h,m))}}if(s){let u=new Ze(s.sort(ii),ya);return r?new ds([u,r]):u}return r||It}eq(e){if(this==e)return!0;if(!(e instanceof Ze)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return sg(this.localsInner(e))}localsInner(e){if(this==It)return ya;if(e.inlineContent||!this.local.some(xs.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof xs||t.push(this.local[r]);return t}forEachSet(e){e(this)}}Ze.empty=new Ze([],[]);Ze.removeOverlap=sg;const It=Ze.empty;class ds{constructor(e){this.members=e}map(e,t){const r=this.members.map(s=>s.map(e,t,si));return ds.from(r)}forChild(e,t){if(t.isLeaf)return Ze.empty;let r=[];for(let s=0;s<this.members.length;s++){let a=this.members[s].forChild(e,t);a!=It&&(a instanceof ds?r=r.concat(a.members):r.push(a))}return ds.from(r)}eq(e){if(!(e instanceof ds)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let s=0;s<this.members.length;s++){let a=this.members[s].localsInner(e);if(a.length)if(!t)t=a;else{r&&(t=t.slice(),r=!1);for(let l=0;l<a.length;l++)t.push(a[l])}}return t?sg(r?t:t.sort(ii)):ya}static from(e){switch(e.length){case 0:return It;case 1:return e[0];default:return new ds(e.every(t=>t instanceof Ze)?e:e.reduce((t,r)=>t.concat(r instanceof Ze?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function UA(n,e,t,r,s,a,l){let u=n.slice();for(let h=0,m=a;h<t.maps.length;h++){let y=0;t.maps[h].forEach((v,x,w,k)=>{let _=k-w-(x-v);for(let N=0;N<u.length;N+=3){let M=u[N+1];if(M<0||v>M+m-y)continue;let C=u[N]+m-y;x>=C?u[N+1]=v<=C?-2:-1:v>=m&&_&&(u[N]+=_,u[N+1]+=_)}y+=_}),m=t.maps[h].map(m,-1)}let d=!1;for(let h=0;h<u.length;h+=3)if(u[h+1]<0){if(u[h+1]==-2){d=!0,u[h+1]=-1;continue}let m=t.map(n[h]+a),y=m-s;if(y<0||y>=r.content.size){d=!0;continue}let v=t.map(n[h+1]+a,-1),x=v-s,{index:w,offset:k}=r.content.findIndex(y),_=r.maybeChild(w);if(_&&k==y&&k+_.nodeSize==x){let N=u[h+2].mapInner(t,_,m+1,n[h]+a+1,l);N!=It?(u[h]=y,u[h+1]=x,u[h+2]=N):(u[h+1]=-2,d=!0)}else d=!0}if(d){let h=PA(u,n,e,t,s,a,l),m=Du(h,r,0,l);e=m.local;for(let y=0;y<u.length;y+=3)u[y+1]<0&&(u.splice(y,3),y-=3);for(let y=0,v=0;y<m.children.length;y+=3){let x=m.children[y];for(;v<u.length&&u[v]<x;)v+=3;u.splice(v,0,m.children[y],m.children[y+1],m.children[y+2])}}return new Ze(e.sort(ii),u)}function PS(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let s=n[r];t.push(new Kt(s.from+e,s.to+e,s.type))}return t}function PA(n,e,t,r,s,a,l){function u(d,h){for(let m=0;m<d.local.length;m++){let y=d.local[m].map(r,s,h);y?t.push(y):l.onRemove&&l.onRemove(d.local[m].spec)}for(let m=0;m<d.children.length;m+=3)u(d.children[m+2],d.children[m]+h+1)}for(let d=0;d<n.length;d+=3)n[d+1]==-1&&u(n[d+2],e[d]+a+1);return t}function $S(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,s=null;for(let a=0,l;a<n.length;a++)(l=n[a])&&l.from>t&&l.to<r&&((s||(s=[])).push(l),n[a]=null);return s}function IS(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function Du(n,e,t,r){let s=[],a=!1;e.forEach((u,d)=>{let h=$S(n,u,d+t);if(h){a=!0;let m=Du(h,u,t+d+1,r);m!=It&&s.push(d,d+u.nodeSize,m)}});let l=PS(a?IS(n):n,-t).sort(ii);for(let u=0;u<l.length;u++)l[u].type.valid(e,l[u])||(r.onRemove&&r.onRemove(l[u].spec),l.splice(u--,1));return l.length||s.length?new Ze(l,s):It}function ii(n,e){return n.from-e.from||n.to-e.to}function sg(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let s=t+1;s<e.length;s++){let a=e[s];if(a.from==r.from){a.to!=r.to&&(e==n&&(e=n.slice()),e[s]=a.copy(a.from,r.to),Zx(e,s+1,a.copy(r.to,a.to)));continue}else{a.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,a.from),Zx(e,s,r.copy(a.from,r.to)));break}}}return e}function Zx(n,e,t){for(;e<n.length&&ii(t,n[e])>0;)e++;n.splice(e,0,t)}function _p(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=It&&e.push(r)}),n.cursorWrapper&&e.push(Ze.create(n.state.doc,[n.cursorWrapper.deco])),ds.from(e)}const $A={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},IA=an&&bs<=11;class HA{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class qA{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new HA,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);an&&bs<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),IA&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,$A)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Fx(this.view)){if(this.suppressingSelectionUpdates)return jr(this.view);if(an&&bs<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&ci(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let a=e.focusNode;a;a=Na(a))t.add(a);for(let a=e.anchorNode;a;a=Na(a))if(t.has(a)){r=a;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&Fx(e)&&!this.ignoreSelectionChange(r),a=-1,l=-1,u=!1,d=[];if(e.editable)for(let m=0;m<t.length;m++){let y=this.registerMutation(t[m],d);y&&(a=a<0?y.from:Math.min(y.from,a),l=l<0?y.to:Math.max(y.to,l),y.typeOver&&(u=!0))}if(Vn&&d.length){let m=d.filter(y=>y.nodeName=="BR");if(m.length==2){let[y,v]=m;y.parentNode&&y.parentNode.parentNode==v.parentNode?v.remove():y.remove()}else{let{focusNode:y}=this.currentSelection;for(let v of m){let x=v.parentNode;x&&x.nodeName=="LI"&&(!y||KA(e,y)!=x)&&v.remove()}}}let h=null;a<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&kd(r)&&(h=Qm(e))&&h.eq(ke.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,jr(e),this.currentSelection.set(r),e.scrollToSelection()):(a>-1||s)&&(a>-1&&(e.docView.markDirty(a,l),VA(e)),this.handleDOMChange(a,l,u,d),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||jr(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let m=0;m<e.addedNodes.length;m++){let y=e.addedNodes[m];t.push(y),y.nodeType==3&&(this.lastChangedTextNode=y)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,a=e.nextSibling;if(an&&bs<=11&&e.addedNodes.length)for(let m=0;m<e.addedNodes.length;m++){let{previousSibling:y,nextSibling:v}=e.addedNodes[m];(!y||Array.prototype.indexOf.call(e.addedNodes,y)<0)&&(s=y),(!v||Array.prototype.indexOf.call(e.addedNodes,v)<0)&&(a=v)}let l=s&&s.parentNode==e.target?Bt(s)+1:0,u=r.localPosFromDOM(e.target,l,-1),d=a&&a.parentNode==e.target?Bt(a):e.target.childNodes.length,h=r.localPosFromDOM(e.target,d,1);return{from:u,to:h}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let e1=new WeakMap,t1=!1;function VA(n){if(!e1.has(n)&&(e1.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Vn,t1)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),t1=!0}}function n1(n,e){let t=e.startContainer,r=e.startOffset,s=e.endContainer,a=e.endOffset,l=n.domAtPos(n.state.selection.anchor);return ci(l.node,l.offset,s,a)&&([t,r,s,a]=[s,a,t,r]),{anchorNode:t,anchorOffset:r,focusNode:s,focusOffset:a}}function FA(n,e){if(e.getComposedRanges){let s=e.getComposedRanges(n.root)[0];if(s)return n1(n,s)}let t;function r(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?n1(n,t):null}function KA(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function GA(n,e,t){let{node:r,fromOffset:s,toOffset:a,from:l,to:u}=n.docView.parseRange(e,t),d=n.domSelectionRange(),h,m=d.anchorNode;if(m&&n.dom.contains(m.nodeType==1?m:m.parentNode)&&(h=[{node:m,offset:d.anchorOffset}],kd(d)||h.push({node:d.focusNode,offset:d.focusOffset})),Ht&&n.input.lastKeyCode===8)for(let _=a;_>s;_--){let N=r.childNodes[_-1],M=N.pmViewDesc;if(N.nodeName=="BR"&&!M){a=_;break}if(!M||M.size)break}let y=n.state.doc,v=n.someProp("domParser")||ys.fromSchema(n.state.schema),x=y.resolve(l),w=null,k=v.parse(r,{topNode:x.parent,topMatch:x.parent.contentMatchAt(x.index()),topOpen:!0,from:s,to:a,preserveWhitespace:x.parent.type.whitespace=="pre"?"full":!0,findPositions:h,ruleFromNode:WA,context:x});if(h&&h[0].pos!=null){let _=h[0].pos,N=h[1]&&h[1].pos;N==null&&(N=_),w={anchor:_+l,head:N+l}}return{doc:k,sel:w,from:l,to:u}}function WA(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Gt&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||Gt&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const YA=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function JA(n,e,t,r,s){let a=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let X=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,Y=Qm(n,X);if(Y&&!n.state.selection.eq(Y)){if(Ht&&Nr&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",$e=>$e(n,Qs(13,"Enter"))))return;let ye=n.state.tr.setSelection(Y);X=="pointer"?ye.setMeta("pointer",!0):X=="key"&&ye.scrollIntoView(),a&&ye.setMeta("composition",a),n.dispatch(ye)}return}let l=n.state.doc.resolve(e),u=l.sharedDepth(t);e=l.before(u+1),t=n.state.doc.resolve(t).after(u+1);let d=n.state.selection,h=GA(n,e,t),m=n.state.doc,y=m.slice(h.from,h.to),v,x;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(v=n.state.selection.to,x="end"):(v=n.state.selection.from,x="start"),n.input.lastKeyCode=null;let w=ZA(y.content,h.doc.content,h.from,v,x);if(w&&n.input.domChangeCount++,(Ca&&n.input.lastIOSEnter>Date.now()-225||Nr)&&s.some(X=>X.nodeType==1&&!YA.test(X.nodeName))&&(!w||w.endA>=w.endB)&&n.someProp("handleKeyDown",X=>X(n,Qs(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!w)if(r&&d instanceof ve&&!d.empty&&d.$head.sameParent(d.$anchor)&&!n.composing&&!(h.sel&&h.sel.anchor!=h.sel.head))w={start:d.from,endA:d.to,endB:d.to};else{if(h.sel){let X=r1(n,n.state.doc,h.sel);if(X&&!X.eq(n.state.selection)){let Y=n.state.tr.setSelection(X);a&&Y.setMeta("composition",a),n.dispatch(Y)}}return}n.state.selection.from<n.state.selection.to&&w.start==w.endB&&n.state.selection instanceof ve&&(w.start>n.state.selection.from&&w.start<=n.state.selection.from+2&&n.state.selection.from>=h.from?w.start=n.state.selection.from:w.endA<n.state.selection.to&&w.endA>=n.state.selection.to-2&&n.state.selection.to<=h.to&&(w.endB+=n.state.selection.to-w.endA,w.endA=n.state.selection.to)),an&&bs<=11&&w.endB==w.start+1&&w.endA==w.start&&w.start>h.from&&h.doc.textBetween(w.start-h.from-1,w.start-h.from+1)=="  "&&(w.start--,w.endA--,w.endB--);let k=h.doc.resolveNoCache(w.start-h.from),_=h.doc.resolveNoCache(w.endB-h.from),N=m.resolve(w.start),M=k.sameParent(_)&&k.parent.inlineContent&&N.end()>=w.endA,C;if((Ca&&n.input.lastIOSEnter>Date.now()-225&&(!M||s.some(X=>X.nodeName=="DIV"||X.nodeName=="P"))||!M&&k.pos<h.doc.content.size&&(!k.sameParent(_)||!k.parent.inlineContent)&&!/\S/.test(h.doc.textBetween(k.pos,_.pos,"",""))&&(C=ke.findFrom(h.doc.resolve(k.pos+1),1,!0))&&C.head>k.pos)&&n.someProp("handleKeyDown",X=>X(n,Qs(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>w.start&&XA(m,w.start,w.endA,k,_)&&n.someProp("handleKeyDown",X=>X(n,Qs(8,"Backspace")))){Nr&&Ht&&n.domObserver.suppressSelectionUpdates();return}Ht&&w.endB==w.start&&(n.input.lastChromeDelete=Date.now()),Nr&&!M&&k.start()!=_.start()&&_.parentOffset==0&&k.depth==_.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==w.endA&&(w.endB-=2,_=h.doc.resolveNoCache(w.endB-h.from),setTimeout(()=>{n.someProp("handleKeyDown",function(X){return X(n,Qs(13,"Enter"))})},20));let I=w.start,H=w.endA,Q=X=>{let Y=X||n.state.tr.replace(I,H,h.doc.slice(w.start-h.from,w.endB-h.from));if(h.sel){let ye=r1(n,Y.doc,h.sel);ye&&!(Ht&&n.composing&&ye.empty&&(w.start!=w.endB||n.input.lastChromeDelete<Date.now()-100)&&(ye.head==I||ye.head==Y.mapping.map(H)-1)||an&&ye.empty&&ye.head==I)&&Y.setSelection(ye)}return a&&Y.setMeta("composition",a),Y.scrollIntoView()},G;if(M){if(k.pos==_.pos){an&&bs<=11&&k.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>jr(n),20));let X=Q(n.state.tr.delete(I,H)),Y=m.resolve(w.start).marksAcross(m.resolve(w.endA));Y&&X.ensureMarks(Y),n.dispatch(X)}else if(w.endA==w.endB&&(G=QA(k.parent.content.cut(k.parentOffset,_.parentOffset),N.parent.content.cut(N.parentOffset,w.endA-N.start())))){let X=Q(n.state.tr);G.type=="add"?X.addMark(I,H,G.mark):X.removeMark(I,H,G.mark),n.dispatch(X)}else if(k.parent.child(k.index()).isText&&k.index()==_.index()-(_.textOffset?0:1)){let X=k.parent.textBetween(k.parentOffset,_.parentOffset),Y=()=>Q(n.state.tr.insertText(X,I,H));n.someProp("handleTextInput",ye=>ye(n,I,H,X,Y))||n.dispatch(Y())}}else n.dispatch(Q())}function r1(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:Xm(n,e.resolve(t.anchor),e.resolve(t.head))}function QA(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,s=t,a=r,l,u,d;for(let m=0;m<r.length;m++)s=r[m].removeFromSet(s);for(let m=0;m<t.length;m++)a=t[m].removeFromSet(a);if(s.length==1&&a.length==0)u=s[0],l="add",d=m=>m.mark(u.addToSet(m.marks));else if(s.length==0&&a.length==1)u=a[0],l="remove",d=m=>m.mark(u.removeFromSet(m.marks));else return null;let h=[];for(let m=0;m<e.childCount;m++)h.push(d(e.child(m)));if(J.from(h).eq(n))return{mark:u,type:l}}function XA(n,e,t,r,s){if(t-e<=s.pos-r.pos||Ep(r,!0,!1)<s.pos)return!1;let a=n.resolve(e);if(!r.parent.isTextblock){let u=a.nodeAfter;return u!=null&&t==e+u.nodeSize}if(a.parentOffset<a.parent.content.size||!a.parent.isTextblock)return!1;let l=n.resolve(Ep(a,!0,!0));return!l.parent.isTextblock||l.pos>t||Ep(l,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(l.parent.content)}function Ep(n,e,t){let r=n.depth,s=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,s++,e=!1;if(t){let a=n.node(r).maybeChild(n.indexAfter(r));for(;a&&!a.isLeaf;)a=a.firstChild,s++}return s}function ZA(n,e,t,r,s){let a=n.findDiffStart(e,t);if(a==null)return null;let{a:l,b:u}=n.findDiffEnd(e,t+n.size,t+e.size);if(s=="end"){let d=Math.max(0,a-Math.min(l,u));r-=l+d-a}if(l<a&&n.size<e.size){let d=r<=a&&r>=l?a-r:0;a-=d,a&&a<e.size&&s1(e.textBetween(a-1,a+1))&&(a+=d?1:-1),u=a+(u-l),l=a}else if(u<a){let d=r<=a&&r>=u?a-r:0;a-=d,a&&a<n.size&&s1(n.textBetween(a-1,a+1))&&(a+=d?1:-1),l=a+(l-u),u=a}return{start:a,endA:l,endB:u}}function s1(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class HS{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new bA,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(c1),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=o1(this),a1(this),this.nodeViews=l1(this),this.docView=Px(this.state.doc,i1(this),_p(this),this.dom,this),this.domObserver=new qA(this,(r,s,a,l)=>JA(this,r,s,a,l)),this.domObserver.start(),vA(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&ym(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(c1),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let s=this.state,a=!1,l=!1;e.storedMarks&&this.composing&&(LS(this),l=!0),this.state=e;let u=s.plugins!=e.plugins||this._props.plugins!=t.plugins;if(u||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let x=l1(this);t4(x,this.nodeViews)&&(this.nodeViews=x,a=!0)}(u||t.handleDOMEvents!=this._props.handleDOMEvents)&&ym(this),this.editable=o1(this),a1(this);let d=_p(this),h=i1(this),m=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",y=a||!this.docView.matchesNode(e.doc,h,d);(y||!e.selection.eq(s.selection))&&(l=!0);let v=m=="preserve"&&l&&this.dom.style.overflowAnchor==null&&RM(this);if(l){this.domObserver.stop();let x=y&&(an||Ht)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&e4(s.selection,e.selection);if(y){let w=Ht?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=OA(this)),(a||!this.docView.update(e.doc,h,d,this))&&(this.docView.updateOuterDeco(h),this.docView.destroy(),this.docView=Px(e.doc,h,d,this.dom,this)),w&&!this.trackWrites&&(x=!0)}x||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&rA(this))?jr(this,x):(kS(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),m=="reset"?this.dom.scrollTop=0:m=="to selection"?this.scrollToSelection():v&&DM(v)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof ue){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&Rx(this,t.getBoundingClientRect(),e)}else Rx(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let a=r.from+(this.state.doc.content.size-t.doc.content.size);(a>0&&this.state.doc.nodeAt(a))==r.node&&(s=a)}this.dragging=new zS(e.slice,e.move,s<0?void 0:ue.create(this.state.doc,s))}someProp(e,t){let r=this._props&&this._props[e],s;if(r!=null&&(s=t?t(r):r))return s;for(let l=0;l<this.directPlugins.length;l++){let u=this.directPlugins[l].props[e];if(u!=null&&(s=t?t(u):u))return s}let a=this.state.plugins;if(a)for(let l=0;l<a.length;l++){let u=a[l].props[e];if(u!=null&&(s=t?t(u):u))return s}}hasFocus(){if(an){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&LM(this.dom),jr(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return $M(this,e)}coordsAtPos(e,t=1){return mS(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let s=this.docView.posFromDOM(e,t,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,t){return FM(this,t||this.state,e)}pasteHTML(e,t){return bl(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return bl(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return Zm(this,e)}destroy(){this.docView&&(xA(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],_p(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,SM())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return SA(this,e)}domSelectionRange(){let e=this.domSelection();return e?Gt&&this.root.nodeType===11&&CM(this.dom.ownerDocument)==this.dom&&FA(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}HS.prototype.dispatch=function(n){let e=this._props.dispatchTransaction;e?e.call(this,n):this.updateState(this.state.apply(n))};function i1(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[Kt.node(0,n.state.doc.content.size,e)]}function a1(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:Kt.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function o1(n){return!n.someProp("editable",e=>e(n.state)===!1)}function e4(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function l1(n){let e=Object.create(null);function t(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function t4(n,e){let t=0,r=0;for(let s in n){if(n[s]!=e[s])return!0;t++}for(let s in e)r++;return t!=r}function c1(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var ws={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Lu={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},n4=typeof navigator<"u"&&/Mac/.test(navigator.platform),r4=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var zt=0;zt<10;zt++)ws[48+zt]=ws[96+zt]=String(zt);for(var zt=1;zt<=24;zt++)ws[zt+111]="F"+zt;for(var zt=65;zt<=90;zt++)ws[zt]=String.fromCharCode(zt+32),Lu[zt]=String.fromCharCode(zt);for(var Np in ws)Lu.hasOwnProperty(Np)||(Lu[Np]=ws[Np]);function s4(n){var e=n4&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||r4&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Lu:ws)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const i4=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),a4=typeof navigator<"u"&&/Win/.test(navigator.platform);function o4(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,s,a,l;for(let u=0;u<e.length-1;u++){let d=e[u];if(/^(cmd|meta|m)$/i.test(d))l=!0;else if(/^a(lt)?$/i.test(d))r=!0;else if(/^(c|ctrl|control)$/i.test(d))s=!0;else if(/^s(hift)?$/i.test(d))a=!0;else if(/^mod$/i.test(d))i4?l=!0:s=!0;else throw new Error("Unrecognized modifier name: "+d)}return r&&(t="Alt-"+t),s&&(t="Ctrl-"+t),l&&(t="Meta-"+t),a&&(t="Shift-"+t),t}function l4(n){let e=Object.create(null);for(let t in n)e[o4(t)]=n[t];return e}function Cp(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function c4(n){return new at({props:{handleKeyDown:qS(n)}})}function qS(n){let e=l4(n);return function(t,r){let s=s4(r),a,l=e[Cp(s,r)];if(l&&l(t.state,t.dispatch,t))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let u=e[Cp(s,r,!1)];if(u&&u(t.state,t.dispatch,t))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(a4&&r.ctrlKey&&r.altKey)&&(a=ws[r.keyCode])&&a!=s){let u=e[Cp(a,r)];if(u&&u(t.state,t.dispatch,t))return!0}}return!1}}const ig=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function VS(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const FS=(n,e,t)=>{let r=VS(n,t);if(!r)return!1;let s=ag(r);if(!s){let l=r.blockRange(),u=l&&Ba(l);return u==null?!1:(e&&e(n.tr.lift(l,u).scrollIntoView()),!0)}let a=s.nodeBefore;if(e2(n,s,e,-1))return!0;if(r.parent.content.size==0&&(Ta(a,"end")||ue.isSelectable(a)))for(let l=r.depth;;l--){let u=wd(n.doc,r.before(l),r.after(l),ne.empty);if(u&&u.slice.size<u.to-u.from){if(e){let d=n.tr.step(u);d.setSelection(Ta(a,"end")?ke.findFrom(d.doc.resolve(d.mapping.map(s.pos,-1)),-1):ue.create(d.doc,s.pos-a.nodeSize)),e(d.scrollIntoView())}return!0}if(l==1||r.node(l-1).childCount>1)break}return a.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos-a.nodeSize,s.pos).scrollIntoView()),!0):!1},u4=(n,e,t)=>{let r=VS(n,t);if(!r)return!1;let s=ag(r);return s?KS(n,s,e):!1},d4=(n,e,t)=>{let r=WS(n,t);if(!r)return!1;let s=og(r);return s?KS(n,s,e):!1};function KS(n,e,t){let r=e.nodeBefore,s=r,a=e.pos-1;for(;!s.isTextblock;a--){if(s.type.spec.isolating)return!1;let m=s.lastChild;if(!m)return!1;s=m}let l=e.nodeAfter,u=l,d=e.pos+1;for(;!u.isTextblock;d++){if(u.type.spec.isolating)return!1;let m=u.firstChild;if(!m)return!1;u=m}let h=wd(n.doc,a,d,ne.empty);if(!h||h.from!=a||h instanceof Ct&&h.slice.size>=d-a)return!1;if(t){let m=n.tr.step(h);m.setSelection(ve.create(m.doc,a)),t(m.scrollIntoView())}return!0}function Ta(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const GS=(n,e,t)=>{let{$head:r,empty:s}=n.selection,a=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;a=ag(r)}let l=a&&a.nodeBefore;return!l||!ue.isSelectable(l)?!1:(e&&e(n.tr.setSelection(ue.create(n.doc,a.pos-l.nodeSize)).scrollIntoView()),!0)};function ag(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function WS(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const YS=(n,e,t)=>{let r=WS(n,t);if(!r)return!1;let s=og(r);if(!s)return!1;let a=s.nodeAfter;if(e2(n,s,e,1))return!0;if(r.parent.content.size==0&&(Ta(a,"start")||ue.isSelectable(a))){let l=wd(n.doc,r.before(),r.after(),ne.empty);if(l&&l.slice.size<l.to-l.from){if(e){let u=n.tr.step(l);u.setSelection(Ta(a,"start")?ke.findFrom(u.doc.resolve(u.mapping.map(s.pos)),1):ue.create(u.doc,u.mapping.map(s.pos))),e(u.scrollIntoView())}return!0}}return a.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos,s.pos+a.nodeSize).scrollIntoView()),!0):!1},JS=(n,e,t)=>{let{$head:r,empty:s}=n.selection,a=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;a=og(r)}let l=a&&a.nodeAfter;return!l||!ue.isSelectable(l)?!1:(e&&e(n.tr.setSelection(ue.create(n.doc,a.pos)).scrollIntoView()),!0)};function og(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const f4=(n,e)=>{let t=n.selection,r=t instanceof ue,s;if(r){if(t.node.isTextblock||!Es(n.doc,t.from))return!1;s=t.from}else if(s=xd(n.doc,t.from,-1),s==null)return!1;if(e){let a=n.tr.join(s);r&&a.setSelection(ue.create(a.doc,s-n.doc.resolve(s).nodeBefore.nodeSize)),e(a.scrollIntoView())}return!0},h4=(n,e)=>{let t=n.selection,r;if(t instanceof ue){if(t.node.isTextblock||!Es(n.doc,t.to))return!1;r=t.to}else if(r=xd(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},p4=(n,e)=>{let{$from:t,$to:r}=n.selection,s=t.blockRange(r),a=s&&Ba(s);return a==null?!1:(e&&e(n.tr.lift(s,a).scrollIntoView()),!0)},QS=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function lg(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const m4=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let s=t.node(-1),a=t.indexAfter(-1),l=lg(s.contentMatchAt(a));if(!l||!s.canReplaceWith(a,a,l))return!1;if(e){let u=t.after(),d=n.tr.replaceWith(u,u,l.createAndFill());d.setSelection(ke.near(d.doc.resolve(u),1)),e(d.scrollIntoView())}return!0},XS=(n,e)=>{let t=n.selection,{$from:r,$to:s}=t;if(t instanceof mn||r.parent.inlineContent||s.parent.inlineContent)return!1;let a=lg(s.parent.contentMatchAt(s.indexAfter()));if(!a||!a.isTextblock)return!1;if(e){let l=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,u=n.tr.insert(l,a.createAndFill());u.setSelection(ve.create(u.doc,l+1)),e(u.scrollIntoView())}return!0},ZS=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let a=t.before();if(Tr(n.doc,a))return e&&e(n.tr.split(a).scrollIntoView()),!0}let r=t.blockRange(),s=r&&Ba(r);return s==null?!1:(e&&e(n.tr.lift(r,s).scrollIntoView()),!0)};function g4(n){return(e,t)=>{let{$from:r,$to:s}=e.selection;if(e.selection instanceof ue&&e.selection.node.isBlock)return!r.parentOffset||!Tr(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let a=[],l,u,d=!1,h=!1;for(let x=r.depth;;x--)if(r.node(x).isBlock){d=r.end(x)==r.pos+(r.depth-x),h=r.start(x)==r.pos-(r.depth-x),u=lg(r.node(x-1).contentMatchAt(r.indexAfter(x-1))),a.unshift(d&&u?{type:u}:null),l=x;break}else{if(x==1)return!1;a.unshift(null)}let m=e.tr;(e.selection instanceof ve||e.selection instanceof mn)&&m.deleteSelection();let y=m.mapping.map(r.pos),v=Tr(m.doc,y,a.length,a);if(v||(a[0]=u?{type:u}:null,v=Tr(m.doc,y,a.length,a)),!v)return!1;if(m.split(y,a.length,a),!d&&h&&r.node(l).type!=u){let x=m.mapping.map(r.before(l)),w=m.doc.resolve(x);u&&r.node(l-1).canReplaceWith(w.index(),w.index()+1,u)&&m.setNodeMarkup(m.mapping.map(r.before(l)),u)}return t&&t(m.scrollIntoView()),!0}}const y4=g4(),b4=(n,e)=>{let{$from:t,to:r}=n.selection,s,a=t.sharedDepth(r);return a==0?!1:(s=t.before(a),e&&e(n.tr.setSelection(ue.create(n.doc,s))),!0)};function v4(n,e,t){let r=e.nodeBefore,s=e.nodeAfter,a=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(a-1,a)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(a,a+1)||!(s.isTextblock||Es(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function e2(n,e,t,r){let s=e.nodeBefore,a=e.nodeAfter,l,u,d=s.type.spec.isolating||a.type.spec.isolating;if(!d&&v4(n,e,t))return!0;let h=!d&&e.parent.canReplace(e.index(),e.index()+1);if(h&&(l=(u=s.contentMatchAt(s.childCount)).findWrapping(a.type))&&u.matchType(l[0]||a.type).validEnd){if(t){let x=e.pos+a.nodeSize,w=J.empty;for(let N=l.length-1;N>=0;N--)w=J.from(l[N].create(null,w));w=J.from(s.copy(w));let k=n.tr.step(new Tt(e.pos-1,x,e.pos,x,new ne(w,1,0),l.length,!0)),_=k.doc.resolve(x+2*l.length);_.nodeAfter&&_.nodeAfter.type==s.type&&Es(k.doc,_.pos)&&k.join(_.pos),t(k.scrollIntoView())}return!0}let m=a.type.spec.isolating||r>0&&d?null:ke.findFrom(e,1),y=m&&m.$from.blockRange(m.$to),v=y&&Ba(y);if(v!=null&&v>=e.depth)return t&&t(n.tr.lift(y,v).scrollIntoView()),!0;if(h&&Ta(a,"start",!0)&&Ta(s,"end")){let x=s,w=[];for(;w.push(x),!x.isTextblock;)x=x.lastChild;let k=a,_=1;for(;!k.isTextblock;k=k.firstChild)_++;if(x.canReplace(x.childCount,x.childCount,k.content)){if(t){let N=J.empty;for(let C=w.length-1;C>=0;C--)N=J.from(w[C].copy(N));let M=n.tr.step(new Tt(e.pos-w.length,e.pos+a.nodeSize,e.pos+_,e.pos+a.nodeSize-_,new ne(N,w.length,0),0,!0));t(M.scrollIntoView())}return!0}}return!1}function t2(n){return function(e,t){let r=e.selection,s=n<0?r.$from:r.$to,a=s.depth;for(;s.node(a).isInline;){if(!a)return!1;a--}return s.node(a).isTextblock?(t&&t(e.tr.setSelection(ve.create(e.doc,n<0?s.start(a):s.end(a)))),!0):!1}}const x4=t2(-1),w4=t2(1);function S4(n,e=null){return function(t,r){let{$from:s,$to:a}=t.selection,l=s.blockRange(a),u=l&&Wm(l,n,e);return u?(r&&r(t.tr.wrap(l,u).scrollIntoView()),!0):!1}}function u1(n,e=null){return function(t,r){let s=!1;for(let a=0;a<t.selection.ranges.length&&!s;a++){let{$from:{pos:l},$to:{pos:u}}=t.selection.ranges[a];t.doc.nodesBetween(l,u,(d,h)=>{if(s)return!1;if(!(!d.isTextblock||d.hasMarkup(n,e)))if(d.type==n)s=!0;else{let m=t.doc.resolve(h),y=m.index();s=m.parent.canReplaceWith(y,y+1,n)}})}if(!s)return!1;if(r){let a=t.tr;for(let l=0;l<t.selection.ranges.length;l++){let{$from:{pos:u},$to:{pos:d}}=t.selection.ranges[l];a.setBlockType(u,d,n,e)}r(a.scrollIntoView())}return!0}}function cg(...n){return function(e,t,r){for(let s=0;s<n.length;s++)if(n[s](e,t,r))return!0;return!1}}cg(ig,FS,GS);cg(ig,YS,JS);cg(QS,XS,ZS,y4);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function k4(n,e=null){return function(t,r){let{$from:s,$to:a}=t.selection,l=s.blockRange(a);if(!l)return!1;let u=r?t.tr:null;return _4(u,l,n,e)?(r&&r(u.scrollIntoView()),!0):!1}}function _4(n,e,t,r=null){let s=!1,a=e,l=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let d=l.resolve(e.start-2);a=new Tu(d,d,e.depth),e.endIndex<e.parent.childCount&&(e=new Tu(e.$from,l.resolve(e.$to.end(e.depth)),e.depth)),s=!0}let u=Wm(a,t,r,e);return u?(n&&E4(n,e,u,s,t),!0):!1}function E4(n,e,t,r,s){let a=J.empty;for(let m=t.length-1;m>=0;m--)a=J.from(t[m].type.create(t[m].attrs,a));n.step(new Tt(e.start-(r?2:0),e.end,e.start,e.end,new ne(a,0,0),t.length,!0));let l=0;for(let m=0;m<t.length;m++)t[m].type==s&&(l=m+1);let u=t.length-l,d=e.start+t.length-(r?2:0),h=e.parent;for(let m=e.startIndex,y=e.endIndex,v=!0;m<y;m++,v=!1)!v&&Tr(n.doc,d,u)&&(n.split(d,u),d+=2*u),d+=h.child(m).nodeSize;return n}function N4(n){return function(e,t){let{$from:r,$to:s}=e.selection,a=r.blockRange(s,l=>l.childCount>0&&l.firstChild.type==n);return a?t?r.node(a.depth-1).type==n?C4(e,t,n,a):T4(e,t,a):!0:!1}}function C4(n,e,t,r){let s=n.tr,a=r.end,l=r.$to.end(r.depth);a<l&&(s.step(new Tt(a-1,l,a,l,new ne(J.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new Tu(s.doc.resolve(r.$from.pos),s.doc.resolve(l),r.depth));const u=Ba(r);if(u==null)return!1;s.lift(r,u);let d=s.doc.resolve(s.mapping.map(a,-1)-1);return Es(s.doc,d.pos)&&d.nodeBefore.type==d.nodeAfter.type&&s.join(d.pos),e(s.scrollIntoView()),!0}function T4(n,e,t){let r=n.tr,s=t.parent;for(let x=t.end,w=t.endIndex-1,k=t.startIndex;w>k;w--)x-=s.child(w).nodeSize,r.delete(x-1,x+1);let a=r.doc.resolve(t.start),l=a.nodeAfter;if(r.mapping.map(t.end)!=t.start+a.nodeAfter.nodeSize)return!1;let u=t.startIndex==0,d=t.endIndex==s.childCount,h=a.node(-1),m=a.index(-1);if(!h.canReplace(m+(u?0:1),m+1,l.content.append(d?J.empty:J.from(s))))return!1;let y=a.pos,v=y+l.nodeSize;return r.step(new Tt(y-(u?1:0),v+(d?1:0),y+1,v-1,new ne((u?J.empty:J.from(s.copy(J.empty))).append(d?J.empty:J.from(s.copy(J.empty))),u?0:1,d?0:1),u?0:1)),e(r.scrollIntoView()),!0}function j4(n){return function(e,t){let{$from:r,$to:s}=e.selection,a=r.blockRange(s,h=>h.childCount>0&&h.firstChild.type==n);if(!a)return!1;let l=a.startIndex;if(l==0)return!1;let u=a.parent,d=u.child(l-1);if(d.type!=n)return!1;if(t){let h=d.lastChild&&d.lastChild.type==u.type,m=J.from(h?n.create():null),y=new ne(J.from(n.create(null,J.from(u.type.create(null,m)))),h?3:1,0),v=a.start,x=a.end;t(e.tr.step(new Tt(v-(h?3:1),x,v,x,y,1,!0)).scrollIntoView())}return!0}}var M4=Object.defineProperty,n2=(n,e)=>{for(var t in e)M4(n,t,{get:e[t],enumerable:!0})};function Nd(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:s}=t,{storedMarks:a}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return a},get selection(){return r},get doc(){return s},get tr(){return r=t.selection,s=t.doc,a=t.storedMarks,t}}}var Cd=class{constructor(n){this.editor=n.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=n.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:n,editor:e,state:t}=this,{view:r}=e,{tr:s}=t,a=this.buildProps(s);return Object.fromEntries(Object.entries(n).map(([l,u])=>[l,(...h)=>{const m=u(...h)(a);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(s),m}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(n,e=!0){const{rawCommands:t,editor:r,state:s}=this,{view:a}=r,l=[],u=!!n,d=n||s.tr,h=()=>(!u&&e&&!d.getMeta("preventDispatch")&&!this.hasCustomState&&a.dispatch(d),l.every(y=>y===!0)),m={...Object.fromEntries(Object.entries(t).map(([y,v])=>[y,(...w)=>{const k=this.buildProps(d,e),_=v(...w)(k);return l.push(_),m}])),run:h};return m}createCan(n){const{rawCommands:e,state:t}=this,r=!1,s=n||t.tr,a=this.buildProps(s,r);return{...Object.fromEntries(Object.entries(e).map(([u,d])=>[u,(...h)=>d(...h)({...a,dispatch:void 0})])),chain:()=>this.createChain(s,r)}}buildProps(n,e=!0){const{rawCommands:t,editor:r,state:s}=this,{view:a}=r,l={tr:n,editor:r,view:a,state:Nd({state:s,transaction:n}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(n,e),can:()=>this.createCan(n),get commands(){return Object.fromEntries(Object.entries(t).map(([u,d])=>[u,(...h)=>d(...h)(l)]))}};return l}},A4=class{constructor(){this.callbacks={}}on(n,e){return this.callbacks[n]||(this.callbacks[n]=[]),this.callbacks[n].push(e),this}emit(n,...e){const t=this.callbacks[n];return t&&t.forEach(r=>r.apply(this,e)),this}off(n,e){const t=this.callbacks[n];return t&&(e?this.callbacks[n]=t.filter(r=>r!==e):delete this.callbacks[n]),this}once(n,e){const t=(...r)=>{this.off(n,t),e.apply(this,r)};return this.on(n,t)}removeAllListeners(){this.callbacks={}}};function r2(n,e){const t=new aS(n);return e.forEach(r=>{r.steps.forEach(s=>{t.step(s)})}),t}var s2=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&s2(r)}return n};function iu(n){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return s2(t)}function xl(n,e,t){if(n instanceof Hn||n instanceof J)return n;t={slice:!0,parseOptions:{},...t};const r=typeof n=="object"&&n!==null,s=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return J.fromArray(n.map(u=>e.nodeFromJSON(u)));const l=e.nodeFromJSON(n);return t.errorOnInvalidContent&&l.check(),l}catch(a){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:a});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",a),xl("",e,t)}if(s){if(t.errorOnInvalidContent){let l=!1,u="";const d=new Vw({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:h=>(l=!0,u=typeof h=="string"?h:h.outerHTML,null)}]}})});if(t.slice?ys.fromSchema(d).parseSlice(iu(n),t.parseOptions):ys.fromSchema(d).parse(iu(n),t.parseOptions),t.errorOnInvalidContent&&l)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${u}`)})}const a=ys.fromSchema(e);return t.slice?a.parseSlice(iu(n),t.parseOptions).content:a.parse(iu(n),t.parseOptions)}return xl("",e,t)}function bm(n,e,t={},r={}){return xl(n,e,{slice:!1,parseOptions:t,errorOnInvalidContent:r.errorOnInvalidContent})}function O4(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function R4(n,e,t){const r=[];return n.nodesBetween(e.from,e.to,(s,a)=>{t(s)&&r.push({node:s,pos:a})}),r}function D4(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function Td(n){return e=>D4(e.$from,n)}function ce(n,e,t){return n.config[e]===void 0&&n.parent?ce(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?ce(n.parent,e,t):null}):n.config[e]}function ug(n){return n.map(e=>{const t={name:e.name,options:e.options,storage:e.storage},r=ce(e,"addExtensions",t);return r?[e,...ug(r())]:e}).flat(10)}function dg(n,e){const t=hi.fromSchema(e).serializeFragment(n),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(t),s.innerHTML}function i2(n){return typeof n=="function"}function Pe(n,e=void 0,...t){return i2(n)?e?n.bind(e)(...t):n(...t):n}function L4(n={}){return Object.keys(n).length===0&&n.constructor===Object}function wl(n){const e=n.filter(s=>s.type==="extension"),t=n.filter(s=>s.type==="node"),r=n.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function a2(n){const e=[],{nodeExtensions:t,markExtensions:r}=wl(n),s=[...t,...r],a={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(l=>{const u={name:l.name,options:l.options,storage:l.storage,extensions:s},d=ce(l,"addGlobalAttributes",u);if(!d)return;d().forEach(m=>{m.types.forEach(y=>{Object.entries(m.attributes).forEach(([v,x])=>{e.push({type:y,name:v,attribute:{...a,...x}})})})})}),s.forEach(l=>{const u={name:l.name,options:l.options,storage:l.storage},d=ce(l,"addAttributes",u);if(!d)return;const h=d();Object.entries(h).forEach(([m,y])=>{const v={...a,...y};typeof v?.default=="function"&&(v.default=v.default()),v?.isRequired&&v?.default===void 0&&delete v.default,e.push({type:l.name,name:m,attribute:v})})}),e}function ht(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([s,a])=>{if(!r[s]){r[s]=a;return}if(s==="class"){const u=a?String(a).split(" "):[],d=r[s]?r[s].split(" "):[],h=u.filter(m=>!d.includes(m));r[s]=[...d,...h].join(" ")}else if(s==="style"){const u=a?a.split(";").map(m=>m.trim()).filter(Boolean):[],d=r[s]?r[s].split(";").map(m=>m.trim()).filter(Boolean):[],h=new Map;d.forEach(m=>{const[y,v]=m.split(":").map(x=>x.trim());h.set(y,v)}),u.forEach(m=>{const[y,v]=m.split(":").map(x=>x.trim());h.set(y,v)}),r[s]=Array.from(h.entries()).map(([m,y])=>`${m}: ${y}`).join("; ")}else r[s]=a}),r},{})}function Bu(n,e){return e.filter(t=>t.type===n.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>ht(t,r),{})}function B4(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function d1(n,e){return"style"in n?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const s=e.reduce((a,l)=>{const u=l.attribute.parseHTML?l.attribute.parseHTML(t):B4(t.getAttribute(l.name));return u==null?a:{...a,[l.name]:u}},{});return{...r,...s}}}}function f1(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&L4(t)?!1:t!=null))}function z4(n,e){var t;const r=a2(n),{nodeExtensions:s,markExtensions:a}=wl(n),l=(t=s.find(h=>ce(h,"topNode")))==null?void 0:t.name,u=Object.fromEntries(s.map(h=>{const m=r.filter(N=>N.type===h.name),y={name:h.name,options:h.options,storage:h.storage,editor:e},v=n.reduce((N,M)=>{const C=ce(M,"extendNodeSchema",y);return{...N,...C?C(h):{}}},{}),x=f1({...v,content:Pe(ce(h,"content",y)),marks:Pe(ce(h,"marks",y)),group:Pe(ce(h,"group",y)),inline:Pe(ce(h,"inline",y)),atom:Pe(ce(h,"atom",y)),selectable:Pe(ce(h,"selectable",y)),draggable:Pe(ce(h,"draggable",y)),code:Pe(ce(h,"code",y)),whitespace:Pe(ce(h,"whitespace",y)),linebreakReplacement:Pe(ce(h,"linebreakReplacement",y)),defining:Pe(ce(h,"defining",y)),isolating:Pe(ce(h,"isolating",y)),attrs:Object.fromEntries(m.map(N=>{var M,C;return[N.name,{default:(M=N?.attribute)==null?void 0:M.default,validate:(C=N?.attribute)==null?void 0:C.validate}]}))}),w=Pe(ce(h,"parseHTML",y));w&&(x.parseDOM=w.map(N=>d1(N,m)));const k=ce(h,"renderHTML",y);k&&(x.toDOM=N=>k({node:N,HTMLAttributes:Bu(N,m)}));const _=ce(h,"renderText",y);return _&&(x.toText=_),[h.name,x]})),d=Object.fromEntries(a.map(h=>{const m=r.filter(_=>_.type===h.name),y={name:h.name,options:h.options,storage:h.storage,editor:e},v=n.reduce((_,N)=>{const M=ce(N,"extendMarkSchema",y);return{..._,...M?M(h):{}}},{}),x=f1({...v,inclusive:Pe(ce(h,"inclusive",y)),excludes:Pe(ce(h,"excludes",y)),group:Pe(ce(h,"group",y)),spanning:Pe(ce(h,"spanning",y)),code:Pe(ce(h,"code",y)),attrs:Object.fromEntries(m.map(_=>{var N,M;return[_.name,{default:(N=_?.attribute)==null?void 0:N.default,validate:(M=_?.attribute)==null?void 0:M.validate}]}))}),w=Pe(ce(h,"parseHTML",y));w&&(x.parseDOM=w.map(_=>d1(_,m)));const k=ce(h,"renderHTML",y);return k&&(x.toDOM=_=>k({mark:_,HTMLAttributes:Bu(_,m)})),[h.name,x]}));return new Vw({topNode:l,nodes:u,marks:d})}function U4(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return Array.from(new Set(e))}function fg(n){return n.sort((t,r)=>{const s=ce(t,"priority")||100,a=ce(r,"priority")||100;return s>a?-1:s<a?1:0})}function o2(n){const e=fg(ug(n)),t=U4(e.map(r=>r.name));return t.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${t.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),e}function l2(n,e,t){const{from:r,to:s}=e,{blockSeparator:a=`

`,textSerializers:l={}}=t||{};let u="";return n.nodesBetween(r,s,(d,h,m,y)=>{var v;d.isBlock&&h>r&&(u+=a);const x=l?.[d.type.name];if(x)return m&&(u+=x({node:d,pos:h,parent:m,index:y,range:e})),!1;d.isText&&(u+=(v=d?.text)==null?void 0:v.slice(Math.max(r,h)-h,s-h))}),u}function P4(n,e){const t={from:0,to:n.content.size};return l2(n,t,e)}function c2(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}function Ar(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}function u2(n,e){const t=Ar(e,n.schema),{from:r,to:s,empty:a}=n.selection,l=[];a?(n.storedMarks&&l.push(...n.storedMarks),l.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,s,d=>{l.push(...d.marks)});const u=l.find(d=>d.type.name===t.name);return u?{...u.attrs}:{}}function pt(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function $4(n,e){const t=pt(e,n.schema),{from:r,to:s}=n.selection,a=[];n.doc.nodesBetween(r,s,u=>{a.push(u)});const l=a.reverse().find(u=>u.type.name===t.name);return l?{...l.attrs}:{}}function jd(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function d2(n,e){const t=jd(typeof e=="string"?e:e.name,n.schema);return t==="node"?$4(n,e):t==="mark"?u2(n,e):{}}function I4(n,e=JSON.stringify){const t={};return n.filter(r=>{const s=e(r);return Object.prototype.hasOwnProperty.call(t,s)?!1:t[s]=!0})}function H4(n){const e=I4(n);return e.length===1?e:e.filter((t,r)=>!e.filter((a,l)=>l!==r).some(a=>t.oldRange.from>=a.oldRange.from&&t.oldRange.to<=a.oldRange.to&&t.newRange.from>=a.newRange.from&&t.newRange.to<=a.newRange.to))}function f2(n){const{mapping:e,steps:t}=n,r=[];return e.maps.forEach((s,a)=>{const l=[];if(s.ranges.length)s.forEach((u,d)=>{l.push({from:u,to:d})});else{const{from:u,to:d}=t[a];if(u===void 0||d===void 0)return;l.push({from:u,to:d})}l.forEach(({from:u,to:d})=>{const h=e.slice(a).map(u,-1),m=e.slice(a).map(d),y=e.invert().map(h,-1),v=e.invert().map(m);r.push({oldRange:{from:y,to:v},newRange:{from:h,to:m}})})}),H4(r)}function hg(n){return Object.prototype.toString.call(n)==="[object RegExp]"}function zu(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>t.strict?e[s]===n[s]:hg(e[s])?e[s].test(n[s]):e[s]===n[s]):!0}function h2(n,e,t={}){return n.find(r=>r.type===e&&zu(Object.fromEntries(Object.keys(t).map(s=>[s,r.attrs[s]])),t))}function h1(n,e,t={}){return!!h2(n,e,t)}function pg(n,e,t){var r;if(!n||!e)return;let s=n.parent.childAfter(n.parentOffset);if((!s.node||!s.node.marks.some(m=>m.type===e))&&(s=n.parent.childBefore(n.parentOffset)),!s.node||!s.node.marks.some(m=>m.type===e)||(t=t||((r=s.node.marks[0])==null?void 0:r.attrs),!h2([...s.node.marks],e,t)))return;let l=s.index,u=n.start()+s.offset,d=l+1,h=u+s.node.nodeSize;for(;l>0&&h1([...n.parent.child(l-1).marks],e,t);)l-=1,u-=n.parent.child(l).nodeSize;for(;d<n.parent.childCount&&h1([...n.parent.child(d).marks],e,t);)h+=n.parent.child(d).nodeSize,d+=1;return{from:u,to:h}}function mg(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(s=>{const a=t.resolve(n),l=pg(a,s.type);l&&r.push({mark:s,...l})}):t.nodesBetween(n,e,(s,a)=>{!s||s?.nodeSize===void 0||r.push(...s.marks.map(l=>({from:a,to:a+s.nodeSize,mark:l})))}),r}var q4=(n,e,t,r=20)=>{const s=n.doc.resolve(t);let a=r,l=null;for(;a>0&&l===null;){const u=s.node(a);u?.type.name===e?l=u:a-=1}return[l,a]};function Tp(n,e){return e.nodes[n]||e.marks[n]||null}function bu(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const s=n.find(a=>a.type===e&&a.name===r);return s?s.attribute.keepOnSplit:!1}))}var V4=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(s,a,l,u)=>{var d,h;const m=((h=(d=s.type.spec).toText)==null?void 0:h.call(d,{node:s,pos:a,parent:l,index:u}))||s.textContent||"%leaf%";t+=s.isAtom&&!s.isText?m:m.slice(0,Math.max(0,r-a))}),t};function vm(n,e,t={}){const{empty:r,ranges:s}=n.selection,a=e?Ar(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(y=>a?a.name===y.type.name:!0).find(y=>zu(y.attrs,t,{strict:!1}));let l=0;const u=[];if(s.forEach(({$from:y,$to:v})=>{const x=y.pos,w=v.pos;n.doc.nodesBetween(x,w,(k,_)=>{if(!k.isText&&!k.marks.length)return;const N=Math.max(x,_),M=Math.min(w,_+k.nodeSize),C=M-N;l+=C,u.push(...k.marks.map(I=>({mark:I,from:N,to:M})))})}),l===0)return!1;const d=u.filter(y=>a?a.name===y.mark.type.name:!0).filter(y=>zu(y.mark.attrs,t,{strict:!1})).reduce((y,v)=>y+v.to-v.from,0),h=u.filter(y=>a?y.mark.type!==a&&y.mark.type.excludes(a):!0).reduce((y,v)=>y+v.to-v.from,0);return(d>0?d+h:d)>=l}function Ss(n,e,t={}){const{from:r,to:s,empty:a}=n.selection,l=e?pt(e,n.schema):null,u=[];n.doc.nodesBetween(r,s,(y,v)=>{if(y.isText)return;const x=Math.max(r,v),w=Math.min(s,v+y.nodeSize);u.push({node:y,from:x,to:w})});const d=s-r,h=u.filter(y=>l?l.name===y.node.type.name:!0).filter(y=>zu(y.node.attrs,t,{strict:!1}));return a?!!h.length:h.reduce((y,v)=>y+v.to-v.from,0)>=d}function F4(n,e,t={}){if(!e)return Ss(n,null,t)||vm(n,null,t);const r=jd(e,n.schema);return r==="node"?Ss(n,e,t):r==="mark"?vm(n,e,t):!1}var K4=(n,e)=>{const{$from:t,$to:r,$anchor:s}=n.selection;if(e){const a=Td(u=>u.type.name===e)(n.selection);if(!a)return!1;const l=n.doc.resolve(a.pos+1);return s.pos+1===l.end()}return!(r.parentOffset<r.parent.nodeSize-2||t.pos!==r.pos)},G4=n=>{const{$from:e,$to:t}=n.selection;return!(e.parentOffset>0||e.pos!==t.pos)};function p1(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}function m1(n,e){const{nodeExtensions:t}=wl(e),r=t.find(l=>l.name===n);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},a=Pe(ce(r,"group",s));return typeof a!="string"?!1:a.split(" ").includes("list")}function Md(n,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var r;if(t){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!=null?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(e){let s=!0;return n.content.forEach(a=>{s!==!1&&(Md(a,{ignoreWhitespace:t,checkChildren:e})||(s=!1))}),s}return!1}function p2(n){return n instanceof ue}function m2(n){return n instanceof ve}function ei(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function g2(n,e=null){if(!e)return null;const t=ke.atStart(n),r=ke.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const s=t.from,a=r.to;return e==="all"?ve.create(n,ei(0,s,a),ei(n.content.size,s,a)):ve.create(n,ei(e,s,a),ei(e,s,a))}function W4(n,e,t){const r=n.steps.length-1;if(r<e)return;const s=n.steps[r];if(!(s instanceof Ct||s instanceof Tt))return;const a=n.mapping.maps[r];let l=0;a.forEach((u,d,h,m)=>{l===0&&(l=m)}),n.setSelection(ke.near(n.doc.resolve(l),t))}var Ad=class{constructor(n){this.find=n.find,this.handler=n.handler}},Y4=(n,e)=>{if(hg(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function au(n){var e;const{editor:t,from:r,to:s,text:a,rules:l,plugin:u}=n,{view:d}=t;if(d.composing)return!1;const h=d.state.doc.resolve(r);if(h.parent.type.spec.code||(e=h.nodeBefore||h.nodeAfter)!=null&&e.marks.find(v=>v.type.spec.code))return!1;let m=!1;const y=V4(h)+a;return l.forEach(v=>{if(m)return;const x=Y4(y,v.find);if(!x)return;const w=d.state.tr,k=Nd({state:d.state,transaction:w}),_={from:r-(x[0].length-a.length),to:s},{commands:N,chain:M,can:C}=new Cd({editor:t,state:k});v.handler({state:k,range:_,match:x,commands:N,chain:M,can:C})===null||!w.steps.length||(w.setMeta(u,{transform:w,from:r,to:s,text:a}),d.dispatch(w),m=!0)}),m}function J4(n){const{editor:e,rules:t}=n,r=new at({state:{init(){return null},apply(s,a,l){const u=s.getMeta(r);if(u)return u;const d=s.getMeta("applyInputRules");return!!d&&setTimeout(()=>{let{text:m}=d;typeof m=="string"?m=m:m=dg(J.from(m),l.schema);const{from:y}=d,v=y+m.length;au({editor:e,from:y,to:v,text:m,rules:t,plugin:r})}),s.selectionSet||s.docChanged?null:a}},props:{handleTextInput(s,a,l,u){return au({editor:e,from:a,to:l,text:u,rules:t,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:a}=s.state.selection;a&&au({editor:e,from:a.pos,to:a.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(s,a){if(a.key!=="Enter")return!1;const{$cursor:l}=s.state.selection;return l?au({editor:e,from:l.pos,to:l.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function Q4(n){return Object.prototype.toString.call(n).slice(8,-1)}function ou(n){return Q4(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function y2(n,e){const t={...n};return ou(n)&&ou(e)&&Object.keys(e).forEach(r=>{ou(e[r])&&ou(n[r])?t[r]=y2(n[r],e[r]):t[r]=e[r]}),t}var gg=class{constructor(n={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...n},this.name=this.config.name}get options(){return{...Pe(ce(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Pe(ce(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(n={}){const e=this.extend({...this.config,addOptions:()=>y2(this.options,n)});return e.name=this.name,e.parent=this.parent,e}extend(n={}){const e=new this.constructor({...this.config,...n});return e.parent=this,this.child=e,e.name="name"in n?n.name:e.parent.name,e}},pi=class b2 extends gg{constructor(){super(...arguments),this.type="mark"}static create(e={}){const t=typeof e=="function"?e():e;return new b2(t)}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const l=s.marks();if(!!!l.find(h=>h?.type.name===t.name))return!1;const d=l.find(h=>h?.type.name===t.name);return d&&r.removeStoredMark(d),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}configure(e){return super.configure(e)}extend(e){const t=typeof e=="function"?e():e;return super.extend(t)}};function X4(n){return typeof n=="number"}var Z4=class{constructor(n){this.find=n.find,this.handler=n.handler}},e3=(n,e,t)=>{if(hg(e))return[...n.matchAll(e)];const r=e(n,t);return r?r.map(s=>{const a=[s.text];return a.index=s.index,a.input=n,a.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),a.push(s.replaceWith)),a}):[]};function t3(n){const{editor:e,state:t,from:r,to:s,rule:a,pasteEvent:l,dropEvent:u}=n,{commands:d,chain:h,can:m}=new Cd({editor:e,state:t}),y=[];return t.doc.nodesBetween(r,s,(x,w)=>{if(!x.isTextblock||x.type.spec.code)return;const k=Math.max(r,w),_=Math.min(s,w+x.content.size),N=x.textBetween(k-w,_-w,void 0,"￼");e3(N,a.find,l).forEach(C=>{if(C.index===void 0)return;const I=k+C.index+1,H=I+C[0].length,Q={from:t.tr.mapping.map(I),to:t.tr.mapping.map(H)},G=a.handler({state:t,range:Q,match:C,commands:d,chain:h,can:m,pasteEvent:l,dropEvent:u});y.push(G)})}),y.every(x=>x!==null)}var lu=null,n3=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)==null||e.setData("text/html",n),t};function r3(n){const{editor:e,rules:t}=n;let r=null,s=!1,a=!1,l=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,u;try{u=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{u=null}const d=({state:m,from:y,to:v,rule:x,pasteEvt:w})=>{const k=m.tr,_=Nd({state:m,transaction:k});if(!(!t3({editor:e,state:_,from:Math.max(y-1,0),to:v.b-1,rule:x,pasteEvent:w,dropEvent:u})||!k.steps.length)){try{u=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{u=null}return l=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,k}};return t.map(m=>new at({view(y){const v=w=>{var k;r=(k=y.dom.parentElement)!=null&&k.contains(w.target)?y.dom.parentElement:null,r&&(lu=e)},x=()=>{lu&&(lu=null)};return window.addEventListener("dragstart",v),window.addEventListener("dragend",x),{destroy(){window.removeEventListener("dragstart",v),window.removeEventListener("dragend",x)}}},props:{handleDOMEvents:{drop:(y,v)=>{if(a=r===y.dom.parentElement,u=v,!a){const x=lu;x?.isEditable&&setTimeout(()=>{const w=x.state.selection;w&&x.commands.deleteRange({from:w.from,to:w.to})},10)}return!1},paste:(y,v)=>{var x;const w=(x=v.clipboardData)==null?void 0:x.getData("text/html");return l=v,s=!!w?.includes("data-pm-slice"),!1}}},appendTransaction:(y,v,x)=>{const w=y[0],k=w.getMeta("uiEvent")==="paste"&&!s,_=w.getMeta("uiEvent")==="drop"&&!a,N=w.getMeta("applyPasteRules"),M=!!N;if(!k&&!_&&!M)return;if(M){let{text:H}=N;typeof H=="string"?H=H:H=dg(J.from(H),x.schema);const{from:Q}=N,G=Q+H.length,X=n3(H);return d({rule:m,state:x,from:Q,to:{b:G},pasteEvt:X})}const C=v.doc.content.findDiffStart(x.doc.content),I=v.doc.content.findDiffEnd(x.doc.content);if(!(!X4(C)||!I||C===I.b))return d({rule:m,state:x,from:C,to:I,pasteEvt:l})}}))}var Od=class{constructor(n,e){this.splittableMarks=[],this.editor=e,this.extensions=o2(n),this.schema=z4(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((n,e)=>{const t={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Tp(e.name,this.schema)},r=ce(e,"addCommands",t);return r?{...n,...r()}:n},{})}get plugins(){const{editor:n}=this,e=fg([...this.extensions].reverse()),t=[],r=[],s=e.map(a=>{const l={name:a.name,options:a.options,storage:this.editor.extensionStorage[a.name],editor:n,type:Tp(a.name,this.schema)},u=[],d=ce(a,"addKeyboardShortcuts",l);let h={};if(a.type==="mark"&&ce(a,"exitable",l)&&(h.ArrowRight=()=>pi.handleExit({editor:n,mark:a})),d){const w=Object.fromEntries(Object.entries(d()).map(([k,_])=>[k,()=>_({editor:n})]));h={...h,...w}}const m=c4(h);u.push(m);const y=ce(a,"addInputRules",l);p1(a,n.options.enableInputRules)&&y&&t.push(...y());const v=ce(a,"addPasteRules",l);p1(a,n.options.enablePasteRules)&&v&&r.push(...v());const x=ce(a,"addProseMirrorPlugins",l);if(x){const w=x();u.push(...w)}return u}).flat();return[J4({editor:n,rules:t}),...r3({editor:n,rules:r}),...s]}get attributes(){return a2(this.extensions)}get nodeViews(){const{editor:n}=this,{nodeExtensions:e}=wl(this.extensions);return Object.fromEntries(e.filter(t=>!!ce(t,"addNodeView")).map(t=>{const r=this.attributes.filter(u=>u.type===t.name),s={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:n,type:pt(t.name,this.schema)},a=ce(t,"addNodeView",s);if(!a)return[];const l=(u,d,h,m,y)=>{const v=Bu(u,r);return a()({node:u,view:d,getPos:h,decorations:m,innerDecorations:y,editor:n,extension:t,HTMLAttributes:v})};return[t.name,l]}))}get markViews(){const{editor:n}=this,{markExtensions:e}=wl(this.extensions);return Object.fromEntries(e.filter(t=>!!ce(t,"addMarkView")).map(t=>{const r=this.attributes.filter(u=>u.type===t.name),s={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:n,type:Ar(t.name,this.schema)},a=ce(t,"addMarkView",s);if(!a)return[];const l=(u,d,h)=>{const m=Bu(u,r);return a()({mark:u,view:d,inline:h,editor:n,extension:t,HTMLAttributes:m,updateAttributes:y=>{vO(u,n,y)}})};return[t.name,l]}))}setupExtensions(){const n=this.extensions;this.editor.extensionStorage=Object.fromEntries(n.map(e=>[e.name,e.storage])),n.forEach(e=>{var t;const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Tp(e.name,this.schema)};e.type==="mark"&&((t=Pe(ce(e,"keepOnSplit",r)))==null||t)&&this.splittableMarks.push(e.name);const s=ce(e,"onBeforeCreate",r),a=ce(e,"onCreate",r),l=ce(e,"onUpdate",r),u=ce(e,"onSelectionUpdate",r),d=ce(e,"onTransaction",r),h=ce(e,"onFocus",r),m=ce(e,"onBlur",r),y=ce(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),a&&this.editor.on("create",a),l&&this.editor.on("update",l),u&&this.editor.on("selectionUpdate",u),d&&this.editor.on("transaction",d),h&&this.editor.on("focus",h),m&&this.editor.on("blur",m),y&&this.editor.on("destroy",y)})}};Od.resolve=o2;Od.sort=fg;Od.flatten=ug;var s3={};n2(s3,{ClipboardTextSerializer:()=>x2,Commands:()=>k2,Delete:()=>_2,Drop:()=>E2,Editable:()=>N2,FocusEvents:()=>T2,Keymap:()=>j2,Paste:()=>M2,Tabindex:()=>A2,focusEventsPluginKey:()=>C2});var mt=class v2 extends gg{constructor(){super(...arguments),this.type="extension"}static create(e={}){const t=typeof e=="function"?e():e;return new v2(t)}configure(e){return super.configure(e)}extend(e){const t=typeof e=="function"?e():e;return super.extend(t)}},x2=mt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new at({key:new Mt("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:s}=e,{ranges:a}=s,l=Math.min(...a.map(m=>m.$from.pos)),u=Math.max(...a.map(m=>m.$to.pos)),d=c2(t);return l2(r,{from:l,to:u},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:d})}}})]}}),w2={};n2(w2,{blur:()=>i3,clearContent:()=>a3,clearNodes:()=>o3,command:()=>l3,createParagraphNear:()=>c3,cut:()=>u3,deleteCurrentNode:()=>d3,deleteNode:()=>f3,deleteRange:()=>h3,deleteSelection:()=>p3,enter:()=>m3,exitCode:()=>g3,extendMarkRange:()=>y3,first:()=>b3,focus:()=>x3,forEach:()=>w3,insertContent:()=>S3,insertContentAt:()=>_3,joinBackward:()=>C3,joinDown:()=>N3,joinForward:()=>T3,joinItemBackward:()=>j3,joinItemForward:()=>M3,joinTextblockBackward:()=>A3,joinTextblockForward:()=>O3,joinUp:()=>E3,keyboardShortcut:()=>D3,lift:()=>L3,liftEmptyBlock:()=>B3,liftListItem:()=>z3,newlineInCode:()=>U3,resetAttributes:()=>P3,scrollIntoView:()=>$3,selectAll:()=>I3,selectNodeBackward:()=>H3,selectNodeForward:()=>q3,selectParentNode:()=>V3,selectTextblockEnd:()=>F3,selectTextblockStart:()=>K3,setContent:()=>G3,setMark:()=>Y3,setMeta:()=>J3,setNode:()=>Q3,setNodeSelection:()=>X3,setTextSelection:()=>Z3,sinkListItem:()=>eO,splitBlock:()=>tO,splitListItem:()=>nO,toggleList:()=>rO,toggleMark:()=>sO,toggleNode:()=>iO,toggleWrap:()=>aO,undoInputRule:()=>oO,unsetAllMarks:()=>lO,unsetMark:()=>cO,updateAttributes:()=>uO,wrapIn:()=>dO,wrapInList:()=>fO});var i3=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window?.getSelection())==null||t.removeAllRanges())}),!0),a3=(n=!0)=>({commands:e})=>e.setContent("",{emitUpdate:n}),o3=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:s}=r;return t&&s.forEach(({$from:a,$to:l})=>{n.doc.nodesBetween(a.pos,l.pos,(u,d)=>{if(u.type.isText)return;const{doc:h,mapping:m}=e,y=h.resolve(m.map(d)),v=h.resolve(m.map(d+u.nodeSize)),x=y.blockRange(v);if(!x)return;const w=Ba(x);if(u.type.isTextblock){const{defaultType:k}=y.parent.contentMatchAt(y.index());e.setNodeMarkup(x.start,k)}(w||w===0)&&e.lift(x,w)})}),!0},l3=n=>e=>n(e),c3=()=>({state:n,dispatch:e})=>XS(n,e),u3=(n,e)=>({editor:t,tr:r})=>{const{state:s}=t,a=s.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const l=r.mapping.map(e);return r.insert(l,a.content),r.setSelection(new ve(r.doc.resolve(Math.max(l-1,0)))),!0},d3=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const s=n.selection.$anchor;for(let a=s.depth;a>0;a-=1)if(s.node(a).type===r.type){if(e){const u=s.before(a),d=s.after(a);n.delete(u,d).scrollIntoView()}return!0}return!1},f3=n=>({tr:e,state:t,dispatch:r})=>{const s=pt(n,t.schema),a=e.selection.$anchor;for(let l=a.depth;l>0;l-=1)if(a.node(l).type===s){if(r){const d=a.before(l),h=a.after(l);e.delete(d,h).scrollIntoView()}return!0}return!1},h3=n=>({tr:e,dispatch:t})=>{const{from:r,to:s}=n;return t&&e.delete(r,s),!0},p3=()=>({state:n,dispatch:e})=>ig(n,e),m3=()=>({commands:n})=>n.keyboardShortcut("Enter"),g3=()=>({state:n,dispatch:e})=>m4(n,e),y3=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const a=Ar(n,r.schema),{doc:l,selection:u}=t,{$from:d,from:h,to:m}=u;if(s){const y=pg(d,a,e);if(y&&y.from<=h&&y.to>=m){const v=ve.create(l,y.from,y.to);t.setSelection(v)}}return!0},b3=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function v3(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function yg(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var x3=(n=null,e={})=>({editor:t,view:r,tr:s,dispatch:a})=>{e={scrollIntoView:!0,...e};const l=()=>{(yg()||v3())&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e?.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(a&&n===null&&!m2(t.state.selection))return l(),!0;const u=g2(s.doc,n)||t.state.selection,d=t.state.selection.eq(u);return a&&(d||s.setSelection(u),d&&s.storedMarks&&s.setStoredMarks(s.storedMarks),l()),!0},w3=(n,e)=>t=>n.every((r,s)=>e(r,{...t,index:s})),S3=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),k3=n=>!("type"in n),_3=(n,e,t)=>({tr:r,dispatch:s,editor:a})=>{var l;if(s){t={parseOptions:a.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let u;const{selection:d}=a.state,h=N=>{a.emit("contentError",{editor:a,error:N,disableCollaboration:()=>{"collaboration"in a.storage&&typeof a.storage.collaboration=="object"&&a.storage.collaboration&&(a.storage.collaboration.isDisabled=!0)}})},m={preserveWhitespace:"full",...t.parseOptions};if(!t.errorOnInvalidContent&&!a.options.enableContentCheck&&a.options.emitContentError)try{xl(e,a.schema,{parseOptions:m,errorOnInvalidContent:!0})}catch(N){h(N)}try{u=xl(e,a.schema,{parseOptions:m,errorOnInvalidContent:(l=t.errorOnInvalidContent)!=null?l:a.options.enableContentCheck})}catch(N){return h(N),!1}let{from:y,to:v}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},x=!0,w=!0;if((k3(u)?u:[u]).forEach(N=>{N.check(),x=x?N.isText&&N.marks.length===0:!1,w=w?N.isBlock:!1}),y===v&&w){const{parent:N}=r.doc.resolve(y);N.isTextblock&&!N.type.spec.code&&!N.childCount&&(y-=1,v+=1)}let _;if(x){if(Array.isArray(e))_=e.map(N=>N.text||"").join("");else if(e instanceof J){let N="";e.forEach(M=>{M.text&&(N+=M.text)}),_=N}else typeof e=="object"&&e&&e.text?_=e.text:_=e;r.insertText(_,y,v)}else{_=u;const N=d.$from.parentOffset===0,M=d.$from.node().isText||d.$from.node().isTextblock,C=d.$from.node().content.size>0;N&&M&&C&&(y=Math.max(0,y-1)),r.replaceWith(y,v,_)}t.updateSelection&&W4(r,r.steps.length-1,-1),t.applyInputRules&&r.setMeta("applyInputRules",{from:y,text:_}),t.applyPasteRules&&r.setMeta("applyPasteRules",{from:y,text:_})}return!0},E3=()=>({state:n,dispatch:e})=>f4(n,e),N3=()=>({state:n,dispatch:e})=>h4(n,e),C3=()=>({state:n,dispatch:e})=>FS(n,e),T3=()=>({state:n,dispatch:e})=>YS(n,e),j3=()=>({state:n,dispatch:e,tr:t})=>{try{const r=xd(n.doc,n.selection.$from.pos,-1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},M3=()=>({state:n,dispatch:e,tr:t})=>{try{const r=xd(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},A3=()=>({state:n,dispatch:e})=>u4(n,e),O3=()=>({state:n,dispatch:e})=>d4(n,e);function S2(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function R3(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,s,a,l;for(let u=0;u<e.length-1;u+=1){const d=e[u];if(/^(cmd|meta|m)$/i.test(d))l=!0;else if(/^a(lt)?$/i.test(d))r=!0;else if(/^(c|ctrl|control)$/i.test(d))s=!0;else if(/^s(hift)?$/i.test(d))a=!0;else if(/^mod$/i.test(d))yg()||S2()?l=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${d}`)}return r&&(t=`Alt-${t}`),s&&(t=`Ctrl-${t}`),l&&(t=`Meta-${t}`),a&&(t=`Shift-${t}`),t}var D3=n=>({editor:e,view:t,tr:r,dispatch:s})=>{const a=R3(n).split(/-(?!$)/),l=a.find(h=>!["Alt","Ctrl","Meta","Shift"].includes(h)),u=new KeyboardEvent("keydown",{key:l==="Space"?" ":l,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),d=e.captureTransaction(()=>{t.someProp("handleKeyDown",h=>h(t,u))});return d?.steps.forEach(h=>{const m=h.map(r.mapping);m&&s&&r.maybeStep(m)}),!0},L3=(n,e={})=>({state:t,dispatch:r})=>{const s=pt(n,t.schema);return Ss(t,s,e)?p4(t,r):!1},B3=()=>({state:n,dispatch:e})=>ZS(n,e),z3=n=>({state:e,dispatch:t})=>{const r=pt(n,e.schema);return N4(r)(e,t)},U3=()=>({state:n,dispatch:e})=>QS(n,e);function g1(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,s)=>(t.includes(s)||(r[s]=n[s]),r),{})}var P3=(n,e)=>({tr:t,state:r,dispatch:s})=>{let a=null,l=null;const u=jd(typeof n=="string"?n:n.name,r.schema);return u?(u==="node"&&(a=pt(n,r.schema)),u==="mark"&&(l=Ar(n,r.schema)),s&&t.selection.ranges.forEach(d=>{r.doc.nodesBetween(d.$from.pos,d.$to.pos,(h,m)=>{a&&a===h.type&&t.setNodeMarkup(m,void 0,g1(h.attrs,e)),l&&h.marks.length&&h.marks.forEach(y=>{l===y.type&&t.addMark(m,m+h.nodeSize,l.create(g1(y.attrs,e)))})})}),!0):!1},$3=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),I3=()=>({tr:n,dispatch:e})=>{if(e){const t=new mn(n.doc);n.setSelection(t)}return!0},H3=()=>({state:n,dispatch:e})=>GS(n,e),q3=()=>({state:n,dispatch:e})=>JS(n,e),V3=()=>({state:n,dispatch:e})=>b4(n,e),F3=()=>({state:n,dispatch:e})=>w4(n,e),K3=()=>({state:n,dispatch:e})=>x4(n,e),G3=(n,{errorOnInvalidContent:e,emitUpdate:t=!0,parseOptions:r={}}={})=>({editor:s,tr:a,dispatch:l,commands:u})=>{const{doc:d}=a;if(r.preserveWhitespace!=="full"){const h=bm(n,s.schema,r,{errorOnInvalidContent:e??s.options.enableContentCheck});return l&&a.replaceWith(0,d.content.size,h).setMeta("preventUpdate",!t),!0}return l&&a.setMeta("preventUpdate",!t),u.insertContentAt({from:0,to:d.content.size},n,{parseOptions:r,errorOnInvalidContent:e??s.options.enableContentCheck})};function W3(n,e,t){var r;const{selection:s}=e;let a=null;if(m2(s)&&(a=s.$cursor),a){const u=(r=n.storedMarks)!=null?r:a.marks();return!!t.isInSet(u)||!u.some(d=>d.type.excludes(t))}const{ranges:l}=s;return l.some(({$from:u,$to:d})=>{let h=u.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(u.pos,d.pos,(m,y,v)=>{if(h)return!1;if(m.isInline){const x=!v||v.type.allowsMarkType(t),w=!!t.isInSet(m.marks)||!m.marks.some(k=>k.type.excludes(t));h=x&&w}return!h}),h})}var Y3=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const{selection:a}=t,{empty:l,ranges:u}=a,d=Ar(n,r.schema);if(s)if(l){const h=u2(r,d);t.addStoredMark(d.create({...h,...e}))}else u.forEach(h=>{const m=h.$from.pos,y=h.$to.pos;r.doc.nodesBetween(m,y,(v,x)=>{const w=Math.max(x,m),k=Math.min(x+v.nodeSize,y);v.marks.find(N=>N.type===d)?v.marks.forEach(N=>{d===N.type&&t.addMark(w,k,d.create({...N.attrs,...e}))}):t.addMark(w,k,d.create(e))})});return W3(r,t,d)},J3=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),Q3=(n,e={})=>({state:t,dispatch:r,chain:s})=>{const a=pt(n,t.schema);let l;return t.selection.$anchor.sameParent(t.selection.$head)&&(l=t.selection.$anchor.parent.attrs),a.isTextblock?s().command(({commands:u})=>u1(a,{...l,...e})(t)?!0:u.clearNodes()).command(({state:u})=>u1(a,{...l,...e})(u,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},X3=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,s=ei(n,0,r.content.size),a=ue.create(r,s);e.setSelection(a)}return!0},Z3=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:s,to:a}=typeof n=="number"?{from:n,to:n}:n,l=ve.atStart(r).from,u=ve.atEnd(r).to,d=ei(s,l,u),h=ei(a,l,u),m=ve.create(r,d,h);e.setSelection(m)}return!0},eO=n=>({state:e,dispatch:t})=>{const r=pt(n,e.schema);return j4(r)(e,t)};function y1(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(s=>e?.includes(s.type.name));n.tr.ensureMarks(r)}}var tO=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:s})=>{const{selection:a,doc:l}=e,{$from:u,$to:d}=a,h=s.extensionManager.attributes,m=bu(h,u.node().type.name,u.node().attrs);if(a instanceof ue&&a.node.isBlock)return!u.parentOffset||!Tr(l,u.pos)?!1:(r&&(n&&y1(t,s.extensionManager.splittableMarks),e.split(u.pos).scrollIntoView()),!0);if(!u.parent.isBlock)return!1;const y=d.parentOffset===d.parent.content.size,v=u.depth===0?void 0:O4(u.node(-1).contentMatchAt(u.indexAfter(-1)));let x=y&&v?[{type:v,attrs:m}]:void 0,w=Tr(e.doc,e.mapping.map(u.pos),1,x);if(!x&&!w&&Tr(e.doc,e.mapping.map(u.pos),1,v?[{type:v}]:void 0)&&(w=!0,x=v?[{type:v,attrs:m}]:void 0),r){if(w&&(a instanceof ve&&e.deleteSelection(),e.split(e.mapping.map(u.pos),1,x),v&&!y&&!u.parentOffset&&u.parent.type!==v)){const k=e.mapping.map(u.before()),_=e.doc.resolve(k);u.node(-1).canReplaceWith(_.index(),_.index()+1,v)&&e.setNodeMarkup(e.mapping.map(u.before()),v)}n&&y1(t,s.extensionManager.splittableMarks),e.scrollIntoView()}return w},nO=(n,e={})=>({tr:t,state:r,dispatch:s,editor:a})=>{var l;const u=pt(n,r.schema),{$from:d,$to:h}=r.selection,m=r.selection.node;if(m&&m.isBlock||d.depth<2||!d.sameParent(h))return!1;const y=d.node(-1);if(y.type!==u)return!1;const v=a.extensionManager.attributes;if(d.parent.content.size===0&&d.node(-1).childCount===d.indexAfter(-1)){if(d.depth===2||d.node(-3).type!==u||d.index(-2)!==d.node(-2).childCount-1)return!1;if(s){let N=J.empty;const M=d.index(-1)?1:d.index(-2)?2:3;for(let X=d.depth-M;X>=d.depth-3;X-=1)N=J.from(d.node(X).copy(N));const C=d.indexAfter(-1)<d.node(-2).childCount?1:d.indexAfter(-2)<d.node(-3).childCount?2:3,I={...bu(v,d.node().type.name,d.node().attrs),...e},H=((l=u.contentMatch.defaultType)==null?void 0:l.createAndFill(I))||void 0;N=N.append(J.from(u.createAndFill(null,H)||void 0));const Q=d.before(d.depth-(M-1));t.replace(Q,d.after(-C),new ne(N,4-M,0));let G=-1;t.doc.nodesBetween(Q,t.doc.content.size,(X,Y)=>{if(G>-1)return!1;X.isTextblock&&X.content.size===0&&(G=Y+1)}),G>-1&&t.setSelection(ve.near(t.doc.resolve(G))),t.scrollIntoView()}return!0}const x=h.pos===d.end()?y.contentMatchAt(0).defaultType:null,w={...bu(v,y.type.name,y.attrs),...e},k={...bu(v,d.node().type.name,d.node().attrs),...e};t.delete(d.pos,h.pos);const _=x?[{type:u,attrs:w},{type:x,attrs:k}]:[{type:u,attrs:w}];if(!Tr(t.doc,d.pos,2))return!1;if(s){const{selection:N,storedMarks:M}=r,{splittableMarks:C}=a.extensionManager,I=M||N.$to.parentOffset&&N.$from.marks();if(t.split(d.pos,2,_).scrollIntoView(),!I||!s)return!0;const H=I.filter(Q=>C.includes(Q.type.name));t.ensureMarks(H)}return!0},jp=(n,e)=>{const t=Td(l=>l.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===s?.type&&Es(n.doc,t.pos)&&n.join(t.pos),!0},Mp=(n,e)=>{const t=Td(l=>l.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===s?.type&&Es(n.doc,r)&&n.join(r),!0},rO=(n,e,t,r={})=>({editor:s,tr:a,state:l,dispatch:u,chain:d,commands:h,can:m})=>{const{extensions:y,splittableMarks:v}=s.extensionManager,x=pt(n,l.schema),w=pt(e,l.schema),{selection:k,storedMarks:_}=l,{$from:N,$to:M}=k,C=N.blockRange(M),I=_||k.$to.parentOffset&&k.$from.marks();if(!C)return!1;const H=Td(Q=>m1(Q.type.name,y))(k);if(C.depth>=1&&H&&C.depth-H.depth<=1){if(H.node.type===x)return h.liftListItem(w);if(m1(H.node.type.name,y)&&x.validContent(H.node.content)&&u)return d().command(()=>(a.setNodeMarkup(H.pos,x),!0)).command(()=>jp(a,x)).command(()=>Mp(a,x)).run()}return!t||!I||!u?d().command(()=>m().wrapInList(x,r)?!0:h.clearNodes()).wrapInList(x,r).command(()=>jp(a,x)).command(()=>Mp(a,x)).run():d().command(()=>{const Q=m().wrapInList(x,r),G=I.filter(X=>v.includes(X.type.name));return a.ensureMarks(G),Q?!0:h.clearNodes()}).wrapInList(x,r).command(()=>jp(a,x)).command(()=>Mp(a,x)).run()},sO=(n,e={},t={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:a=!1}=t,l=Ar(n,r.schema);return vm(r,l,e)?s.unsetMark(l,{extendEmptyMarkRange:a}):s.setMark(l,e)},iO=(n,e,t={})=>({state:r,commands:s})=>{const a=pt(n,r.schema),l=pt(e,r.schema),u=Ss(r,a,t);let d;return r.selection.$anchor.sameParent(r.selection.$head)&&(d=r.selection.$anchor.parent.attrs),u?s.setNode(l,d):s.setNode(a,{...d,...t})},aO=(n,e={})=>({state:t,commands:r})=>{const s=pt(n,t.schema);return Ss(t,s,e)?r.lift(s):r.wrapIn(s,e)},oO=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const s=t[r];let a;if(s.spec.isInputRules&&(a=s.getState(n))){if(e){const l=n.tr,u=a.transform;for(let d=u.steps.length-1;d>=0;d-=1)l.step(u.steps[d].invert(u.docs[d]));if(a.text){const d=l.doc.resolve(a.from).marks();l.replaceWith(a.from,a.to,n.schema.text(a.text,d))}else l.delete(a.from,a.to)}return!0}}return!1},lO=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:s}=t;return r||e&&s.forEach(a=>{n.removeMark(a.$from.pos,a.$to.pos)}),!0},cO=(n,e={})=>({tr:t,state:r,dispatch:s})=>{var a;const{extendEmptyMarkRange:l=!1}=e,{selection:u}=t,d=Ar(n,r.schema),{$from:h,empty:m,ranges:y}=u;if(!s)return!0;if(m&&l){let{from:v,to:x}=u;const w=(a=h.marks().find(_=>_.type===d))==null?void 0:a.attrs,k=pg(h,d,w);k&&(v=k.from,x=k.to),t.removeMark(v,x,d)}else y.forEach(v=>{t.removeMark(v.$from.pos,v.$to.pos,d)});return t.removeStoredMark(d),!0},uO=(n,e={})=>({tr:t,state:r,dispatch:s})=>{let a=null,l=null;const u=jd(typeof n=="string"?n:n.name,r.schema);return u?(u==="node"&&(a=pt(n,r.schema)),u==="mark"&&(l=Ar(n,r.schema)),s&&t.selection.ranges.forEach(d=>{const h=d.$from.pos,m=d.$to.pos;let y,v,x,w;t.selection.empty?r.doc.nodesBetween(h,m,(k,_)=>{a&&a===k.type&&(x=Math.max(_,h),w=Math.min(_+k.nodeSize,m),y=_,v=k)}):r.doc.nodesBetween(h,m,(k,_)=>{_<h&&a&&a===k.type&&(x=Math.max(_,h),w=Math.min(_+k.nodeSize,m),y=_,v=k),_>=h&&_<=m&&(a&&a===k.type&&t.setNodeMarkup(_,void 0,{...k.attrs,...e}),l&&k.marks.length&&k.marks.forEach(N=>{if(l===N.type){const M=Math.max(_,h),C=Math.min(_+k.nodeSize,m);t.addMark(M,C,l.create({...N.attrs,...e}))}}))}),v&&(y!==void 0&&t.setNodeMarkup(y,void 0,{...v.attrs,...e}),l&&v.marks.length&&v.marks.forEach(k=>{l===k.type&&t.addMark(x,w,l.create({...k.attrs,...e}))}))}),!0):!1},dO=(n,e={})=>({state:t,dispatch:r})=>{const s=pt(n,t.schema);return S4(s,e)(t,r)},fO=(n,e={})=>({state:t,dispatch:r})=>{const s=pt(n,t.schema);return k4(s,e)(t,r)},k2=mt.create({name:"commands",addCommands(){return{...w2}}}),_2=mt.create({name:"delete",onUpdate({transaction:n,appendedTransactions:e}){var t,r,s;const a=()=>{var l,u,d,h;if((h=(d=(u=(l=this.editor.options.coreExtensionOptions)==null?void 0:l.delete)==null?void 0:u.filterTransaction)==null?void 0:d.call(u,n))!=null?h:n.getMeta("y-sync$"))return;const m=r2(n.before,[n,...e]);f2(m).forEach(x=>{m.mapping.mapResult(x.oldRange.from).deletedAfter&&m.mapping.mapResult(x.oldRange.to).deletedBefore&&m.before.nodesBetween(x.oldRange.from,x.oldRange.to,(w,k)=>{const _=k+w.nodeSize-2,N=x.oldRange.from<=k&&_<=x.oldRange.to;this.editor.emit("delete",{type:"node",node:w,from:k,to:_,newFrom:m.mapping.map(k),newTo:m.mapping.map(_),deletedRange:x.oldRange,newRange:x.newRange,partial:!N,editor:this.editor,transaction:n,combinedTransform:m})})});const v=m.mapping;m.steps.forEach((x,w)=>{var k,_;if(x instanceof In){const N=v.slice(w).map(x.from,-1),M=v.slice(w).map(x.to),C=v.invert().map(N,-1),I=v.invert().map(M),H=(k=m.doc.nodeAt(N-1))==null?void 0:k.marks.some(G=>G.eq(x.mark)),Q=(_=m.doc.nodeAt(M))==null?void 0:_.marks.some(G=>G.eq(x.mark));this.editor.emit("delete",{type:"mark",mark:x.mark,from:x.from,to:x.to,deletedRange:{from:C,to:I},newRange:{from:N,to:M},partial:!!(Q||H),editor:this.editor,transaction:n,combinedTransform:m})}})};(s=(r=(t=this.editor.options.coreExtensionOptions)==null?void 0:t.delete)==null?void 0:r.async)==null||s?setTimeout(a,0):a()}}),E2=mt.create({name:"drop",addProseMirrorPlugins(){return[new at({key:new Mt("tiptapDrop"),props:{handleDrop:(n,e,t,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:r})}}})]}}),N2=mt.create({name:"editable",addProseMirrorPlugins(){return[new at({key:new Mt("editable"),props:{editable:()=>this.editor.options.editable}})]}}),C2=new Mt("focusEvents"),T2=mt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new at({key:C2,props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),j2=mt.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:l})=>[()=>l.undoInputRule(),()=>l.command(({tr:u})=>{const{selection:d,doc:h}=u,{empty:m,$anchor:y}=d,{pos:v,parent:x}=y,w=y.parent.isTextblock&&v>0?u.doc.resolve(v-1):y,k=w.parent.type.spec.isolating,_=y.pos-y.parentOffset,N=k&&w.parent.childCount===1?_===y.pos:ke.atStart(h).from===v;return!m||!x.type.isTextblock||x.textContent.length||!N||N&&y.parent.type.name==="paragraph"?!1:l.clearNodes()}),()=>l.deleteSelection(),()=>l.joinBackward(),()=>l.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:l})=>[()=>l.deleteSelection(),()=>l.deleteCurrentNode(),()=>l.joinForward(),()=>l.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:l})=>[()=>l.newlineInCode(),()=>l.createParagraphNear(),()=>l.liftEmptyBlock(),()=>l.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},a={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return yg()||S2()?a:s},addProseMirrorPlugins(){return[new at({key:new Mt("clearDocument"),appendTransaction:(n,e,t)=>{if(n.some(k=>k.getMeta("composition")))return;const r=n.some(k=>k.docChanged)&&!e.doc.eq(t.doc),s=n.some(k=>k.getMeta("preventClearDocument"));if(!r||s)return;const{empty:a,from:l,to:u}=e.selection,d=ke.atStart(e.doc).from,h=ke.atEnd(e.doc).to;if(a||!(l===d&&u===h)||!Md(t.doc))return;const v=t.tr,x=Nd({state:t,transaction:v}),{commands:w}=new Cd({editor:this.editor,state:x});if(w.clearNodes(),!!v.steps.length)return v}})]}}),M2=mt.create({name:"paste",addProseMirrorPlugins(){return[new at({key:new Mt("tiptapPaste"),props:{handlePaste:(n,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}}),A2=mt.create({name:"tabindex",addProseMirrorPlugins(){return[new at({key:new Mt("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),hO=class ba{constructor(e,t,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=t,this.currentNode=s}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:t,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new ba(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new ba(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new ba(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,r)=>{const s=t.isBlock&&!t.isTextblock,a=t.isAtom&&!t.isText,l=this.pos+r+(a?0:1);if(l<0||l>this.resolvedPos.doc.nodeSize-2)return;const u=this.resolvedPos.doc.resolve(l);if(!s&&u.depth<=this.depth)return;const d=new ba(u,this.editor,s,s?t:null);s&&(d.actualDepth=this.depth+1),e.push(new ba(u,this.editor,s,s?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(t).length>0){const a=s.node.attrs,l=Object.keys(t);for(let u=0;u<l.length;u+=1){const d=l[u];if(a[d]!==t[d])break}}else r=s;s=s.parent}return r}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const a=Object.keys(t);return this.children.forEach(l=>{r&&s.length>0||(l.node.type.name===e&&a.every(d=>t[d]===l.node.attrs[d])&&s.push(l),!(r&&s.length>0)&&(s=s.concat(l.querySelectorAll(e,t,r))))}),s}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}},pO=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function mO(n,e,t){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(s),s}var gO=class extends A4{constructor(n={}){super(),this.css=null,this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(n),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:s,moved:a})=>this.options.onDrop(r,s,a)),this.on("paste",({event:r,slice:s})=>this.options.onPaste(r,s)),this.on("delete",this.options.onDelete);const e=this.createDoc(),t=g2(e,this.options.autofocus);this.editorState=wa.create({doc:e,schema:this.schema,selection:t||void 0}),this.options.element&&this.mount(this.options.element)}mount(n){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(n),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){var n;if(this.editorView){const e=this.editorView.dom;e?.editor&&delete e.editor,this.editorView.destroy()}this.editorView=null,this.isInitialized=!1,(n=this.css)==null||n.remove(),this.css=null}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=mO(pO,this.options.injectNonce))}setOptions(n={}){this.options={...this.options,...n},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(n,e=!0){this.setOptions({editable:n}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:n=>{this.editorState=n},dispatch:n=>{this.editorState=this.state.apply(n)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(n,e)=>{if(e==="state")return this.editorState;if(e in n)return Reflect.get(n,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(n,e){const t=i2(e)?e(n,[...this.state.plugins]):[...this.state.plugins,n],r=this.state.reconfigure({plugins:t});return this.view.updateState(r),r}unregisterPlugin(n){if(this.isDestroyed)return;const e=this.state.plugins;let t=e;if([].concat(n).forEach(s=>{const a=typeof s=="string"?`${s}$`:s.key;t=t.filter(l=>!l.key.startsWith(a))}),e.length===t.length)return;const r=this.state.reconfigure({plugins:t});return this.view.updateState(r),r}createExtensionManager(){var n,e;const r=[...this.options.enableCoreExtensions?[N2,x2.configure({blockSeparator:(e=(n=this.options.coreExtensionOptions)==null?void 0:n.clipboardTextSerializer)==null?void 0:e.blockSeparator}),k2,T2,j2,A2,E2,M2,_2].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s?.type));this.extensionManager=new Od(r,this)}createCommandManager(){this.commandManager=new Cd({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let n;try{n=bm(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(t=>t.name!=="collaboration"),this.createExtensionManager()}}),n=bm(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return n}createView(n){var e;this.editorView=new HS(n,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)==null?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState});const t=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(t),this.createNodeViews(),this.prependClass(),this.injectCSS();const r=this.view.dom;r.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(n){this.isCapturingTransaction=!0,n(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(n){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=n;return}n.steps.forEach(h=>{var m;return(m=this.capturedTransaction)==null?void 0:m.step(h)});return}const{state:e,transactions:t}=this.state.applyTransaction(n),r=!this.state.selection.eq(e.selection),s=t.includes(n),a=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:n,nextState:e}),!s)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:n,appendedTransactions:t.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:n});const l=t.findLast(h=>h.getMeta("focus")||h.getMeta("blur")),u=l?.getMeta("focus"),d=l?.getMeta("blur");u&&this.emit("focus",{editor:this,event:u.event,transaction:l}),d&&this.emit("blur",{editor:this,event:d.event,transaction:l}),!(n.getMeta("preventUpdate")||!t.some(h=>h.docChanged)||a.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:n,appendedTransactions:t.slice(1)})}getAttributes(n){return d2(this.state,n)}isActive(n,e){const t=typeof n=="string"?n:null,r=typeof n=="string"?e:n;return F4(this.state,t,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return dg(this.state.doc.content,this.schema)}getText(n){const{blockSeparator:e=`

`,textSerializers:t={}}=n||{};return P4(this.state.doc,{blockSeparator:e,textSerializers:{...c2(this.schema),...t}})}get isEmpty(){return Md(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var n,e;return(e=(n=this.editorView)==null?void 0:n.isDestroyed)!=null?e:!0}$node(n,e){var t;return((t=this.$doc)==null?void 0:t.querySelector(n,e))||null}$nodes(n,e){var t;return((t=this.$doc)==null?void 0:t.querySelectorAll(n,e))||null}$pos(n){const e=this.state.doc.resolve(n);return new hO(e,this)}get $doc(){return this.$pos(0)}};function ja(n){return new Ad({find:n.find,handler:({state:e,range:t,match:r})=>{const s=Pe(n.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:a}=e,l=r[r.length-1],u=r[0];if(l){const d=u.search(/\S/),h=t.from+u.indexOf(l),m=h+l.length;if(mg(t.from,t.to,e.doc).filter(x=>x.mark.type.excluded.find(k=>k===n.type&&k!==x.mark.type)).filter(x=>x.to>h).length)return null;m<t.to&&a.delete(m,t.to),h>t.from&&a.delete(t.from+d,h);const v=t.from+d+l.length;a.addMark(t.from+d,v,n.type.create(s||{})),a.removeStoredMark(n.type)}}})}function yO(n){return new Ad({find:n.find,handler:({state:e,range:t,match:r})=>{const s=Pe(n.getAttributes,void 0,r)||{},{tr:a}=e,l=t.from;let u=t.to;const d=n.type.create(s);if(r[1]){const h=r[0].lastIndexOf(r[1]);let m=l+h;m>u?m=u:u=m+r[1].length;const y=r[0][r[0].length-1];a.insertText(y,l+r[0].length-1),a.replaceWith(m,u,d)}else if(r[0]){const h=n.type.isInline?l:l-1;a.insert(h,n.type.create(s)).delete(a.mapping.map(l),a.mapping.map(u))}a.scrollIntoView()}})}function xm(n){return new Ad({find:n.find,handler:({state:e,range:t,match:r})=>{const s=e.doc.resolve(t.from),a=Pe(n.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,a)}})}function Ma(n){return new Ad({find:n.find,handler:({state:e,range:t,match:r,chain:s})=>{const a=Pe(n.getAttributes,void 0,r)||{},l=e.tr.delete(t.from,t.to),d=l.doc.resolve(t.from).blockRange(),h=d&&Wm(d,n.type,a);if(!h)return null;if(l.wrap(d,h),n.keepMarks&&n.editor){const{selection:y,storedMarks:v}=e,{splittableMarks:x}=n.editor.extensionManager,w=v||y.$to.parentOffset&&y.$from.marks();if(w){const k=w.filter(_=>x.includes(_.type.name));l.ensureMarks(k)}}if(n.keepAttributes){const y=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(y,a).run()}const m=l.doc.resolve(t.from-1).nodeBefore;m&&m.type===n.type&&Es(l.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,m))&&l.join(t.from-1)}})}function bO(n,e){const{selection:t}=n,{$from:r}=t;if(t instanceof ue){const a=r.index();return r.parent.canReplaceWith(a,a+1,e)}let s=r.depth;for(;s>=0;){const a=r.index(s);if(r.node(s).contentMatchAt(a).matchType(e))return!0;s-=1}return!1}function vO(n,e,t={}){const{state:r}=e,{doc:s,tr:a}=r,l=n;s.descendants((u,d)=>{const h=a.mapping.map(d),m=a.mapping.map(d)+u.nodeSize;let y=null;if(u.marks.forEach(x=>{if(x!==l)return!1;y=x}),!y)return;let v=!1;if(Object.keys(t).forEach(x=>{t[x]!==y.attrs[x]&&(v=!0)}),v){const x=n.type.create({...n.attrs,...t});a.removeMark(h,m,n.type),a.addMark(h,m,x)}}),a.docChanged&&e.view.dispatch(a)}var gn=class O2 extends gg{constructor(){super(...arguments),this.type="node"}static create(e={}){const t=typeof e=="function"?e():e;return new O2(t)}configure(e){return super.configure(e)}extend(e){const t=typeof e=="function"?e():e;return super.extend(t)}};function di(n){return new Z4({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:s})=>{const a=Pe(n.getAttributes,void 0,r,s);if(a===!1||a===null)return null;const{tr:l}=e,u=r[r.length-1],d=r[0];let h=t.to;if(u){const m=d.search(/\S/),y=t.from+d.indexOf(u),v=y+u.length;if(mg(t.from,t.to,e.doc).filter(w=>w.mark.type.excluded.find(_=>_===n.type&&_!==w.mark.type)).filter(w=>w.to>y).length)return null;v<t.to&&l.delete(v,t.to),y>t.from&&l.delete(t.from+m,y),h=t.from+m+u.length,l.addMark(t.from+m,h,n.type.create(a||{})),l.removeStoredMark(n.type)}}})}var Ap,b1;function xO(){return b1||(b1=1,Ap=function n(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,s,a;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(s=r;s--!==0;)if(!n(e[s],t[s]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(s of e.entries())if(!t.has(s[0]))return!1;for(s of e.entries())if(!n(s[1],t.get(s[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(s of e.entries())if(!t.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(s=r;s--!==0;)if(e[s]!==t[s])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(t,a[s]))return!1;for(s=r;s--!==0;){var l=a[s];if(!(l==="_owner"&&e.$$typeof)&&!n(e[l],t[l]))return!1}return!0}return e!==e&&t!==t}),Ap}var wO=xO();const SO=pd(wO);var Op={exports:{}},Rp={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v1;function kO(){if(v1)return Rp;v1=1;var n=_l(),e=Cw();function t(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}var r=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,a=n.useRef,l=n.useEffect,u=n.useMemo,d=n.useDebugValue;return Rp.useSyncExternalStoreWithSelector=function(h,m,y,v,x){var w=a(null);if(w.current===null){var k={hasValue:!1,value:null};w.current=k}else k=w.current;w=u(function(){function N(Q){if(!M){if(M=!0,C=Q,Q=v(Q),x!==void 0&&k.hasValue){var G=k.value;if(x(G,Q))return I=G}return I=Q}if(G=I,r(C,Q))return G;var X=v(Q);return x!==void 0&&x(G,X)?(C=Q,G):(C=Q,I=X)}var M=!1,C,I,H=y===void 0?null:y;return[function(){return N(m())},H===null?void 0:function(){return N(H())}]},[m,y,v,x]);var _=s(h,w[0],w[1]);return l(function(){k.hasValue=!0,k.value=_},[_]),d(_),_},Rp}var x1;function _O(){return x1||(x1=1,Op.exports=kO()),Op.exports}var EO=_O(),NO=(...n)=>e=>{n.forEach(t=>{typeof t=="function"?t(e):t&&(t.current=e)})},CO=({contentComponent:n})=>{const e=Tw.useSyncExternalStore(n.subscribe,n.getSnapshot,n.getServerSnapshot);return p.jsx(p.Fragment,{children:Object.values(e)})};function TO(){const n=new Set;let e={};return{subscribe(t){return n.add(t),()=>{n.delete(t)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(t,r){e={...e,[t]:iC.createPortal(r.reactElement,r.element,t)},n.forEach(s=>s())},removeRenderer(t){const r={...e};delete r[t],e=r,n.forEach(s=>s())}}}var jO=class extends An.Component{constructor(n){var e;super(n),this.editorContentRef=An.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=n.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const n=this.props.editor;if(n&&!n.isDestroyed&&n.options.element){if(n.contentComponent)return;const e=this.editorContentRef.current;e.append(...n.options.element.childNodes),n.setOptions({element:e}),n.contentComponent=TO(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=n.contentComponent.subscribe(()=>{this.setState(t=>t.hasContentComponentInitialized?t:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),n.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var n;const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!((n=e.options.element)!=null&&n.firstChild)))return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){const{editor:n,innerRef:e,...t}=this.props;return p.jsxs(p.Fragment,{children:[p.jsx("div",{ref:NO(e,this.editorContentRef),...t}),n?.contentComponent&&p.jsx(CO,{contentComponent:n.contentComponent})]})}},MO=T.forwardRef((n,e)=>{const t=An.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[n.editor]);return An.createElement(jO,{key:t,innerRef:e,...n})}),AO=An.memo(MO),OO=typeof window<"u"?T.useLayoutEffect:T.useEffect,RO=class{constructor(n){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=n,this.lastSnapshot={editor:n,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(n){return this.subscribers.add(n),()=>{this.subscribers.delete(n)}}watch(n){if(this.editor=n,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},t=this.editor;return t.on("transaction",e),()=>{t.off("transaction",e)}}}};function DO(n){var e;const[t]=T.useState(()=>new RO(n.editor)),r=EO.useSyncExternalStoreWithSelector(t.subscribe,t.getSnapshot,t.getServerSnapshot,n.selector,(e=n.equalityFn)!=null?e:SO);return OO(()=>t.watch(n.editor),[n.editor,t]),T.useDebugValue(r),r}var LO=!1,wm=typeof window>"u",BO=wm||!!(typeof window<"u"&&window.next),zO=class R2{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(t=>t())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?wm||BO?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var s,a;return(a=(s=this.options.current).onBeforeCreate)==null?void 0:a.call(s,...r)},onBlur:(...r)=>{var s,a;return(a=(s=this.options.current).onBlur)==null?void 0:a.call(s,...r)},onCreate:(...r)=>{var s,a;return(a=(s=this.options.current).onCreate)==null?void 0:a.call(s,...r)},onDestroy:(...r)=>{var s,a;return(a=(s=this.options.current).onDestroy)==null?void 0:a.call(s,...r)},onFocus:(...r)=>{var s,a;return(a=(s=this.options.current).onFocus)==null?void 0:a.call(s,...r)},onSelectionUpdate:(...r)=>{var s,a;return(a=(s=this.options.current).onSelectionUpdate)==null?void 0:a.call(s,...r)},onTransaction:(...r)=>{var s,a;return(a=(s=this.options.current).onTransaction)==null?void 0:a.call(s,...r)},onUpdate:(...r)=>{var s,a;return(a=(s=this.options.current).onUpdate)==null?void 0:a.call(s,...r)},onContentError:(...r)=>{var s,a;return(a=(s=this.options.current).onContentError)==null?void 0:a.call(s,...r)},onDrop:(...r)=>{var s,a;return(a=(s=this.options.current).onDrop)==null?void 0:a.call(s,...r)},onPaste:(...r)=>{var s,a;return(a=(s=this.options.current).onPaste)==null?void 0:a.call(s,...r)},onDelete:(...r)=>{var s,a;return(a=(s=this.options.current).onDelete)==null?void 0:a.call(s,...r)}};return new gO(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&t.extensions?e.extensions.length!==t.extensions.length?!1:e.extensions.every((s,a)=>{var l;return s===((l=t.extensions)==null?void 0:l[a])}):e[r]===t[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?R2.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,s)=>r===e[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){t&&t.setOptions(this.options.current);return}t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function UO(n={},e=[]){const t=T.useRef(n);t.current=n;const[r]=T.useState(()=>new zO(t)),s=Tw.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return T.useDebugValue(s),T.useEffect(r.onRender(e)),DO({editor:s,selector:({transactionNumber:a})=>n.shouldRerenderOnTransaction===!1||n.shouldRerenderOnTransaction===void 0?null:n.immediatelyRender&&a===0?0:a+1}),s}var PO=T.createContext({editor:null});PO.Consumer;var $O=T.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),IO=()=>T.useContext($O);An.forwardRef((n,e)=>{const{onDragStart:t}=IO(),r=n.as||"div";return p.jsx(r,{...n,ref:e,"data-node-view-wrapper":"",onDragStart:t,style:{whiteSpace:"normal",...n.style}})});An.createContext({markViewContentRef:()=>{}});var Uu=(n,e)=>{if(n==="slot")return 0;if(n instanceof Function)return n(e);const{children:t,...r}=e??{};if(n==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[n,r,t]},HO=/^\s*>\s$/,D2=gn.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return Uu("blockquote",{...ht(this.options.HTMLAttributes,n),children:Uu("slot",{})})},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Ma({find:HO,type:this.type})]}}),qO=D2,VO=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,FO=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,KO=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,GO=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,L2=pi.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return Uu("strong",{...ht(this.options.HTMLAttributes,n),children:Uu("slot",{})})},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[ja({find:VO,type:this.type}),ja({find:KO,type:this.type})]},addPasteRules(){return[di({find:FO,type:this.type}),di({find:GO,type:this.type})]}}),WO=L2,YO=/(^|[^`])`([^`]+)`(?!`)/,JO=/(^|[^`])`([^`]+)`(?!`)/g,QO=pi.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[ja({find:YO,type:this.type})]},addPasteRules(){return[di({find:JO,type:this.type})]}}),XO=/^```([a-z]+)?[\s\n]$/,ZO=/^~~~([a-z]+)?[\s\n]$/,eR=gn.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,a=[...((e=n.firstElementChild)==null?void 0:e.classList)||[]].filter(l=>l.startsWith(t)).map(l=>l.replace(t,""))[0];return a||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",ht(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:s}=t;if(!s||r.parent.type!==this.type)return!1;const a=r.parentOffset===r.parent.nodeSize-2,l=r.parent.textContent.endsWith(`

`);return!a||!l?!1:n.chain().command(({tr:u})=>(u.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:s,empty:a}=t;if(!a||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const u=s.after();return u===void 0?!1:r.nodeAt(u)?n.commands.command(({tr:h})=>(h.setSelection(ke.near(r.resolve(u))),!0)):n.commands.exitCode()}}},addInputRules(){return[xm({find:XO,type:this.type,getAttributes:n=>({language:n[1]})}),xm({find:ZO,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new at({key:new Mt("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,a=s?.mode;if(!t||!a)return!1;const{tr:l,schema:u}=n.state,d=u.text(t.replace(/\r\n?/g,`
`));return l.replaceSelectionWith(this.type.create({language:a},d)),l.selection.$from.parent.type!==this.type&&l.setSelection(ve.near(l.doc.resolve(Math.max(0,l.selection.from-2)))),l.setMeta("paste",!0),n.dispatch(l),!0}}})]}}),tR=gn.create({name:"doc",topNode:!0,content:"block+"}),nR=gn.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",ht(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:s,storedMarks:a}=t;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:l}=this.options,{splittableMarks:u}=r.extensionManager,d=a||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:h,dispatch:m})=>{if(m&&d&&l){const y=d.filter(v=>u.includes(v.type.name));h.ensureMarks(y)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),rR=gn.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,ht(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>xm({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}}),sR=gn.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",ht(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{if(!bO(e,e.schema.nodes[this.name]))return!1;const{selection:t}=e,{$to:r}=t,s=n();return p2(t)?s.insertContentAt(r.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({tr:a,dispatch:l})=>{var u;if(l){const{$to:d}=a.selection,h=d.end();if(d.nodeAfter)d.nodeAfter.isTextblock?a.setSelection(ve.create(a.doc,d.pos+1)):d.nodeAfter.isBlock?a.setSelection(ue.create(a.doc,d.pos)):a.setSelection(ve.create(a.doc,d.pos));else{const m=(u=d.parent.type.contentMatch.defaultType)==null?void 0:u.create();m&&(a.insert(h,m),a.setSelection(ve.create(a.doc,h+1)))}a.scrollIntoView()}return!0}).run()}}},addInputRules(){return[yO({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),iR=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,aR=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,oR=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,lR=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,B2=pi.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[ja({find:iR,type:this.type}),ja({find:oR,type:this.type})]},addPasteRules(){return[di({find:aR,type:this.type}),di({find:lR,type:this.type})]}}),cR=B2;const uR="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mögensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",dR="ελ1υ2бг1ел3дети4ею2католик6ом3мкд2он1сква6онлайн5рг3рус2ф2сайт3рб3укр3қаз3հայ3ישראל5קום3ابوظبي5رامكو5لاردن4بحرين5جزائر5سعودية6عليان5مغرب5مارات5یران5بارت2زار4يتك3ھارت5تونس4سودان3رية5شبكة4عراق2ب2مان4فلسطين6قطر3كاثوليك6وم3مصر2ليسيا5وريتانيا7قع4همراه5پاکستان7ڀارت4कॉम3नेट3भारत0म्3ोत5संगठन5বাংলা5ভারত2ৰত4ਭਾਰਤ4ભારત4ଭାରତ4இந்தியா6லங்கை6சிங்கப்பூர்11భారత్5ಭಾರತ4ഭാരതം5ලංකා4คอม3ไทย3ລາວ3გე2みんな3アマゾン4クラウド4グーグル4コム2ストア3セール3ファッション6ポイント4世界2中信1国1國1文网3亚马逊3企业2佛山2信息2健康2八卦2公司1益2台湾1灣2商城1店1标2嘉里0大酒店5在线2大拿2天主教3娱乐2家電2广东2微博2慈善2我爱你3手机2招聘2政务1府2新加坡2闻2时尚2書籍2机构2淡马锡3游戏2澳門2点看2移动2组织机构4网址1店1站1络2联通2谷歌2购物2通販2集团2電訊盈科4飞利浦3食品2餐厅2香格里拉3港2닷넷1컴2삼성2한국2",Sm="numeric",km="ascii",_m="alpha",sl="asciinumeric",Jo="alphanumeric",Em="domain",z2="emoji",fR="scheme",hR="slashscheme",Dp="whitespace";function pR(n,e){return n in e||(e[n]=[]),e[n]}function ti(n,e,t){e[Sm]&&(e[sl]=!0,e[Jo]=!0),e[km]&&(e[sl]=!0,e[_m]=!0),e[sl]&&(e[Jo]=!0),e[_m]&&(e[Jo]=!0),e[Jo]&&(e[Em]=!0),e[z2]&&(e[Em]=!0);for(const r in e){const s=pR(r,t);s.indexOf(n)<0&&s.push(n)}}function mR(n,e){const t={};for(const r in e)e[r].indexOf(n)>=0&&(t[r]=!0);return t}function rn(n=null){this.j={},this.jr=[],this.jd=null,this.t=n}rn.groups={};rn.prototype={accepts(){return!!this.t},go(n){const e=this,t=e.j[n];if(t)return t;for(let r=0;r<e.jr.length;r++){const s=e.jr[r][0],a=e.jr[r][1];if(a&&s.test(n))return a}return e.jd},has(n,e=!1){return e?n in this.j:!!this.go(n)},ta(n,e,t,r){for(let s=0;s<n.length;s++)this.tt(n[s],e,t,r)},tr(n,e,t,r){r=r||rn.groups;let s;return e&&e.j?s=e:(s=new rn(e),t&&r&&ti(e,t,r)),this.jr.push([n,s]),s},ts(n,e,t,r){let s=this;const a=n.length;if(!a)return s;for(let l=0;l<a-1;l++)s=s.tt(n[l]);return s.tt(n[a-1],e,t,r)},tt(n,e,t,r){r=r||rn.groups;const s=this;if(e&&e.j)return s.j[n]=e,e;const a=e;let l,u=s.go(n);if(u?(l=new rn,Object.assign(l.j,u.j),l.jr.push.apply(l.jr,u.jr),l.jd=u.jd,l.t=u.t):l=new rn,a){if(r)if(l.t&&typeof l.t=="string"){const d=Object.assign(mR(l.t,r),t);ti(a,d,r)}else t&&ti(a,t,r);l.t=a}return s.j[n]=l,l}};const _e=(n,e,t,r,s)=>n.ta(e,t,r,s),st=(n,e,t,r,s)=>n.tr(e,t,r,s),w1=(n,e,t,r,s)=>n.ts(e,t,r,s),Z=(n,e,t,r,s)=>n.tt(e,t,r,s),Sr="WORD",Nm="UWORD",U2="ASCIINUMERICAL",P2="ALPHANUMERICAL",Sl="LOCALHOST",Cm="TLD",Tm="UTLD",vu="SCHEME",va="SLASH_SCHEME",bg="NUM",jm="WS",vg="NL",il="OPENBRACE",al="CLOSEBRACE",Pu="OPENBRACKET",$u="CLOSEBRACKET",Iu="OPENPAREN",Hu="CLOSEPAREN",qu="OPENANGLEBRACKET",Vu="CLOSEANGLEBRACKET",Fu="FULLWIDTHLEFTPAREN",Ku="FULLWIDTHRIGHTPAREN",Gu="LEFTCORNERBRACKET",Wu="RIGHTCORNERBRACKET",Yu="LEFTWHITECORNERBRACKET",Ju="RIGHTWHITECORNERBRACKET",Qu="FULLWIDTHLESSTHAN",Xu="FULLWIDTHGREATERTHAN",Zu="AMPERSAND",ed="APOSTROPHE",td="ASTERISK",ls="AT",nd="BACKSLASH",rd="BACKTICK",sd="CARET",fs="COLON",xg="COMMA",id="DOLLAR",Jn="DOT",ad="EQUALS",wg="EXCLAMATION",Tn="HYPHEN",ol="PERCENT",od="PIPE",ld="PLUS",cd="POUND",ll="QUERY",Sg="QUOTE",$2="FULLWIDTHMIDDLEDOT",kg="SEMI",Qn="SLASH",cl="TILDE",ud="UNDERSCORE",I2="EMOJI",dd="SYM";var H2=Object.freeze({__proto__:null,ALPHANUMERICAL:P2,AMPERSAND:Zu,APOSTROPHE:ed,ASCIINUMERICAL:U2,ASTERISK:td,AT:ls,BACKSLASH:nd,BACKTICK:rd,CARET:sd,CLOSEANGLEBRACKET:Vu,CLOSEBRACE:al,CLOSEBRACKET:$u,CLOSEPAREN:Hu,COLON:fs,COMMA:xg,DOLLAR:id,DOT:Jn,EMOJI:I2,EQUALS:ad,EXCLAMATION:wg,FULLWIDTHGREATERTHAN:Xu,FULLWIDTHLEFTPAREN:Fu,FULLWIDTHLESSTHAN:Qu,FULLWIDTHMIDDLEDOT:$2,FULLWIDTHRIGHTPAREN:Ku,HYPHEN:Tn,LEFTCORNERBRACKET:Gu,LEFTWHITECORNERBRACKET:Yu,LOCALHOST:Sl,NL:vg,NUM:bg,OPENANGLEBRACKET:qu,OPENBRACE:il,OPENBRACKET:Pu,OPENPAREN:Iu,PERCENT:ol,PIPE:od,PLUS:ld,POUND:cd,QUERY:ll,QUOTE:Sg,RIGHTCORNERBRACKET:Wu,RIGHTWHITECORNERBRACKET:Ju,SCHEME:vu,SEMI:kg,SLASH:Qn,SLASH_SCHEME:va,SYM:dd,TILDE:cl,TLD:Cm,UNDERSCORE:ud,UTLD:Tm,UWORD:Nm,WORD:Sr,WS:jm});const vr=/[a-z]/,Vo=new RegExp("\\p{L}","u"),Lp=new RegExp("\\p{Emoji}","u"),xr=/\d/,Bp=/\s/,S1="\r",zp=`
`,gR="️",yR="‍",Up="￼";let cu=null,uu=null;function bR(n=[]){const e={};rn.groups=e;const t=new rn;cu==null&&(cu=k1(uR)),uu==null&&(uu=k1(dR)),Z(t,"'",ed),Z(t,"{",il),Z(t,"}",al),Z(t,"[",Pu),Z(t,"]",$u),Z(t,"(",Iu),Z(t,")",Hu),Z(t,"<",qu),Z(t,">",Vu),Z(t,"（",Fu),Z(t,"）",Ku),Z(t,"「",Gu),Z(t,"」",Wu),Z(t,"『",Yu),Z(t,"』",Ju),Z(t,"＜",Qu),Z(t,"＞",Xu),Z(t,"&",Zu),Z(t,"*",td),Z(t,"@",ls),Z(t,"`",rd),Z(t,"^",sd),Z(t,":",fs),Z(t,",",xg),Z(t,"$",id),Z(t,".",Jn),Z(t,"=",ad),Z(t,"!",wg),Z(t,"-",Tn),Z(t,"%",ol),Z(t,"|",od),Z(t,"+",ld),Z(t,"#",cd),Z(t,"?",ll),Z(t,'"',Sg),Z(t,"/",Qn),Z(t,";",kg),Z(t,"~",cl),Z(t,"_",ud),Z(t,"\\",nd),Z(t,"・",$2);const r=st(t,xr,bg,{[Sm]:!0});st(r,xr,r);const s=st(r,vr,U2,{[sl]:!0}),a=st(r,Vo,P2,{[Jo]:!0}),l=st(t,vr,Sr,{[km]:!0});st(l,xr,s),st(l,vr,l),st(s,xr,s),st(s,vr,s);const u=st(t,Vo,Nm,{[_m]:!0});st(u,vr),st(u,xr,a),st(u,Vo,u),st(a,xr,a),st(a,vr),st(a,Vo,a);const d=Z(t,zp,vg,{[Dp]:!0}),h=Z(t,S1,jm,{[Dp]:!0}),m=st(t,Bp,jm,{[Dp]:!0});Z(t,Up,m),Z(h,zp,d),Z(h,Up,m),st(h,Bp,m),Z(m,S1),Z(m,zp),st(m,Bp,m),Z(m,Up,m);const y=st(t,Lp,I2,{[z2]:!0});Z(y,"#"),st(y,Lp,y),Z(y,gR,y);const v=Z(y,yR);Z(v,"#"),st(v,Lp,y);const x=[[vr,l],[xr,s]],w=[[vr,null],[Vo,u],[xr,a]];for(let k=0;k<cu.length;k++)ns(t,cu[k],Cm,Sr,x);for(let k=0;k<uu.length;k++)ns(t,uu[k],Tm,Nm,w);ti(Cm,{tld:!0,ascii:!0},e),ti(Tm,{utld:!0,alpha:!0},e),ns(t,"file",vu,Sr,x),ns(t,"mailto",vu,Sr,x),ns(t,"http",va,Sr,x),ns(t,"https",va,Sr,x),ns(t,"ftp",va,Sr,x),ns(t,"ftps",va,Sr,x),ti(vu,{scheme:!0,ascii:!0},e),ti(va,{slashscheme:!0,ascii:!0},e),n=n.sort((k,_)=>k[0]>_[0]?1:-1);for(let k=0;k<n.length;k++){const _=n[k][0],M=n[k][1]?{[fR]:!0}:{[hR]:!0};_.indexOf("-")>=0?M[Em]=!0:vr.test(_)?xr.test(_)?M[sl]=!0:M[km]=!0:M[Sm]=!0,w1(t,_,_,M)}return w1(t,"localhost",Sl,{ascii:!0}),t.jd=new rn(dd),{start:t,tokens:Object.assign({groups:e},H2)}}function q2(n,e){const t=vR(e.replace(/[A-Z]/g,u=>u.toLowerCase())),r=t.length,s=[];let a=0,l=0;for(;l<r;){let u=n,d=null,h=0,m=null,y=-1,v=-1;for(;l<r&&(d=u.go(t[l]));)u=d,u.accepts()?(y=0,v=0,m=u):y>=0&&(y+=t[l].length,v++),h+=t[l].length,a+=t[l].length,l++;a-=y,l-=v,h-=y,s.push({t:m.t,v:e.slice(a-h,a),s:a-h,e:a})}return s}function vR(n){const e=[],t=n.length;let r=0;for(;r<t;){let s=n.charCodeAt(r),a,l=s<55296||s>56319||r+1===t||(a=n.charCodeAt(r+1))<56320||a>57343?n[r]:n.slice(r,r+2);e.push(l),r+=l.length}return e}function ns(n,e,t,r,s){let a;const l=e.length;for(let u=0;u<l-1;u++){const d=e[u];n.j[d]?a=n.j[d]:(a=new rn(r),a.jr=s.slice(),n.j[d]=a),n=a}return a=new rn(t),a.jr=s.slice(),n.j[e[l-1]]=a,a}function k1(n){const e=[],t=[];let r=0,s="0123456789";for(;r<n.length;){let a=0;for(;s.indexOf(n[r+a])>=0;)a++;if(a>0){e.push(t.join(""));for(let l=parseInt(n.substring(r,r+a),10);l>0;l--)t.pop();r+=a}else t.push(n[r]),r++}return e}const kl={defaultProtocol:"http",events:null,format:_1,formatHref:_1,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function _g(n,e=null){let t=Object.assign({},kl);n&&(t=Object.assign(t,n instanceof _g?n.o:n));const r=t.ignoreTags,s=[];for(let a=0;a<r.length;a++)s.push(r[a].toUpperCase());this.o=t,e&&(this.defaultRender=e),this.ignoreTags=s}_g.prototype={o:kl,ignoreTags:[],defaultRender(n){return n},check(n){return this.get("validate",n.toString(),n)},get(n,e,t){const r=e!=null;let s=this.o[n];return s&&(typeof s=="object"?(s=t.t in s?s[t.t]:kl[n],typeof s=="function"&&r&&(s=s(e,t))):typeof s=="function"&&r&&(s=s(e,t.t,t)),s)},getObj(n,e,t){let r=this.o[n];return typeof r=="function"&&e!=null&&(r=r(e,t.t,t)),r},render(n){const e=n.render(this);return(this.get("render",null,n)||this.defaultRender)(e,n.t,n)}};function _1(n){return n}function V2(n,e){this.t="token",this.v=n,this.tk=e}V2.prototype={isLink:!1,toString(){return this.v},toHref(n){return this.toString()},toFormattedString(n){const e=this.toString(),t=n.get("truncate",e,this),r=n.get("format",e,this);return t&&r.length>t?r.substring(0,t)+"…":r},toFormattedHref(n){return n.get("formatHref",this.toHref(n.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(n=kl.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(n),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(n){return{type:this.t,value:this.toFormattedString(n),isLink:this.isLink,href:this.toFormattedHref(n),start:this.startIndex(),end:this.endIndex()}},validate(n){return n.get("validate",this.toString(),this)},render(n){const e=this,t=this.toHref(n.get("defaultProtocol")),r=n.get("formatHref",t,this),s=n.get("tagName",t,e),a=this.toFormattedString(n),l={},u=n.get("className",t,e),d=n.get("target",t,e),h=n.get("rel",t,e),m=n.getObj("attributes",t,e),y=n.getObj("events",t,e);return l.href=r,u&&(l.class=u),d&&(l.target=d),h&&(l.rel=h),m&&Object.assign(l,m),{tagName:s,attributes:l,content:a,eventListeners:y}}};function Rd(n,e){class t extends V2{constructor(s,a){super(s,a),this.t=n}}for(const r in e)t.prototype[r]=e[r];return t.t=n,t}const E1=Rd("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),N1=Rd("text"),xR=Rd("nl"),du=Rd("url",{isLink:!0,toHref(n=kl.defaultProtocol){return this.hasProtocol()?this.v:`${n}://${this.v}`},hasProtocol(){const n=this.tk;return n.length>=2&&n[0].t!==Sl&&n[1].t===fs}}),Cn=n=>new rn(n);function wR({groups:n}){const e=n.domain.concat([Zu,td,ls,nd,rd,sd,id,ad,Tn,bg,ol,od,ld,cd,Qn,dd,cl,ud]),t=[ed,fs,xg,Jn,wg,ol,ll,Sg,kg,qu,Vu,il,al,$u,Pu,Iu,Hu,Fu,Ku,Gu,Wu,Yu,Ju,Qu,Xu],r=[Zu,ed,td,nd,rd,sd,id,ad,Tn,il,al,ol,od,ld,cd,ll,Qn,dd,cl,ud],s=Cn(),a=Z(s,cl);_e(a,r,a),_e(a,n.domain,a);const l=Cn(),u=Cn(),d=Cn();_e(s,n.domain,l),_e(s,n.scheme,u),_e(s,n.slashscheme,d),_e(l,r,a),_e(l,n.domain,l);const h=Z(l,ls);Z(a,ls,h),Z(u,ls,h),Z(d,ls,h);const m=Z(a,Jn);_e(m,r,a),_e(m,n.domain,a);const y=Cn();_e(h,n.domain,y),_e(y,n.domain,y);const v=Z(y,Jn);_e(v,n.domain,y);const x=Cn(E1);_e(v,n.tld,x),_e(v,n.utld,x),Z(h,Sl,x);const w=Z(y,Tn);Z(w,Tn,w),_e(w,n.domain,y),_e(x,n.domain,y),Z(x,Jn,v),Z(x,Tn,w);const k=Z(x,fs);_e(k,n.numeric,E1);const _=Z(l,Tn),N=Z(l,Jn);Z(_,Tn,_),_e(_,n.domain,l),_e(N,r,a),_e(N,n.domain,l);const M=Cn(du);_e(N,n.tld,M),_e(N,n.utld,M),_e(M,n.domain,l),_e(M,r,a),Z(M,Jn,N),Z(M,Tn,_),Z(M,ls,h);const C=Z(M,fs),I=Cn(du);_e(C,n.numeric,I);const H=Cn(du),Q=Cn();_e(H,e,H),_e(H,t,Q),_e(Q,e,H),_e(Q,t,Q),Z(M,Qn,H),Z(I,Qn,H);const G=Z(u,fs),X=Z(d,fs),Y=Z(X,Qn),ye=Z(Y,Qn);_e(u,n.domain,l),Z(u,Jn,N),Z(u,Tn,_),_e(d,n.domain,l),Z(d,Jn,N),Z(d,Tn,_),_e(G,n.domain,H),Z(G,Qn,H),Z(G,ll,H),_e(ye,n.domain,H),_e(ye,e,H),Z(ye,Qn,H);const $e=[[il,al],[Pu,$u],[Iu,Hu],[qu,Vu],[Fu,Ku],[Gu,Wu],[Yu,Ju],[Qu,Xu]];for(let Ce=0;Ce<$e.length;Ce++){const[tt,ie]=$e[Ce],he=Z(H,tt);Z(Q,tt,he),Z(he,ie,H);const $=Cn(du);_e(he,e,$);const P=Cn();_e(he,t),_e($,e,$),_e($,t,P),_e(P,e,$),_e(P,t,P),Z($,ie,H),Z(P,ie,H)}return Z(s,Sl,M),Z(s,vg,xR),{start:s,tokens:H2}}function SR(n,e,t){let r=t.length,s=0,a=[],l=[];for(;s<r;){let u=n,d=null,h=null,m=0,y=null,v=-1;for(;s<r&&!(d=u.go(t[s].t));)l.push(t[s++]);for(;s<r&&(h=d||u.go(t[s].t));)d=null,u=h,u.accepts()?(v=0,y=u):v>=0&&v++,s++,m++;if(v<0)s-=m,s<r&&(l.push(t[s]),s++);else{l.length>0&&(a.push(Pp(N1,e,l)),l=[]),s-=v,m-=v;const x=y.t,w=t.slice(s-m,s);a.push(Pp(x,e,w))}}return l.length>0&&a.push(Pp(N1,e,l)),a}function Pp(n,e,t){const r=t[0].s,s=t[t.length-1].e,a=e.slice(r,s);return new n(a,t)}const kR=typeof console<"u"&&console&&console.warn||(()=>{}),_R="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Ye={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function ER(){return rn.groups={},Ye.scanner=null,Ye.parser=null,Ye.tokenQueue=[],Ye.pluginQueue=[],Ye.customSchemes=[],Ye.initialized=!1,Ye}function C1(n,e=!1){if(Ye.initialized&&kR(`linkifyjs: already initialized - will not register custom scheme "${n}" ${_R}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(n))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Ye.customSchemes.push([n,e])}function NR(){Ye.scanner=bR(Ye.customSchemes);for(let n=0;n<Ye.tokenQueue.length;n++)Ye.tokenQueue[n][1]({scanner:Ye.scanner});Ye.parser=wR(Ye.scanner.tokens);for(let n=0;n<Ye.pluginQueue.length;n++)Ye.pluginQueue[n][1]({scanner:Ye.scanner,parser:Ye.parser});return Ye.initialized=!0,Ye}function Eg(n){return Ye.initialized||NR(),SR(Ye.parser.start,n,q2(Ye.scanner.start,n))}Eg.scan=q2;function F2(n,e=null,t=null){if(e&&typeof e=="object"){if(t)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);t=e,e=null}const r=new _g(t),s=Eg(n),a=[];for(let l=0;l<s.length;l++){const u=s[l];u.isLink&&(!e||u.t===e)&&r.check(u)&&a.push(u.toFormattedObject(r))}return a}var Ng="[\0-   ᠎ -\u2029 　]",CR=new RegExp(Ng),TR=new RegExp(`${Ng}$`),jR=new RegExp(Ng,"g");function MR(n){return n.length===1?n[0].isLink:n.length===3&&n[1].isLink?["()","[]"].includes(n[0].value+n[2].value):!1}function AR(n){return new at({key:new Mt("autolink"),appendTransaction:(e,t,r)=>{const s=e.some(h=>h.docChanged)&&!t.doc.eq(r.doc),a=e.some(h=>h.getMeta("preventAutolink"));if(!s||a)return;const{tr:l}=r,u=r2(t.doc,[...e]);if(f2(u).forEach(({newRange:h})=>{const m=R4(r.doc,h,x=>x.isTextblock);let y,v;if(m.length>1)y=m[0],v=r.doc.textBetween(y.pos,y.pos+y.node.nodeSize,void 0," ");else if(m.length){const x=r.doc.textBetween(h.from,h.to," "," ");if(!TR.test(x))return;y=m[0],v=r.doc.textBetween(y.pos,h.to,void 0," ")}if(y&&v){const x=v.split(CR).filter(Boolean);if(x.length<=0)return!1;const w=x[x.length-1],k=y.pos+v.lastIndexOf(w);if(!w)return!1;const _=Eg(w).map(N=>N.toObject(n.defaultProtocol));if(!MR(_))return!1;_.filter(N=>N.isLink).map(N=>({...N,from:k+N.start+1,to:k+N.end+1})).filter(N=>r.schema.marks.code?!r.doc.rangeHasMark(N.from,N.to,r.schema.marks.code):!0).filter(N=>n.validate(N.value)).filter(N=>n.shouldAutoLink(N.value)).forEach(N=>{mg(N.from,N.to,r.doc).some(M=>M.mark.type===n.type)||l.addMark(N.from,N.to,n.type.create({href:N.href}))})}}),!!l.steps.length)return l}})}function OR(n){return new at({key:new Mt("handleClickLink"),props:{handleClick:(e,t,r)=>{var s,a;if(r.button!==0||!e.editable)return!1;let l=null;if(r.target instanceof HTMLAnchorElement)l=r.target;else{let m=r.target;const y=[];for(;m.nodeName!=="DIV";)y.push(m),m=m.parentNode;l=y.find(v=>v.nodeName==="A")}if(!l)return!1;const u=d2(e.state,n.type.name),d=(s=l?.href)!=null?s:u.href,h=(a=l?.target)!=null?a:u.target;return n.enableClickSelection&&n.editor.commands.extendMarkRange(n.type.name),l&&d?(window.open(d,h),!0):!1}}})}function RR(n){return new at({key:new Mt("handlePasteLink"),props:{handlePaste:(e,t,r)=>{const{state:s}=e,{selection:a}=s,{empty:l}=a;if(l)return!1;let u="";r.content.forEach(h=>{u+=h.textContent});const d=F2(u,{defaultProtocol:n.defaultProtocol}).find(h=>h.isLink&&h.value===u);return!u||!d?!1:n.editor.commands.setMark(n.type,{href:d.href})}}})}function Ws(n,e){const t=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const s=typeof r=="string"?r:r.scheme;s&&t.push(s)}),!n||n.replace(jR,"").match(new RegExp(`^(?:(?:${t.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var K2=pi.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(n=>{if(typeof n=="string"){C1(n);return}C1(n.scheme,n.optionalSlashes)})},onDestroy(){ER()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(n,e)=>!!Ws(n,e.protocols),validate:n=>!!n,shouldAutoLink:n=>!!n}},addAttributes(){return{href:{default:null,parseHTML(n){return n.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:n=>{const e=n.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:t=>!!Ws(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:n}){return this.options.isAllowedUri(n.href,{defaultValidate:e=>!!Ws(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",ht(this.options.HTMLAttributes,n),0]:["a",ht(this.options.HTMLAttributes,{...n,href:""}),0]},addCommands(){return{setLink:n=>({chain:e})=>{const{href:t}=n;return this.options.isAllowedUri(t,{defaultValidate:r=>!!Ws(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,n).setMeta("preventAutolink",!0).run():!1},toggleLink:n=>({chain:e})=>{const{href:t}=n||{};return t&&!this.options.isAllowedUri(t,{defaultValidate:r=>!!Ws(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,n,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:n})=>n().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[di({find:n=>{const e=[];if(n){const{protocols:t,defaultProtocol:r}=this.options,s=F2(n).filter(a=>a.isLink&&this.options.isAllowedUri(a.value,{defaultValidate:l=>!!Ws(l,t),protocols:t,defaultProtocol:r}));s.length&&s.forEach(a=>e.push({text:a.value,data:{href:a.href},index:a.start}))}return e},type:this.type,getAttributes:n=>{var e;return{href:(e=n.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const n=[],{protocols:e,defaultProtocol:t}=this.options;return this.options.autolink&&n.push(AR({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:s=>!!Ws(s,e),protocols:e,defaultProtocol:t}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&n.push(OR({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&n.push(RR({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),n}}),DR=K2,LR=Object.defineProperty,BR=(n,e)=>{for(var t in e)LR(n,t,{get:e[t],enumerable:!0})},zR="listItem",T1="textStyle",j1=/^\s*([-+*])\s$/,G2=gn.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(zR,this.editor.getAttributes(T1)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=Ma({find:j1,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Ma({find:j1,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(T1),editor:this.editor})),[n]}}),W2=gn.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",ht(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),UR={};BR(UR,{findListItemPos:()=>Rl,getNextListDepth:()=>Cg,handleBackspace:()=>Mm,handleDelete:()=>Am,hasListBefore:()=>Y2,hasListItemAfter:()=>PR,hasListItemBefore:()=>J2,listItemHasSubList:()=>Q2,nextListIsDeeper:()=>X2,nextListIsHigher:()=>Z2});var Rl=(n,e)=>{const{$from:t}=e.selection,r=pt(n,e.schema);let s=null,a=t.depth,l=t.pos,u=null;for(;a>0&&u===null;)s=t.node(a),s.type===r?u=a:(a-=1,l-=1);return u===null?null:{$pos:e.doc.resolve(l),depth:u}},Cg=(n,e)=>{const t=Rl(n,e);if(!t)return!1;const[,r]=q4(e,n,t.$pos.pos+4);return r},Y2=(n,e,t)=>{const{$anchor:r}=n.selection,s=Math.max(0,r.pos-2),a=n.doc.resolve(s).node();return!(!a||!t.includes(a.type.name))},J2=(n,e)=>{var t;const{$anchor:r}=e.selection,s=e.doc.resolve(r.pos-2);return!(s.index()===0||((t=s.nodeBefore)==null?void 0:t.type.name)!==n)},Q2=(n,e,t)=>{if(!t)return!1;const r=pt(n,e.schema);let s=!1;return t.descendants(a=>{a.type===r&&(s=!0)}),s},Mm=(n,e,t)=>{if(n.commands.undoInputRule())return!0;if(n.state.selection.from!==n.state.selection.to)return!1;if(!Ss(n.state,e)&&Y2(n.state,e,t)){const{$anchor:u}=n.state.selection,d=n.state.doc.resolve(u.before()-1),h=[];d.node().descendants((v,x)=>{v.type.name===e&&h.push({node:v,pos:x})});const m=h.at(-1);if(!m)return!1;const y=n.state.doc.resolve(d.start()+m.pos+1);return n.chain().cut({from:u.start()-1,to:u.end()+1},y.end()).joinForward().run()}if(!Ss(n.state,e)||!G4(n.state))return!1;const r=Rl(e,n.state);if(!r)return!1;const a=n.state.doc.resolve(r.$pos.pos-2).node(r.depth),l=Q2(e,n.state,a);return J2(e,n.state)&&!l?n.commands.joinItemBackward():n.chain().liftListItem(e).run()},X2=(n,e)=>{const t=Cg(n,e),r=Rl(n,e);return!r||!t?!1:t>r.depth},Z2=(n,e)=>{const t=Cg(n,e),r=Rl(n,e);return!r||!t?!1:t<r.depth},Am=(n,e)=>{if(!Ss(n.state,e)||!K4(n.state,e))return!1;const{selection:t}=n.state,{$from:r,$to:s}=t;return!t.empty&&r.sameParent(s)?!1:X2(e,n.state)?n.chain().focus(n.state.selection.from+4).lift(e).joinBackward().run():Z2(e,n.state)?n.chain().joinForward().joinBackward().run():n.commands.joinItemForward()},PR=(n,e)=>{var t;const{$anchor:r}=e.selection,s=e.doc.resolve(r.pos-r.parentOffset-2);return!(s.index()===s.parent.childCount-1||((t=s.nodeAfter)==null?void 0:t.type.name)!==n)},ek=mt.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:n})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t})=>{n.state.schema.nodes[t]!==void 0&&Am(n,t)&&(e=!0)}),e},"Mod-Delete":({editor:n})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t})=>{n.state.schema.nodes[t]!==void 0&&Am(n,t)&&(e=!0)}),e},Backspace:({editor:n})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t,wrapperNames:r})=>{n.state.schema.nodes[t]!==void 0&&Mm(n,t,r)&&(e=!0)}),e},"Mod-Backspace":({editor:n})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t,wrapperNames:r})=>{n.state.schema.nodes[t]!==void 0&&Mm(n,t,r)&&(e=!0)}),e}}}}),$R="listItem",M1="textStyle",A1=/^(\d+)\.\s$/,tk=gn.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",ht(this.options.HTMLAttributes,t),0]:["ol",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes($R,this.editor.getAttributes(M1)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=Ma({find:A1,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Ma({find:A1,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(M1)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),IR=/^\s*(\[([( |x])?\])\s$/,HR=gn.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:n=>{const e=n.getAttribute("data-checked");return e===""||e==="true"},renderHTML:n=>({"data-checked":n.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:n,HTMLAttributes:e}){return["li",ht(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:n.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts(){const n={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...n,Tab:()=>this.editor.commands.sinkListItem(this.name)}:n},addNodeView(){return({node:n,HTMLAttributes:e,getPos:t,editor:r})=>{const s=document.createElement("li"),a=document.createElement("label"),l=document.createElement("span"),u=document.createElement("input"),d=document.createElement("div"),h=m=>{var y,v;u.ariaLabel=((v=(y=this.options.a11y)==null?void 0:y.checkboxLabel)==null?void 0:v.call(y,m,u.checked))||`Task item checkbox for ${m.textContent||"empty task item"}`};return h(n),a.contentEditable="false",u.type="checkbox",u.addEventListener("mousedown",m=>m.preventDefault()),u.addEventListener("change",m=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){u.checked=!u.checked;return}const{checked:y}=m.target;r.isEditable&&typeof t=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:v})=>{const x=t();if(typeof x!="number")return!1;const w=v.doc.nodeAt(x);return v.setNodeMarkup(x,void 0,{...w?.attrs,checked:y}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(n,y)||(u.checked=!u.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([m,y])=>{s.setAttribute(m,y)}),s.dataset.checked=n.attrs.checked,u.checked=n.attrs.checked,a.append(u,l),s.append(a,d),Object.entries(e).forEach(([m,y])=>{s.setAttribute(m,y)}),{dom:s,contentDOM:d,update:m=>m.type!==this.type?!1:(s.dataset.checked=m.attrs.checked,u.checked=m.attrs.checked,h(m),!0)}}},addInputRules(){return[Ma({find:IR,type:this.type,getAttributes:n=>({checked:n[n.length-1]==="x"})})]}}),qR=gn.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:n}){return["ul",ht(this.options.HTMLAttributes,n,{"data-type":this.name}),0]},addCommands(){return{toggleTaskList:()=>({commands:n})=>n.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});mt.create({name:"listKit",addExtensions(){const n=[];return this.options.bulletList!==!1&&n.push(G2.configure(this.options.bulletList)),this.options.listItem!==!1&&n.push(W2.configure(this.options.listItem)),this.options.listKeymap!==!1&&n.push(ek.configure(this.options.listKeymap)),this.options.orderedList!==!1&&n.push(tk.configure(this.options.orderedList)),this.options.taskItem!==!1&&n.push(HR.configure(this.options.taskItem)),this.options.taskList!==!1&&n.push(qR.configure(this.options.taskList)),n}});var VR=gn.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),FR=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,KR=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,GR=pi.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[ja({find:FR,type:this.type})]},addPasteRules(){return[di({find:KR,type:this.type})]}}),WR=gn.create({name:"text",group:"inline"}),nk=pi.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["u",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{setUnderline:()=>({commands:n})=>n.setMark(this.name),toggleUnderline:()=>({commands:n})=>n.toggleMark(this.name),unsetUnderline:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),YR=nk;function JR(n={}){return new at({view(e){return new QR(e,n)}})}class QR{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let a=l=>{this[s](l)};return e.dom.addEventListener(s,a),{name:s,handler:a}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r,s=this.editorView.dom,a=s.getBoundingClientRect(),l=a.width/s.offsetWidth,u=a.height/s.offsetHeight;if(t){let y=e.nodeBefore,v=e.nodeAfter;if(y||v){let x=this.editorView.nodeDOM(this.cursorPos-(y?y.nodeSize:0));if(x){let w=x.getBoundingClientRect(),k=y?w.bottom:w.top;y&&v&&(k=(k+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let _=this.width/2*u;r={left:w.left,right:w.right,top:k-_,bottom:k+_}}}}if(!r){let y=this.editorView.coordsAtPos(this.cursorPos),v=this.width/2*l;r={left:y.left-v,right:y.left+v,top:y.top,bottom:y.bottom}}let d=this.editorView.dom.offsetParent;this.element||(this.element=d.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let h,m;if(!d||d==document.body&&getComputedStyle(d).position=="static")h=-pageXOffset,m=-pageYOffset;else{let y=d.getBoundingClientRect(),v=y.width/d.offsetWidth,x=y.height/d.offsetHeight;h=y.left-d.scrollLeft*v,m=y.top-d.scrollTop*x}this.element.style.left=(r.left-h)/l+"px",this.element.style.top=(r.top-m)/u+"px",this.element.style.width=(r.right-r.left)/l+"px",this.element.style.height=(r.bottom-r.top)/u+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),s=r&&r.type.spec.disableDropCursor,a=typeof s=="function"?s(this.editorView,t,e):s;if(t&&!a){let l=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let u=tS(this.editorView.state.doc,l,this.editorView.dragging.slice);u!=null&&(l=u)}this.setCursor(l),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class it extends ke{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return it.valid(r)?new it(r):ke.near(r)}content(){return ne.empty}eq(e){return e instanceof it&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new it(e.resolve(t.pos))}getBookmark(){return new Tg(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!XR(e)||!ZR(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let s=t.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&it.valid(e))return e;let s=e.pos,a=null;for(let l=e.depth;;l--){let u=e.node(l);if(t>0?e.indexAfter(l)<u.childCount:e.index(l)>0){a=u.child(t>0?e.indexAfter(l):e.index(l)-1);break}else if(l==0)return null;s+=t;let d=e.doc.resolve(s);if(it.valid(d))return d}for(;;){let l=t>0?a.firstChild:a.lastChild;if(!l){if(a.isAtom&&!a.isText&&!ue.isSelectable(a)){e=e.doc.resolve(s+a.nodeSize*t),r=!1;continue e}break}a=l,s+=t;let u=e.doc.resolve(s);if(it.valid(u))return u}return null}}}it.prototype.visible=!1;it.findFrom=it.findGapCursorFrom;ke.jsonID("gapcursor",it);class Tg{constructor(e){this.pos=e}map(e){return new Tg(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return it.valid(t)?new it(t):ke.near(t)}}function XR(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function ZR(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function eD(){return new at({props:{decorations:sD,createSelectionBetween(n,e,t){return e.pos==t.pos&&it.valid(t)?new it(t):null},handleClick:nD,handleKeyDown:tD,handleDOMEvents:{beforeinput:rD}}})}const tD=qS({ArrowLeft:fu("horiz",-1),ArrowRight:fu("horiz",1),ArrowUp:fu("vert",-1),ArrowDown:fu("vert",1)});function fu(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,s,a){let l=r.selection,u=e>0?l.$to:l.$from,d=l.empty;if(l instanceof ve){if(!a.endOfTextblock(t)||u.depth==0)return!1;d=!1,u=r.doc.resolve(e>0?u.after():u.before())}let h=it.findGapCursorFrom(u,e,d);return h?(s&&s(r.tr.setSelection(new it(h))),!0):!1}}function nD(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!it.valid(r))return!1;let s=n.posAtCoords({left:t.clientX,top:t.clientY});return s&&s.inside>-1&&ue.isSelectable(n.state.doc.nodeAt(s.inside))?!1:(n.dispatch(n.state.tr.setSelection(new it(r))),!0)}function rD(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof it))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let s=J.empty;for(let l=r.length-1;l>=0;l--)s=J.from(r[l].createAndFill(null,s));let a=n.state.tr.replace(t.pos,t.pos,new ne(s,0,0));return a.setSelection(ve.near(a.doc.resolve(t.pos+1))),n.dispatch(a),!1}function sD(n){if(!(n.selection instanceof it))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Ze.create(n.doc,[Kt.widget(n.selection.head,e,{key:"gapcursor"})])}var fd=200,jt=function(){};jt.prototype.append=function(e){return e.length?(e=jt.from(e),!this.length&&e||e.length<fd&&this.leafAppend(e)||this.length<fd&&e.leafPrepend(this)||this.appendInner(e)):this};jt.prototype.prepend=function(e){return e.length?jt.from(e).append(this):this};jt.prototype.appendInner=function(e){return new iD(this,e)};jt.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?jt.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};jt.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};jt.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};jt.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(a,l){return s.push(e(a,l))},t,r),s};jt.from=function(e){return e instanceof jt?e:e&&e.length?new rk(e):jt.empty};var rk=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,a){return s==0&&a==this.length?this:new e(this.values.slice(s,a))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,a,l,u){for(var d=a;d<l;d++)if(s(this.values[d],u+d)===!1)return!1},e.prototype.forEachInvertedInner=function(s,a,l,u){for(var d=a-1;d>=l;d--)if(s(this.values[d],u+d)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=fd)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=fd)return new e(s.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(jt);jt.empty=new rk([]);var iD=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,a,l){var u=this.left.length;if(s<u&&this.left.forEachInner(r,s,Math.min(a,u),l)===!1||a>u&&this.right.forEachInner(r,Math.max(s-u,0),Math.min(this.length,a)-u,l+u)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,a,l){var u=this.left.length;if(s>u&&this.right.forEachInvertedInner(r,s-u,Math.max(a,u)-u,l+u)===!1||a<u&&this.left.forEachInvertedInner(r,Math.min(s,u),a,l)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var a=this.left.length;return s<=a?this.left.slice(r,s):r>=a?this.right.slice(r-a,s-a):this.left.slice(r,a).append(this.right.slice(0,s-a))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(jt);const aD=500;class $n{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,a;t&&(s=this.remapping(r,this.items.length),a=s.maps.length);let l=e.tr,u,d,h=[],m=[];return this.items.forEach((y,v)=>{if(!y.step){s||(s=this.remapping(r,v+1),a=s.maps.length),a--,m.push(y);return}if(s){m.push(new Xn(y.map));let x=y.step.map(s.slice(a)),w;x&&l.maybeStep(x).doc&&(w=l.mapping.maps[l.mapping.maps.length-1],h.push(new Xn(w,void 0,void 0,h.length+m.length))),a--,w&&s.appendMap(w,a)}else l.maybeStep(y.step);if(y.selection)return u=s?y.selection.map(s.slice(a)):y.selection,d=new $n(this.items.slice(0,r).append(m.reverse().concat(h)),this.eventCount-1),!1},this.items.length,0),{remaining:d,transform:l,selection:u}}addTransform(e,t,r,s){let a=[],l=this.eventCount,u=this.items,d=!s&&u.length?u.get(u.length-1):null;for(let m=0;m<e.steps.length;m++){let y=e.steps[m].invert(e.docs[m]),v=new Xn(e.mapping.maps[m],y,t),x;(x=d&&d.merge(v))&&(v=x,m?a.pop():u=u.slice(0,u.length-1)),a.push(v),t&&(l++,t=void 0),s||(d=v)}let h=l-r.depth;return h>lD&&(u=oD(u,h),l-=h),new $n(u.append(a),l)}remapping(e,t){let r=new ml;return this.items.forEach((s,a)=>{let l=s.mirrorOffset!=null&&a-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,l)},e,t),r}addMaps(e){return this.eventCount==0?this:new $n(this.items.append(e.map(t=>new Xn(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-t),a=e.mapping,l=e.steps.length,u=this.eventCount;this.items.forEach(v=>{v.selection&&u--},s);let d=t;this.items.forEach(v=>{let x=a.getMirror(--d);if(x==null)return;l=Math.min(l,x);let w=a.maps[x];if(v.step){let k=e.steps[x].invert(e.docs[x]),_=v.selection&&v.selection.map(a.slice(d+1,x));_&&u++,r.push(new Xn(w,k,_))}else r.push(new Xn(w))},s);let h=[];for(let v=t;v<l;v++)h.push(new Xn(a.maps[v]));let m=this.items.slice(0,s).append(h).append(r),y=new $n(m,u);return y.emptyItemCount()>aD&&(y=y.compress(this.items.length-r.length)),y}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,s=[],a=0;return this.items.forEach((l,u)=>{if(u>=e)s.push(l),l.selection&&a++;else if(l.step){let d=l.step.map(t.slice(r)),h=d&&d.getMap();if(r--,h&&t.appendMap(h,r),d){let m=l.selection&&l.selection.map(t.slice(r));m&&a++;let y=new Xn(h.invert(),d,m),v,x=s.length-1;(v=s.length&&s[x].merge(y))?s[x]=v:s.push(y)}}else l.map&&r--},this.items.length,0),new $n(jt.from(s.reverse()),a)}}$n.empty=new $n(jt.empty,0);function oD(n,e){let t;return n.forEach((r,s)=>{if(r.selection&&e--==0)return t=s,!1}),n.slice(t)}class Xn{constructor(e,t,r,s){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Xn(t.getMap().invert(),t,this.selection)}}}class cs{constructor(e,t,r,s,a){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=s,this.prevComposition=a}}const lD=20;function cD(n,e,t,r){let s=t.getMeta(ai),a;if(s)return s.historyState;t.getMeta(fD)&&(n=new cs(n.done,n.undone,null,0,-1));let l=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(l&&l.getMeta(ai))return l.getMeta(ai).redo?new cs(n.done.addTransform(t,void 0,r,xu(e)),n.undone,O1(t.mapping.maps),n.prevTime,n.prevComposition):new cs(n.done,n.undone.addTransform(t,void 0,r,xu(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(l&&l.getMeta("addToHistory")===!1)){let u=t.getMeta("composition"),d=n.prevTime==0||!l&&n.prevComposition!=u&&(n.prevTime<(t.time||0)-r.newGroupDelay||!uD(t,n.prevRanges)),h=l?$p(n.prevRanges,t.mapping):O1(t.mapping.maps);return new cs(n.done.addTransform(t,d?e.selection.getBookmark():void 0,r,xu(e)),$n.empty,h,t.time,u??n.prevComposition)}else return(a=t.getMeta("rebased"))?new cs(n.done.rebased(t,a),n.undone.rebased(t,a),$p(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new cs(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),$p(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function uD(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,s)=>{for(let a=0;a<e.length;a+=2)r<=e[a+1]&&s>=e[a]&&(t=!0)}),t}function O1(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((r,s,a,l)=>e.push(a,l));return e}function $p(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let s=e.map(n[r],1),a=e.map(n[r+1],-1);s<=a&&t.push(s,a)}return t}function dD(n,e,t){let r=xu(e),s=ai.get(e).spec.config,a=(t?n.undone:n.done).popEvent(e,r);if(!a)return null;let l=a.selection.resolve(a.transform.doc),u=(t?n.done:n.undone).addTransform(a.transform,e.selection.getBookmark(),s,r),d=new cs(t?u:a.remaining,t?a.remaining:u,null,0,-1);return a.transform.setSelection(l).setMeta(ai,{redo:t,historyState:d})}let Ip=!1,R1=null;function xu(n){let e=n.plugins;if(R1!=e){Ip=!1,R1=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Ip=!0;break}}return Ip}const ai=new Mt("history"),fD=new Mt("closeHistory");function hD(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new at({key:ai,state:{init(){return new cs($n.empty,$n.empty,null,0,-1)},apply(e,t,r){return cD(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,s=r=="historyUndo"?ik:r=="historyRedo"?ak:null;return s?(t.preventDefault(),s(e.state,e.dispatch)):!1}}}})}function sk(n,e){return(t,r)=>{let s=ai.getState(t);if(!s||(n?s.undone:s.done).eventCount==0)return!1;if(r){let a=dD(s,t,n);a&&r(e?a.scrollIntoView():a)}return!0}}const ik=sk(!1,!0),ak=sk(!0,!0);mt.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:n=>n.length,wordCounter:n=>n.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=n=>{const e=n?.node||this.editor.state.doc;if((n?.mode||this.options.mode)==="textSize"){const r=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(r)}return e.nodeSize},this.storage.words=n=>{const e=n?.node||this.editor.state.doc,t=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(t)}},addProseMirrorPlugins(){let n=!1;return[new at({key:new Mt("characterCount"),appendTransaction:(e,t,r)=>{if(n)return;const s=this.options.limit;if(s==null||s===0){n=!0;return}const a=this.storage.characters({node:r.doc});if(a>s){const l=a-s,u=0,d=l;console.warn(`[CharacterCount] Initial content exceeded limit of ${s} characters. Content was automatically trimmed.`);const h=r.tr.deleteRange(u,d);return n=!0,h}n=!0},filterTransaction:(e,t)=>{const r=this.options.limit;if(!e.docChanged||r===0||r===null||r===void 0)return!0;const s=this.storage.characters({node:t.doc}),a=this.storage.characters({node:e.doc});if(a<=r||s>r&&a>r&&a<=s)return!0;if(s>r&&a>r&&a>s||!e.getMeta("paste"))return!1;const u=e.selection.$head.pos,d=a-r,h=u-d,m=u;return e.deleteRange(h,m),!(this.storage.characters({node:e.doc})>r)}})]}});var pD=mt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[JR(this.options)]}});mt.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new at({key:new Mt("focus"),props:{decorations:({doc:n,selection:e})=>{const{isEditable:t,isFocused:r}=this.editor,{anchor:s}=e,a=[];if(!t||!r)return Ze.create(n,[]);let l=0;this.options.mode==="deepest"&&n.descendants((d,h)=>{if(d.isText)return;if(!(s>=h&&s<=h+d.nodeSize-1))return!1;l+=1});let u=0;return n.descendants((d,h)=>{if(d.isText||!(s>=h&&s<=h+d.nodeSize-1))return!1;if(u+=1,this.options.mode==="deepest"&&l-u>0||this.options.mode==="shallowest"&&u>1)return this.options.mode==="deepest";a.push(Kt.node(h,h+d.nodeSize,{class:this.options.className}))}),Ze.create(n,a)}}})]}});var mD=mt.create({name:"gapCursor",addProseMirrorPlugins(){return[eD()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=Pe(ce(n,"allowGapCursor",t)))!=null?e:null}}});mt.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new at({key:new Mt("placeholder"),props:{decorations:({doc:n,selection:e})=>{const t=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,s=[];if(!t)return null;const a=this.editor.isEmpty;return n.descendants((l,u)=>{const d=r>=u&&r<=u+l.nodeSize,h=!l.isLeaf&&Md(l);if((d||!this.options.showOnlyCurrent)&&h){const m=[this.options.emptyNodeClass];a&&m.push(this.options.emptyEditorClass);const y=Kt.node(u,u+l.nodeSize,{class:m.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:l,pos:u,hasAnchor:d}):this.options.placeholder});s.push(y)}return this.options.includeChildren}),Ze.create(n,s)}}})]}});mt.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:n,options:e}=this;return[new at({key:new Mt("selection"),props:{decorations(t){return t.selection.empty||n.isFocused||!n.isEditable||p2(t.selection)||n.view.dragging?null:Ze.create(t.doc,[Kt.inline(t.selection.from,t.selection.to,{class:e.className})])}}})]}});function D1({types:n,node:e}){return e&&Array.isArray(n)&&n.includes(e.type)||e?.type===n}var gD=mt.create({name:"trailingNode",addOptions(){return{node:"paragraph",notAfter:[]}},addProseMirrorPlugins(){const n=new Mt(this.name),e=Object.entries(this.editor.schema.nodes).map(([,t])=>t).filter(t=>(this.options.notAfter||[]).concat(this.options.node).includes(t.name));return[new at({key:n,appendTransaction:(t,r,s)=>{const{doc:a,tr:l,schema:u}=s,d=n.getState(s),h=a.content.size,m=u.nodes[this.options.node];if(d)return l.insert(h,m.create())},state:{init:(t,r)=>{const s=r.tr.doc.lastChild;return!D1({node:s,types:e})},apply:(t,r)=>{if(!t.docChanged)return r;const s=t.doc.lastChild;return!D1({node:s,types:e})}}})]}}),yD=mt.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>ik(n,e),redo:()=>({state:n,dispatch:e})=>ak(n,e)}},addProseMirrorPlugins(){return[hD(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),bD=mt.create({name:"starterKit",addExtensions(){var n,e,t,r;const s=[];return this.options.bold!==!1&&s.push(L2.configure(this.options.bold)),this.options.blockquote!==!1&&s.push(D2.configure(this.options.blockquote)),this.options.bulletList!==!1&&s.push(G2.configure(this.options.bulletList)),this.options.code!==!1&&s.push(QO.configure(this.options.code)),this.options.codeBlock!==!1&&s.push(eR.configure(this.options.codeBlock)),this.options.document!==!1&&s.push(tR.configure(this.options.document)),this.options.dropcursor!==!1&&s.push(pD.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&s.push(mD.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&s.push(nR.configure(this.options.hardBreak)),this.options.heading!==!1&&s.push(rR.configure(this.options.heading)),this.options.undoRedo!==!1&&s.push(yD.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&s.push(sR.configure(this.options.horizontalRule)),this.options.italic!==!1&&s.push(B2.configure(this.options.italic)),this.options.listItem!==!1&&s.push(W2.configure(this.options.listItem)),this.options.listKeymap!==!1&&s.push(ek.configure((n=this.options)==null?void 0:n.listKeymap)),this.options.link!==!1&&s.push(K2.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&s.push(tk.configure(this.options.orderedList)),this.options.paragraph!==!1&&s.push(VR.configure(this.options.paragraph)),this.options.strike!==!1&&s.push(GR.configure(this.options.strike)),this.options.text!==!1&&s.push(WR.configure(this.options.text)),this.options.underline!==!1&&s.push(nk.configure((t=this.options)==null?void 0:t.underline)),this.options.trailingNode!==!1&&s.push(gD.configure((r=this.options)==null?void 0:r.trailingNode)),s}}),vD=bD;const xD=()=>{const[n,e]=T.useState(""),[t,r]=T.useState(!1),[s,a]=T.useState(null),l=T.useCallback(()=>{const h=window.getSelection();if(h&&h.toString().trim().length>0){const m=h.toString().trim();e(m),r(!0),h.rangeCount>0&&a(h.getRangeAt(0).cloneRange())}else e(""),r(!1),a(null)},[]),u=T.useCallback(h=>{if(n&&h){const m=`> ${n}

`;h.chain().focus().insertContent(m).run(),e(""),r(!1),a(null)}},[n]),d=T.useCallback(()=>{e(""),r(!1),a(null)},[]);return{selectedText:n,citationMode:t,handleTextSelection:l,insertCitation:u,clearSelection:d}},wD=({children:n,onTextSelect:e})=>(T.useEffect(()=>{const t=()=>{const r=window.getSelection();r&&r.toString().trim()&&e()};return document.addEventListener("mouseup",t),document.addEventListener("keyup",t),()=>{document.removeEventListener("mouseup",t),document.removeEventListener("keyup",t)}},[e]),p.jsx("div",{className:"selectable-content",children:n})),Om=({content:n,onChange:e,placeholder:t="Write your content...",className:r="",minHeight:s="150px",mobileOptimized:a=!1})=>{const{selectedText:l,citationMode:u,insertCitation:d,clearSelection:h}=xD(),m=a?"60vh":s,y=UO({extensions:[vD,qO.configure({HTMLAttributes:{class:"border-l-4 border-primary-500 pl-4 italic text-gray-700 my-4"}}),DR.configure({openOnClick:!1,HTMLAttributes:{class:"text-primary-600 hover:text-primary-800 underline"}}),WO,cR,YR],content:n,onUpdate:({editor:k})=>{e(k.getHTML())},editorProps:{attributes:{class:`prose prose-sm max-w-none focus:outline-none p-4 text-left ${r}`,style:`min-height: ${m}; text-align: left;`}}});if(!y)return null;const v=()=>{const k=window.prompt("Enter URL:");k&&y.chain().focus().extendMarkRange("link").setLink({href:k}).run()},x=()=>{y.chain().focus().extendMarkRange("link").unsetLink().run()},w=()=>a?p.jsxs("div",{className:"border-b border-gray-200 p-2 flex items-center gap-1 flex-wrap",children:[p.jsx("button",{type:"button",onClick:()=>y.chain().focus().toggleBold().run(),className:`p-2 rounded hover:bg-gray-100 transition-colors ${y.isActive("bold")?"bg-gray-200 text-primary-600":"text-gray-600"}`,title:"Bold",children:p.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 16 16",children:p.jsx("path",{d:"M8.21 13c2.106 0 3.412-1.087 3.412-2.823 0-1.306-.984-2.283-2.324-2.386v-.055a2.176 2.176 0 0 0 1.852-2.14c0-1.51-1.162-2.46-3.014-2.46H3.843V13H8.21zM5.908 4.674h1.696c.963 0 1.517.451 1.517 1.244 0 .834-.629 1.32-1.73 1.32H5.908V4.674zm0 6.788V8.598h1.73c1.217 0 1.88.492 1.88 1.415 0 .943-.643 1.449-1.832 1.449H5.908z"})})}),p.jsx("button",{type:"button",onClick:()=>y.chain().focus().toggleItalic().run(),className:`p-2 rounded hover:bg-gray-100 transition-colors ${y.isActive("italic")?"bg-gray-200 text-primary-600":"text-gray-600"}`,title:"Italic",children:p.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 16 16",children:p.jsx("path",{d:"M7.991 11.674L9.53 4.455c.123-.595.246-.71 1.347-.807l.11-.52H7.211l-.11.52c1.06.096 1.128.212 1.005.807L6.57 11.674c-.123.595-.246.71-1.346.806l-.11.52h3.774l.11-.52c-1.06-.095-1.129-.211-1.006-.806z"})})}),p.jsx("button",{type:"button",onClick:()=>y.chain().focus().toggleBulletList().run(),className:`p-2 rounded hover:bg-gray-100 transition-colors ${y.isActive("bulletList")?"bg-gray-200 text-primary-600":"text-gray-600"}`,title:"Bullet List",children:p.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 16 16",children:p.jsx("path",{d:"M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"})})})]}):p.jsxs("div",{className:"border-b border-gray-200 p-3 flex items-center gap-1 flex-wrap",children:[p.jsx("button",{type:"button",onClick:()=>y.chain().focus().toggleBold().run(),className:`p-2 rounded hover:bg-gray-100 transition-colors ${y.isActive("bold")?"bg-gray-200 text-primary-600":"text-gray-600"}`,title:"Bold",children:p.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:p.jsx("path",{d:"M3 5a1 1 0 011-1h5.5a2.5 2.5 0 010 5H4v2.5h4.5a2.5 2.5 0 010 5H4a1 1 0 01-1-1V5z"})})}),p.jsx("button",{type:"button",onClick:()=>y.chain().focus().toggleItalic().run(),className:`p-2 rounded hover:bg-gray-100 transition-colors ${y.isActive("italic")?"bg-gray-200 text-primary-600":"text-gray-600"}`,title:"Italic",children:p.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:p.jsx("path",{d:"M8 5v14l4-2V9h5l-2-4H8z"})})}),p.jsx("button",{type:"button",onClick:()=>y.chain().focus().toggleUnderline().run(),className:`p-2 rounded hover:bg-gray-100 transition-colors ${y.isActive("underline")?"bg-gray-200 text-primary-600":"text-gray-600"}`,title:"Underline",children:p.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:p.jsx("path",{d:"M5 3v8c0 2.761 2.239 5 5 5s5-2.239 5-5V3h-2v8c0 1.657-1.343 3-3 3s-3-1.343-3-3V3H5zM3 17h14v2H3v-2z"})})}),p.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),p.jsx("button",{type:"button",onClick:()=>y.chain().focus().toggleBlockquote().run(),className:`p-2 rounded hover:bg-gray-100 transition-colors ${y.isActive("blockquote")?"bg-gray-200 text-primary-600":"text-gray-600"}`,title:"Quote",children:p.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:p.jsx("path",{d:"M3 17V7c0-1.1.9-2 2-2h3l-2 4v8H3zM14 17V7c0-1.1.9-2 2-2h3l-2 4v8h-3z"})})}),p.jsx("button",{type:"button",onClick:()=>y.chain().focus().toggleBulletList().run(),className:`p-2 rounded hover:bg-gray-100 transition-colors ${y.isActive("bulletList")?"bg-gray-200 text-primary-600":"text-gray-600"}`,title:"Bullet List",children:p.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:p.jsx("path",{d:"M3 4a1 1 0 100 2 1 1 0 000-2zM6 4h11a1 1 0 110 2H6a1 1 0 110-2zM3 9a1 1 0 100 2 1 1 0 000-2zM6 9h11a1 1 0 110 2H6a1 1 0 110-2zM3 14a1 1 0 100 2 1 1 0 000-2zM6 14h11a1 1 0 110 2H6a1 1 0 110-2z"})})}),p.jsx("button",{type:"button",onClick:()=>y.chain().focus().toggleOrderedList().run(),className:`p-2 rounded hover:bg-gray-100 transition-colors ${y.isActive("orderedList")?"bg-gray-200 text-primary-600":"text-gray-600"}`,title:"Numbered List",children:p.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:p.jsx("path",{d:"M3 4a1 1 0 100 2 1 1 0 000-2zM6 4h11a1 1 0 110 2H6a1 1 0 110-2zM3 9a1 1 0 100 2 1 1 0 000-2zM6 9h11a1 1 0 110 2H6a1 1 0 110-2zM3 14a1 1 0 100 2 1 1 0 000-2zM6 14h11a1 1 0 110 2H6a1 1 0 110-2z"})})}),p.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),p.jsx("button",{type:"button",onClick:v,className:`p-2 rounded hover:bg-gray-100 transition-colors ${y.isActive("link")?"bg-gray-200 text-primary-600":"text-gray-600"}`,title:"Add Link",children:p.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:p.jsx("path",{d:"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z"})})}),y.isActive("link")&&p.jsx("button",{type:"button",onClick:x,className:"p-2 rounded hover:bg-gray-100 transition-colors text-red-600",title:"Remove Link",children:p.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:p.jsx("path",{d:"M6.293 6.293a1 1 0 011.414 0L10 8.586l2.293-2.293a1 1 0 111.414 1.414L11.414 10l2.293 2.293a1 1 0 01-1.414 1.414L10 11.414l-2.293 2.293a1 1 0 01-1.414-1.414L8.586 10 6.293 7.707a1 1 0 010-1.414z"})})}),u&&p.jsxs("div",{className:"flex items-center ml-2",children:[p.jsx("div",{className:"w-px h-6 bg-gray-300 mr-2"}),p.jsxs("button",{type:"button",onClick:()=>d(y),className:"px-3 py-1 bg-primary-600 text-white text-sm rounded hover:bg-primary-700 transition-colors",title:"Quote Selected Text",children:[p.jsx("svg",{className:"w-4 h-4 inline mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:p.jsx("path",{d:"M3 17V7c0-1.1.9-2 2-2h3l-2 4v8H3zM14 17V7c0-1.1.9-2 2-2h3l-2 4v8h-3z"})}),"Quote"]})]})]});return p.jsxs("div",{className:"relative border border-gray-300 rounded-lg bg-white",children:[w(),p.jsxs("div",{className:"relative",children:[p.jsx(AO,{editor:y,className:"focus-within:ring-2 focus-within:ring-primary-500 focus-within:ring-opacity-50 rounded-b-lg overflow-hidden"}),y.isEmpty&&p.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:t})]}),l&&p.jsx("div",{className:"absolute top-2 right-2 bg-primary-600 text-white text-xs px-2 py-1 rounded shadow-lg z-10",children:p.jsxs("div",{className:"flex items-center",children:[p.jsxs("span",{className:"mr-2",children:['Text selected: "',l.substring(0,30),'..."']}),p.jsx("button",{type:"button",onClick:h,className:"hover:text-gray-200 transition-colors",title:"Clear selection",children:p.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:p.jsx("path",{d:"M6.293 6.293a1 1 0 011.414 0L10 8.586l2.293-2.293a1 1 0 111.414 1.414L11.414 10l2.293 2.293a1 1 0 01-1.414 1.414L10 11.414l-2.293 2.293a1 1 0 01-1.414-1.414L8.586 10 6.293 7.707a1 1 0 010-1.414z"})})})]})})]})};class Dd{async getTherapists(){console.log("🔧 TherapistsService: Getting all therapists...");const{data:e,error:t}=await B.from("therapists").select("*").order("last_name",{ascending:!0}).order("first_name",{ascending:!0});if(t)throw console.error("❌ TherapistsService: Error fetching therapists:",t),t;return console.log("✅ TherapistsService: Fetched therapists:",e?.length||0,"records"),e||[]}async searchTherapists(e){if(!e.trim())return this.getTherapists();const{data:t,error:r}=await B.from("therapists").select("*").or(`first_name.ilike.%${e}%,last_name.ilike.%${e}%,institution.ilike.%${e}%,designation.ilike.%${e}%`).order("last_name",{ascending:!0}).order("first_name",{ascending:!0});if(r)throw console.error("Error searching therapists:",r),r;return t||[]}async getTherapistsByCanton(e){const{data:t,error:r}=await B.from("therapists").select("*").eq("canton",e).order("last_name",{ascending:!0}).order("first_name",{ascending:!0});if(r)throw console.error("Error fetching therapists by canton:",r),r;return t||[]}async createTherapist(e){console.log("🔧 TherapistsService: Creating therapist with data:",e);const{data:{user:t},error:r}=await B.auth.getUser();if(r)throw console.error("❌ TherapistsService: Auth error:",r),new Error("Authentication failed: "+r.message);if(!t)throw console.error("❌ TherapistsService: No authenticated user"),new Error("User not authenticated");console.log("👤 TherapistsService: Authenticated user:",t.email,"ID:",t.id);const s={form_of_address:e.form_of_address,first_name:e.first_name.trim(),last_name:e.last_name.trim(),institution:e.institution?.trim()||null,designation:e.designation,description:e.description?.trim()||null,canton:e.canton||null};console.log("📤 TherapistsService: Inserting data:",s);const{data:a,error:l}=await B.from("therapists").insert([s]).select().single();if(l)throw console.error("❌ TherapistsService: Database error:",l),console.error("❌ TherapistsService: Error details:",{code:l.code,message:l.message,details:l.details,hint:l.hint}),new Error("Database error: "+l.message);return console.log("✅ TherapistsService: Therapist created successfully:",a),a}async updateTherapist(e,t){const{data:r,error:s}=await B.from("therapists").update(t).eq("id",e).select().single();if(s)throw console.error("Error updating therapist:",s),s;return r}async getTherapist(e){const{data:t,error:r}=await B.from("therapists").select("*").eq("id",e).single();if(r){if(r.code==="PGRST116")return null;throw console.error("Error fetching therapist:",r),r}return t}formatTherapistName(e){return[e.form_of_address,e.first_name,e.last_name].filter(Boolean).join(" ")}formatTherapistDisplay(e){const t=this.formatTherapistName(e),r=[];return e.designation&&r.push(e.designation),e.institution&&r.push(e.institution),e.canton&&r.push(e.canton),r.length>0?`${t} (${r.join(", ")})`:t}}const SD=Object.freeze(Object.defineProperty({__proto__:null,TherapistsService:Dd},Symbol.toStringTag,{value:"Module"})),kD=({isOpen:n,onClose:e,onTherapistCreated:t,preselectedCanton:r=""})=>{const[s,a]=T.useState({canton:r,form_of_address:"",first_name:"",last_name:"",designation:"",institution:""}),[l,u]=T.useState(!1),[d,h]=T.useState(""),m=new Dd;T.useEffect(()=>{a(M=>({...M,canton:r}))},[r]);const y=[{code:"",name:"Kanton auswählen"},{code:"AG",name:"Aargau"},{code:"AI",name:"Appenzell Innerrhoden"},{code:"AR",name:"Appenzell Ausserrhoden"},{code:"BE",name:"Bern"},{code:"BL",name:"Basel-Landschaft"},{code:"BS",name:"Basel-Stadt"},{code:"FR",name:"Freiburg"},{code:"GE",name:"Genf"},{code:"GL",name:"Glarus"},{code:"GR",name:"Graubünden"},{code:"JU",name:"Jura"},{code:"LU",name:"Luzern"},{code:"NE",name:"Neuenburg"},{code:"NW",name:"Nidwalden"},{code:"OW",name:"Obwalden"},{code:"SG",name:"St. Gallen"},{code:"SH",name:"Schaffhausen"},{code:"SO",name:"Solothurn"},{code:"SZ",name:"Schwyz"},{code:"TG",name:"Thurgau"},{code:"TI",name:"Tessin"},{code:"UR",name:"Uri"},{code:"VD",name:"Waadt"},{code:"VS",name:"Wallis"},{code:"ZG",name:"Zug"},{code:"ZH",name:"Zürich"}],v=["Frau","Herr","Dr.","Dr. med.","Prof.","Prof. Dr.","Prof. Dr. med."],x=["Psychotherapeut","Psychologe","Psychiater","Facharzt für Psychiatrie","Facharzt für Psychotherapie","Coach","Berater","Sozialarbeiter","Klinischer Psychologe"],w=(M,C)=>{a(I=>({...I,[M]:C})),d&&h("")},k=()=>s.canton?s.first_name.trim()?s.last_name.trim()?s.designation?!0:(h("Bitte wählen Sie eine Berufsbezeichnung aus"),!1):(h("Bitte geben Sie den Nachnamen ein"),!1):(h("Bitte geben Sie den Vornamen ein"),!1):(h("Bitte wählen Sie einen Kanton aus"),!1),_=async M=>{if(M.preventDefault(),M.stopPropagation(),!!k()){u(!0),h("");try{console.log("🔧 TherapistCreateModal: Submitting form with data:",s);const C=await m.createTherapist({canton:s.canton,form_of_address:s.form_of_address,first_name:s.first_name,last_name:s.last_name,designation:s.designation,institution:s.institution||void 0});console.log("✅ TherapistCreateModal: Therapist created successfully:",C),t(C),e(),a({canton:r,form_of_address:"",first_name:"",last_name:"",designation:"",institution:""})}catch(C){console.error("❌ TherapistCreateModal: Error creating therapist:",C),h(C instanceof Error?C.message:"Fehler beim Speichern")}finally{u(!1)}}},N=()=>{l||(e(),h(""))};return n?Z1.createPortal(p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:p.jsxs("div",{className:"bg-slate-700 rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:[p.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-600",children:[p.jsx("h2",{className:"text-xl font-bold text-yellow-400",children:"Neuen Therapeuten hinzufügen"}),p.jsx("button",{onClick:N,disabled:l,className:"text-gray-400 hover:text-white transition-colors disabled:opacity-50",children:p.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),p.jsx("div",{className:"p-6",children:p.jsxs("form",{onSubmit:_,className:"space-y-4",children:[d&&p.jsx("div",{className:"bg-red-500 bg-opacity-20 border border-red-500 text-red-300 px-4 py-3 rounded",children:d}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Kanton"}),p.jsx("select",{value:s.canton,onChange:M=>w("canton",M.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-yellow-500 rounded text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-yellow-500",disabled:l,required:!0,children:y.map(M=>p.jsx("option",{value:M.code,className:"bg-slate-600",children:M.code?`${M.code} - ${M.name}`:M.name},M.code))})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Anrede"}),p.jsxs("select",{value:s.form_of_address,onChange:M=>w("form_of_address",M.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-yellow-500 rounded text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-yellow-500",disabled:l,children:[p.jsx("option",{value:"",className:"bg-slate-600",children:"Anrede auswählen (optional)"}),v.map(M=>p.jsx("option",{value:M,className:"bg-slate-600",children:M},M))]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Vorname"}),p.jsx("input",{type:"text",value:s.first_name,onChange:M=>w("first_name",M.target.value),placeholder:"Vorname",className:"w-full px-3 py-2 bg-slate-600 border border-yellow-500 rounded text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-yellow-500",disabled:l,required:!0,maxLength:100})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Nachname"}),p.jsx("input",{type:"text",value:s.last_name,onChange:M=>w("last_name",M.target.value),placeholder:"Nachname",className:"w-full px-3 py-2 bg-slate-600 border border-yellow-500 rounded text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-yellow-500",disabled:l,required:!0,maxLength:100})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Berufsbezeichnung"}),p.jsxs("select",{value:s.designation,onChange:M=>w("designation",M.target.value),className:"w-full px-3 py-2 bg-slate-600 border border-yellow-500 rounded text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-yellow-500",disabled:l,required:!0,children:[p.jsx("option",{value:"",className:"bg-slate-600",children:"Berufsbezeichnung auswählen"}),x.map(M=>p.jsx("option",{value:M,className:"bg-slate-600",children:M},M))]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-yellow-400 text-sm font-medium mb-2",children:"Institution (wenn vorhanden)"}),p.jsx("input",{type:"text",value:s.institution,onChange:M=>w("institution",M.target.value),placeholder:"z.B. Klinik, Tagesstruktur, Programm",className:"w-full px-3 py-2 bg-slate-600 border border-yellow-500 rounded text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-yellow-500",disabled:l,maxLength:200})]}),p.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[p.jsx("button",{type:"button",onClick:N,disabled:l,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Abbrechen"}),p.jsx("button",{type:"submit",disabled:l,className:"px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-black font-medium rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Speichern...":"Speichern"})]})]})})]})}),document.body):null},Rm=({selectedTherapist:n,onTherapistSelect:e,canton:t="",disabled:r=!1})=>{const[s,a]=T.useState(""),[l,u]=T.useState([]),[d,h]=T.useState([]),[m,y]=T.useState(!1),[v,x]=T.useState(!1),[w,k]=T.useState(!1),[_,N]=T.useState(-1),M=new Dd,C=T.useRef(null),I=T.useRef(null);T.useEffect(()=>{H()},[]),T.useEffect(()=>{let ie=l;if(t&&(ie=ie.filter(he=>he.canton===t||!he.canton)),s.trim()){const he=s.toLowerCase();ie=ie.filter($=>$.first_name.toLowerCase().includes(he)||$.last_name.toLowerCase().includes(he)||$.institution&&$.institution.toLowerCase().includes(he)||$.designation.toLowerCase().includes(he))}h(ie),N(-1)},[l,s,t]),T.useEffect(()=>{n&&(a(M.formatTherapistDisplay(n)),y(!1))},[n]);const H=async()=>{try{k(!0),console.log("🔧 TherapistSelector: Loading therapists...");const ie=await M.getTherapists();console.log("✅ TherapistSelector: Loaded therapists:",ie),u(ie)}catch(ie){console.error("❌ TherapistSelector: Error loading therapists:",ie)}finally{k(!1)}},Q=ie=>{const he=ie.target.value;a(he),n&&he!==M.formatTherapistDisplay(n)&&e(null),y(!0)},G=()=>{y(!0)},X=()=>{setTimeout(()=>{y(!1)},200)},Y=ie=>{e(ie),a(M.formatTherapistDisplay(ie)),y(!1)},ye=ie=>{if(m)switch(ie.key){case"ArrowDown":ie.preventDefault(),N(he=>he<d.length-1?he+1:he);break;case"ArrowUp":ie.preventDefault(),N(he=>he>0?he-1:-1);break;case"Enter":ie.preventDefault(),_>=0&&_<d.length&&Y(d[_]);break;case"Escape":y(!1),N(-1);break}},$e=()=>{x(!0),y(!1)},Ce=ie=>{console.log("🔧 TherapistSelector: Handling newly created therapist:",ie),u(he=>{const $=[ie,...he];return console.log("✅ TherapistSelector: Updated therapists list:",$),$}),e(ie),a(M.formatTherapistDisplay(ie)),setTimeout(()=>{console.log("🔄 TherapistSelector: Reloading therapists from database..."),H()},1e3)},tt=()=>{e(null),a(""),C.current?.focus()};return p.jsxs("div",{className:"relative",children:[p.jsxs("div",{className:"relative",children:[p.jsx("input",{ref:C,type:"text",value:s,onChange:Q,onFocus:G,onBlur:X,onClick:G,onKeyDown:ye,placeholder:"Therapeut/in suchen oder klicken um zu erstellen...",disabled:r,className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 disabled:bg-gray-100 disabled:text-gray-500"}),n&&!r&&p.jsx("button",{type:"button",onClick:tt,className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",children:p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),w&&p.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:p.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary-600"})})]}),m&&!r&&p.jsxs("div",{ref:I,className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[p.jsxs("div",{onClick:$e,className:"px-4 py-3 cursor-pointer hover:bg-primary-50 border-b border-gray-200 flex items-center space-x-2 text-primary-600 font-medium",children:[p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),p.jsx("span",{children:"Neuen Therapeuten hinzufügen"})]}),d.length===0&&s?p.jsxs("div",{className:"px-4 py-3 text-gray-500 text-sm",children:['Keine Therapeuten gefunden für "',s,'"',l.length>0&&p.jsxs("div",{className:"text-xs mt-1",children:["(",l.length," Therapeuten insgesamt verfügbar)"]})]}):d.length===0&&l.length===0?p.jsx("div",{className:"px-4 py-3 text-gray-500 text-sm",children:"Noch keine Therapeuten vorhanden. Erstellen Sie den ersten Therapeuten."}):d.length===0?p.jsxs("div",{className:"px-4 py-3 text-gray-500 text-sm",children:["Keine Therapeuten für diesen Kanton gefunden",l.length>0&&p.jsxs("div",{className:"text-xs mt-1",children:["(",l.length," Therapeuten insgesamt verfügbar)"]})]}):d.map((ie,he)=>p.jsxs("div",{onClick:()=>Y(ie),className:`px-4 py-3 cursor-pointer hover:bg-gray-50 ${he===_?"bg-primary-50":""} ${n?.id===ie.id?"bg-primary-100":""}`,children:[p.jsx("div",{className:"font-medium text-gray-900",children:M.formatTherapistName(ie)}),p.jsxs("div",{className:"text-sm text-gray-600",children:[ie.designation,ie.institution&&` • ${ie.institution}`,ie.canton&&` • ${ie.canton}`]})]},ie.id))]}),p.jsx(kD,{isOpen:v,onClose:()=>x(!1),onTherapistCreated:Ce,preselectedCanton:t})]})},hd=({value:n,options:e,onChange:t,placeholder:r="Select...",className:s="",badgeClassName:a="",dropdownClassName:l="",disabled:u=!1,required:d=!1})=>{const[h,m]=T.useState(!1),y=T.useRef(null),v=e.find(k=>k.value===n);T.useEffect(()=>{const k=_=>{y.current&&!y.current.contains(_.target)&&m(!1)};return h&&document.addEventListener("mousedown",k),()=>{document.removeEventListener("mousedown",k)}},[h]);const x=k=>{t(k),m(!1)},w=k=>{k.key==="Enter"||k.key===" "?(k.preventDefault(),u||m(!h)):k.key==="Escape"&&m(!1)};return p.jsxs("div",{className:`relative ${s}`,ref:y,children:[p.jsxs("button",{type:"button",onClick:()=>!u&&m(!h),onKeyDown:w,disabled:u,className:`
          inline-flex items-center px-2 py-1 rounded-lg font-medium text-xs
          transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500
          ${u?"opacity-50 cursor-not-allowed":"cursor-pointer hover:opacity-80"}
          ${a}
        `,style:{fontSize:"0.65rem"},"aria-haspopup":"listbox","aria-expanded":h,"aria-required":d,children:[v?.icon&&p.jsx("span",{className:"mr-1 flex items-center",children:v.icon}),p.jsx("span",{className:"truncate",children:v?v.label:r}),p.jsx("svg",{className:`ml-1 w-3 h-3 transition-transform duration-200 ${h?"transform rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),h&&p.jsx("div",{className:`
            absolute top-full left-0 z-50 mt-1 min-w-full max-w-xs bg-white border border-gray-200 rounded-lg shadow-lg
            max-h-48 overflow-y-auto
            ${l}
          `,role:"listbox",children:e.map(k=>p.jsxs("button",{type:"button",onClick:()=>x(k.value),className:`
                w-full px-3 py-2 text-left text-sm hover:bg-gray-100 focus:bg-gray-100 focus:outline-none
                first:rounded-t-lg last:rounded-b-lg
                transition-colors duration-150
                flex items-center
                ${n===k.value?"bg-blue-50 text-blue-700":"text-gray-700"}
              `,role:"option","aria-selected":n===k.value,children:[k.icon&&p.jsx("span",{className:"mr-2 flex items-center flex-shrink-0",children:k.icon}),p.jsx("span",{className:"truncate",children:k.label}),n===k.value&&p.jsx("svg",{className:"ml-auto w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:p.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},k.value))})]})},ok=({onSubmit:n,onCancel:e,isLoading:t,editMode:r=!1,mobileOptimized:s=!1,initialData:a})=>{const[l,u]=T.useState(a?.title||""),[d,h]=T.useState(a?.content||""),[m,y]=T.useState(a?.category_id||1),[v,x]=T.useState(a?.canton||""),[w,k]=T.useState(null),[_,N]=T.useState([]),[M,C]=T.useState(!1),I=new fl,H=[{code:"",name:"Kanton auswählen"},{code:"AG",name:"Aargau"},{code:"AI",name:"Appenzell Innerrhoden"},{code:"AR",name:"Appenzell Ausserrhoden"},{code:"BE",name:"Bern"},{code:"BL",name:"Basel-Landschaft"},{code:"BS",name:"Basel-Stadt"},{code:"FR",name:"Freiburg"},{code:"GE",name:"Genf"},{code:"GL",name:"Glarus"},{code:"GR",name:"Graubünden"},{code:"JU",name:"Jura"},{code:"LU",name:"Luzern"},{code:"NE",name:"Neuenburg"},{code:"NW",name:"Nidwalden"},{code:"OW",name:"Obwalden"},{code:"SG",name:"St. Gallen"},{code:"SH",name:"Schaffhausen"},{code:"SO",name:"Solothurn"},{code:"SZ",name:"Schwyz"},{code:"TG",name:"Thurgau"},{code:"TI",name:"Tessin"},{code:"UR",name:"Uri"},{code:"VD",name:"Waadt"},{code:"VS",name:"Wallis"},{code:"ZG",name:"Zug"},{code:"ZH",name:"Zürich"}];T.useEffect(()=>{Q(),r&&a?.therapist_id&&G(a.therapist_id)},[r,a?.therapist_id]);const Q=async()=>{try{const Y=await I.getCategories();N(Y)}catch(Y){console.error("Error loading categories:",Y)}},G=async Y=>{try{const{TherapistsService:ye}=await Da(async()=>{const{TherapistsService:tt}=await Promise.resolve().then(()=>SD);return{TherapistsService:tt}},void 0,import.meta.url),Ce=await new ye().getTherapist(Y);Ce&&k(Ce)}catch(ye){console.error("Error loading initial therapist:",ye)}},X=async(Y,ye=!0)=>{if(Y.preventDefault(),m!==1&&!l.trim()){alert("Bitte Titel ausfüllen");return}if(!d.trim()){alert("Bitte Inhalt ausfüllen");return}if(!v){alert("Bitte Kanton auswählen");return}if(m===1&&!w){alert("Bitte wählen Sie einen Therapeuten für Ihre Erfahrung aus");return}C(!0);try{const Ce={title:m===1&&!l.trim()?"Erfahrung":l.trim(),content:d.trim(),category_id:m,canton:v,is_published:ye,...w&&{therapist_id:w.id}};n&&await n(Ce),u(""),h(""),y(1),x(""),k(null)}catch($e){console.error("Error submitting post:",$e),alert("Fehler beim Speichern des Beitrags")}finally{C(!1)}};return p.jsx("div",{className:"relative",children:p.jsxs("form",{onSubmit:Y=>X(Y,!0),children:[s?p.jsxs(p.Fragment,{children:[m!==1&&p.jsx("div",{className:"mb-4",children:p.jsx("input",{type:"text",value:l,onChange:Y=>u(Y.target.value),className:"w-full px-3 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-[#0284c7] focus:border-transparent text-base",placeholder:"Titel eingeben...",maxLength:255,required:!0})}),p.jsxs("div",{className:"mb-4",children:[p.jsxs("div",{className:"flex items-center justify-between space-x-3 mb-2",children:[p.jsx(hd,{value:m,options:_.map(Y=>({value:Y.id,label:Y.name_de})),onChange:Y=>y(Number(Y)),placeholder:"Kategorie",badgeClassName:"bg-[#5a9f51] text-white hover:bg-[#4a8542]",required:!0}),p.jsx(hd,{value:v,options:H.filter(Y=>Y.code).map(Y=>({value:Y.code,label:Y.name,icon:Y.code?p.jsx("img",{src:`/blueprint/assets/kantone/${Y.code.toLowerCase()}.png`,alt:`${Y.code} flag`,className:"w-3 h-2 object-cover",onError:ye=>{ye.target.style.display="none"}}):void 0})),onChange:Y=>x(String(Y)),placeholder:"Kanton",badgeClassName:"bg-gray-600 text-white hover:bg-gray-700",required:!0})]}),m===1&&p.jsxs("div",{className:"mt-2",children:[p.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-2 mb-2",children:p.jsx("p",{className:"text-xs text-blue-800",children:"Therapeut/in für Ihre Erfahrung auswählen"})}),p.jsx(Rm,{selectedTherapist:w,onTherapistSelect:k,canton:v})]})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Inhalt *"}),p.jsx(Om,{content:d,onChange:h,placeholder:"Teile deine Gedanken, Erfahrungen oder Fragen mit der Community...",minHeight:"200px",mobileOptimized:s}),p.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[d.replace(/<[^>]*>/g,"").length," Zeichen (ohne HTML)"]})]})]}):p.jsx(p.Fragment,{children:m!==1&&p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Titel *"}),p.jsx("input",{type:"text",id:"title",value:l,onChange:Y=>u(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",placeholder:"Gib deinem Beitrag einen aussagekräftigen Titel...",maxLength:255,required:!0})]})}),!s&&p.jsxs("div",{className:"mb-6",children:[m!==1&&p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Titel *"}),p.jsx("input",{type:"text",id:"title",value:l,onChange:Y=>u(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",placeholder:"Gib deinem Beitrag einen aussagekräftigen Titel...",maxLength:255,required:!0})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Kategorie *"}),p.jsx("select",{id:"category",value:m,onChange:Y=>y(Number(Y.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",required:!0,children:_.map(Y=>p.jsx("option",{value:Y.id,children:Y.name_de},Y.id))})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"canton",className:"block text-sm font-medium text-gray-700 mb-1",children:"Kanton *"}),p.jsx("select",{id:"canton",value:v,onChange:Y=>x(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",required:!0,children:H.map(Y=>p.jsx("option",{value:Y.code,children:Y.name},Y.code))})]})]}),m===1&&p.jsxs("div",{className:"mb-4",children:[p.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3 mb-4",children:p.jsxs("div",{className:"flex",children:[p.jsx("div",{className:"flex-shrink-0",children:p.jsx("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:p.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),p.jsx("div",{className:"ml-3",children:p.jsx("p",{className:"text-sm text-blue-800",children:"Der Titel wird automatisch basierend auf dem ausgewählten Therapeuten erstellt."})})]})}),p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Therapeut/in *"}),p.jsx(Rm,{selectedTherapist:w,onTherapistSelect:k,canton:v}),p.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Wählen Sie den Therapeuten/die Therapeutin aus, mit dem/der Sie eine Erfahrung gemacht haben."})]})]}),!s&&p.jsxs("div",{className:"mb-6",children:[p.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-1",children:"Inhalt *"}),p.jsx(Om,{content:d,onChange:h,placeholder:"Teile deine Gedanken, Erfahrungen oder Fragen mit der Community...",minHeight:"200px",mobileOptimized:s}),p.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[d.replace(/<[^>]*>/g,"").length," Zeichen (ohne HTML)"]})]}),s?p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"flex items-center justify-center space-x-2 mb-4",children:p.jsx("button",{type:"submit",disabled:M||t,className:"flex-1 px-6 py-4 text-lg font-bold text-white bg-primary-600 border border-transparent rounded-lg shadow-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all",style:{backgroundColor:"#0284c7",fontSize:"18px",fontWeight:"bold"},children:M||t?r?"📝 Wird aktualisiert...":"📤 Wird veröffentlicht...":r?"📝 Aktualisieren":"🚀 Veröffentlichen"})}),p.jsxs("div",{className:"flex items-center justify-between space-x-2",children:[e&&p.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 text-sm font-medium text-gray-600 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors",disabled:M,children:"Abbrechen"}),p.jsx("button",{type:"button",onClick:Y=>X(Y,!1),className:"flex-1 px-4 py-3 text-sm font-medium text-gray-600 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors",disabled:M,children:"📄 Als Entwurf"})]})]}):p.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[e&&p.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",disabled:M,children:"Abbrechen"}),p.jsx("button",{type:"button",onClick:Y=>X(Y,!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",disabled:M,children:"Als Entwurf speichern"}),p.jsx("button",{type:"submit",disabled:M||t,className:"px-6 py-3 text-base font-bold text-white bg-primary-600 border border-transparent rounded-md shadow-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 transition-all",style:{backgroundColor:"#0284c7",fontSize:"16px",fontWeight:"bold",padding:"12px 24px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:M||t?r?"📝 Wird aktualisiert...":"📤 Wird veröffentlicht...":r?"📝 Aktualisieren":"🚀 Veröffentlichen"})]})]})})},_D=[{name:"Aargau",code:"AG"},{name:"Appenzell Ausserrhoden",code:"AR"},{name:"Appenzell Innerrhoden",code:"AI"},{name:"Basel-Landschaft",code:"BL"},{name:"Basel-Stadt",code:"BS"},{name:"Bern",code:"BE"},{name:"Freiburg",code:"FR"},{name:"Genf",code:"GE"},{name:"Glarus",code:"GL"},{name:"Graubünden",code:"GR"},{name:"Jura",code:"JU"},{name:"Luzern",code:"LU"},{name:"Neuenburg",code:"NE"},{name:"Nidwalden",code:"NW"},{name:"Obwalden",code:"OW"},{name:"Schaffhausen",code:"SH"},{name:"Schwyz",code:"SZ"},{name:"Solothurn",code:"SO"},{name:"St. Gallen",code:"SG"},{name:"Tessin",code:"TI"},{name:"Thurgau",code:"TG"},{name:"Uri",code:"UR"},{name:"Waadt",code:"VD"},{name:"Wallis",code:"VS"},{name:"Zug",code:"ZG"},{name:"Zürich",code:"ZH"}],ED=({isOpen:n,onClose:e})=>{const{categories:t,filters:r,setFilters:s,clearFilters:a,loadPosts:l}=hs(),[u,d]=T.useState({}),[h,m]=T.useState([]),[y,v]=T.useState(!1),[x,w]=T.useState(""),[k,_]=T.useState([]),[N,M]=T.useState(!1),[C,I]=T.useState(null),[H,Q]=T.useState(!1),G=new fl,X=new Dd;T.useEffect(()=>{ye()},[]),T.useEffect(()=>{n&&(d({category:r.category,canton:r.canton,therapist:r.therapist,designation:r.designation,dateFrom:r.dateFrom,dateTo:r.dateTo}),r.therapist?Y(r.therapist):(w(""),I(null)))},[n,r]);const Y=async P=>{try{const Ae=(await X.getTherapists()).find(A=>A.id.toString()===P);Ae&&(I(Ae),w(X.formatTherapistDisplay(Ae)))}catch(oe){console.error("Error loading therapist:",oe)}},ye=async()=>{try{const P=await G.getDesignations();m(P)}catch(P){console.error("Error loading designations:",P)}},$e=async P=>{if(!P.trim()){_([]);return}try{const oe=await X.searchTherapists(P);_(oe.slice(0,10))}catch(oe){console.error("Error searching therapists:",oe),_([])}},Ce=P=>{w(P),M(!0),P?$e(P):(I(null),_([]),ie("therapist",void 0))},tt=P=>{I(P),w(X.formatTherapistDisplay(P)),M(!1),ie("therapist",P.id.toString())},ie=(P,oe)=>{d(Ae=>({...Ae,[P]:oe}))},he=async()=>{v(!0);try{const P={category:u.category,canton:u.canton,therapist:u.therapist,designation:u.designation,dateFrom:u.dateFrom,dateTo:u.dateTo,search:r.search};s(P),await l(P),e()}catch(P){console.error("Error applying filters:",P)}finally{v(!1)}},$=async()=>{v(!0);try{d({}),w(""),I(null),M(!1),Q(!1),a(),await l({}),e()}catch(P){console.error("Error clearing filters:",P)}finally{v(!1)}};return n?p.jsxs("div",{className:"bg-[#203f4a] rounded-lg mb-4 mx-4 md:mx-0",style:{borderRadius:"20px"},children:[p.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-[#2a4a57]",children:[p.jsx("h2",{className:"text-xl font-semibold text-white",children:"Filter"}),p.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:p.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),p.jsx("div",{className:"p-6",children:p.jsxs("div",{className:`grid grid-cols-2 gap-4 mb-6 max-w-md mx-auto ${H?"relative":""}`,children:[p.jsx("div",{className:"relative",children:p.jsxs("select",{value:u.category||"",onChange:P=>ie("category",P.target.value?parseInt(P.target.value):void 0),className:"w-full appearance-none bg-[#e85a4f] hover:bg-[#d14940] text-white px-3 py-2 rounded-lg font-medium text-center focus:outline-none focus:ring-2 focus:ring-[#37a653] cursor-pointer text-sm",children:[p.jsx("option",{value:"",children:"Alle Kategorien"}),t.map(P=>p.jsx("option",{value:P.id,children:P.name_de},P.id))]})}),p.jsx("div",{className:"relative",children:p.jsxs("select",{value:u.canton||"",onChange:P=>ie("canton",P.target.value||void 0),className:"w-full appearance-none bg-[#e85a4f] hover:bg-[#d14940] text-white px-3 py-2 rounded-lg font-medium text-center focus:outline-none focus:ring-2 focus:ring-[#37a653] cursor-pointer text-sm",children:[p.jsx("option",{value:"",children:"Alle Kantone"}),_D.map(P=>p.jsx("option",{value:P.code,children:P.name},P.code))]})}),p.jsxs("div",{className:`relative ${H?"absolute inset-0 z-40 col-span-2":""}`,children:[p.jsx("input",{type:"text",placeholder:C?X.formatTherapistDisplay(C):"Therapeut suchen...",value:x,onChange:P=>Ce(P.target.value),onFocus:()=>{Q(!0),M(!0),x&&!C&&$e(x)},onBlur:()=>{setTimeout(()=>{M(!1),Q(!1)},200)},className:`w-full bg-[#e85a4f] hover:bg-[#d14940] text-white px-3 py-2 rounded-lg font-medium text-center placeholder-white placeholder-opacity-90 focus:outline-none focus:ring-2 focus:ring-[#37a653] focus:text-left focus:placeholder-transparent text-sm transition-all duration-300 ${H?"shadow-lg":""}`}),(C||x)&&p.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-5 bg-white bg-opacity-90 rounded-r-lg flex items-center justify-center",children:p.jsx("button",{type:"button",onClick:()=>{I(null),w(""),M(!1),Q(!1),ie("therapist",void 0)},className:"hover:bg-gray-100 rounded-full p-1 transition-colors duration-200",children:p.jsx("svg",{className:"w-3 h-3 text-gray-600 hover:text-gray-800",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})}),!(C||x)&&p.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none",children:p.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),N&&k.length>0&&p.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:k.map(P=>p.jsxs("div",{onMouseDown:oe=>oe.preventDefault(),onClick:()=>tt(P),className:"px-3 py-2 cursor-pointer hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:[p.jsx("div",{className:"font-medium text-gray-900 text-sm",children:X.formatTherapistName(P)}),p.jsxs("div",{className:"text-xs text-gray-600",children:[P.designation,P.institution&&` • ${P.institution}`]})]},P.id))})]}),p.jsx("div",{className:"relative",children:p.jsxs("select",{value:u.designation||"",onChange:P=>ie("designation",P.target.value||void 0),className:"w-full appearance-none bg-[#e85a4f] hover:bg-[#d14940] text-white px-3 py-2 rounded-lg font-medium text-center focus:outline-none focus:ring-2 focus:ring-[#37a653] cursor-pointer text-sm",children:[p.jsx("option",{value:"",children:"Alle Bezeichnungen"}),h.map(P=>p.jsx("option",{value:P.name_de,children:P.name_de},P.id))]})}),p.jsxs("div",{className:"relative",children:[p.jsx("input",{type:"date",value:u.dateFrom||"",onChange:P=>ie("dateFrom",P.target.value||void 0),className:"w-full bg-[#e85a4f] hover:bg-[#d14940] text-white px-3 py-2 rounded-lg font-medium text-center focus:outline-none focus:ring-2 focus:ring-[#37a653] text-sm [color-scheme:dark] [&::-webkit-calendar-picker-indicator]:opacity-0 [&::-webkit-calendar-picker-indicator]:absolute [&::-webkit-calendar-picker-indicator]:inset-0 [&::-webkit-calendar-picker-indicator]:w-full [&::-webkit-calendar-picker-indicator]:h-full [&::-webkit-calendar-picker-indicator]:cursor-pointer",placeholder:"tt.mm.jjjj"}),p.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none",children:p.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]}),p.jsxs("div",{className:"relative",children:[p.jsx("input",{type:"date",value:u.dateTo||"",onChange:P=>ie("dateTo",P.target.value||void 0),className:"w-full bg-[#e85a4f] hover:bg-[#d14940] text-white px-3 py-2 rounded-lg font-medium text-center focus:outline-none focus:ring-2 focus:ring-[#37a653] text-sm [color-scheme:dark] [&::-webkit-calendar-picker-indicator]:opacity-0 [&::-webkit-calendar-picker-indicator]:absolute [&::-webkit-calendar-picker-indicator]:inset-0 [&::-webkit-calendar-picker-indicator]:w-full [&::-webkit-calendar-picker-indicator]:h-full [&::-webkit-calendar-picker-indicator]:cursor-pointer",placeholder:"tt.mm.jjjj"}),p.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none",children:p.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]})]})}),p.jsxs("div",{className:"flex items-center justify-center p-4 space-x-3",children:[p.jsx("button",{onClick:$,disabled:y,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50 text-sm",children:"Zurücksetzen"}),p.jsxs("button",{onClick:he,disabled:y,className:"bg-black hover:bg-gray-800 text-white px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50 flex items-center space-x-2 text-sm",children:[y&&p.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),p.jsx("span",{children:"Filtern"})]})]})]}):null},ND=({showCreatePostDialog:n=!1,onCreatePostDialogClose:e=()=>{},onCreatePost:t=()=>{}})=>{const[r,s]=T.useState(""),[a,l]=T.useState(null),[u,d]=T.useState(!1),{posts:h,categories:m,loading:y,filters:v,loadPosts:x,createPost:w,setFilters:k,searchPosts:_,loadCategories:N}=hs();T.useEffect(()=>{x(),N()},[]),T.useEffect(()=>()=>{a&&clearTimeout(a)},[a]);const M=async G=>{if(!G.trim()){x();return}try{await _(G.trim())}catch(X){console.error("Error searching posts:",X)}},C=G=>{const X=G.target.value;s(X),a&&clearTimeout(a);const Y=setTimeout(()=>{M(X)},300);l(Y)},I=async G=>{try{console.log("🚀 ForumView: Attempting to create post with data:",G),await w(G),console.log("✅ ForumView: Post created successfully"),e(),await x()}catch(X){throw console.error("❌ ForumView: Error creating post:",X),alert("Fehler beim Erstellen des Beitrags: "+(X instanceof Error?X.message:"Unbekannter Fehler")),X}},H=G=>{k({category:G||void 0}),x({category:G||void 0})},Q=()=>{let G=0;return v.category&&G++,v.canton&&G++,v.therapist&&G++,v.designation&&G++,(v.dateFrom||v.dateTo)&&G++,G};return p.jsx("div",{className:"min-h-screen bg-[#1a3442]",children:p.jsxs("div",{className:"max-w-6xl mx-auto pt-0 pb-6 px-0 md:px-4",children:[p.jsx("div",{className:"bg-[#203f4a] p-4 mb-4 mx-4 md:mx-0",style:{borderRadius:"20px"},children:p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsxs("button",{onClick:t,className:"bg-[#37a653] hover:bg-[#2e8844] text-white px-4 py-2 font-medium transition-colors text-sm flex items-center gap-2",style:{borderRadius:"20px"},children:[p.jsx("svg",{className:"w-4 h-4 transform rotate-90",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),"Neu"]}),p.jsxs("button",{onClick:()=>d(!0),className:"bg-[#1a3442] hover:bg-[#0f2329] text-white px-4 py-2 font-medium transition-colors text-sm relative flex items-center space-x-2",style:{borderRadius:"20px"},children:[p.jsx("span",{children:"Filter"}),Q()>0&&p.jsx("span",{className:"bg-[#37a653] text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:Q()})]}),p.jsxs("div",{className:"relative flex-1",children:[p.jsx("input",{type:"text",placeholder:"Suche...",value:r,onChange:C,className:"w-full pl-4 pr-10 py-2 bg-[#1a3442] text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#37a653] text-sm",style:{borderRadius:"20px"}}),p.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:p.jsx("svg",{className:"h-4 w-4 text-[#37a653]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})]})}),p.jsx(ED,{isOpen:u,onClose:()=>d(!1)}),p.jsxs("div",{className:"hidden md:flex items-center space-x-2 overflow-x-auto px-4 md:px-0 mb-4",children:[p.jsx("button",{onClick:()=>H(null),className:`inline-flex items-center px-2 py-0.5 rounded-lg font-medium whitespace-nowrap transition-colors ${v.category?"bg-[#203f4a] text-gray-300 hover:bg-[#2a4a57]":"bg-[#37a653] text-white"}`,style:{fontSize:"0.65rem"},children:"Alle Kategorien"}),m.map(G=>p.jsx("button",{onClick:()=>H(G.id),className:`inline-flex items-center px-2 py-0.5 rounded-lg font-medium whitespace-nowrap transition-colors ${v.category===G.id?"bg-[#37a653] text-white":"bg-[#203f4a] text-gray-300 hover:bg-[#2a4a57]"}`,style:{fontSize:"0.65rem"},children:G.name_de},G.id))]}),n&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-0 md:p-4 z-50",children:p.jsxs("div",{className:"bg-[#1a3442] md:bg-white w-screen h-screen md:rounded-lg md:max-w-4xl md:w-full md:max-h-[90vh] md:h-auto overflow-y-auto",children:[p.jsx("div",{className:"sticky top-0 bg-[#1a3442] md:bg-white border-b border-[#2a4a57] md:border-gray-200 px-4 md:px-6 py-3 md:py-4",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("h2",{className:"text-lg md:text-xl font-headline font-bold text-[#37a653] md:text-gray-900",children:"Neuen Beitrag erstellen"}),p.jsx("button",{onClick:e,className:"text-[#37a653] md:text-gray-400 hover:text-[#2e8844] md:hover:text-gray-600 transition-colors p-1",children:p.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),p.jsx("div",{className:"p-4 md:p-6 pb-20 md:pb-6",children:p.jsx(ok,{onSubmit:I,onCancel:e,mobileOptimized:!0})})]})}),p.jsxs("div",{children:[y?p.jsx("div",{className:"flex items-center justify-center py-12",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#37a653]"})}):h.length===0?p.jsxs("div",{className:"text-center py-12",children:[p.jsx("div",{className:"text-gray-400 mb-4",children:p.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),p.jsx("h3",{className:"text-lg font-medium text-white",children:"Keine Beiträge gefunden"}),p.jsx("p",{className:"text-gray-300 mt-1",children:v.category?"In dieser Kategorie wurden noch keine Beiträge erstellt.":"Es wurden noch keine Beiträge erstellt."})]}):p.jsx("div",{className:"space-y-4 px-4 md:px-0",children:h.map(G=>p.jsx(Ej,{post:G},G.id))}),h.length>0&&p.jsx("div",{className:"text-center mt-8",children:p.jsx("button",{className:"bg-[#203f4a] hover:bg-[#2a4a57] text-white px-6 py-3 rounded-md font-medium transition-colors",children:"Weitere Beiträge laden"})})]})]})})},CD=n=>{const{addComment:e,updateComment:t,deleteComment:r}=Fm();T.useEffect(()=>{const s=B.channel(`comments:post_id=eq.${n}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"comments",filter:`post_id=eq.${n}`},async a=>{const l=a.new,{data:u}=await B.from("comments").select(`
              *,
              users!inner(id, username, avatar_url, role)
            `).eq("id",l.id).single();u&&e(n,u)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"comments",filter:`post_id=eq.${n}`},a=>{const l=a.new;t(n,l.id,l)}).on("postgres_changes",{event:"DELETE",schema:"public",table:"comments",filter:`post_id=eq.${n}`},a=>{const l=a.old;r(n,l.id)}).subscribe();return()=>{B.removeChannel(s)}},[n,e,t,r])},Hp=n=>n?n.replace(/<p[^>]*>/gi,"").replace(/<\/p>/gi,`
`).replace(/<br\s*\/?>/gi,`
`).replace(/<[^>]*>/g,"").replace(/\n\s*\n/g,`
`).trim():"",lk=({comment:n,onReply:e,onUpdate:t,depth:r=0})=>{const[s,a]=T.useState(!1),[l,u]=T.useState(Hp(n.content)),[d,h]=T.useState(!0),[m,y]=T.useState(!1),v=new Vm,x=C=>new Date(C).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),w=async()=>{if(l.trim()){y(!0);try{await v.updateComment(n.id,l.trim()),a(!1),t()}catch(C){console.error("Error updating comment:",C),alert("Fehler beim Speichern des Kommentars")}finally{y(!1)}}},k=async()=>{if(confirm("Kommentar wirklich löschen?"))try{await v.deleteComment(n.id),t()}catch(C){console.error("Error deleting comment:",C),alert("Fehler beim Löschen des Kommentars")}},_=()=>{const C=window.getSelection()?.toString();C?e(n.id,C.trim()):e(n.id)},N=C=>p.jsx("div",{className:"border-l-4 border-[#37a653] pl-3 mb-3 bg-[#2a4a57] p-2 rounded-r",children:p.jsxs("div",{className:"text-sm text-gray-300 italic",children:['"',C,'"']})}),M=Math.min(r*2,8);return p.jsxs("div",{className:`bg-[#203f4a] ${r>0?`ml-${M}`:""}`,children:[p.jsxs("div",{className:"flex items-start space-x-3 mb-4",children:[p.jsx(sn,{user:n.users||{id:n.user_id||"unknown",username:"Unbekannt",avatar_url:null},size:"small",className:"flex-shrink-0"}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("p",{className:"font-medium text-white text-xs text-left leading-none",children:n.users?.username||"Unbekannt"}),p.jsxs("p",{className:"text-xs text-gray-300 text-left leading-none mt-0.5",style:{fontSize:"0.65rem"},children:[x(n.created_at),n.updated_at&&n.updated_at!==n.created_at&&p.jsx("span",{className:"text-gray-400 ml-1",children:"(bearbeitet)"})]})]}),p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("button",{onClick:_,className:"text-gray-400 hover:text-[#37a653] transition-colors p-1",title:"Zitieren",children:p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),p.jsx("button",{onClick:()=>{u(Hp(n.content)),a(!0)},className:"text-gray-400 hover:text-[#37a653] transition-colors p-1",title:"Bearbeiten",children:p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),p.jsx("button",{onClick:k,className:"text-gray-400 hover:text-red-400 transition-colors p-1",title:"Löschen",children:p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),n.quoted_text&&N(n.quoted_text),p.jsx("div",{className:"mb-3",children:s?p.jsxs("div",{children:[p.jsx("textarea",{value:l,onChange:C=>u(C.target.value),className:"w-full px-3 py-2 border border-[#2a4a57] bg-[#203f4a] text-white rounded-md focus:ring-[#37a653] focus:border-[#37a653] resize-vertical",rows:4}),p.jsxs("div",{className:"flex justify-end space-x-2 mt-2",children:[p.jsx("button",{onClick:()=>a(!1),className:"px-3 py-1 text-sm text-gray-300 hover:text-white",disabled:m,children:"Abbrechen"}),p.jsx("button",{onClick:w,className:"px-3 py-1 text-sm bg-[#37a653] text-white rounded hover:bg-[#2e8844] disabled:opacity-50",disabled:m||!l.trim(),children:m?"Speichern...":"Speichern"})]})]}):p.jsx("div",{className:"whitespace-pre-wrap text-white text-sm leading-relaxed text-left",children:Hp(n.content)})}),p.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[n.replies&&n.replies.length>0&&p.jsx("button",{onClick:()=>h(!d),className:"text-xs text-gray-300 hover:text-[#37a653] transition-colors",children:d?"Antworten ausblenden":`${n.replies.length} Antworten anzeigen`}),p.jsx("button",{onClick:()=>e(n.id),className:"px-2 py-0.5 text-xs bg-[#37a653] text-white rounded-lg font-medium hover:bg-[#2e8844] transition-colors",children:"Antworten"})]}),n.replies&&n.replies.length>0&&d&&p.jsx("div",{className:"mt-4 space-y-3",children:n.replies.map(C=>p.jsx(lk,{comment:C,onReply:e,onUpdate:t,depth:r+1},C.id))})]})},TD=({postId:n,parentCommentId:e,quotedText:t,onSubmit:r,onCommentAdded:s,onCancel:a,placeholder:l="Schreibe einen Kommentar...",fullWidth:u=!1})=>{const[d,h]=T.useState(""),[m,y]=T.useState(!1),[v,x]=T.useState(""),w=new Vm;T.useEffect(()=>{t&&x(t)},[t]);const k=async M=>{if(M.preventDefault(),!d.replace(/<[^>]*>/g,"").trim()){alert("Bitte gib einen Kommentar ein");return}y(!0);try{const I=await w.createComment({post_id:n,content:d.trim()});h(""),x(""),s&&s(I),r&&r()}catch(I){console.error("Error creating comment:",I),alert("Fehler beim Erstellen des Kommentars")}finally{y(!1)}},_=()=>{x("")},N=()=>v?p.jsx("div",{className:`border-l-4 border-[#37a653] pl-3 mb-3 bg-[#2a4a57] p-2 ${u?"mx-0":"rounded-r"}`,children:p.jsxs("div",{className:"flex items-start justify-between",children:[p.jsxs("div",{className:"text-sm text-gray-300 italic",children:['"',v,'"']}),p.jsx("button",{onClick:_,className:"ml-2 text-gray-400 hover:text-gray-300 transition-colors",title:"Zitat entfernen",children:p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}):null;return p.jsxs("div",{className:`${u?"bg-[#203f4a] border-0 rounded-none px-6 py-8":"bg-[#1a3442] border border-[#2a4a57] rounded-lg p-4"}`,children:[p.jsxs("form",{onSubmit:k,children:[N(),p.jsx("div",{className:"relative",children:p.jsx(Om,{content:d,onChange:h,placeholder:l,minHeight:u?"200px":"120px"})}),p.jsxs("div",{className:"flex justify-between items-center mt-3",children:[p.jsxs("span",{className:"text-xs text-gray-400",children:[d.replace(/<[^>]*>/g,"").length," Zeichen (ohne HTML)"]}),p.jsxs("div",{className:"flex space-x-2",children:[a&&p.jsx("button",{type:"button",onClick:a,className:"px-3 py-1.5 text-xs text-gray-300 hover:text-white transition-colors",disabled:m,children:"Abbrechen"}),p.jsx("button",{type:"submit",disabled:m||!d.replace(/<[^>]*>/g,"").trim(),className:"px-4 py-1.5 text-xs font-bold bg-[#37a653] text-white rounded-md hover:bg-[#2e8844] disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?"Wird gesendet...":"Kommentieren"})]})]})]}),!u&&p.jsx("div",{className:"mt-3 text-xs text-gray-400 border-t border-[#2a4a57] pt-3",children:p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsx("span",{children:"💡 Tipp: Markiere Text um ihn zu zitieren"}),p.jsx("span",{children:"• Behandle andere respektvoll"}),p.jsx("span",{children:"• Teile keine persönlichen Daten"})]})})]})},jD=({postId:n})=>{const[e,t]=T.useState(!1),[r,s]=T.useState(""),{comments:a,loading:l,loadComments:u,createComment:d,getCommentCount:h}=Fm(),m=a[n.toString()]||[],y=l[n.toString()]||!1,v=h(n);T.useEffect(()=>{console.log("CommentsSection: Loading comments for postId:",n),u(n).catch(w=>{console.error("CommentsSection: Error loading comments:",w)})},[n,u]);const x=async w=>{try{await d(w),t(!1)}catch(k){throw console.error("Error creating comment:",k),k}};return y?p.jsx("div",{className:"bg-[#203f4a] p-6",style:{borderRadius:"20px"},children:p.jsx("div",{className:"flex items-center justify-center py-8",children:p.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#37a653]"})})}):p.jsxs("div",{className:"bg-[#203f4a] overflow-hidden",style:{borderRadius:"20px"},children:[p.jsx("div",{className:"px-6 py-4 border-b border-[#2a4a57]",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Antworten (",v,")"]}),p.jsx("button",{onClick:()=>t(!e),className:"inline-flex items-center px-3 py-1.5 text-xs font-bold bg-[#37a653] text-white rounded-md hover:bg-[#2e8844] transition-colors",children:e?"Abbrechen":"Antworten"})]})}),e&&p.jsx("div",{className:"border-b border-[#2a4a57] -mx-4 md:mx-0",children:p.jsx(TD,{postId:n,quotedText:r,onCommentAdded:w=>{x({post_id:n,content:w.content,quoted_text:r})},onCancel:()=>{t(!1),s("")},placeholder:"Teile deine Gedanken zu diesem Beitrag...",fullWidth:!0})}),p.jsx("div",{className:"divide-y divide-[#2a4a57]",children:m.length===0?p.jsx("div",{className:"px-6 py-8",children:p.jsx("p",{className:"text-center text-gray-300",children:"Noch keine Antworten vorhanden. Sei der erste der antwortet!"})}):p.jsx("div",{className:"px-6 py-6 space-y-6",children:m.map(w=>p.jsx(lk,{comment:w,onReply:(k,_)=>{s(_||""),t(!0)},onUpdate:()=>u(n)},w.id))})}),m.length>0&&m.length>=10&&p.jsx("div",{className:"px-6 py-4 border-t border-[#2a4a57] text-center",children:p.jsx("button",{className:"text-sm text-gray-300 hover:text-[#37a653] transition-colors",children:"Weitere Kommentare laden..."})})]})},MD=({isOpen:n,post:e,onClose:t,onUpdate:r})=>{const s=async a=>{try{await r(a),t()}catch(l){throw console.error("Error updating post:",l),l}};return n?p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-0 md:p-4 z-50",children:p.jsxs("div",{className:"bg-[#1a3442] md:bg-white w-screen h-screen md:rounded-lg md:max-w-4xl md:w-full md:max-h-[90vh] md:h-auto overflow-y-auto",children:[p.jsx("div",{className:"sticky top-0 bg-[#1a3442] md:bg-white border-b border-[#2a4a57] md:border-gray-200 px-4 md:px-6 py-3 md:py-4",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("h2",{className:"text-lg md:text-xl font-headline font-bold text-[#37a653] md:text-gray-900",children:"Beitrag bearbeiten"}),p.jsx("button",{onClick:t,className:"text-[#37a653] md:text-gray-400 hover:text-[#2e8844] md:hover:text-gray-600 transition-colors p-1",children:p.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),p.jsx("div",{className:"p-4 md:p-6 pb-20 md:pb-6",children:p.jsx(ok,{editMode:!0,mobileOptimized:!0,initialData:{title:e.title,content:e.content,category_id:e.category_id,canton:e.canton||"",therapist_id:e.therapist_id||void 0},onSubmit:s,onCancel:t})})]})}):null},AD=()=>{const{id:n}=cN(),e=Ra(),t=n?parseInt(n):null,[r,s]=T.useState(!1),{currentPost:a,loading:l,loadPost:u,updatePost:d}=hs(),{user:h}=Jt();CD(t),T.useEffect(()=>{t&&u(t)},[t,u]);const m=w=>new Date(w).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),y=w=>({1:"bg-[#37a653] text-white",2:"bg-[#37a653] text-white",3:"bg-[#37a653] text-white",4:"bg-[#37a653] text-white",5:"bg-[#37a653] text-white"})[w]||"bg-[#37a653] text-white",v=async w=>{if(a)try{await d(a.id,{title:w.title,content:w.content,category_id:w.category_id,canton:w.canton,therapist_id:w.therapist_id}),await u(a.id)}catch(k){throw console.error("Error updating post:",k),alert("Fehler beim Aktualisieren des Beitrags: "+(k instanceof Error?k.message:"Unbekannter Fehler")),k}},x=()=>h&&a&&h.id===a.user_id;return l?p.jsx("div",{className:"min-h-screen bg-[#1a3442]",children:p.jsx("div",{className:"max-w-6xl mx-auto py-6 px-4 md:px-0",children:p.jsx("div",{className:"flex items-center justify-center py-12",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#37a653]"})})})}):!a&&!l?p.jsx("div",{className:"min-h-screen bg-[#1a3442]",children:p.jsx("div",{className:"max-w-6xl mx-auto py-6 px-4 md:px-0",children:p.jsxs("div",{className:"text-center py-12",children:[p.jsx("div",{className:"text-red-400 mb-4",children:p.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.982 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),p.jsx("h3",{className:"text-lg font-medium text-white",children:"Beitrag nicht gefunden"}),p.jsx("p",{className:"text-gray-300 mt-1",children:"Der angeforderte Beitrag existiert nicht oder wurde entfernt."}),p.jsx("button",{onClick:()=>e("/"),className:"mt-4 bg-[#37a653] hover:bg-[#2e8844] text-white px-4 py-2 rounded-md transition-colors",children:"Zurück zum Forum"})]})})}):a?p.jsx("div",{className:"min-h-screen bg-[#1a3442]",children:p.jsxs("div",{className:"max-w-6xl mx-auto py-6 px-4 md:px-0",children:[p.jsx("div",{className:"mb-6",children:p.jsxs("button",{onClick:()=>e("/"),className:"inline-flex items-center text-gray-300 hover:text-white transition-colors",children:[p.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Zurück zum Forum"]})}),p.jsxs("div",{className:"bg-[#203f4a] p-6 mb-4",style:{borderRadius:"20px"},children:[p.jsxs("div",{className:"flex items-start justify-between mb-4",children:[p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-lg font-medium ${y(a.category_id)}`,style:{fontSize:"0.65rem"},children:a.categories?.name_de}),a.canton&&p.jsx("img",{src:`/kantone/${a.canton.toLowerCase()}.png`,alt:`${a.canton} flag`,className:"w-4 h-auto object-cover",onError:w=>{w.target.style.display="none"}}),a.canton&&p.jsx("span",{className:"text-gray-300 text-xs font-medium",children:a.canton})]}),p.jsxs("div",{className:"flex items-center space-x-3",children:[x()&&p.jsxs("button",{onClick:()=>s(!0),className:"flex items-center space-x-1 text-gray-300 hover:text-white transition-colors",title:"Beitrag bearbeiten",children:[p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),p.jsx("span",{className:"text-xs",children:"Bearbeiten"})]}),!x()&&h&&a.users&&p.jsx(Nw,{recipientId:a.user_id,recipientUsername:a.users.username,postTitle:_u(a),postId:a.id,variant:"small"}),p.jsx("div",{className:"relative flex items-center",children:p.jsx("div",{className:"relative bg-[#37a653] rounded-full p-1.5",children:p.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})})})]})]}),p.jsxs("div",{className:"flex items-start space-x-3 mb-4",children:[a.users&&p.jsx(sn,{user:a.users,size:"small",className:"flex-shrink-0"}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("p",{className:"font-medium text-white text-xs text-left leading-none",children:a.users?.username}),p.jsx("p",{className:"text-xs text-gray-300 text-left leading-none mt-0.5",style:{fontSize:"0.65rem"},children:m(a.created_at)})]})]}),p.jsx("h1",{className:"text-base md:text-xl font-semibold text-[#37a653] mb-4 leading-tight text-left",children:_u(a)}),p.jsx(wD,{onTextSelect:()=>{},children:p.jsx("div",{className:"prose prose-gray max-w-none text-white leading-tight text-left text-sm",dangerouslySetInnerHTML:{__html:a.content}})})]}),p.jsx("div",{className:"mt-8",children:p.jsx(jD,{postId:parseInt(n)})}),a&&p.jsx(MD,{isOpen:r,post:a,onClose:()=>s(!1),onUpdate:v})]})}):null},OD=()=>{const{conversations:n,currentConversation:e,loading:t,setCurrentConversation:r}=On(),s=l=>{const u=new Date(l),h=new Date().getTime()-u.getTime(),m=Math.floor(h/(1e3*60*60*24));return m===0?u.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"}):m===1?"Gestern":m<7?u.toLocaleDateString("de-DE",{weekday:"short"}):u.toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit"})},a=(l,u=60)=>l.length<=u?l:l.substring(0,u)+"...";return t?p.jsx("div",{className:"p-4",children:p.jsxs("div",{className:"animate-pulse",children:[p.jsx("div",{className:"h-4 bg-gray-600 rounded w-24 mb-4"}),[...Array(3)].map((l,u)=>p.jsxs("div",{className:"flex items-center space-x-3 p-3 mb-2",children:[p.jsx("div",{className:"w-10 h-10 bg-gray-600 rounded-full"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("div",{className:"h-4 bg-gray-600 rounded w-20 mb-2"}),p.jsx("div",{className:"h-3 bg-gray-700 rounded w-32"})]})]},u))]})}):p.jsxs("div",{className:"flex flex-col h-full",children:[p.jsxs("div",{className:"p-4 border-b border-[#2a4a57]",children:[p.jsx("h2",{className:"text-lg font-semibold text-white",children:"Messages"}),n.length>0&&p.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[n.length," conversation",n.length!==1?"s":""]})]}),p.jsx("div",{className:"flex-1 overflow-y-auto",children:n.length===0?p.jsxs("div",{className:"p-6 text-center",children:[p.jsx("div",{className:"text-gray-400 mb-4",children:p.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),p.jsx("h3",{className:"text-sm font-medium text-white mb-2",children:"No conversations yet"}),p.jsx("p",{className:"text-xs text-gray-400",children:"Start a conversation by messaging someone from their profile or a post."})]}):n.map(l=>p.jsx("button",{onClick:()=>r(l),className:`w-full p-4 text-left hover:bg-[#2a4a57] transition-colors border-b border-[#2a4a57]/50 ${e?.id===l.id?"bg-[#2a4a57] border-l-2 border-l-[#37a653]":""}`,children:p.jsxs("div",{className:"flex items-start space-x-3",children:[p.jsx(sn,{user:l.participant,size:"small",className:"flex-shrink-0"}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsxs("div",{className:"flex items-center justify-between mb-1",children:[p.jsx("h3",{className:"text-sm font-medium text-white truncate",children:l.participant.username}),p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("span",{className:"text-xs text-gray-400",children:s(l.lastActivity)}),l.unreadCount>0&&p.jsx("div",{className:"bg-[#37a653] text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-bold",children:l.unreadCount>9?"9+":l.unreadCount})]})]}),p.jsx("p",{className:"text-xs text-gray-300 truncate",children:a(l.lastMessage.content)})]})]})},l.id))})]})},RD=({message:n,isOwn:e,showAvatar:t,showTimestamp:r})=>{const{deleteMessage:s}=On(),[a,l]=T.useState(!1),u=h=>new Date(h).toLocaleString("de-DE",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}),d=async()=>{if(window.confirm("Are you sure you want to delete this message?"))try{await s(n.id)}catch(h){console.error("Error deleting message:",h),alert("Error deleting message")}};return p.jsxs("div",{className:`flex ${e?"justify-end":"justify-start"} items-end space-x-2`,children:[!e&&t&&n.sender&&p.jsx(sn,{user:n.sender,size:"small",className:"flex-shrink-0"}),!e&&!t&&p.jsx("div",{className:"w-8"}),p.jsxs("div",{className:"max-w-xs lg:max-w-md relative group",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[p.jsx("div",{className:`px-4 py-2 rounded-2xl break-words ${e?"bg-[#37a653] text-white rounded-br-md":"bg-[#2a4a57] text-white rounded-bl-md"}`,children:p.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:n.content})}),e&&a&&p.jsx("div",{className:"absolute top-0 right-0 -mr-8 flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:p.jsx("button",{onClick:d,className:"p-1 text-gray-400 hover:text-red-400 transition-colors",title:"Delete message",children:p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})}),r&&p.jsxs("div",{className:`text-xs text-gray-400 mt-1 ${e?"text-right":"text-left"}`,children:[u(n.created_at),e&&p.jsx("span",{className:"ml-1",children:n.is_read?"✓✓":"✓"})]})]})]})},DD=({recipientId:n,recipientUsername:e})=>{const{sendMessage:t}=On(),[r,s]=T.useState(""),[a,l]=T.useState(!1),u=T.useRef(null);T.useEffect(()=>{const m=sessionStorage.getItem("messageContext");if(m)try{const{postTitle:y}=JSON.parse(m),v=`Regarding your post: "${y}"

`;s(v),sessionStorage.removeItem("messageContext"),u.current&&(u.current.focus(),u.current.setSelectionRange(v.length,v.length))}catch(y){console.error("Error parsing message context:",y)}},[]),T.useEffect(()=>{u.current&&(u.current.style.height="auto",u.current.style.height=u.current.scrollHeight+"px")},[r]);const d=async m=>{m.preventDefault();const y=r.trim();if(!(!y||a)){l(!0);try{await t({receiver_id:n,content:y}),s("")}catch(v){console.error("Error sending message:",v),alert("Fehler beim Senden der Nachricht: "+(v instanceof Error?v.message:"Unbekannter Fehler"))}finally{l(!1)}}},h=m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),d(m))};return p.jsx("form",{onSubmit:d,className:"p-4",children:p.jsxs("div",{className:"flex items-end space-x-3",children:[p.jsxs("div",{className:"flex-1",children:[p.jsx("textarea",{ref:u,value:r,onChange:m=>s(m.target.value),onKeyPress:h,placeholder:`Send a message to ${e}...`,className:"w-full p-3 bg-[#2a4a57] text-white rounded-xl border border-[#3a5a67] focus:border-[#37a653] focus:outline-none resize-none min-h-[44px] max-h-32",rows:1,disabled:a}),p.jsxs("div",{className:"flex items-center justify-between mt-2",children:[p.jsx("span",{className:"text-xs text-gray-400",children:"Press Enter to send, Shift+Enter for new line"}),p.jsxs("span",{className:"text-xs text-gray-400",children:[r.length,"/1000"]})]})]}),p.jsx("button",{type:"submit",disabled:!r.trim()||a||r.length>1e3,className:"p-3 bg-[#37a653] hover:bg-[#2e8844] disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-xl transition-colors flex items-center justify-center min-w-[48px]",title:"Send message",children:a?p.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):p.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})},LD=({conversation:n,onClose:e})=>{const[t,r]=T.useState(!1),[s,a]=T.useState(!1),l=new xw;An.useEffect(()=>{u()},[n.id]);const u=async()=>{try{const h=await l.isUserBlocked(n.id);r(h)}catch(h){console.error("Error checking block status:",h)}},d=async()=>{if(!s){a(!0);try{const h=await l.toggleBlockUser(n.id);r(h.action==="blocked");const m=h.action==="blocked"?"blocked":"unblocked";alert(`User has been ${m}`)}catch(h){console.error("Error toggling block:",h),alert("Error updating block status: "+(h instanceof Error?h.message:"Unknown error"))}finally{a(!1)}}};return p.jsx("div",{className:"bg-[#203f4a] border-b border-[#2a4a57] p-4",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center space-x-3",children:[p.jsx("button",{onClick:e,className:"md:hidden p-2 text-gray-400 hover:text-white transition-colors",children:p.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),p.jsx(sn,{user:n.participant,size:"small"}),p.jsxs("div",{children:[p.jsx("h2",{className:"font-semibold text-white",children:n.participant.username}),t&&p.jsx("span",{className:"text-xs text-red-400",children:"Blocked"})]})]}),p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("button",{onClick:d,disabled:s,className:`px-3 py-1 text-xs rounded-md transition-colors ${t?"bg-green-600 hover:bg-green-700 text-white":"bg-red-600 hover:bg-red-700 text-white"} disabled:opacity-50`,children:s?p.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}):t?"Unblock":"Block"}),p.jsx("div",{className:"relative",children:p.jsx("button",{className:"p-2 text-gray-400 hover:text-white transition-colors",children:p.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})})]})]})})},L1=()=>{const{user:n}=Jt(),{currentConversation:e,currentMessages:t,loadingMessages:r,setCurrentConversation:s}=On(),a=T.useRef(null);return T.useEffect(()=>{a.current&&t.length>0&&a.current.scrollIntoView({behavior:"smooth"})},[t]),e?p.jsxs("div",{className:"flex flex-col h-full",children:[p.jsx(LD,{conversation:e,onClose:()=>s(null)}),p.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-[#1a3442]",children:r?p.jsx("div",{className:"flex items-center justify-center h-32",children:p.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#37a653]"})}):t.length===0?p.jsx("div",{className:"flex items-center justify-center h-32",children:p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"text-gray-400 mb-2",children:p.jsx("svg",{className:"mx-auto h-8 w-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),p.jsxs("p",{className:"text-sm text-gray-400",children:["Start a conversation with ",e.participant.username]})]})}):p.jsxs("div",{className:"space-y-4",children:[t.map((l,u)=>p.jsx(RD,{message:l,isOwn:l.sender_id===n?.id,showAvatar:u===0||t[u-1].sender_id!==l.sender_id,showTimestamp:u===t.length-1||t[u+1].sender_id!==l.sender_id||new Date(t[u+1].created_at).getTime()-new Date(l.created_at).getTime()>300*1e3},l.id)),p.jsx("div",{ref:a})]})}),p.jsx("div",{className:"border-t border-[#2a4a57] bg-[#203f4a]",children:p.jsx(DD,{recipientId:e.id,recipientUsername:e.participant.username})})]}):p.jsx("div",{className:"flex-1 flex items-center justify-center",children:p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"text-gray-400 mb-4",children:p.jsx("svg",{className:"mx-auto h-16 w-16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),p.jsx("h3",{className:"text-xl font-medium text-white mb-2",children:"Select a conversation"}),p.jsx("p",{className:"text-gray-300",children:"Choose a conversation from the sidebar to start messaging."})]})})},BD=()=>{const{user:n}=Jt(),{currentConversation:e,loadConversations:t}=On(),[r]=ZN();return T.useEffect(()=>{bj(),n&&t()},[n,t]),T.useEffect(()=>{const s=r.get("postTitle"),a=r.get("postId");s&&a&&sessionStorage.setItem("messageContext",JSON.stringify({postTitle:s,postId:parseInt(a)}))},[r]),n?p.jsx("div",{className:"min-h-screen bg-[#1a3442]",children:p.jsx("div",{className:"max-w-7xl mx-auto",children:p.jsxs("div",{className:"flex h-screen",children:[p.jsx("div",{className:"w-full md:w-1/3 lg:w-1/4 border-r border-[#2a4a57] bg-[#203f4a]",children:p.jsx(OD,{})}),p.jsx("div",{className:"hidden md:flex md:w-2/3 lg:w-3/4 flex-col",children:e?p.jsx(L1,{}):p.jsx("div",{className:"flex-1 flex items-center justify-center",children:p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"text-gray-400 mb-4",children:p.jsx("svg",{className:"mx-auto h-16 w-16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),p.jsx("h3",{className:"text-xl font-medium text-white mb-2",children:"Welcome to Messages"}),p.jsx("p",{className:"text-gray-300",children:"Select a conversation to start messaging, or start a new conversation from user profiles."})]})})}),e&&p.jsx("div",{className:"md:hidden fixed inset-0 z-50 bg-[#1a3442]",children:p.jsx(L1,{})})]})})}):p.jsx("div",{className:"min-h-screen bg-[#1a3442] flex items-center justify-center",children:p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"text-gray-400 mb-4",children:p.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),p.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Authentication Required"}),p.jsx("p",{className:"text-gray-300",children:"Please log in to access your messages."})]})})},zD=()=>{const n=bd(),[e,t]=T.useState(null),[r,s]=T.useState([]),[a,l]=T.useState(!0),[u,d]=T.useState("overview"),h=new Ew;T.useEffect(()=>{n.canModerate&&m()},[n.canModerate]);const m=async()=>{try{l(!0);const[x,w]=await Promise.all([h.getModerationStats(),h.getUsers(50,0)]);t(x),s(w)}catch(x){console.error("Error loading dashboard data:",x)}finally{l(!1)}},y=async(x,w)=>{try{await h.updateUserRole(x,w),await m(),alert("Benutzerrolle erfolgreich geändert")}catch(k){console.error("Error changing user role:",k),alert("Fehler beim Ändern der Benutzerrolle")}},v=async(x,w)=>{try{w?await h.banUser(x):await h.unbanUser(x),await m(),alert(`Benutzer ${w?"gesperrt":"entsperrt"}`)}catch(k){console.error("Error banning/unbanning user:",k),alert("Fehler beim Sperren/Entsperren des Benutzers")}};return n.canModerate?a?p.jsx("div",{className:"min-h-screen bg-[#1a3442] flex items-center justify-center",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#37a653]"})}):p.jsx("div",{className:"min-h-screen bg-[#1a3442]",children:p.jsxs("div",{className:"max-w-7xl mx-auto py-6 px-4",children:[p.jsxs("div",{className:"mb-8",children:[p.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:n.isAdmin?"Admin Dashboard":"Moderator Dashboard"}),p.jsx("p",{className:"text-gray-300",children:"Verwalten Sie Benutzer, Inhalte und Einstellungen des Forums"})]}),p.jsx("div",{className:"mb-6 border-b border-[#2a4a57]",children:p.jsxs("nav",{className:"flex space-x-8",children:[p.jsx("button",{onClick:()=>d("overview"),className:`py-2 px-1 border-b-2 font-medium text-sm ${u==="overview"?"border-[#37a653] text-[#37a653]":"border-transparent text-gray-300 hover:text-white hover:border-gray-300"}`,children:"Übersicht"}),p.jsx("button",{onClick:()=>d("users"),className:`py-2 px-1 border-b-2 font-medium text-sm ${u==="users"?"border-[#37a653] text-[#37a653]":"border-transparent text-gray-300 hover:text-white hover:border-gray-300"}`,children:"Benutzer"}),p.jsx("button",{onClick:()=>d("content"),className:`py-2 px-1 border-b-2 font-medium text-sm ${u==="content"?"border-[#37a653] text-[#37a653]":"border-transparent text-gray-300 hover:text-white hover:border-gray-300"}`,children:"Inhalte"})]})}),u==="overview"&&e&&p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[p.jsx("div",{className:"bg-[#203f4a] rounded-lg p-6",children:p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"p-2 bg-[#37a653] rounded-lg",children:p.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"})})}),p.jsxs("div",{className:"ml-4",children:[p.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Benutzer gesamt"}),p.jsx("p",{className:"text-2xl font-bold text-white",children:e.totalUsers})]})]})}),p.jsx("div",{className:"bg-[#203f4a] rounded-lg p-6",children:p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"p-2 bg-red-500 rounded-lg",children:p.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636"})})}),p.jsxs("div",{className:"ml-4",children:[p.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Gesperrte Benutzer"}),p.jsx("p",{className:"text-2xl font-bold text-white",children:e.bannedUsers})]})]})}),p.jsx("div",{className:"bg-[#203f4a] rounded-lg p-6",children:p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"p-2 bg-blue-500 rounded-lg",children:p.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),p.jsxs("div",{className:"ml-4",children:[p.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Beiträge gesamt"}),p.jsx("p",{className:"text-2xl font-bold text-white",children:e.totalPosts})]})]})}),p.jsx("div",{className:"bg-[#203f4a] rounded-lg p-6",children:p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"p-2 bg-yellow-500 rounded-lg",children:p.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),p.jsxs("div",{className:"ml-4",children:[p.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Kommentare gesamt"}),p.jsx("p",{className:"text-2xl font-bold text-white",children:e.totalComments})]})]})}),p.jsx("div",{className:"bg-[#203f4a] rounded-lg p-6",children:p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"p-2 bg-[#37a653] rounded-lg",children:p.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),p.jsxs("div",{className:"ml-4",children:[p.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Moderatoren"}),p.jsx("p",{className:"text-2xl font-bold text-white",children:e.moderators})]})]})}),p.jsx("div",{className:"bg-[#203f4a] rounded-lg p-6",children:p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"p-2 bg-purple-500 rounded-lg",children:p.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),p.jsxs("div",{className:"ml-4",children:[p.jsx("p",{className:"text-sm font-medium text-gray-300",children:"Admins"}),p.jsx("p",{className:"text-2xl font-bold text-white",children:e.admins})]})]})})]}),u==="users"&&p.jsxs("div",{className:"bg-[#203f4a] rounded-lg",children:[p.jsx("div",{className:"px-6 py-4 border-b border-[#2a4a57]",children:p.jsx("h2",{className:"text-lg font-semibold text-white",children:"Benutzerverwaltung"})}),p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"min-w-full",children:[p.jsx("thead",{className:"bg-[#1a3442]",children:p.jsxs("tr",{children:[p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Benutzer"}),p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Rolle"}),p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Status"}),p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Registriert"}),n.isAdmin&&p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Aktionen"})]})}),p.jsx("tbody",{className:"divide-y divide-[#2a4a57]",children:r.map(x=>p.jsxs("tr",{className:"bg-[#203f4a]",children:[p.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"mr-3",children:p.jsx(sn,{user:x,size:"small"})}),p.jsxs("div",{children:[p.jsx("div",{className:"text-sm font-medium text-white",children:x.username}),p.jsx("div",{className:"text-sm text-gray-300",children:x.email})]})]})}),p.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${x.role==="admin"?"bg-purple-100 text-purple-800":x.role==="moderator"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:x.role==="admin"?"Admin":x.role==="moderator"?"Moderator":"Benutzer"})}),p.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${x.is_banned?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:x.is_banned?"Gesperrt":"Aktiv"})}),p.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:new Date(x.created_at).toLocaleDateString("de-DE")}),n.isAdmin&&p.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:p.jsxs("div",{className:"flex space-x-2",children:[x.is_banned?p.jsx("button",{onClick:()=>v(x.id,!1),className:"text-green-400 hover:text-green-300 transition-colors",children:"Entsperren"}):p.jsx("button",{onClick:()=>v(x.id,!0),className:"text-red-400 hover:text-red-300 transition-colors",children:"Sperren"}),p.jsxs("select",{value:x.role,onChange:w=>y(x.id,w.target.value),className:"bg-[#1a3442] text-white text-sm rounded px-2 py-1 border border-[#2a4a57]",children:[p.jsx("option",{value:"user",children:"Benutzer"}),p.jsx("option",{value:"moderator",children:"Moderator"}),p.jsx("option",{value:"admin",children:"Admin"})]})]})})]},x.id))})]})})]}),u==="content"&&p.jsxs("div",{className:"bg-[#203f4a] rounded-lg p-6",children:[p.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Inhaltsverwaltung"}),p.jsxs("div",{className:"text-gray-300",children:[p.jsx("p",{className:"mb-4",children:"Die Moderation von Beiträgen und Kommentaren erfolgt direkt über die jeweiligen Moderationsbuttons in den Inhalten."}),p.jsxs("p",{children:["Als ",n.isAdmin?"Administrator":"Moderator"," können Sie:"]}),p.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[p.jsx("li",{children:"Beiträge und Kommentare bearbeiten"}),p.jsx("li",{children:"Unangemessene Inhalte löschen"}),n.isAdmin&&p.jsx("li",{children:"Benutzer sperren und Rollen verwalten"})]})]})]})]})}):p.jsx("div",{className:"min-h-screen bg-[#1a3442] flex items-center justify-center",children:p.jsxs("div",{className:"text-white text-center",children:[p.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Zugriff verweigert"}),p.jsx("p",{className:"text-gray-300",children:"Sie haben keine Berechtigung für diese Seite."})]})})};class UD{async getPendingContent(){const{data:e,error:t}=await B.from("posts").select(`
        *,
        users!posts_user_id_fkey(id, username, email, role, avatar_url),
        categories!inner(id, name_de, name_fr, name_it)
      `).eq("moderation_status","pending").order("created_at",{ascending:!0});if(t)throw console.error("Error fetching pending posts:",t),t;const{data:r,error:s}=await B.from("comments").select(`
        *,
        users!comments_user_id_fkey(id, username, email, role, avatar_url)
      `).eq("moderation_status","pending").order("created_at",{ascending:!0});if(s)throw console.error("Error fetching pending comments:",s),s;const a=(e||[]).map(d=>({content_type:"post",id:d.id,content_id:d.id,user_id:d.user_id,title:d.title,content:d.content,canton:d.canton,created_at:d.created_at,moderation_status:d.moderation_status,moderated_by:d.moderated_by,moderated_at:d.moderated_at,rejection_reason:d.rejection_reason,users:d.users,category_id:d.category_id})),l=(r||[]).map(d=>({content_type:"comment",id:d.id,content_id:d.id,user_id:d.user_id,content:d.content,created_at:d.created_at,moderation_status:d.moderation_status,moderated_by:d.moderated_by,moderated_at:d.moderated_at,rejection_reason:d.rejection_reason,post_id:d.post_id,users:d.users})),u=[...a,...l];return u.sort((d,h)=>new Date(d.created_at).getTime()-new Date(h.created_at).getTime()),u}async getPendingContentCount(){const[e,t]=await Promise.all([B.from("posts").select("id",{count:"exact",head:!0}).eq("moderation_status","pending"),B.from("comments").select("id",{count:"exact",head:!0}).eq("moderation_status","pending")]),r=e.count||0,s=t.count||0;return{posts:r,comments:s,total:r+s}}async approvePost(e,t){const r={moderation_status:"approved",moderated_by:t,moderated_at:new Date().toISOString(),is_published:!0,updated_at:new Date().toISOString()},{error:s}=await B.from("posts").update(r).eq("id",e);if(s)throw console.error("Error approving post:",s),s;console.log(`✅ Post ${e} approved by moderator ${t}`)}async rejectPost(e,t,r){const s={moderation_status:"rejected",moderated_by:t,moderated_at:new Date().toISOString(),rejection_reason:r||null,is_banned:!0,is_published:!1,updated_at:new Date().toISOString()},{error:a}=await B.from("posts").update(s).eq("id",e);if(a)throw console.error("Error rejecting post:",a),a;console.log(`❌ Post ${e} rejected and banned by moderator ${t}`)}async approveComment(e,t){const{error:r}=await B.from("comments").update({moderation_status:"approved",moderated_by:t,moderated_at:new Date().toISOString(),is_published:!0}).eq("id",e);if(r)throw console.error("Error approving comment:",r),r;console.log(`✅ Comment ${e} approved by moderator ${t}`)}async rejectComment(e,t,r){const{error:s}=await B.from("comments").update({moderation_status:"rejected",moderated_by:t,moderated_at:new Date().toISOString(),rejection_reason:r||null,is_banned:!0,is_published:!1}).eq("id",e);if(s)throw console.error("Error rejecting comment:",s),s;console.log(`❌ Comment ${e} rejected and banned by moderator ${t}`)}async getModerationHistory(e,t=50){const[r,s]=await Promise.all([B.from("posts").select(`
          *,
          users!posts_user_id_fkey(id, username, email, avatar_url)
        `).eq("moderated_by",e).not("moderation_status","eq","pending").order("moderated_at",{ascending:!1}).limit(t),B.from("comments").select(`
          *,
          users!comments_user_id_fkey(id, username, email, avatar_url)
        `).eq("moderated_by",e).not("moderation_status","eq","pending").order("moderated_at",{ascending:!1}).limit(t)]);if(r.error)throw console.error("Error fetching moderated posts:",r.error),r.error;if(s.error)throw console.error("Error fetching moderated comments:",s.error),s.error;return{posts:(r.data||[]).map(a=>({...a,moderated_content_type:"post"})),comments:(s.data||[]).map(a=>({...a,moderated_content_type:"comment"}))}}async getModerationStats(){const[e,t,r,s,a,l]=await Promise.all([B.from("posts").select("id",{count:"exact",head:!0}).eq("moderation_status","pending"),B.from("comments").select("id",{count:"exact",head:!0}).eq("moderation_status","pending"),B.from("posts").select("id",{count:"exact",head:!0}).eq("moderation_status","approved"),B.from("comments").select("id",{count:"exact",head:!0}).eq("moderation_status","approved"),B.from("posts").select("id",{count:"exact",head:!0}).eq("moderation_status","rejected"),B.from("comments").select("id",{count:"exact",head:!0}).eq("moderation_status","rejected")]),u={posts:e.count||0,comments:t.count||0,total:(e.count||0)+(t.count||0)},d={posts:r.count||0,comments:s.count||0,total:(r.count||0)+(s.count||0)},h={posts:a.count||0,comments:l.count||0,total:(a.count||0)+(l.count||0)};return{pending:u,approved:d,rejected:h,totalProcessed:d.total+h.total}}async bulkApprove(e,t){const r=e.filter(h=>h.type==="post").map(h=>h.id),s=e.filter(h=>h.type==="comment").map(h=>h.id),a={moderation_status:"approved",moderated_by:t,moderated_at:new Date().toISOString(),is_published:!0,updated_at:new Date().toISOString()},l={moderation_status:"approved",moderated_by:t,moderated_at:new Date().toISOString(),is_published:!0},u=[];r.length>0&&u.push(B.from("posts").update(a).in("id",r)),s.length>0&&u.push(B.from("comments").update(l).in("id",s));const d=await Promise.all(u);for(const h of d)if(h.error)throw console.error("Error in bulk approve:",h.error),h.error;console.log(`✅ Bulk approved ${e.length} items by moderator ${t}`)}async deletePost(e,t){const{error:r}=await B.from("posts").delete().eq("id",e);if(r)throw console.error("Error deleting post:",r),r;console.log(`🗑️ Post ${e} deleted permanently${t?` (${t})`:""}`)}async deleteComment(e,t){const{error:r}=await B.from("comments").delete().eq("id",e);if(r)throw console.error("Error deleting comment:",r),r;console.log(`🗑️ Comment ${e} deleted permanently${t?` (${t})`:""}`)}async bulkDelete(e,t){const r=e.filter(u=>u.type==="post").map(u=>u.id),s=e.filter(u=>u.type==="comment").map(u=>u.id),a=[];r.length>0&&a.push(B.from("posts").delete().in("id",r)),s.length>0&&a.push(B.from("comments").delete().in("id",s));const l=await Promise.all(a);for(const u of l)if(u.error)throw console.error("Error in bulk delete:",u.error),u.error;console.log(`🗑️ Bulk deleted ${e.length} items${t?` (${t})`:""}`)}}const PD=({isOpen:n,item:e,onClose:t,onApprove:r,onReject:s,onDelete:a,onMessage:l,isProcessing:u,postTitles:d,categories:h})=>{if(!n||!e)return null;const m=x=>new Date(x).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),y=x=>{const w=x.replace(/<[^>]*>/g,""),k=w.split(`
`)[0]||w;return k.length>80?k.substring(0,80)+"...":k},v=(x,w=50)=>x.length>w?x.substring(0,w)+"...":x;return p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:p.jsxs("div",{className:"bg-[#1a3442] rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[p.jsxs("div",{className:"sticky top-0 bg-[#1a3442] border-b border-gray-600 p-4 flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center space-x-3",children:[p.jsx("h2",{className:"text-xl font-semibold text-white",children:"Moderation Vorschau"}),p.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-lg font-medium bg-yellow-600 text-white text-sm",children:"🔍 PREVIEW MODE"})]}),p.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white transition-colors",children:p.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"bg-[#203f4a] p-6 relative",style:{borderRadius:"20px"},children:[p.jsx("span",{className:`absolute -top-2 left-4 z-10 inline-flex items-center px-2 py-0.5 rounded-lg font-medium shadow-lg ${e.content_type==="post"?"bg-gray-600 text-white":"bg-blue-600 text-white"}`,style:{fontSize:"0.65rem"},children:e.content_type==="post"?"Beitrag":"Kommentar"}),p.jsx("div",{className:"flex items-start justify-end mb-4",children:e.canton&&p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("img",{src:`/kantone/${e.canton.toLowerCase()}.png`,alt:`${e.canton} flag`,className:"w-4 h-auto object-cover",onError:x=>{x.target.style.display="none"}}),p.jsx("span",{className:"text-gray-300 text-xs font-medium",children:e.canton})]})}),e.category_id&&p.jsx("div",{className:"mb-2",children:p.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-lg font-medium bg-[#37a653] text-white",style:{fontSize:"0.65rem"},children:h[e.category_id]||"Kategorie"})}),p.jsxs("div",{className:"flex items-start space-x-3 mb-4",children:[e.users&&p.jsx(sn,{user:e.users,size:"small",className:"flex-shrink-0"}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("p",{className:"font-medium text-white text-xs text-left leading-none",children:e.users?.username}),p.jsx("p",{className:"text-xs text-gray-300 text-left leading-none mt-0.5",style:{fontSize:"0.65rem"},children:m(e.created_at)})]})]}),p.jsx("div",{className:"mb-4",children:e.content_type==="post"?p.jsxs("div",{children:[e.title&&p.jsx("h1",{className:"text-base md:text-xl font-semibold text-[#37a653] mb-4 leading-tight text-left",children:e.title}),p.jsx("div",{className:"prose prose-gray max-w-none text-white leading-tight text-left text-sm",children:p.jsx("div",{dangerouslySetInnerHTML:{__html:e.content||""}})})]}):p.jsxs("div",{children:[p.jsxs("div",{className:"text-gray-300 text-sm mb-2 italic",children:['"',y(e.content||""),'"']}),e.post_id&&p.jsxs("div",{className:"text-xs text-gray-400 mb-4",children:["Kommentar zu: ",p.jsx("span",{className:"text-white",children:d[e.post_id]?v(d[e.post_id]):`Post #${e.post_id}`})]}),p.jsx("div",{className:"prose prose-gray max-w-none text-white leading-tight text-left text-sm border-l-2 border-gray-600 pl-4",children:p.jsx("div",{dangerouslySetInnerHTML:{__html:e.content||""}})})]})})]}),p.jsxs("div",{className:"mt-6 flex items-center justify-center space-x-3",children:[p.jsx("button",{onClick:()=>l(e),disabled:u,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors disabled:opacity-50 text-sm",children:"Message"}),p.jsx("button",{onClick:()=>a(e),disabled:u,className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors disabled:opacity-50 text-sm",children:"Löschen"}),p.jsx("button",{onClick:()=>s(e),disabled:u,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors disabled:opacity-50 text-sm",children:"Ablehnen"}),p.jsx("button",{onClick:()=>r(e),disabled:u,className:"bg-[#37a653] hover:bg-[#2e8844] text-white px-4 py-2 rounded-lg transition-colors disabled:opacity-50 text-sm",children:u?"Verarbeitung...":"Publizieren"})]})]})]})})},$D=({isOpen:n,item:e,actionType:t,onClose:r,onConfirm:s,isProcessing:a})=>{const[l,u]=T.useState(""),[d,h]=T.useState(!1);if(!n||!e||!t)return null;const m=()=>{switch(t){case"approve":return`${e.content_type==="post"?"Beitrag":"Kommentar"} genehmigen`;case"reject":return`${e.content_type==="post"?"Beitrag":"Kommentar"} ablehnen`;case"message":return`Nachricht an ${e.users?.username||"Benutzer"} senden`;default:return"Moderation"}},y=()=>{switch(t){case"approve":return`Dieser ${e.content_type==="post"?"Beitrag":"Kommentar"} wird für alle Benutzer sichtbar gemacht.`;case"reject":return`Dieser ${e.content_type==="post"?"Beitrag":"Kommentar"} wird abgelehnt und nur für den Autor sichtbar bleiben.`;case"message":return"Senden Sie eine Nachricht an den Benutzer bezüglich ihres Inhalts.";default:return""}},v=()=>{switch(t){case"approve":return{text:"Genehmigen",color:"bg-[#37a653] hover:bg-[#2e8844]"};case"reject":return{text:"Ablehnen",color:"bg-red-600 hover:bg-red-700"};case"message":return{text:"Nachricht senden",color:"bg-blue-600 hover:bg-blue-700"};default:return{text:"Bestätigen",color:"bg-gray-600 hover:bg-gray-700"}}},x=()=>{if(t==="message"&&!l.trim()){alert("Bitte geben Sie eine Nachricht ein.");return}if(t==="reject"&&d&&!l.trim()){alert("Bitte geben Sie eine Nachricht ein oder deaktivieren Sie die Nachrichtenoption.");return}const _=t==="message"||d?l.trim():void 0;s(_)},w=()=>{u(""),h(!1),r()},k=v();return p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:p.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:m()}),p.jsx("p",{className:"text-sm text-gray-600 mb-4",children:y()}),p.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg mb-4",children:[p.jsx("div",{className:"text-xs text-gray-500 mb-1",children:e.content_type==="post"?"Beitragstitel:":"Kommentar:"}),p.jsx("div",{className:"text-sm text-gray-800",children:e.content_type==="post"?e.title||"Kein Titel":(e.content||"").replace(/<[^>]*>/g,"").substring(0,100)+"..."}),p.jsxs("div",{className:"flex items-center mt-2",children:[e.users&&p.jsx("div",{className:"mr-2",children:p.jsx(sn,{user:e.users,size:"small"})}),p.jsxs("div",{className:"text-xs text-gray-500",children:["von ",e.users?.username||"Unbekannt"]})]})]}),(t==="approve"||t==="reject")&&p.jsx("div",{className:"mb-4",children:p.jsxs("label",{className:"flex items-center space-x-2",children:[p.jsx("input",{type:"checkbox",checked:d,onChange:_=>h(_.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),p.jsx("span",{className:"text-sm text-gray-700",children:"Nachricht an Benutzer senden"})]})}),(t==="message"||d)&&p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:t==="reject"?"Grund für Ablehnung":"Nachricht"}),p.jsx("textarea",{value:l,onChange:_=>u(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:t==="reject"?"Erklären Sie, warum dieser Inhalt nicht geeignet ist...":"Ihre Nachricht an den Benutzer..."})]}),p.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[p.jsx("button",{onClick:w,disabled:a,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors disabled:opacity-50",children:"Abbrechen"}),p.jsx("button",{onClick:x,disabled:a,className:`px-4 py-2 text-sm font-medium text-white rounded-md transition-colors disabled:opacity-50 ${k.color}`,children:a?"Verarbeitung...":k.text})]})]})})},ID=()=>{const n=bd(),[e,t]=T.useState([]),[r,s]=T.useState(!0),[a,l]=T.useState(null),[u,d]=T.useState(new Set),[h,m]=T.useState(""),[y,v]=T.useState(!1),[x,w]=T.useState(null),[k,_]=T.useState(!1),[N,M]=T.useState(null),[C,I]=T.useState(null),[H,Q]=T.useState({}),[G,X]=T.useState({}),[Y,ye]=T.useState([]),[$e,Ce]=T.useState(!1),[tt,ie]=T.useState(null),[he,$]=T.useState(null),P=new UD;T.useEffect(()=>(n.canModerate&&(Ae(),oe()),()=>{B.removeAllChannels()}),[n.canModerate]);const oe=()=>{const V=B.channel("posts-moderation").on("postgres_changes",{event:"*",schema:"public",table:"posts",filter:"moderation_status=eq.pending"},async te=>{if(console.log("Real-time posts update:",te),te.eventType==="INSERT"){const we=te.new,{data:be}=await B.from("posts").select(`
                *,
                users(id, username, email, role)
              `).eq("id",we.id).single();if(be){const At={content_type:"post",id:be.id,content_id:be.id,user_id:be.user_id,title:be.title,content:be.content,created_at:be.created_at,moderation_status:be.moderation_status,moderated_by:be.moderated_by,moderated_at:be.moderated_at,rejection_reason:be.rejection_reason,users:be.users};t(Le=>[At,...Le])}}else if(te.eventType==="UPDATE"){const we=te.new;we.moderation_status!=="pending"&&t(be=>be.filter(At=>!(At.content_type==="post"&&At.id===we.id)))}}).subscribe(),se=B.channel("comments-moderation").on("postgres_changes",{event:"*",schema:"public",table:"comments",filter:"moderation_status=eq.pending"},async te=>{if(console.log("Real-time comments update:",te),te.eventType==="INSERT"){const we=te.new,{data:be}=await B.from("comments").select(`
                *,
                users(id, username, email, role)
              `).eq("id",we.id).single();if(be){const At={content_type:"comment",id:be.id,content_id:be.id,user_id:be.user_id,content:be.content,created_at:be.created_at,moderation_status:be.moderation_status,moderated_by:be.moderated_by,moderated_at:be.moderated_at,rejection_reason:be.rejection_reason,post_id:be.post_id,users:be.users};t(Le=>[At,...Le])}}else if(te.eventType==="UPDATE"){const we=te.new;we.moderation_status!=="pending"&&t(be=>be.filter(At=>!(At.content_type==="comment"&&At.id===we.id)))}}).subscribe();return()=>{V.unsubscribe(),se.unsubscribe()}},Ae=async()=>{try{s(!0);const V=await P.getPendingContent();t(V),await Promise.all([Bd(V),Ll(V)])}catch(V){console.error("Error loading moderation queue:",V),alert("Fehler beim Laden der Moderationsqueue")}finally{s(!1)}},A=async(V,se)=>{if(!n.canModerate||!n.userProfile?.id){console.error("No permissions to moderate");return}l(V.id);try{V.content_type==="post"?await P.approvePost(V.id,n.userProfile.id):await P.approveComment(V.id,n.userProfile.id),se&&console.log(`Message to user: ${se}`),t(te=>te.filter(we=>we.id!==V.id)),alert(`${V.content_type==="post"?"Beitrag":"Kommentar"} genehmigt!`)}catch(te){throw console.error("Error approving content:",te),alert("Fehler beim Genehmigen: "+(te instanceof Error?te.message:"Unbekannter Fehler")),te}finally{l(null)}},W=async(V,se)=>{if(!n.canModerate||!n.userProfile?.id){console.error("No permissions to moderate");return}l(V.id);try{V.content_type==="post"?await P.rejectPost(V.id,n.userProfile.id,se):await P.rejectComment(V.id,n.userProfile.id,se),se&&console.log(`Rejection message to user: ${se}`),t(te=>te.filter(we=>we.id!==V.id)),alert(`${V.content_type==="post"?"Beitrag":"Kommentar"} abgelehnt!`)}catch(te){throw console.error("Error rejecting content:",te),alert("Fehler beim Ablehnen: "+(te instanceof Error?te.message:"Unbekannter Fehler")),te}finally{l(null)}},re=async V=>{!n.canModerate||!n.userProfile?.id||!x||(await W(x,V),v(!1),w(null),m(""))},ee=async()=>{if(!n.canModerate||!n.userProfile?.id||u.size===0)return;const V=Array.from(u).map(se=>{const te=e.find(we=>we.id===se);return te?{type:te.content_type,id:se}:null}).filter(Boolean);try{await P.bulkApprove(V,n.userProfile.id),t(se=>se.filter(te=>!u.has(te.id))),d(new Set),alert(`${V.length} Elemente genehmigt!`)}catch(se){console.error("Error bulk approving:",se),alert("Fehler bei der Massengenehmigung")}},de=async()=>{if(!n.canModerate||!n.userProfile?.id||u.size===0)return;const V=prompt("Grund für die Ablehnung (optional):");if(V===null)return;const se=Array.from(u).map(te=>e.find(be=>be.id===te)).filter(Boolean);try{await Promise.all(se.map(te=>te.content_type==="post"?P.rejectPost(te.id,n.userProfile.id,V):P.rejectComment(te.id,n.userProfile.id,V))),t(te=>te.filter(we=>!u.has(we.id))),d(new Set),alert(`${se.length} Elemente abgelehnt!`)}catch(te){console.error("Error bulk rejecting:",te),alert("Fehler bei der Massenablehnung")}},Oe=async()=>{if(!n.canModerate||u.size===0)return;const V=`Sind Sie sicher, dass Sie ${u.size} Elemente endgültig löschen möchten?`;if(!confirm(V))return;const se=Array.from(u).map(te=>{const we=e.find(be=>be.id===te);return we?{type:we.content_type,id:te}:null}).filter(Boolean);try{await P.bulkDelete(se,"Bulk moderation deletion"),t(te=>te.filter(we=>!u.has(we.id))),d(new Set),alert(`${se.length} Elemente gelöscht!`)}catch(te){console.error("Error bulk deleting:",te),alert("Fehler bei der Massenlöschung")}},ge=V=>{d(se=>{const te=new Set(se);return te.has(V)?te.delete(V):te.add(V),te})},Vt=V=>{M(V),_(!0)},Ke=V=>{const se=setTimeout(()=>{ge(V.id),navigator.vibrate&&navigator.vibrate(50)},500);I(se)},Dn=()=>{C&&(clearTimeout(C),I(null))},mi=async V=>{const se=`Sind Sie sicher, dass Sie ${V.content_type==="post"?"diesen Beitrag":"diesen Kommentar"} endgültig löschen möchten?`;if(confirm(se)){l(V.id);try{V.content_type==="post"?await P.deletePost(V.id,"Moderator deletion"):await P.deleteComment(V.id,"Moderator deletion"),t(te=>te.filter(we=>we.id!==V.id)),alert(`${V.content_type==="post"?"Beitrag":"Kommentar"} gelöscht!`)}catch(te){console.error("Error deleting content:",te),alert("Fehler beim Löschen")}finally{l(null)}}},Cs=V=>{$(V),ie("message"),Ce(!0)},za=async V=>{if(!(!he||!tt))try{tt==="approve"?await A(he,V):tt==="reject"?await W(he,V):tt==="message"&&(console.log(`Direct message to user: ${V}`),alert("Nachricht gesendet!")),Ce(!1),ie(null),$(null)}catch(se){console.error("Error in message modal confirm:",se)}},Ua=()=>{Ce(!1),ie(null),$(null)},Pa=async(V,se)=>{if(n.canModerate)try{const{error:te}=await B.from("posts").update({category_id:se}).eq("id",V);if(te)throw te;t(we=>we.map(be=>be.id===V&&be.content_type==="post"?{...be,category_id:se}:be)),alert("Kategorie erfolgreich geändert!")}catch(te){console.error("Error updating category:",te),alert("Fehler beim Ändern der Kategorie")}},Ld=V=>new Date(V).toLocaleString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),Dl=(V,se=100)=>V.length<=se?V:V.substring(0,se)+"...",yn=V=>{const se=V.replace(/<[^>]*>/g,""),te=se.split(`
`)[0]||se;return Dl(te,80)},Bd=async V=>{const se=V.filter(we=>we.content_type==="comment"&&we.post_id),te=[...new Set(se.map(we=>we.post_id))];if(te.length!==0)try{const{data:we,error:be}=await B.from("posts").select("id, title").in("id",te);if(be)throw be;const At={};we?.forEach(Le=>{At[Le.id]=Le.title}),Q(Le=>({...Le,...At}))}catch(we){console.error("Error fetching post titles:",we)}},Ll=async V=>{try{const{data:Le,error:Qe}=await B.from("categories").select("id, name_de").eq("is_active",!0).order("id",{ascending:!0});if(Qe)throw Qe;ye(Le||[])}catch(Le){console.error("Error fetching all categories:",Le)}const se=V.filter(Le=>Le.content_type==="post"),te=V.filter(Le=>Le.content_type==="comment"&&Le.post_id),we=se.map(Le=>Le.category_id).filter(Boolean);let be=[];if(te.length>0){const Le=te.map(xt=>xt.post_id),{data:Qe}=await B.from("posts").select("id, category_id").in("id",Le);Qe&&(be=Qe.map(xt=>xt.category_id).filter(Boolean),Qe.forEach(xt=>{const ot=te.find(zd=>zd.post_id===xt.id);ot&&(ot.category_id=xt.category_id)}))}const At=[...new Set([...we,...be])];if(At.length!==0)try{const{data:Le,error:Qe}=await B.from("categories").select("id, name_de").in("id",At);if(Qe)throw Qe;const xt={};Le?.forEach(ot=>{xt[ot.id]=ot.name_de}),X(ot=>({...ot,...xt}))}catch(Le){console.error("Error fetching categories:",Le)}};return n.canModerate?r?p.jsx("div",{className:"min-h-screen bg-[#1a3442] flex items-center justify-center",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#37a653]"})}):p.jsx("div",{className:"min-h-screen bg-[#1a3442]",children:p.jsxs("div",{className:"max-w-6xl mx-auto py-6 px-4 md:px-0",children:[p.jsxs("div",{className:"flex items-center justify-between mb-6",children:[p.jsxs("div",{children:[p.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Moderationsqueue"}),p.jsxs("p",{className:"text-gray-300",children:[e.length," Elemente warten auf Moderation"]})]}),u.size>0&&p.jsxs("div",{className:"flex items-center space-x-3",children:[p.jsxs("span",{className:"text-gray-300 text-sm",children:[u.size," ausgewählt"]}),p.jsx("button",{onClick:ee,className:"bg-[#37a653] hover:bg-[#2e8844] text-white px-4 py-2 rounded-lg transition-colors text-sm",children:"Publizieren"}),p.jsx("button",{onClick:de,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors text-sm",children:"Ablehnen"}),p.jsx("button",{onClick:Oe,className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors text-sm",children:"Löschen"}),p.jsx("button",{onClick:()=>d(new Set),className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors text-sm",children:"Auswahl aufheben"})]})]}),e.length===0?p.jsxs("div",{className:"bg-[#203f4a] p-8 text-center",style:{borderRadius:"20px"},children:[p.jsx("div",{className:"text-[#37a653] mb-4",children:p.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),p.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Queue ist leer"}),p.jsx("p",{className:"text-gray-300",children:"Alle Inhalte wurden moderiert!"})]}):p.jsx("div",{className:"space-y-4",children:e.map(V=>p.jsxs("div",{className:`p-6 mb-4 hover:bg-[#234652] transition-colors cursor-pointer relative ${u.has(V.id)?"ring-2 ring-[#37a653] bg-[#234652]":"bg-[#203f4a]"}`,style:{borderRadius:"20px"},onClick:()=>Vt(V),onTouchStart:()=>Ke(V),onTouchEnd:Dn,onTouchCancel:Dn,children:[p.jsx("span",{className:`absolute -top-2 left-4 z-10 inline-flex items-center px-2 py-0.5 rounded-lg font-medium shadow-lg ${V.content_type==="post"?"bg-gray-600 text-white":"bg-blue-600 text-white"}`,style:{fontSize:"0.65rem"},children:V.content_type==="post"?"Beitrag":"Kommentar"}),p.jsx("div",{className:"flex items-start justify-end mb-4",children:p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded bg-gray-600 text-white text-xs",children:"BS"}),p.jsx("div",{className:"hidden md:block",children:p.jsx("input",{type:"checkbox",checked:u.has(V.id),onChange:se=>{se.stopPropagation(),ge(V.id)},className:"w-4 h-4 text-[#37a653] bg-gray-100 border-gray-300 rounded focus:ring-[#37a653] focus:ring-2"})})]})}),V.content_type==="post"&&p.jsx("div",{className:"mb-2 flex justify-start",children:n.canModerate?p.jsxs("select",{value:V.category_id||"",onChange:se=>{se.target.value&&Pa(V.id,parseInt(se.target.value))},className:"px-2 py-0.5 rounded-lg font-medium bg-[#37a653] text-white border-none outline-none cursor-pointer hover:bg-[#2e8844] transition-colors w-auto",style:{fontSize:"0.65rem",minWidth:"fit-content"},onClick:se=>se.stopPropagation(),children:[p.jsx("option",{value:"",disabled:!0,children:"Kategorie wählen"}),Y.map(se=>p.jsx("option",{value:se.id,style:{backgroundColor:"#1a3442",color:"white"},children:se.name_de},se.id))]}):p.jsx("span",{className:"px-2 py-0.5 rounded-lg font-medium bg-[#37a653] text-white w-auto",style:{fontSize:"0.65rem"},children:V.category_id&&G[V.category_id]?G[V.category_id]:"Keine Kategorie"})}),p.jsxs("div",{className:"flex items-start space-x-3 mb-4",children:[V.users&&p.jsx(sn,{user:V.users,size:"small",className:"flex-shrink-0"}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("p",{className:"font-medium text-white text-xs text-left leading-none",children:V.users?.username}),p.jsx("p",{className:"text-xs text-gray-300 text-left leading-none mt-0.5",style:{fontSize:"0.65rem"},children:Ld(V.created_at)})]})]}),p.jsx("div",{className:"mb-4",children:V.content_type==="post"?V.title&&p.jsx("h3",{className:"text-base md:text-xl font-semibold text-[#37a653] leading-tight text-left",children:V.title}):p.jsxs("div",{children:[p.jsxs("div",{className:"text-gray-300 text-sm mb-2 italic text-left",children:['"',yn(V.content||""),'"']}),V.post_id&&p.jsxs("div",{className:"text-xs text-gray-400 text-left",children:["Kommentar zu: ",p.jsx("span",{className:"text-white",children:H[V.post_id]?Dl(H[V.post_id],40):`Post #${V.post_id}`})]})]})}),p.jsxs("div",{className:"absolute bottom-3 right-3 flex items-center space-x-1",children:[p.jsxs("button",{onClick:se=>{se.stopPropagation(),Cs(V)},disabled:a===V.id,className:"bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded transition-colors disabled:opacity-50",title:"Message",children:[p.jsx("span",{className:"md:hidden",children:p.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),p.jsx("span",{className:"hidden md:inline text-xs",children:"Message"})]}),p.jsxs("button",{onClick:se=>{se.stopPropagation(),mi(V)},disabled:a===V.id,className:"bg-gray-600 hover:bg-gray-700 text-white px-2 py-1 rounded transition-colors disabled:opacity-50",title:"Löschen",children:[p.jsx("span",{className:"md:hidden",children:p.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),p.jsx("span",{className:"hidden md:inline text-xs",children:"Löschen"})]}),p.jsxs("button",{onClick:se=>{se.stopPropagation(),$(V),ie("reject"),Ce(!0)},disabled:a===V.id,className:"bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded transition-colors disabled:opacity-50",title:"Ablehnen",children:[p.jsx("span",{className:"md:hidden",children:p.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),p.jsx("span",{className:"hidden md:inline text-xs",children:"Ablehnen"})]}),p.jsx("button",{onClick:se=>{se.stopPropagation(),$(V),ie("approve"),Ce(!0)},disabled:a===V.id,className:"bg-[#37a653] hover:bg-[#2e8844] text-white px-2 py-1 rounded transition-colors disabled:opacity-50 text-xs",title:"Publizieren",children:"Publizieren"})]})]},`${V.content_type}-${V.id}`))}),p.jsx(PD,{isOpen:k,item:N,postTitles:H,categories:G,onClose:()=>{_(!1),M(null)},onApprove:V=>{_(!1),M(null),$(V),ie("approve"),Ce(!0)},onReject:V=>{_(!1),M(null),$(V),ie("reject"),Ce(!0)},onDelete:V=>{_(!1),M(null),mi(V)},onMessage:V=>{_(!1),M(null),Cs(V)},isProcessing:a!==null}),y&&x&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:p.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[p.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:[x.content_type==="post"?"Beitrag":"Kommentar"," ablehnen"]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Grund für Ablehnung (optional)"}),p.jsx("textarea",{value:h,onChange:V=>m(V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500",rows:3,placeholder:"Erklären Sie, warum dieser Inhalt nicht geeignet ist..."})]}),p.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[p.jsx("button",{onClick:()=>{v(!1),w(null),m("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Abbrechen"}),p.jsx("button",{onClick:()=>re(h),disabled:a===x.id,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors disabled:opacity-50",children:a===x.id?"Verarbeitung...":"Ablehnen"})]})]})}),p.jsx($D,{isOpen:$e,item:he,actionType:tt,onClose:Ua,onConfirm:za,isProcessing:a!==null})]})}):p.jsx("div",{className:"min-h-screen bg-[#1a3442] flex items-center justify-center",children:p.jsxs("div",{className:"text-white text-center",children:[p.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Zugriff verweigert"}),p.jsx("p",{className:"text-gray-300",children:"Sie haben keine Berechtigung für die Moderationsqueue."})]})})},HD=()=>{const[n,e]=T.useState(null),t=r=>{e(r)};return p.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:p.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[p.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Therapist Directory"}),p.jsx("p",{className:"text-gray-600 mb-8",children:"Search and explore our directory of qualified therapists."}),p.jsx(Rm,{selectedTherapist:n,onTherapistSelect:t}),n&&p.jsxs("div",{className:"mt-8 p-6 bg-gray-50 rounded-lg",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Selected Therapist"}),p.jsxs("div",{className:"space-y-2",children:[p.jsxs("p",{children:[p.jsx("span",{className:"font-medium",children:"Name:"})," ",n.form_of_address," ",n.first_name," ",n.last_name]}),p.jsxs("p",{children:[p.jsx("span",{className:"font-medium",children:"Designation:"})," ",n.designation]}),n.institution&&p.jsxs("p",{children:[p.jsx("span",{className:"font-medium",children:"Institution:"})," ",n.institution]}),n.canton&&p.jsxs("p",{children:[p.jsx("span",{className:"font-medium",children:"Canton:"})," ",n.canton]}),n.description&&p.jsxs("p",{children:[p.jsx("span",{className:"font-medium",children:"Description:"})," ",n.description]})]})]})]})})})},qD=()=>{const{userProfile:n,updateProfile:e}=Jt(),[t,r]=T.useState(!1),[s,a]=T.useState({username:"",bio:"",default_canton:"",language_preference:"",messages_active:!1}),[l,u]=T.useState(!1),[d,h]=T.useState(null),m=[{value:"",label:"Kanton auswählen"},{value:"AG",label:"Aargau"},{value:"AI",label:"Appenzell Innerrhoden"},{value:"AR",label:"Appenzell Ausserrhoden"},{value:"BE",label:"Bern"},{value:"BL",label:"Basel-Landschaft"},{value:"BS",label:"Basel-Stadt"},{value:"FR",label:"Freiburg"},{value:"GE",label:"Genf"},{value:"GL",label:"Glarus"},{value:"GR",label:"Graubünden"},{value:"JU",label:"Jura"},{value:"LU",label:"Luzern"},{value:"NE",label:"Neuenburg"},{value:"NW",label:"Nidwalden"},{value:"OW",label:"Obwalden"},{value:"SG",label:"St. Gallen"},{value:"SH",label:"Schaffhausen"},{value:"SO",label:"Solothurn"},{value:"SZ",label:"Schwyz"},{value:"TG",label:"Thurgau"},{value:"TI",label:"Tessin"},{value:"UR",label:"Uri"},{value:"VD",label:"Waadt"},{value:"VS",label:"Wallis"},{value:"ZG",label:"Zug"},{value:"ZH",label:"Zürich"}],y=[{value:"de",label:"Deutsch"},{value:"fr",label:"Français"},{value:"it",label:"Italiano"}];T.useEffect(()=>{n&&a({username:n.username||"",bio:n.bio||"",default_canton:n.default_canton||"",language_preference:n.language_preference||"de",messages_active:n.messages_active??!0})},[n]);const v=async w=>{if(w.preventDefault(),!!n){u(!0),h(null);try{await e({username:s.username,bio:s.bio,default_canton:s.default_canton||null,language_preference:s.language_preference,messages_active:s.messages_active}),h({type:"success",text:"Settings updated successfully!"}),r(!1)}catch(k){console.error("Profile update error:",k),h({type:"error",text:k instanceof Error?k.message:"Failed to update settings"})}finally{u(!1)}}},x=()=>{n&&a({username:n.username||"",bio:n.bio||"",default_canton:n.default_canton||"",language_preference:n.language_preference||"de",messages_active:n.messages_active??!0}),r(!1),h(null)};return n?p.jsx("div",{className:"bg-white rounded-lg shadow-sm",children:p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex items-center justify-between mb-6",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Profile Settings"}),!t&&p.jsx("button",{onClick:()=>r(!0),className:"text-[#37a653] hover:text-[#2d8544] font-medium text-sm transition-colors duration-200",children:"Edit Settings"})]}),d&&p.jsx("div",{className:`mb-6 p-4 rounded-lg ${d.type==="success"?"bg-green-50 border border-green-200 text-green-700":"bg-red-50 border border-red-200 text-red-700"}`,children:d.text}),p.jsx("form",{onSubmit:v,children:p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),t?p.jsx("input",{type:"text",value:s.username,onChange:w=>a({...s,username:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#37a653] focus:border-transparent",required:!0}):p.jsx("p",{className:"text-gray-900",children:n.username})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),t?p.jsx("textarea",{value:s.bio,onChange:w=>a({...s,bio:w.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#37a653] focus:border-transparent resize-none",placeholder:"Tell us a bit about yourself..."}):p.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:n.bio||p.jsx("span",{className:"text-gray-500 italic",children:"No bio provided"})})]}),p.jsxs("div",{className:"border-t pt-6",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Private Settings"}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Canton"}),t?p.jsx(hd,{value:s.default_canton,options:m,onChange:w=>a({...s,default_canton:w}),badgeClassName:"bg-gray-100 text-gray-800 hover:bg-gray-200",placeholder:"Select canton..."}):p.jsx("p",{className:"text-gray-900",children:m.find(w=>w.value===n.default_canton)?.label||p.jsx("span",{className:"text-gray-500 italic",children:"No default canton set"})})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Language"}),t?p.jsx(hd,{value:s.language_preference,options:y,onChange:w=>a({...s,language_preference:w}),badgeClassName:"bg-blue-100 text-blue-800 hover:bg-blue-200"}):p.jsx("p",{className:"text-gray-900",children:y.find(w=>w.value===n.language_preference)?.label||"Deutsch"})]}),p.jsx("div",{children:p.jsxs("label",{className:"flex items-center justify-between",children:[p.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Allow private messages"}),t?p.jsx("button",{type:"button",onClick:()=>a({...s,messages_active:!s.messages_active}),className:`
                          relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent 
                          transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-[#37a653] focus:ring-offset-2
                          ${s.messages_active?"bg-[#37a653]":"bg-gray-200"}
                        `,children:p.jsx("span",{className:`
                            pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 
                            transition duration-200 ease-in-out
                            ${s.messages_active?"translate-x-5":"translate-x-0"}
                          `})}):p.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${n.messages_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:n.messages_active?"Enabled":"Disabled"})]})})]})]}),t&&p.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[p.jsx("button",{type:"submit",disabled:l,className:"flex-1 bg-[#37a653] hover:bg-[#2d8544] text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Saving...":"Save Changes"}),p.jsx("button",{type:"button",onClick:x,disabled:l,className:"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"})]})]})})]})}):null};class hu{static async searchUsers(e,t){if(!e.trim()||e.length<2)return[];try{let r=B.from("users").select("id, username, avatar_url, created_at").ilike("username",`%${e.trim()}%`).limit(10);t&&(r=r.neq("id",t));const{data:s,error:a}=await r;if(a)throw console.error("User search error:",a),new Error("Failed to search users");return s||[]}catch(r){throw console.error("Error searching users:",r),r}}static async getBlockedUsers(e){try{const{data:t,error:r}=await B.from("user_blocks").select("blocker_id, blocked_id, blocked_at").eq("blocker_id",e).order("blocked_at",{ascending:!1});if(r)throw console.error("Error fetching blocked user IDs:",r),new Error("Failed to load blocked users");if(!t||t.length===0)return[];const s=t.map(d=>d.blocked_id),{data:a,error:l}=await B.from("users").select("id, username, avatar_url, created_at").in("id",s);if(l)throw console.error("Error fetching blocked users info:",l),new Error("Failed to load blocked users");return t.map(d=>({...d,blocked_user:a?.find(h=>h.id===d.blocked_id)}))}catch(t){throw console.error("Error getting blocked users:",t),t}}static async blockUser(e,t){if(e===t)throw new Error("You cannot block yourself");try{const{data:r}=await B.from("user_blocks").select("blocker_id").eq("blocker_id",e).eq("blocked_id",t).single();if(r)throw new Error("User is already blocked");const{error:s}=await B.from("user_blocks").insert({blocker_id:e,blocked_id:t,blocked_at:new Date().toISOString()});if(s)throw console.error("Block user error:",s),new Error("Failed to block user")}catch(r){throw console.error("Error blocking user:",r),r}}static async unblockUser(e,t){try{const{error:r}=await B.from("user_blocks").delete().eq("blocker_id",e).eq("blocked_id",t);if(r)throw console.error("Unblock user error:",r),new Error("Failed to unblock user")}catch(r){throw console.error("Error unblocking user:",r),r}}static async isUserBlocked(e,t){try{const{data:r,error:s}=await B.from("user_blocks").select("blocker_id").eq("blocker_id",e).eq("blocked_id",t).single();return s&&s.code!=="PGRST116"?(console.error("Error checking block status:",s),!1):!!r}catch(r){return console.error("Error checking if user is blocked:",r),!1}}static async getUsersWhoBlockedMe(e){try{const{data:t,error:r}=await B.from("user_blocks").select("blocker_id").eq("blocked_id",e);return r?(console.error("Error getting users who blocked me:",r),[]):t.map(s=>s.blocker_id)}catch(t){return console.error("Error getting users who blocked me:",t),[]}}}const VD=()=>{const{userProfile:n}=Jt(),[e,t]=T.useState([]),[r,s]=T.useState(""),[a,l]=T.useState([]),[u,d]=T.useState(!1),[h,m]=T.useState(!1),[y,v]=T.useState(null);T.useEffect(()=>{n?.id&&x()},[n?.id]),T.useEffect(()=>{const C=setTimeout(()=>{r.length>=2?w():l([])},300);return()=>clearTimeout(C)},[r]);const x=async()=>{if(n?.id){d(!0);try{const C=await hu.getBlockedUsers(n.id);t(C)}catch(C){console.error("Error loading blocked users:",C),v({type:"error",text:"Failed to load blocked users"})}finally{d(!1)}}},w=async()=>{if(!(!n?.id||r.length<2)){m(!0);try{const C=await hu.searchUsers(r,n.id),I=e.map(Q=>Q.blocked_id),H=C.filter(Q=>Q.id&&!I.includes(Q.id));l(H)}catch(C){console.error("Error searching users:",C),v({type:"error",text:"Failed to search users"})}finally{m(!1)}}},k=async C=>{if(n?.id){m(!0),v(null);try{await hu.blockUser(n.id,C.id),v({type:"success",text:`Successfully blocked ${C.username}`}),await x(),s(""),l([])}catch(I){console.error("Error blocking user:",I),v({type:"error",text:I instanceof Error?I.message:"Failed to block user"})}finally{m(!1)}}},_=async C=>{if(n?.id){d(!0),v(null);try{await hu.unblockUser(n.id,C.blocked_id),v({type:"success",text:`Successfully unblocked ${C.blocked_user?.username||"user"}`}),await x()}catch(I){console.error("Error unblocking user:",I),v({type:"error",text:I instanceof Error?I.message:"Failed to unblock user"})}finally{d(!1)}}},N=C=>new Date(C).toLocaleDateString("de-DE",{year:"numeric",month:"short",day:"numeric"}),M=()=>v(null);return n?p.jsx("div",{className:"bg-white rounded-lg shadow-sm",children:p.jsxs("div",{className:"p-6",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Blocked Users"}),y&&p.jsxs("div",{className:`mb-6 p-4 rounded-lg flex items-center justify-between ${y.type==="success"?"bg-green-50 border border-green-200 text-green-700":"bg-red-50 border border-red-200 text-red-700"}`,children:[p.jsx("span",{children:y.text}),p.jsx("button",{onClick:M,className:"text-current hover:opacity-75 ml-2",children:"×"})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search users to block"}),p.jsxs("div",{className:"relative",children:[p.jsx("input",{type:"text",value:r,onChange:C=>s(C.target.value),placeholder:"Type username to search...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#37a653] focus:border-transparent"}),h&&p.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:p.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-[#37a653]"})})]}),a.length>0&&p.jsx("div",{className:"mt-2 border border-gray-200 rounded-lg bg-white shadow-sm max-h-48 overflow-y-auto",children:a.map(C=>p.jsxs("div",{className:"p-3 border-b border-gray-100 last:border-b-0 flex items-center justify-between hover:bg-gray-50",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("img",{src:C.avatar_url||xa.getDefaultAvatar(C.username||"User"),alt:`${C.username||"User"}'s avatar`,className:"w-8 h-8 rounded-full mr-3"}),p.jsxs("div",{children:[p.jsx("p",{className:"font-medium text-gray-900",children:C.username}),p.jsxs("p",{className:"text-xs text-gray-500",children:["Member since ",N(C.created_at)]})]})]}),p.jsx("button",{onClick:()=>k(C),disabled:h,className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm font-medium transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Block"})]},C.id))}),r.length>=2&&a.length===0&&!h&&p.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:['No users found matching "',r,'"']})]}),p.jsxs("div",{children:[p.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Currently Blocked (",e.length,")"]}),u?p.jsx("div",{className:"flex items-center justify-center py-8",children:p.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#37a653]"})}):e.length===0?p.jsxs("div",{className:"text-center py-8",children:[p.jsx("svg",{className:"w-12 h-12 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L5.636 5.636"})}),p.jsx("p",{className:"text-gray-500",children:"No blocked users"}),p.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Users you block will appear here"})]}):p.jsx("div",{className:"space-y-3",children:e.map(C=>p.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("img",{src:C.blocked_user?.avatar_url||xa.getDefaultAvatar(C.blocked_user?.username||"User"),alt:`${C.blocked_user?.username||"User"}'s avatar`,className:"w-10 h-10 rounded-full mr-4"}),p.jsxs("div",{children:[p.jsx("p",{className:"font-medium text-gray-900",children:C.blocked_user?.username||"Unknown User"}),p.jsxs("p",{className:"text-sm text-gray-500",children:["Blocked on ",N(C.blocked_at)]})]})]}),p.jsx("button",{onClick:()=>_(C),disabled:u,className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Unblock"})]},C.blocked_id))})]})]})}):null};class Fo{static async getUserPosts(e,t=50){try{const{data:r,error:s}=await B.from("posts").select(`
          *,
          categories(id, name_de),
          therapists(id, form_of_address, first_name, last_name, designation, institution)
        `).eq("user_id",e).order("created_at",{ascending:!1}).limit(t);if(s)throw console.error("Error fetching user posts:",s),new Error("Failed to load user posts");return r||[]}catch(r){throw console.error("Error getting user posts:",r),r}}static async getUserComments(e,t=50){try{const{data:r,error:s}=await B.from("comments").select(`
          *,
          posts(id, title, category_id, created_at)
        `).eq("user_id",e).order("created_at",{ascending:!1}).limit(t);if(s)throw console.error("Error fetching user comments:",s),new Error("Failed to load user comments");return r||[]}catch(r){throw console.error("Error getting user comments:",r),r}}static async getUserDrafts(e,t=50){try{const{data:r,error:s}=await B.from("post_drafts").select("*").eq("user_id",e).order("updated_at",{ascending:!1}).limit(t);if(s)throw console.error("Error fetching user drafts:",s),new Error("Failed to load user drafts");return r||[]}catch(r){throw console.error("Error getting user drafts:",r),r}}static async deleteDraft(e,t){try{const{error:r}=await B.from("post_drafts").delete().eq("id",e).eq("user_id",t);if(r)throw console.error("Error deleting draft:",r),new Error("Failed to delete draft")}catch(r){throw console.error("Error deleting draft:",r),r}}static getPostStatusBadge(e){return e.is_banned?{text:"Banned",className:"bg-red-100 text-red-800 border-red-200"}:e.is_active?e.is_published?e.is_published&&e.is_active&&!e.is_banned?{text:"Published",className:"bg-green-100 text-green-800 border-green-200"}:{text:"Unknown",className:"bg-gray-100 text-gray-800 border-gray-200"}:{text:"Pending Review",className:"bg-yellow-100 text-yellow-800 border-yellow-200"}:{text:"Inactive",className:"bg-gray-100 text-gray-800 border-gray-200"}}static async getPostCommentCount(e){try{const{count:t,error:r}=await B.from("comments").select("*",{count:"exact",head:!0}).eq("post_id",e).eq("is_active",!0).neq("is_banned",!0);return r?(console.error("Error getting comment count:",r),0):t||0}catch(t){return console.error("Error getting post comment count:",t),0}}}const FD=({userId:n})=>{const[e,t]=T.useState("posts"),[r,s]=T.useState([]),[a,l]=T.useState([]),[u,d]=T.useState([]),[h,m]=T.useState(!1),[y,v]=T.useState(null);T.useEffect(()=>{x()},[e,n]);const x=async()=>{m(!0),v(null);try{switch(e){case"posts":const C=await Fo.getUserPosts(n);s(C);break;case"comments":const I=await Fo.getUserComments(n);l(I);break;case"drafts":const H=await Fo.getUserDrafts(n);d(H);break}}catch(C){console.error(`Error loading ${e}:`,C),v({type:"error",text:`Failed to load ${e}`})}finally{m(!1)}},w=async C=>{if(confirm("Are you sure you want to delete this draft?"))try{await Fo.deleteDraft(C,n),v({type:"success",text:"Draft deleted successfully"}),e==="drafts"&&await x()}catch(I){console.error("Error deleting draft:",I),v({type:"error",text:I instanceof Error?I.message:"Failed to delete draft"})}},k=C=>new Date(C).toLocaleDateString("de-DE",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),_=(C,I)=>C.length<=I?C:C.substring(0,I).trim()+"...",N=C=>{const I=Fo.getPostStatusBadge(C);return p.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${I.className}`,children:I.text})},M=()=>v(null);return p.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[p.jsx("div",{className:"border-b border-gray-200",children:p.jsxs("div",{className:"p-6 pb-0",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"My Content"}),p.jsx("div",{className:"flex space-x-8",children:[{id:"posts",label:"Posts",count:r.length},{id:"comments",label:"Comments",count:a.length},{id:"drafts",label:"Drafts",count:u.length}].map(C=>p.jsxs("button",{onClick:()=>t(C.id),className:`pb-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${e===C.id?"border-[#37a653] text-[#37a653]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[C.label,(e===C.id||C.count>0)&&p.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs ${e===C.id?"bg-[#37a653]/10 text-[#37a653]":"bg-gray-100 text-gray-600"}`,children:C.count})]},C.id))})]})}),p.jsxs("div",{className:"p-6",children:[y&&p.jsxs("div",{className:`mb-6 p-4 rounded-lg flex items-center justify-between ${y.type==="success"?"bg-green-50 border border-green-200 text-green-700":"bg-red-50 border border-red-200 text-red-700"}`,children:[p.jsx("span",{children:y.text}),p.jsx("button",{onClick:M,className:"text-current hover:opacity-75 ml-2",children:"×"})]}),h?p.jsx("div",{className:"flex items-center justify-center py-12",children:p.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#37a653]"})}):p.jsxs("div",{children:[e==="posts"&&p.jsx("div",{children:r.length===0?p.jsxs("div",{className:"text-center py-12",children:[p.jsx("svg",{className:"w-12 h-12 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),p.jsx("p",{className:"text-gray-500",children:"No posts yet"}),p.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Your published and pending posts will appear here"})]}):p.jsx("div",{className:"space-y-4",children:r.map(C=>p.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors duration-200",children:[p.jsx("div",{className:"flex items-start justify-between mb-3",children:p.jsxs("div",{className:"flex-1",children:[p.jsx(vt,{to:`/post/${C.id}`,className:"text-lg font-medium text-gray-900 hover:text-[#37a653] transition-colors duration-200",children:C.title||"Untitled Post"}),p.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[N(C),C.categories&&p.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-600",children:C.categories.name_de}),C.canton&&p.jsx("img",{src:`/kantone/${C.canton.toLowerCase()}.png`,alt:`${C.canton} flag`,className:"w-4 h-auto object-cover",onError:I=>{I.target.style.display="none"}}),C.canton&&p.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-600",children:C.canton})]})]})}),p.jsx("p",{className:"text-gray-600 text-sm mb-3",children:_(C.content.replace(/<[^>]*>/g,""),150)}),p.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[p.jsxs("span",{children:["Created ",k(C.created_at)]}),C.therapists&&p.jsxs("span",{children:["with ",C.therapists.first_name," ",C.therapists.last_name]})]})]},C.id))})}),e==="comments"&&p.jsx("div",{children:a.length===0?p.jsxs("div",{className:"text-center py-12",children:[p.jsx("svg",{className:"w-12 h-12 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),p.jsx("p",{className:"text-gray-500",children:"No comments yet"}),p.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Your comments on posts will appear here"})]}):p.jsx("div",{className:"space-y-4",children:a.map(C=>p.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[p.jsx("div",{className:"mb-3",children:C.posts&&p.jsxs(vt,{to:`/post/${C.posts.id}`,className:"text-sm font-medium text-[#37a653] hover:text-[#2d8544] transition-colors duration-200",children:["Comment on: ",C.posts.title||"Untitled Post"]})}),p.jsx("div",{className:"text-gray-700 text-sm mb-3",children:_(C.content.replace(/<[^>]*>/g,""),200)}),p.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[p.jsxs("span",{children:["Posted ",k(C.created_at)]}),C.is_edited&&p.jsx("span",{className:"text-xs text-gray-400",children:"Edited"})]})]},C.id))})}),e==="drafts"&&p.jsx("div",{children:u.length===0?p.jsxs("div",{className:"text-center py-12",children:[p.jsx("svg",{className:"w-12 h-12 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),p.jsx("p",{className:"text-gray-500",children:"No drafts saved"}),p.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Your unsaved post drafts will appear here"})]}):p.jsx("div",{className:"space-y-4",children:u.map(C=>p.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[p.jsxs("div",{className:"flex items-start justify-between mb-3",children:[p.jsxs("div",{className:"flex-1",children:[p.jsx("h4",{className:"text-lg font-medium text-gray-900",children:C.title||"Untitled Draft"}),p.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800 border border-blue-200",children:"Draft"})]}),p.jsx("button",{onClick:()=>w(C.id),className:"text-red-500 hover:text-red-700 p-1 transition-colors duration-200",title:"Delete draft",children:p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),p.jsx("p",{className:"text-gray-600 text-sm mb-3",children:_(C.content.replace(/<[^>]*>/g,""),150)}),p.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[p.jsxs("span",{children:["Last edited ",k(C.updated_at)]}),p.jsxs("span",{children:["Created ",k(C.created_at)]})]})]},C.id))})})]})]})]})},KD=()=>{const{user:n,userProfile:e}=Jt(),[t,r]=T.useState(!1);if(!n||!e)return p.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#37a653] mx-auto"}),p.jsx("p",{className:"mt-4 text-gray-600",children:"Loading profile..."})]})});const s=a=>new Date(a).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric"});return p.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:p.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"bg-gradient-to-r from-[#37a653] to-[#2d8544] rounded-lg h-48 relative overflow-hidden"}),p.jsx("div",{className:"absolute -bottom-16 left-1/2 transform -translate-x-1/2",children:p.jsx(sn,{user:e,size:"large",showUpload:!0})}),p.jsx("div",{className:"absolute top-4 right-4",children:p.jsxs("button",{onClick:()=>r(!t),className:"bg-white/90 hover:bg-white text-[#37a653] px-4 py-2 rounded-lg font-medium text-sm transition-colors duration-200 flex items-center shadow-sm",children:[p.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit Profile"]})})]}),p.jsx("div",{className:"mt-20 bg-white rounded-lg shadow-sm p-6",children:p.jsxs("div",{className:"text-left",children:[p.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:e.username}),p.jsxs("p",{className:"text-gray-500 mb-4",children:["Member since ",s(e.created_at)]}),e.bio&&p.jsx("div",{children:p.jsx("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:e.bio})})]})}),t&&p.jsxs("div",{className:"mt-6 space-y-6",children:[p.jsx(qD,{}),p.jsx(VD,{})]}),p.jsx("div",{className:"mt-6",children:p.jsx(FD,{userId:e.id})})]})})};function GD(){const[n,e]=T.useState(!1),{user:t,loading:r}=Jt();mj(),gj(),T.useEffect(()=>{yj()},[]);const s=()=>{e(!0)};return r?p.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),p.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):t?p.jsx(WN,{children:p.jsx(xj,{onCreatePost:s,children:p.jsxs(_N,{children:[p.jsx(rs,{path:"/",element:p.jsx(ND,{showCreatePostDialog:n,onCreatePostDialogClose:()=>e(!1)})}),p.jsx(rs,{path:"/post/:id",element:p.jsx(AD,{})}),p.jsx(rs,{path:"/messages",element:p.jsx(BD,{})}),p.jsx(rs,{path:"/therapists",element:p.jsx(HD,{})}),p.jsx(rs,{path:"/profile",element:p.jsx(KD,{})}),p.jsx(rs,{path:"/admin",element:p.jsx(zD,{})}),p.jsx(rs,{path:"/admin/moderation",element:p.jsx(ID,{})})]})})}):p.jsx(WD,{})}function WD(){const[n,e]=T.useState(""),[t,r]=T.useState(""),[s,a]=T.useState(!1),[l,u]=T.useState(!1),[d,h]=T.useState(""),{login:m,register:y}=Jt(),v=async x=>{x.preventDefault(),a(!0),h("");try{l?(await y(n,t,n.split("@")[0]),h("Check your email for the confirmation link!")):await m(n,t)}catch(w){h(w instanceof Error?w.message:"An error occurred")}finally{a(!1)}};return p.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"max-w-md w-full space-y-8",children:[p.jsxs("div",{children:[p.jsx("h1",{className:"text-4xl font-headline font-bold text-center text-primary-600 mb-2",children:"Remy Forum"}),p.jsx("h2",{className:"text-2xl font-headline font-semibold text-center text-gray-900",children:l?"Create your account":"Sign in to your account"}),p.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"A safe space for psychotherapy patient experiences"})]}),p.jsxs("form",{className:"mt-8 space-y-6",onSubmit:v,children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),p.jsx("input",{id:"email",name:"email",type:"email",required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter your email",value:n,onChange:x=>e(x.target.value)})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),p.jsx("input",{id:"password",name:"password",type:"password",required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter your password",value:t,onChange:x=>r(x.target.value)})]}),d&&p.jsx("div",{className:`rounded-md p-4 ${d.includes("error")||d.includes("Error")?"bg-red-50 border border-red-200 text-red-700":"bg-green-50 border border-green-200 text-green-700"}`,children:d}),p.jsx("div",{children:p.jsx("button",{type:"submit",disabled:s,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:s?"Loading...":l?"Sign Up":"Sign In"})}),p.jsx("div",{className:"text-center",children:p.jsx("button",{type:"button",onClick:()=>u(!l),className:"text-sm text-primary-600 hover:text-primary-500",children:l?"Already have an account? Sign In":"Need an account? Sign Up"})})]})]})})}RE.createRoot(document.getElementById("root")).render(p.jsx(T.StrictMode,{children:p.jsx(GD,{})}));
